/*
MICROSOFT SOFTWARE LICENSE TERMS
MICROSOFT AZURE MAPS WEB SDK
These license terms are an agreement between you and Microsoft Corporation (or one of its affiliates). They apply to the software named above and any Microsoft services or software updates (except to the extent such services or updates are accompanied by new or additional terms, in which case those different terms apply prospectively and do not alter your or Microsoft’s rights relating to pre-updated software or services). IF YOU COMPLY WITH THESE LICENSE TERMS, YOU HAVE THE RIGHTS BELOW.  BY USING THE SOFTWARE, YOU ACCEPT THESE TERMS.
1. INSTALLATION AND USE RIGHTS.
  a) General. You may install and use any number of copies of the software to develop and test your applications.
  b) User Region Parameters. The software will allow you to select from a View list to set the map view within your application for a given customer. By default the View parameter (also referred to as “user region parameter” is set to “Unified”.  Countries/Regions that are not on the View list will default to the “Unified” View. It is your responsibility to determine the location of your users, and then set the View parameter correctly for that location. The View parameter must be used in compliance with applicable laws, including those regarding mapping, of the country where maps, images and other data and third party content that You are authorized to access via the software is made available. 
  c) Third Party Software. The software may include third party applications that Microsoft, not the third party, licenses to you under this agreement. Any included notices for third party applications are for your information only.
  d) Microsoft Online Subscription Agreement. Some features of the software provide access to, or rely on, Microsoft Azure Services. The use of those services (but not the software) is governed by the separate terms and privacy policies associated with your Microsoft Azure subscription. The services may not be available in all regions. For more information see https://go.microsoft.com/fwLink/?LinkID=522330&amp;clcid=0x9.
2. DISTRIBUTABLE CODE. The software is comprised of “Distributable Code”. “Distributable Code” is code that you are permitted to distribute in applications you develop if you comply with the terms below and otherwise set forth in these license terms. 
  a) Distribution Rights. 
    i. You may copy and distribute the object code form of the software.
    i. Third Party Distribution. You may permit distributors of your applications to copy and distribute any of this distributable code you elect to distribute with your applications.
  b) Distribution Requirements. For any code you distribute, you must:
    i. add significant primary functionality to it in your applications;
    ii. require distributors and external end users to agree to terms that protect it and Microsoft at least as much as this agreement; and
    iii. indemnify, defend, and hold harmless Microsoft from any claims, including attorneys’ fees, related to the distribution or use of your applications, except to the extent that any claim is based solely on the unmodified distributable code.
  c) Distribution Restrictions. You may not:
    i. use Microsoft’s trademarks or trade dress in your application in any way that suggests your application comes from or is endorsed by Microsoft; or
    ii. modify or distribute the source code of any distributable code so that any part of it becomes subject to any license that requires that the distributable code, any other part of the software, or any of Microsoft’s other intellectual property be disclosed or distributed in source code form, or that others have the right to modify it.
3. DATA COLLECTION. The software may collect information about you and your use of the software and send that to Microsoft. Microsoft may use this information to provide services and improve Microsoft’s products and services. Your opt-out rights, if any, are described in the product documentation. Some features in the software may enable collection of data from users of your applications that access or use the software. If you use these features to enable data collection in your applications, you must comply with applicable law, including getting any required user consent, and maintain a prominent privacy policy that accurately informs users about how you use, collect, and share their data. You can learn more about Microsoft’s data collection and use in the product documentation and the Microsoft Privacy Statement at https://go.microsoft.com/fwlink/?LinkId=512132. You agree to comply with all applicable provisions of the Microsoft Privacy Statement.
4. SCOPE OF LICENSE. The software is licensed, not sold. Microsoft reserves all other rights. Unless applicable law gives you more rights despite this limitation, you will not (and have no right to):
  a) work around any technical limitations in the software that only allow you to use it in certain ways;
  b) reverse engineer, decompile, or disassemble the software, or attempt to do so, except and only to the extent permitted by licensing terms governing the use of open-source components that may be included with the software;
  c) remove, minimize, block, or modify any notices of Microsoft or its suppliers in the software;
  d) use the software in any way that is against the law or to create or propagate malware; or
  e) share, publish, distribute, or lend the software (except for any distributable code, subject to the terms above), provide the software as a stand-alone hosted solution for others to use, or transfer the software or this agreement to any third party.
5. EXPORT RESTRICTIONS. You must comply with all domestic and international export laws and regulations that apply to the software, which include restrictions on destinations, end users, and end use. For further information on export restrictions, visit http://aka.ms/exporting.
6. SUPPORT SERVICES. Microsoft is not obligated under this agreement to provide any support services for the software. Any support provided is “as is”, “with all faults”, and without warranty of any kind.
7. UPDATES. The software may periodically check for updates, and download and install them for you. You may obtain updates only from Microsoft or authorized sources. Microsoft may need to update your system to provide you with updates. You agree to receive these automatic updates without any additional notice. Updates may not include or support all existing software features, services, or peripheral devices.
8. ENTIRE AGREEMENT. This agreement, and any other terms Microsoft may provide for supplements, updates, or third-party applications, is the entire agreement for the software.
9. APPLICABLE LAW AND PLACE TO RESOLVE DISPUTES. If you acquired the software in the United States or Canada, the laws of the state or province where you live (or, if a business, where your principal place of business is located) govern the interpretation of this agreement, claims for its breach, and all other claims (including consumer protection, unfair competition, and tort claims), regardless of conflict of laws principles. If you acquired the software in any other country, its laws apply. If U.S. federal jurisdiction exists, you and Microsoft consent to exclusive jurisdiction and venue in the federal court in King County, Washington for all disputes heard in court. If not, you and Microsoft consent to exclusive jurisdiction and venue in the Superior Court of King County, Washington for all disputes heard in court.
10. CONSUMER RIGHTS; REGIONAL VARIATIONS. This agreement describes certain legal rights. You may have other rights, including consumer rights, under the laws of your state or country. Separate and apart from your relationship with Microsoft, you may also have rights with respect to the party from which you acquired the software. This agreement does not change those other rights if the laws of your state or country do not permit it to do so. For example, if you acquired the software in one of the below regions, or mandatory country law applies, then the following provisions apply to you:
  a) Australia. You have statutory guarantees under the Australian Consumer Law and nothing in this agreement is intended to affect those rights.
  b) Canada. If you acquired this software in Canada, you may stop receiving updates by turning off the automatic update feature, disconnecting your device from the Internet (if and when you re-connect to the Internet, however, the software will resume checking for and installing updates), or uninstalling the software. The product documentation, if any, may also specify how to turn off updates for your specific device or software.
  c) Germany and Austria.
    i. Warranty. The properly licensed software will perform substantially as described in any Microsoft materials that accompany the software. However, Microsoft gives no contractual guarantee in relation to the licensed software.
    ii. Limitation of Liability. In case of intentional conduct, gross negligence, claims based on the Product Liability Act, as well as, in case of death or personal or physical injury, Microsoft is liable according to the statutory law.
  Subject to the foregoing clause ii., Microsoft will only be liable for slight negligence if Microsoft is in breach of such material contractual obligations, the fulfillment of which facilitate the due performance of this agreement, the breach of which would endanger the purpose of this agreement and the compliance with which a party may constantly trust in (so-called "cardinal obligations"). In other cases of slight negligence, Microsoft will not be liable for slight negligence.
11. DISCLAIMER OF WARRANTY. THE SOFTWARE IS LICENSED “AS IS.” YOU BEAR THE RISK OF USING IT. MICROSOFT GIVES NO EXPRESS WARRANTIES, GUARANTEES, OR CONDITIONS. TO THE EXTENT PERMITTED UNDER APPLICABLE LAWS, MICROSOFT EXCLUDES ALL IMPLIED WARRANTIES, INCLUDING MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, AND NON-INFRINGEMENT.
12. LIMITATION ON AND EXCLUSION OF DAMAGES. IF YOU HAVE ANY BASIS FOR RECOVERING DAMAGES DESPITE THE PRECEDING DISCLAIMER OF WARRANTY, YOU CAN RECOVER FROM MICROSOFT AND ITS SUPPLIERS ONLY DIRECT DAMAGES UP TO U.S. $5.00. YOU CANNOT RECOVER ANY OTHER DAMAGES, INCLUDING CONSEQUENTIAL, LOST PROFITS, SPECIAL, INDIRECT, OR INCIDENTAL DAMAGES.
This limitation applies to (a) anything related to the software, services, content (including code) on third party Internet sites, or third party applications; and (b) claims for breach of contract, warranty, guarantee, or condition; strict liability, negligence, or other tort; or any other claim; in each case to the extent permitted by applicable law.
It also applies even if Microsoft knew or should have known about the possibility of the damages. The above limitation or exclusion may not apply to you because your state, province, or country may not allow the exclusion or limitation of incidental, consequential, or other damages.
Please note: As this software is distributed in Canada, some of the clauses in this agreement are provided below in French.
Remarque: Ce logiciel étant distribué au Canada, certaines des clauses dans ce contrat sont fournies ci-dessous en français.
EXONÉRATION DE GARANTIE. Le logiciel visé par une licence est offert « tel quel ». Toute utilisation de ce logiciel est à votre seule risque et péril. Microsoft n’accorde aucune autre garantie expresse. Vous pouvez bénéficier de droits additionnels en vertu du droit local sur la protection des consommateurs, que ce contrat ne peut modifier. La ou elles sont permises par le droit locale, les garanties implicites de qualité marchande, d’adéquation à un usage particulier et d’absence de contrefaçon sont exclues.
LIMITATION DES DOMMAGES-INTÉRÊTS ET EXCLUSION DE RESPONSABILITÉ POUR LES DOMMAGES. Vous pouvez obtenir de Microsoft et de ses fournisseurs une indemnisation en cas de dommages directs uniquement à hauteur de 5,00 $ US. Vous ne pouvez prétendre à aucune indemnisation pour les autres dommages, y compris les dommages spéciaux, indirects ou accessoires et pertes de bénéfices.
Cette limitation concerne:
• tout ce qui est relié au logiciel, aux services ou au contenu (y compris le code) figurant sur des sites Internet tiers ou dans des programmes tiers; et
• les réclamations au titre de violation de contrat ou de garantie, ou au titre de responsabilité stricte, de négligence ou d’une autre faute dans la limite autorisée par la loi en vigueur.
Elle s’applique également, même si Microsoft connaissait ou devrait connaître l’éventualité d’un tel dommage. Si votre pays n’autorise pas l’exclusion ou la limitation de responsabilité pour les dommages indirects, accessoires ou de quelque nature que ce soit, il se peut que la limitation ou l’exclusion ci-dessus ne s’appliquera pas à votre égard.
EFFET JURIDIQUE. Le présent contrat décrit certains droits juridiques. Vous pourriez avoir d’autres droits prévus par les lois de votre pays. Le présent contrat ne modifie pas les droits que vous confèrent les lois de votre pays si celles-ci ne le permettent pas.
---
title: THIRD PARTY NOTICES FOR Azure Maps SDK
preamble: |
	Do Not Translate or Localize

	This file is based on or incorporates material from the projects listed below (Third Party IP).
	The original copyright notice and the license under which Microsoft received such Third Party IP,
	are set forth below. Such licenses and notices are provided for informational purposes only.
	Microsoft licenses the Third Party IP to you under the licensing terms for the Microsoft product.
	Microsoft reserves all other rights not expressly granted under this agreement, whether by implication,
	estoppel or otherwise.


registrations:
	- component:
		name: @mapbox/mapbox-gl-rtl-text
		version: 0.2.3
		license: |
mapbox-gl-rtl-text copyright (c) 2017 Mapbox.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

 - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
 - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This source code is derived from the International Components for Unicode (ICU) library, available from [http://site.icu-project.org/](). ICU C++ code original license as follows:

COPYRIGHT AND PERMISSION NOTICE (ICU 58 and later)

Copyright © 1991-2016 Unicode, Inc. All rights reserved.
Distributed under the Terms of Use in http://www.unicode.org/copyright.html

Permission is hereby granted, free of charge, to any person obtaining
a copy of the Unicode data files and any associated documentation
(the "Data Files") or Unicode software and any associated documentation
(the "Software") to deal in the Data Files or Software
without restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, and/or sell copies of
the Data Files or Software, and to permit persons to whom the Data Files
or Software are furnished to do so, provided that either
(a) this copyright and permission notice appear with all copies
of the Data Files or Software, or
(b) this copyright and permission notice appear in associated
Documentation.

THE DATA FILES AND SOFTWARE ARE PROVIDED "AS IS", WITHOUT WARRANTY OF
ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT OF THIRD PARTY RIGHTS.
IN NO EVENT SHALL THE COPYRIGHT HOLDER OR HOLDERS INCLUDED IN THIS
NOTICE BE LIABLE FOR ANY CLAIM, OR ANY SPECIAL INDIRECT OR CONSEQUENTIAL
DAMAGES, OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE,
DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THE DATA FILES OR SOFTWARE.

Except as contained in this notice, the name of a copyright holder
shall not be used in advertising or otherwise to promote the sale,
use or other dealings in these Data Files or Software without prior
written authorization of the copyright holder.


	- component:
		name: @microsoft/applicationinsights-web
		version: 2.2.2
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @microsoft/applicationinsights-analytics-js
		version: 2.2.2
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @microsoft/applicationinsights-common
		version: 2.2.2
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @microsoft/applicationinsights-core-js
		version: 2.2.2
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: tslib
		version: 1.10.0
		license: |
Apache License

Version 2.0, January 2004

http://www.apache.org/licenses/ 

TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

1. Definitions.

"License" shall mean the terms and conditions for use, reproduction, and distribution as defined by Sections 1 through 9 of this document.

"Licensor" shall mean the copyright owner or entity authorized by the copyright owner that is granting the License.

"Legal Entity" shall mean the union of the acting entity and all other entities that control, are controlled by, or are under common control with that entity. For the purposes of this definition, "control" means (i) the power, direct or indirect, to cause the direction or management of such entity, whether by contract or otherwise, or (ii) ownership of fifty percent (50%) or more of the outstanding shares, or (iii) beneficial ownership of such entity.

"You" (or "Your") shall mean an individual or Legal Entity exercising permissions granted by this License.

"Source" form shall mean the preferred form for making modifications, including but not limited to software source code, documentation source, and configuration files.

"Object" form shall mean any form resulting from mechanical transformation or translation of a Source form, including but not limited to compiled object code, generated documentation, and conversions to other media types.

"Work" shall mean the work of authorship, whether in Source or Object form, made available under the License, as indicated by a copyright notice that is included in or attached to the work (an example is provided in the Appendix below).

"Derivative Works" shall mean any work, whether in Source or Object form, that is based on (or derived from) the Work and for which the editorial revisions, annotations, elaborations, or other modifications represent, as a whole, an original work of authorship. For the purposes of this License, Derivative Works shall not include works that remain separable from, or merely link (or bind by name) to the interfaces of, the Work and Derivative Works thereof.

"Contribution" shall mean any work of authorship, including the original version of the Work and any modifications or additions to that Work or Derivative Works thereof, that is intentionally submitted to Licensor for inclusion in the Work by the copyright owner or by an individual or Legal Entity authorized to submit on behalf of the copyright owner. For the purposes of this definition, "submitted" means any form of electronic, verbal, or written communication sent to the Licensor or its representatives, including but not limited to communication on electronic mailing lists, source code control systems, and issue tracking systems that are managed by, or on behalf of, the Licensor for the purpose of discussing and improving the Work, but excluding communication that is conspicuously marked or otherwise designated in writing by the copyright owner as "Not a Contribution."

"Contributor" shall mean Licensor and any individual or Legal Entity on behalf of whom a Contribution has been received by Licensor and subsequently incorporated within the Work.

2. Grant of Copyright License. Subject to the terms and conditions of this License, each Contributor hereby grants to You a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare Derivative Works of, publicly display, publicly perform, sublicense, and distribute the Work and such Derivative Works in Source or Object form.

3. Grant of Patent License. Subject to the terms and conditions of this License, each Contributor hereby grants to You a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable (except as stated in this section) patent license to make, have made, use, offer to sell, sell, import, and otherwise transfer the Work, where such license applies only to those patent claims licensable by such Contributor that are necessarily infringed by their Contribution(s) alone or by combination of their Contribution(s) with the Work to which such Contribution(s) was submitted. If You institute patent litigation against any entity (including a cross-claim or counterclaim in a lawsuit) alleging that the Work or a Contribution incorporated within the Work constitutes direct or contributory patent infringement, then any patent licenses granted to You under this License for that Work shall terminate as of the date such litigation is filed.

4. Redistribution. You may reproduce and distribute copies of the Work or Derivative Works thereof in any medium, with or without modifications, and in Source or Object form, provided that You meet the following conditions:

You must give any other recipients of the Work or Derivative Works a copy of this License; and

You must cause any modified files to carry prominent notices stating that You changed the files; and

You must retain, in the Source form of any Derivative Works that You distribute, all copyright, patent, trademark, and attribution notices from the Source form of the Work, excluding those notices that do not pertain to any part of the Derivative Works; and

If the Work includes a "NOTICE" text file as part of its distribution, then any Derivative Works that You distribute must include a readable copy of the attribution notices contained within such NOTICE file, excluding those notices that do not pertain to any part of the Derivative Works, in at least one of the following places: within a NOTICE text file distributed as part of the Derivative Works; within the Source form or documentation, if provided along with the Derivative Works; or, within a display generated by the Derivative Works, if and wherever such third-party notices normally appear. The contents of the NOTICE file are for informational purposes only and do not modify the License. You may add Your own attribution notices within Derivative Works that You distribute, alongside or as an addendum to the NOTICE text from the Work, provided that such additional attribution notices cannot be construed as modifying the License. You may add Your own copyright statement to Your modifications and may provide additional or different license terms and conditions for use, reproduction, or distribution of Your modifications, or for any such Derivative Works as a whole, provided Your use, reproduction, and distribution of the Work otherwise complies with the conditions stated in this License.

5. Submission of Contributions. Unless You explicitly state otherwise, any Contribution intentionally submitted for inclusion in the Work by You to the Licensor shall be under the terms and conditions of this License, without any additional terms or conditions. Notwithstanding the above, nothing herein shall supersede or modify the terms of any separate license agreement you may have executed with Licensor regarding such Contributions.

6. Trademarks. This License does not grant permission to use the trade names, trademarks, service marks, or product names of the Licensor, except as required for reasonable and customary use in describing the origin of the Work and reproducing the content of the NOTICE file.

7. Disclaimer of Warranty. Unless required by applicable law or agreed to in writing, Licensor provides the Work (and each Contributor provides its Contributions) on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. You are solely responsible for determining the appropriateness of using or redistributing the Work and assume any risks associated with Your exercise of permissions under this License.

8. Limitation of Liability. In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall any Contributor be liable to You for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising as a result of this License or out of the use or inability to use the Work (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if such Contributor has been advised of the possibility of such damages.

9. Accepting Warranty or Additional Liability. While redistributing the Work or Derivative Works thereof, You may choose to offer, and charge a fee for, acceptance of support, warranty, indemnity, or other liability obligations and/or rights consistent with this License. However, in accepting such obligations, You may act only on Your own behalf and on Your sole responsibility, not on behalf of any other Contributor, and only if You agree to indemnify, defend, and hold each Contributor harmless for any liability incurred by, or claims asserted against, such Contributor by reason of your accepting any such warranty or additional liability.

END OF TERMS AND CONDITIONS


	- component:
		name: @microsoft/applicationinsights-channel-js
		version: 2.2.2
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @microsoft/applicationinsights-dependencies-js
		version: 2.2.2
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @microsoft/applicationinsights-properties-js
		version: 2.2.2
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @types/adal-angular
		version: 1.0.1
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @types/color
		version: 3.0.0
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @types/color-convert
		version: 1.9.0
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @types/color-name
		version: 1.1.1
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @types/jwt-decode
		version: 2.2.1
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @types/lodash
		version: 4.14.136
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @types/mapbox-gl
		version: 1.7.0
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @types/geojson
		version: 7946.0.7
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: adal-angular
		version: 1.0.17
		license: |
                                 Apache License
                           Version 2.0, January 2004
                        http://www.apache.org/licenses/

   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

   1. Definitions.

      "License" shall mean the terms and conditions for use, reproduction,
      and distribution as defined by Sections 1 through 9 of this document.

      "Licensor" shall mean the copyright owner or entity authorized by
      the copyright owner that is granting the License.

      "Legal Entity" shall mean the union of the acting entity and all
      other entities that control, are controlled by, or are under common
      control with that entity. For the purposes of this definition,
      "control" means (i) the power, direct or indirect, to cause the
      direction or management of such entity, whether by contract or
      otherwise, or (ii) ownership of fifty percent (50%) or more of the
      outstanding shares, or (iii) beneficial ownership of such entity.

      "You" (or "Your") shall mean an individual or Legal Entity
      exercising permissions granted by this License.

      "Source" form shall mean the preferred form for making modifications,
      including but not limited to software source code, documentation
      source, and configuration files.

      "Object" form shall mean any form resulting from mechanical
      transformation or translation of a Source form, including but
      not limited to compiled object code, generated documentation,
      and conversions to other media types.

      "Work" shall mean the work of authorship, whether in Source or
      Object form, made available under the License, as indicated by a
      copyright notice that is included in or attached to the work
      (an example is provided in the Appendix below).

      "Derivative Works" shall mean any work, whether in Source or Object
      form, that is based on (or derived from) the Work and for which the
      editorial revisions, annotations, elaborations, or other modifications
      represent, as a whole, an original work of authorship. For the purposes
      of this License, Derivative Works shall not include works that remain
      separable from, or merely link (or bind by name) to the interfaces of,
      the Work and Derivative Works thereof.

      "Contribution" shall mean any work of authorship, including
      the original version of the Work and any modifications or additions
      to that Work or Derivative Works thereof, that is intentionally
      submitted to Licensor for inclusion in the Work by the copyright owner
      or by an individual or Legal Entity authorized to submit on behalf of
      the copyright owner. For the purposes of this definition, "submitted"
      means any form of electronic, verbal, or written communication sent
      to the Licensor or its representatives, including but not limited to
      communication on electronic mailing lists, source code control systems,
      and issue tracking systems that are managed by, or on behalf of, the
      Licensor for the purpose of discussing and improving the Work, but
      excluding communication that is conspicuously marked or otherwise
      designated in writing by the copyright owner as "Not a Contribution."

      "Contributor" shall mean Licensor and any individual or Legal Entity
      on behalf of whom a Contribution has been received by Licensor and
      subsequently incorporated within the Work.

   2. Grant of Copyright License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      copyright license to reproduce, prepare Derivative Works of,
      publicly display, publicly perform, sublicense, and distribute the
      Work and such Derivative Works in Source or Object form.

   3. Grant of Patent License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      (except as stated in this section) patent license to make, have made,
      use, offer to sell, sell, import, and otherwise transfer the Work,
      where such license applies only to those patent claims licensable
      by such Contributor that are necessarily infringed by their
      Contribution(s) alone or by combination of their Contribution(s)
      with the Work to which such Contribution(s) was submitted. If You
      institute patent litigation against any entity (including a
      cross-claim or counterclaim in a lawsuit) alleging that the Work
      or a Contribution incorporated within the Work constitutes direct
      or contributory patent infringement, then any patent licenses
      granted to You under this License for that Work shall terminate
      as of the date such litigation is filed.

   4. Redistribution. You may reproduce and distribute copies of the
      Work or Derivative Works thereof in any medium, with or without
      modifications, and in Source or Object form, provided that You
      meet the following conditions:

      (a) You must give any other recipients of the Work or
          Derivative Works a copy of this License; and

      (b) You must cause any modified files to carry prominent notices
          stating that You changed the files; and

      (c) You must retain, in the Source form of any Derivative Works
          that You distribute, all copyright, patent, trademark, and
          attribution notices from the Source form of the Work,
          excluding those notices that do not pertain to any part of
          the Derivative Works; and

      (d) If the Work includes a "NOTICE" text file as part of its
          distribution, then any Derivative Works that You distribute must
          include a readable copy of the attribution notices contained
          within such NOTICE file, excluding those notices that do not
          pertain to any part of the Derivative Works, in at least one
          of the following places: within a NOTICE text file distributed
          as part of the Derivative Works; within the Source form or
          documentation, if provided along with the Derivative Works; or,
          within a display generated by the Derivative Works, if and
          wherever such third-party notices normally appear. The contents
          of the NOTICE file are for informational purposes only and
          do not modify the License. You may add Your own attribution
          notices within Derivative Works that You distribute, alongside
          or as an addendum to the NOTICE text from the Work, provided
          that such additional attribution notices cannot be construed
          as modifying the License.

      You may add Your own copyright statement to Your modifications and
      may provide additional or different license terms and conditions
      for use, reproduction, or distribution of Your modifications, or
      for any such Derivative Works as a whole, provided Your use,
      reproduction, and distribution of the Work otherwise complies with
      the conditions stated in this License.

   5. Submission of Contributions. Unless You explicitly state otherwise,
      any Contribution intentionally submitted for inclusion in the Work
      by You to the Licensor shall be under the terms and conditions of
      this License, without any additional terms or conditions.
      Notwithstanding the above, nothing herein shall supersede or modify
      the terms of any separate license agreement you may have executed
      with Licensor regarding such Contributions.

   6. Trademarks. This License does not grant permission to use the trade
      names, trademarks, service marks, or product names of the Licensor,
      except as required for reasonable and customary use in describing the
      origin of the Work and reproducing the content of the NOTICE file.

   7. Disclaimer of Warranty. Unless required by applicable law or
      agreed to in writing, Licensor provides the Work (and each
      Contributor provides its Contributions) on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
      implied, including, without limitation, any warranties or conditions
      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
      PARTICULAR PURPOSE. You are solely responsible for determining the
      appropriateness of using or redistributing the Work and assume any
      risks associated with Your exercise of permissions under this License.

   8. Limitation of Liability. In no event and under no legal theory,
      whether in tort (including negligence), contract, or otherwise,
      unless required by applicable law (such as deliberate and grossly
      negligent acts) or agreed to in writing, shall any Contributor be
      liable to You for damages, including any direct, indirect, special,
      incidental, or consequential damages of any character arising as a
      result of this License or out of the use or inability to use the
      Work (including but not limited to damages for loss of goodwill,
      work stoppage, computer failure or malfunction, or any and all
      other commercial damages or losses), even if such Contributor
      has been advised of the possibility of such damages.

   9. Accepting Warranty or Additional Liability. While redistributing
      the Work or Derivative Works thereof, You may choose to offer,
      and charge a fee for, acceptance of support, warranty, indemnity,
      or other liability obligations and/or rights consistent with this
      License. However, in accepting such obligations, You may act only
      on Your own behalf and on Your sole responsibility, not on behalf
      of any other Contributor, and only if You agree to indemnify,
      defend, and hold each Contributor harmless for any liability
      incurred by, or claims asserted against, such Contributor by reason
      of your accepting any such warranty or additional liability.

   END OF TERMS AND CONDITIONS

   APPENDIX: How to apply the Apache License to your work.

      To apply the Apache License to your work, attach the following
      boilerplate notice, with the fields enclosed by brackets "[]"
      replaced with your own identifying information. (Don't include
      the brackets!)  The text should be enclosed in the appropriate
      comment syntax for the file format. We also recommend that a
      file or class name and description of purpose be included on the
      same "printed page" as the copyright notice for easier
      identification within third-party archives.

   Copyright [yyyy] [name of copyright owner]

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.


	- component:
		name: color
		version: 3.1.2
		license: |
Copyright (c) 2012 Heather Arthur

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.



	- component:
		name: color-convert
		version: 1.9.3
		license: |
Copyright (c) 2011-2016 Heather Arthur <fayearthur@gmail.com>

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.



	- component:
		name: color-name
		version: 1.1.3
		license: |
The MIT License (MIT)
Copyright (c) 2015 Dmitry Ivanov

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

	- component:
		name: color-string
		version: 1.5.3
		license: |
Copyright (c) 2011 Heather Arthur <fayearthur@gmail.com>

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.



	- component:
		name: simple-swizzle
		version: 0.2.2
		license: |
The MIT License (MIT)

Copyright (c) 2015 Josh Junon

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.


	- component:
		name: is-arrayish
		version: 0.3.2
		license: |
The MIT License (MIT)

Copyright (c) 2015 JD Ballard

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.


	- component:
		name: jwt-decode
		version: 2.2.0
		license: |
The MIT License (MIT)
 
Copyright (c) 2015 Auth0, Inc. <support@auth0.com> (http://auth0.com)
 
Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:
 
The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.
 
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.


	- component:
		name: lodash
		version: 4.17.15
		license: |
Copyright OpenJS Foundation and other contributors <https://openjsf.org/>

Based on Underscore.js, copyright Jeremy Ashkenas,
DocumentCloud and Investigative Reporters & Editors <http://underscorejs.org/>

This software consists of voluntary contributions made by many
individuals. For exact contribution history, see the revision history
available at https://github.com/lodash/lodash

The following license applies to all parts of this software except as
documented below:

====

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

====

Copyright and related rights for sample code are waived via CC0. Sample
code is defined as all source code displayed within the prose of the
documentation.

CC0: http://creativecommons.org/publicdomain/zero/1.0/

====

Files located in the node_modules and vendor directories are externally
maintained libraries used by this software which have their own
licenses; we recommend you read them, as their terms may differ from the
terms above.


	- component:
		name: mapbox-gl
		version: 1.11.1
		license: |
Copyright (c) 2020, Mapbox

All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

    * Redistributions of source code must retain the above copyright notice,
      this list of conditions and the following disclaimer.
    * Redistributions in binary form must reproduce the above copyright notice,
      this list of conditions and the following disclaimer in the documentation
      and/or other materials provided with the distribution.
    * Neither the name of Mapbox GL JS nor the names of its contributors
      may be used to endorse or promote products derived from this software
      without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.


-------------------------------------------------------------------------------

Contains code from glfx.js

Copyright (C) 2011 by Evan Wallace

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

--------------------------------------------------------------------------------

Contains a portion of d3-color https://github.com/d3/d3-color

Copyright 2010-2016 Mike Bostock
All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright notice, this
  list of conditions and the following disclaimer.

* Redistributions in binary form must reproduce the above copyright notice,
  this list of conditions and the following disclaimer in the documentation
  and/or other materials provided with the distribution.

* Neither the name of the author nor the names of contributors may be used to
  endorse or promote products derived from this software without specific prior
  written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.


	- component:
		name: @mapbox/geojson-rewind
		version: 0.5.0
		license: |
Copyright (c) 2020, Mapbox

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.


	- component:
		name: concat-stream
		version: 2.0.0
		license: |
The MIT License

Copyright (c) 2013 Max Ogden

Permission is hereby granted, free of charge, 
to any person obtaining a copy of this software and 
associated documentation files (the "Software"), to 
deal in the Software without restriction, including 
without limitation the rights to use, copy, modify, 
merge, publish, distribute, sublicense, and/or sell 
copies of the Software, and to permit persons to whom 
the Software is furnished to do so, 
subject to the following conditions:

The above copyright notice and this permission notice 
shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, 
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES 
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. 
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR 
ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, 
TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE 
SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

	- component:
		name: readable-stream
		version: 3.6.0
		license: |
Node.js is licensed for use as follows:

"""
Copyright Node.js contributors. All rights reserved.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to
deal in the Software without restriction, including without limitation the
rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
sell copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
IN THE SOFTWARE.
"""

This license applies to parts of Node.js originating from the
https://github.com/joyent/node repository:

"""
Copyright Joyent, Inc. and other Node contributors. All rights reserved.
Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to
deal in the Software without restriction, including without limitation the
rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
sell copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
IN THE SOFTWARE.
"""


	- component:
		name: inherits
		version: 2.0.4
		license: |
The ISC License

Copyright (c) Isaac Z. Schlueter

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.



	- component:
		name: string_decoder
		version: 1.1.1
		license: |
Node.js is licensed for use as follows:

"""
Copyright Node.js contributors. All rights reserved.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to
deal in the Software without restriction, including without limitation the
rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
sell copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
IN THE SOFTWARE.
"""

This license applies to parts of Node.js originating from the
https://github.com/joyent/node repository:

"""
Copyright Joyent, Inc. and other Node contributors. All rights reserved.
Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to
deal in the Software without restriction, including without limitation the
rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
sell copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
IN THE SOFTWARE.
"""



	- component:
		name: safe-buffer
		version: 5.1.2
		license: |
The MIT License (MIT)

Copyright (c) Feross Aboukhadijeh

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.


	- component:
		name: util-deprecate
		version: 1.0.2
		license: |
(The MIT License)

Copyright (c) 2014 Nathan Rajlich <nathan@tootallnate.net>

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.


	- component:
		name: buffer-from
		version: 1.1.1
		license: |
MIT License

Copyright (c) 2016, 2018 Linus Unnebäck

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

	- component:
		name: typedarray
		version: 0.0.6
		license: |
 Copyright (c) 2010, Linden Research, Inc.
 Copyright (c) 2012, Joshua Bell

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 $/LicenseInfo$

// Original can be found at:
//   https://bitbucket.org/lindenlab/llsd
// Modifications by Joshua Bell inexorabletash@gmail.com
//   https://github.com/inexorabletash/polyfill

// ES3/ES5 implementation of the Krhonos Typed Array Specification
//   Ref: http://www.khronos.org/registry/typedarray/specs/latest/
//   Date: 2011-02-01
//
// Variations:
//  * Allows typed_array.get/set() as alias for subscripts (typed_array[])

	- component:
		name: minimist
		version: 1.2.5
		license: |
This software is released under the MIT license:

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


	- component:
		name: @mapbox/geojson-types
		version: 1.0.2
		license: |
MIT License

Copyright (c) 2018 Mapbox

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.


	- component:
		name: @mapbox/jsonlint-lines-primitives
		version: 2.0.2
		license: |
No license information found

	- component:
		name: @mapbox/mapbox-gl-supported
		version: 1.5.0
		license: |

BSD 3-Clause License

Copyright (c) 2017, Mapbox
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright notice, this
  list of conditions and the following disclaimer.

* Redistributions in binary form must reproduce the above copyright notice,
  this list of conditions and the following disclaimer in the documentation
  and/or other materials provided with the distribution.

* Neither the name of the copyright holder nor the names of its
  contributors may be used to endorse or promote products derived from
  this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.


	- component:
		name: @mapbox/point-geometry
		version: 0.1.0
		license: |
Copyright (c) 2015, Mapbox <>

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.


	- component:
		name: @mapbox/tiny-sdf
		version: 1.1.1
		license: |
Copyright © 2016-2017 Mapbox, Inc.
This code available under the terms of the BSD 2-Clause license.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
© 2018 GitHub, Inc.

	- component:
		name: @mapbox/unitbezier
		version: 0.0.0
		license: |
BSD-2-Clause

Copyright (C) 2008 Apple Inc. All Rights Reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:

1. Redistributions of source code must retain the above copyright
   notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in the
   documentation and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS'' AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

Ported from Webkit
http://svn.webkit.org/repository/webkit/trunk/Source/WebCore/platform/graphics/UnitBezier.h

	- component:
		name: @mapbox/vector-tile
		version: 1.3.1
		license: |
Copyright (c) 2014, Mapbox


All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

    * Redistributions of source code must retain the above copyright notice,
      this list of conditions and the following disclaimer.
    * Redistributions in binary form must reproduce the above copyright notice,
      this list of conditions and the following disclaimer in the documentation
      and/or other materials provided with the distribution.
    * Neither the name of Mapbox nor the names of its contributors
      may be used to endorse or promote products derived from this software
      without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.


	- component:
		name: @mapbox/whoots-js
		version: 3.1.0
		license: |
ISC License

Copyright (c) 2017, Mapbox

Permission to use, copy, modify, and/or distribute this software for any purpose
with or without fee is hereby granted, provided that the above copyright notice
and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
THIS SOFTWARE.


	- component:
		name: csscolorparser
		version: 1.0.3
		license: |
(c) Dean McNamee <dean@gmail.com>, 2012.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to
deal in the Software without restriction, including without limitation the
rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
sell copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
IN THE SOFTWARE.

	- component:
		name: earcut
		version: 2.2.2
		license: |
ISC License

Copyright (c) 2016, Mapbox

Permission to use, copy, modify, and/or distribute this software for any purpose
with or without fee is hereby granted, provided that the above copyright notice
and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
THIS SOFTWARE.


	- component:
		name: geojson-vt
		version: 3.2.1
		license: |
ISC License

Copyright (c) 2015, Mapbox

Permission to use, copy, modify, and/or distribute this software for any purpose
with or without fee is hereby granted, provided that the above copyright notice
and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
THIS SOFTWARE.


	- component:
		name: gl-matrix
		version: 3.3.0
		license: |
Copyright (c) 2015-2020, Brandon Jones, Colin MacKenzie IV.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

	- component:
		name: grid-index
		version: 1.1.0
		license: |
Copyright (c) 2016, Mapbox

Permission to use, copy, modify, and/or distribute this software for any purpose
with or without fee is hereby granted, provided that the above copyright notice
and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
THIS SOFTWARE.


	- component:
		name: murmurhash-js
		version: 1.0.0
		license: |
The MIT License (MIT)

Copyright (c) 2011 Gary Court

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

	- component:
		name: pbf
		version: 3.2.1
		license: |
Copyright (c) 2017, Mapbox
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright notice, this
  list of conditions and the following disclaimer.

* Redistributions in binary form must reproduce the above copyright notice,
  this list of conditions and the following disclaimer in the documentation
  and/or other materials provided with the distribution.

* Neither the name of pbf nor the names of its
  contributors may be used to endorse or promote products derived from
  this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.


	- component:
		name: ieee754
		version: 1.1.13
		license: |
Copyright 2008 Fair Oaks Labs, Inc.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.

2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.


	- component:
		name: resolve-protobuf-schema
		version: 2.1.0
		license: |
The MIT License (MIT)

Copyright (c) 2014 Mathias Buus

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.


	- component:
		name: protocol-buffers-schema
		version: 3.4.0
		license: |
The MIT License (MIT)

Copyright (c) 2014 Mathias Buus

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

	- component:
		name: potpack
		version: 1.0.1
		license: |
ISC License

Copyright (c) 2018, Mapbox

Permission to use, copy, modify, and/or distribute this software for any purpose
with or without fee is hereby granted, provided that the above copyright notice
and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
THIS SOFTWARE.


	- component:
		name: quickselect
		version: 2.0.0
		license: |
ISC License

Copyright (c) 2018, Vladimir Agafonkin

Permission to use, copy, modify, and/or distribute this software for any purpose
with or without fee is hereby granted, provided that the above copyright notice
and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
THIS SOFTWARE.


	- component:
		name: rw
		version: 1.3.3
		license: |
Copyright (c) 2014-2016, Michael Bostock
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright notice, this
  list of conditions and the following disclaimer.

* Redistributions in binary form must reproduce the above copyright notice,
  this list of conditions and the following disclaimer in the documentation
  and/or other materials provided with the distribution.

* The name Michael Bostock may not be used to endorse or promote products
  derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL MICHAEL BOSTOCK BE LIABLE FOR ANY DIRECT,
INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.


	- component:
		name: supercluster
		version: 7.1.0
		license: |
ISC License

Copyright (c) 2016, Mapbox

Permission to use, copy, modify, and/or distribute this software for any purpose
with or without fee is hereby granted, provided that the above copyright notice
and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
THIS SOFTWARE.


	- component:
		name: kdbush
		version: 3.0.0
		license: |
ISC License

Copyright (c) 2018, Vladimir Agafonkin

Permission to use, copy, modify, and/or distribute this software for any purpose
with or without fee is hereby granted, provided that the above copyright notice
and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
THIS SOFTWARE.

	- component:
		name: tinyqueue
		version: 2.0.3
		license: |
ISC License

Copyright (c) 2017, Vladimir Agafonkin

Permission to use, copy, modify, and/or distribute this software for any purpose
with or without fee is hereby granted, provided that the above copyright notice
and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
THIS SOFTWARE.


	- component:
		name: vt-pbf
		version: 3.1.1
		license: |
The MIT License (MIT)

Copyright (c) 2015 Anand Thakker

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

--------------------------------------------------------------------------------

Contains geojson_wrapper.js from https://github.com/mapbox/mapbox-gl-js

Copyright (c) 2014, Mapbox

All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

    * Redistributions of source code must retain the above copyright notice,
      this list of conditions and the following disclaimer.
    * Redistributions in binary form must reproduce the above copyright notice,
      this list of conditions and the following disclaimer in the documentation
      and/or other materials provided with the distribution.
    * Neither the name of Mapbox GL JS nor the names of its contributors
      may be used to endorse or promote products derived from this software
      without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.



	- component:
		name: typescript
		version: 3.7.2
		license: |
Apache License

Version 2.0, January 2004

http://www.apache.org/licenses/ 

TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

1. Definitions.

"License" shall mean the terms and conditions for use, reproduction, and distribution as defined by Sections 1 through 9 of this document.

"Licensor" shall mean the copyright owner or entity authorized by the copyright owner that is granting the License.

"Legal Entity" shall mean the union of the acting entity and all other entities that control, are controlled by, or are under common control with that entity. For the purposes of this definition, "control" means (i) the power, direct or indirect, to cause the direction or management of such entity, whether by contract or otherwise, or (ii) ownership of fifty percent (50%) or more of the outstanding shares, or (iii) beneficial ownership of such entity.

"You" (or "Your") shall mean an individual or Legal Entity exercising permissions granted by this License.

"Source" form shall mean the preferred form for making modifications, including but not limited to software source code, documentation source, and configuration files.

"Object" form shall mean any form resulting from mechanical transformation or translation of a Source form, including but not limited to compiled object code, generated documentation, and conversions to other media types.

"Work" shall mean the work of authorship, whether in Source or Object form, made available under the License, as indicated by a copyright notice that is included in or attached to the work (an example is provided in the Appendix below).

"Derivative Works" shall mean any work, whether in Source or Object form, that is based on (or derived from) the Work and for which the editorial revisions, annotations, elaborations, or other modifications represent, as a whole, an original work of authorship. For the purposes of this License, Derivative Works shall not include works that remain separable from, or merely link (or bind by name) to the interfaces of, the Work and Derivative Works thereof.

"Contribution" shall mean any work of authorship, including the original version of the Work and any modifications or additions to that Work or Derivative Works thereof, that is intentionally submitted to Licensor for inclusion in the Work by the copyright owner or by an individual or Legal Entity authorized to submit on behalf of the copyright owner. For the purposes of this definition, "submitted" means any form of electronic, verbal, or written communication sent to the Licensor or its representatives, including but not limited to communication on electronic mailing lists, source code control systems, and issue tracking systems that are managed by, or on behalf of, the Licensor for the purpose of discussing and improving the Work, but excluding communication that is conspicuously marked or otherwise designated in writing by the copyright owner as "Not a Contribution."

"Contributor" shall mean Licensor and any individual or Legal Entity on behalf of whom a Contribution has been received by Licensor and subsequently incorporated within the Work.

2. Grant of Copyright License. Subject to the terms and conditions of this License, each Contributor hereby grants to You a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare Derivative Works of, publicly display, publicly perform, sublicense, and distribute the Work and such Derivative Works in Source or Object form.

3. Grant of Patent License. Subject to the terms and conditions of this License, each Contributor hereby grants to You a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable (except as stated in this section) patent license to make, have made, use, offer to sell, sell, import, and otherwise transfer the Work, where such license applies only to those patent claims licensable by such Contributor that are necessarily infringed by their Contribution(s) alone or by combination of their Contribution(s) with the Work to which such Contribution(s) was submitted. If You institute patent litigation against any entity (including a cross-claim or counterclaim in a lawsuit) alleging that the Work or a Contribution incorporated within the Work constitutes direct or contributory patent infringement, then any patent licenses granted to You under this License for that Work shall terminate as of the date such litigation is filed.

4. Redistribution. You may reproduce and distribute copies of the Work or Derivative Works thereof in any medium, with or without modifications, and in Source or Object form, provided that You meet the following conditions:

You must give any other recipients of the Work or Derivative Works a copy of this License; and

You must cause any modified files to carry prominent notices stating that You changed the files; and

You must retain, in the Source form of any Derivative Works that You distribute, all copyright, patent, trademark, and attribution notices from the Source form of the Work, excluding those notices that do not pertain to any part of the Derivative Works; and

If the Work includes a "NOTICE" text file as part of its distribution, then any Derivative Works that You distribute must include a readable copy of the attribution notices contained within such NOTICE file, excluding those notices that do not pertain to any part of the Derivative Works, in at least one of the following places: within a NOTICE text file distributed as part of the Derivative Works; within the Source form or documentation, if provided along with the Derivative Works; or, within a display generated by the Derivative Works, if and wherever such third-party notices normally appear. The contents of the NOTICE file are for informational purposes only and do not modify the License. You may add Your own attribution notices within Derivative Works that You distribute, alongside or as an addendum to the NOTICE text from the Work, provided that such additional attribution notices cannot be construed as modifying the License. You may add Your own copyright statement to Your modifications and may provide additional or different license terms and conditions for use, reproduction, or distribution of Your modifications, or for any such Derivative Works as a whole, provided Your use, reproduction, and distribution of the Work otherwise complies with the conditions stated in this License.

5. Submission of Contributions. Unless You explicitly state otherwise, any Contribution intentionally submitted for inclusion in the Work by You to the Licensor shall be under the terms and conditions of this License, without any additional terms or conditions. Notwithstanding the above, nothing herein shall supersede or modify the terms of any separate license agreement you may have executed with Licensor regarding such Contributions.

6. Trademarks. This License does not grant permission to use the trade names, trademarks, service marks, or product names of the Licensor, except as required for reasonable and customary use in describing the origin of the Work and reproducing the content of the NOTICE file.

7. Disclaimer of Warranty. Unless required by applicable law or agreed to in writing, Licensor provides the Work (and each Contributor provides its Contributions) on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. You are solely responsible for determining the appropriateness of using or redistributing the Work and assume any risks associated with Your exercise of permissions under this License.

8. Limitation of Liability. In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall any Contributor be liable to You for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising as a result of this License or out of the use or inability to use the Work (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if such Contributor has been advised of the possibility of such damages.

9. Accepting Warranty or Additional Liability. While redistributing the Work or Derivative Works thereof, You may choose to offer, and charge a fee for, acceptance of support, warranty, indemnity, or other liability obligations and/or rights consistent with this License. However, in accepting such obligations, You may act only on Your own behalf and on Your sole responsibility, not on behalf of any other Contributor, and only if You agree to indemnify, defend, and hold each Contributor harmless for any liability incurred by, or claims asserted against, such Contributor by reason of your accepting any such warranty or additional liability.

END OF TERMS AND CONDITIONS


	- component:
		name: uuid-random
		version: 1.0.9
		license: |
Copyright (c) 2016-2019 Wes Roberts

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).atlas=t.atlas||{})}(this,function(p){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t,e){return t(e={exports:{}},e.exports),e.exports}var h=e(function(t,e){function i(t,e){if(n)if(o){var i="var sharedChunk = {}; ("+n+")(sharedChunk); ("+o+")(sharedChunk);",r={};n(r),a=e(r),"undefined"!=typeof window&&(a.workerUrl=window.URL.createObjectURL(new Blob([i],{type:"text/javascript"})))}else o=e;else n=e}var n,o,a;t.exports=(i(0,function(t){function e(t,e){return t(e={exports:{}},e.exports),e.exports}var a=i;function i(t,e,i,r){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(r-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=i,this.p2y=r}i.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},i.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},i.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},i.prototype.solveCurveX=function(t,e){var i,r,n,o,a;for(void 0===e&&(e=1e-6),n=t,a=0;a<8;a++){if(o=this.sampleCurveX(n)-t,Math.abs(o)<e)return n;var s=this.sampleCurveDerivativeX(n);if(Math.abs(s)<1e-6)break;n-=o/s}if((n=t)<(i=0))return i;if(n>(r=1))return r;for(;i<r;){if(o=this.sampleCurveX(n),Math.abs(o-t)<e)return n;o<t?i=n:r=n,n=.5*(r-i)+i}return n},i.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var G=r;function r(t,e){this.x=t,this.y=e}r.prototype={clone:function(){return new r(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),r=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=r,this},_rotateAround:function(t,e){var i=Math.cos(t),r=Math.sin(t),n=e.y+r*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-r*(this.y-e.y),this.y=n,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},r.convert=function(t){return t instanceof r||!Array.isArray(t)?t:new r(t[0],t[1])};var p="undefined"!=typeof self?self:{};function n(t,e,i,r){var n=new a(t,e,i,r);return function(t){return n.solve(t)}}var o=n(.25,.1,.25,1);function u(t,e,i){return Math.min(i,Math.max(e,t))}function s(t,e,i){var r=i-e,n=((t-e)%r+r)%r+e;return n===e?i:n}function d(t){for(var e=[],i=arguments.length-1;0<i--;)e[i]=arguments[i+1];for(var r=0,n=e;r<n.length;r+=1){var o=n[r];for(var a in o)t[a]=o[a]}return t}var l=1;function c(){return l++}function h(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function f(t){return t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function m(t,e){t.forEach(function(t){e[t]&&(e[t]=e[t].bind(e))})}function g(t,e){return-1!==t.indexOf(e,t.length-e.length)}function y(t,e,i){var r={};for(var n in t)r[n]=e.call(i||this,t[n],n,t);return r}function v(t,e,i){var r={};for(var n in t)e.call(i||this,t[n],n,t)&&(r[n]=t[n]);return r}function _(t){return Array.isArray(t)?t.map(_):"object"==typeof t&&t?y(t,_):t}var x={};function pt(t){x[t]||("undefined"!=typeof console&&console.warn(t),x[t]=!0)}function b(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}function w(t){for(var e=0,i=0,r=t.length,n=r-1,o=void 0,a=void 0;i<r;n=i++)e+=((a=t[n]).x-(o=t[i]).x)*(o.y+a.y);return e}function S(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function T(t){var o={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(t,e,i,r){var n=i||r;return o[e]=!n||n.toLowerCase(),""}),o["max-age"]){var e=parseInt(o["max-age"],10);isNaN(e)?delete o["max-age"]:o["max-age"]=e}return o}var I=null;function E(t){if(null==I){var e=t.navigator?t.navigator.userAgent:null;I=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return I}function C(t){try{var e=p[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch(t){return!1}}var A,k,P,M,L=p.performance&&p.performance.now?p.performance.now.bind(p.performance):Date.now.bind(Date),D=p.requestAnimationFrame||p.mozRequestAnimationFrame||p.webkitRequestAnimationFrame||p.msRequestAnimationFrame,z=p.cancelAnimationFrame||p.mozCancelAnimationFrame||p.webkitCancelAnimationFrame||p.msCancelAnimationFrame,O={now:L,frame:function(t){var e=D(t);return{cancel:function(){return z(e)}}},getImageData:function(t,e){void 0===e&&(e=0);var i=p.document.createElement("canvas"),r=i.getContext("2d");if(!r)throw new Error("failed to create canvas 2d context");return i.width=t.width,i.height=t.height,r.drawImage(t,0,0,t.width,t.height),r.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:function(t){return(A=A||p.document.createElement("a")).href=t,A.href},hardwareConcurrency:p.navigator&&p.navigator.hardwareConcurrency||4,get devicePixelRatio(){return p.devicePixelRatio},get prefersReducedMotion(){return!!p.matchMedia&&(null==k&&(k=p.matchMedia("(prefers-reduced-motion: reduce)")),k.matches)}},R={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},N={supported:!1,testSupport:function(t){!B&&M&&(F?U(t):P=t)}},B=!1,F=!1;function U(t){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,M),t.isContextLost())return;N.supported=!0}catch(t){}t.deleteTexture(e),B=!0}function j(t,e){this._transformRequestFn=t,this._customAccessToken=e,this._createSkuToken()}p.document&&((M=p.document.createElement("img")).onload=function(){P&&U(P),F=!(P=null)},M.onerror=function(){B=!0,P=null},M.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var q="01";function V(t){return 0===t.indexOf("mapbox:")}j.prototype._createSkuToken=function(){var t=function(){for(var t="",e=0;e<10;e++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",q,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},j.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},j.prototype.transformRequest=function(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}},j.prototype.normalizeStyleURL=function(t,e){if(!V(t))return t;var i=K(t);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||e)},j.prototype.normalizeGlyphsURL=function(t,e){if(!V(t))return t;var i=K(t);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||e)},j.prototype.normalizeSourceURL=function(t,e){if(!V(t))return t;var i=K(t);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||e)},j.prototype.normalizeSpriteURL=function(t,e,i,r){var n=K(t);return V(t)?(n.path="/styles/v1"+n.path+"/sprite"+e+i,this._makeAPIURL(n,this._customAccessToken||r)):(n.path+=""+e+i,X(n))},j.prototype.normalizeTileURL=function(t,e){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!V(t))return t;var r=K(t);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(2<=O.devicePixelRatio||512===e?"@2x":"")+(N.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var i=this._customAccessToken||function(){for(var t=0,e=r.params;t<e.length;t+=1){var i=e[t].match(/^access_token=(.*)$/);if(i)return i[1]}return null}()||R.ACCESS_TOKEN;return R.REQUIRE_ACCESS_TOKEN&&i&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,i)},j.prototype.canonicalizeTileURL=function(t,e){var i=K(t);if(!i.path.match(/(^\/v4\/)/)||!i.path.match(/\.[\w]+$/))return t;var r="mapbox://tiles/";r+=i.path.replace("/v4/","");var n=i.params;return e&&(n=n.filter(function(t){return!t.match(/^access_token=/)})),n.length&&(r+="?"+n.join("&")),r},j.prototype.canonicalizeTileset=function(t,e){for(var i=!!e&&V(e),r=[],n=0,o=t.tiles||[];n<o.length;n+=1){var a=o[n];H(a)?r.push(this.canonicalizeTileURL(a,i)):r.push(a)}return r},j.prototype._makeAPIURL=function(t,e){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",r=K(R.API_URL);if(t.protocol=r.protocol,t.authority=r.authority,"/"!==r.path&&(t.path=""+r.path+t.path),!R.REQUIRE_ACCESS_TOKEN)return X(t);if(!(e=e||R.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+i);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i);return t.params=t.params.filter(function(t){return-1===t.indexOf("access_token")}),t.params.push("access_token="+e),X(t)};var Z=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function H(t){return Z.test(t)}var W=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function K(t){var e=t.match(W);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function X(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}function Y(t){if(!t)return null;var e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(p.atob(e[1]).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(t){return null}}function J(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}J.prototype.getStorageKey=function(t){var e,i=Y(R.ACCESS_TOKEN);return e=i&&i.u?p.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,function(t,e){return String.fromCharCode(Number("0x"+e))})):R.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+e:"mapbox.eventData:"+e},J.prototype.fetchEventData=function(){var t=C("localStorage"),e=this.getStorageKey(),i=this.getStorageKey("uuid");if(t)try{var r=p.localStorage.getItem(e);r&&(this.eventData=JSON.parse(r));var n=p.localStorage.getItem(i);n&&(this.anonId=n)}catch(t){pt("Unable to read from LocalStorage")}},J.prototype.saveEventData=function(){var t=C("localStorage"),e=this.getStorageKey(),i=this.getStorageKey("uuid");if(t)try{p.localStorage.setItem(i,this.anonId),1<=Object.keys(this.eventData).length&&p.localStorage.setItem(e,JSON.stringify(this.eventData))}catch(t){pt("Unable to write to LocalStorage")}},J.prototype.processRequests=function(t){},J.prototype.postEvent=function(t,e,i,r){var n=this;if(R.EVENTS_URL){var o=K(R.EVENTS_URL);o.params.push("access_token="+(r||R.ACCESS_TOKEN||""));var a={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.11.1",skuId:q,userId:this.anonId},s=e?d(a,e):a,l={url:X(o),headers:{"Content-Type":"text/plain"},body:JSON.stringify([s])};this.pendingRequest=Et(l,function(t){n.pendingRequest=null,i(t),n.saveEventData(),n.processRequests(r)})}},J.prototype.queueRequest=function(t,e){this.queue.push(t),this.processRequests(e)};var Q,$,tt,et,it=(ct.__proto__=et=J,((ct.prototype=Object.create(et&&et.prototype)).constructor=ct).prototype.postMapLoadEvent=function(t,e,i,r){this.skuToken=i,(R.EVENTS_URL&&r||R.ACCESS_TOKEN&&Array.isArray(t)&&t.some(function(t){return V(t)||H(t)}))&&this.queueRequest({id:e,timestamp:Date.now()},r)},ct.prototype.processRequests=function(t){var e=this;if(!this.pendingRequest&&0!==this.queue.length){var i=this.queue.shift(),r=i.id,n=i.timestamp;r&&this.success[r]||(this.anonId||this.fetchEventData(),f(this.anonId)||(this.anonId=h()),this.postEvent(n,{skuToken:this.skuToken},function(t){t||r&&(e.success[r]=!0)},t))}},ct),rt=(ut.__proto__=tt=J,((ut.prototype=Object.create(tt&&tt.prototype)).constructor=ut).prototype.postTurnstileEvent=function(t,e){R.EVENTS_URL&&R.ACCESS_TOKEN&&Array.isArray(t)&&t.some(function(t){return V(t)||H(t)})&&this.queueRequest(Date.now(),e)},ut.prototype.processRequests=function(t){var e=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var i=Y(R.ACCESS_TOKEN),r=i?i.u:R.ACCESS_TOKEN,n=r!==this.eventData.tokenU;f(this.anonId)||(this.anonId=h(),n=!0);var o=this.queue.shift();if(this.eventData.lastSuccess){var a=new Date(this.eventData.lastSuccess),s=new Date(o),l=(o-this.eventData.lastSuccess)/864e5;n=n||1<=l||l<-1||a.getDate()!==s.getDate()}else n=!0;if(!n)return this.processRequests();this.postEvent(o,{"enabled.telemetry":!1},function(t){t||(e.eventData.lastSuccess=o,e.eventData.tokenU=r)},t)}},new ut),nt=rt.postTurnstileEvent.bind(rt),ot=new it,at=ot.postMapLoadEvent.bind(ot),st=500,lt=50;function ut(t){tt.call(this,"appUserTurnstile"),this._customAccessToken=t}function ct(){et.call(this,"map.load"),this.success={},this.skuToken=""}function ht(){p.caches&&!Q&&(Q=p.caches.open("mapbox-tiles"))}function dt(t){var e=t.indexOf("?");return e<0?t:t.slice(0,e)}var ft,mt=1/0;function gt(){return null==ft&&(ft=p.OffscreenCanvas&&new p.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof p.createImageBitmap),ft}var yt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(yt);var vt,_t=((vt=Error)&&(bt.__proto__=vt),((bt.prototype=Object.create(vt&&vt.prototype)).constructor=bt).prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},bt),xt=S()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===p.location.protocol?p.parent:p).location.href};function bt(t,e,i){401===e&&H(i)&&(t+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),vt.call(this,t),this.status=e,this.url=i,this.name=this.constructor.name,this.message=t}function wt(t,e){if(!(/^file:/.test(i=t.url)||/^file:/.test(xt())&&!/^\w+:/.test(i))){if(p.fetch&&p.Request&&p.AbortController&&p.Request.prototype.hasOwnProperty("signal"))return function(n,o){var t,e=new p.AbortController,a=new p.Request(n.url,{method:n.method||"GET",body:n.body,credentials:n.credentials,headers:n.headers,referrer:xt(),signal:e.signal}),s=!1,l=!1,u=0<(t=a.url).indexOf("sku=")&&H(t);function i(t,e,i){if(!l){if(t&&"SecurityError"!==t.message&&pt(t),e&&i)return c(e);var r=Date.now();p.fetch(a).then(function(t){if(t.ok){var e=u?t.clone():null;return c(t,e,r)}return o(new _t(t.statusText,t.status,n.url))}).catch(function(t){20!==t.code&&o(new Error(t.message))})}}"json"===n.type&&a.headers.set("Accept","application/json");var c=function(e,i,r){("arrayBuffer"===n.type?e.arrayBuffer():"json"===n.type?e.json():e.text()).then(function(t){l||(i&&r&&function(i,t,e){if(ht(),Q){var r={status:t.status,statusText:t.statusText,headers:new p.Headers};t.headers.forEach(function(t,e){return r.headers.set(e,t)});var n=T(t.headers.get("Cache-Control")||"");n["no-store"]||(n["max-age"]&&r.headers.set("Expires",new Date(e+1e3*n["max-age"]).toUTCString()),new Date(r.headers.get("Expires")).getTime()-e<42e4||function(t,e){if(void 0===$)try{new Response(new ReadableStream),$=!0}catch(t){$=!1}$?e(t.body):t.blob().then(e)}(t,function(t){var e=new p.Response(t,r);ht(),Q&&Q.then(function(t){return t.put(dt(i.url),e)}).catch(function(t){return pt(t.message)})}))}}(a,i,r),s=!0,o(null,t,e.headers.get("Cache-Control"),e.headers.get("Expires")))}).catch(function(t){l||o(new Error(t.message))})};return u?function(t,r){if(ht(),!Q)return r(null);var n=dt(t.url);Q.then(function(i){i.match(n).then(function(t){var e=function(t){if(!t)return!1;var e=new Date(t.headers.get("Expires")||0),i=T(t.headers.get("Cache-Control")||"");return e>Date.now()&&!i["no-cache"]}(t);i.delete(n),e&&i.put(n,t.clone()),r(null,t,e)}).catch(r)}).catch(r)}(a,i):i(null,null),{cancel:function(){l=!0,s||e.abort()}}}(t,e);if(S()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var i;return function(e,i){var r=new p.XMLHttpRequest;for(var t in r.open(e.method||"GET",e.url,!0),"arrayBuffer"===e.type&&(r.responseType="arraybuffer"),e.headers)r.setRequestHeader(t,e.headers[t]);return"json"===e.type&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials="include"===e.credentials,r.onerror=function(){i(new Error(r.statusText))},r.onload=function(){if((200<=r.status&&r.status<300||0===r.status)&&null!==r.response){var t=r.response;if("json"===e.type)try{t=JSON.parse(r.response)}catch(t){return i(t)}i(null,t,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"))}else i(new _t(r.statusText,r.status,e.url))},r.send(e.body),{cancel:function(){return r.abort()}}}(t,e)}function St(t,e){return wt(d(t,{type:"arrayBuffer"}),e)}var Tt,It,Et=function(t,e){return wt(d(t,{method:"POST"}),e)};Tt=[],It=0;var Ct=function(t,s){if(N.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),It>=R.MAX_PARALLEL_IMAGE_REQUESTS){var e={requestParameters:t,callback:s,cancelled:!1,cancel:function(){this.cancelled=!0}};return Tt.push(e),e}function l(){if(!i)for(i=!0,It--;Tt.length&&It<R.MAX_PARALLEL_IMAGE_REQUESTS;){var t=Tt.shift();t.cancelled||(t.cancel=Ct(t.requestParameters,t.callback).cancel)}}It++;var i=!1,r=St(t,function(t,e,i,r){var n,o,a;l(),t?s(t):e&&(gt()?(n=e,o=s,a=new p.Blob([new Uint8Array(n)],{type:"image/png"}),p.createImageBitmap(a).then(function(t){o(null,t)}).catch(function(t){o(new Error("Could not load image because of "+t.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})):function(t,e,i,r){var n=new p.Image,o=p.URL;n.onload=function(){e(null,n),o.revokeObjectURL(n.src)},n.onerror=function(){return e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var a=new p.Blob([new Uint8Array(t)],{type:"image/png"});n.cacheControl=i,n.expires=r,n.src=t.byteLength?o.createObjectURL(a):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(e,s,i,r))});return{cancel:function(){r.cancel(),l()}}};function At(t,e,i){i[t]&&-1!==i[t].indexOf(e)||(i[t]=i[t]||[],i[t].push(e))}function kt(t,e,i){if(i&&i[t]){var r=i[t].indexOf(e);-1!==r&&i[t].splice(r,1)}}function Pt(t,e){void 0===e&&(e={}),d(this,e),this.type=t}function Mt(){}var Lt,Dt=(zt.__proto__=Lt=Pt,(zt.prototype=Object.create(Lt&&Lt.prototype)).constructor=zt);function zt(t,e){void 0===e&&(e={}),Lt.call(this,"error",d({error:t},e))}Mt.prototype.on=function(t,e){return this._listeners=this._listeners||{},At(t,e,this._listeners),this},Mt.prototype.off=function(t,e){return kt(t,e,this._listeners),kt(t,e,this._oneTimeListeners),this},Mt.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},At(t,e,this._oneTimeListeners),this},Mt.prototype.fire=function(t,e){"string"==typeof t&&(t=new Pt(t,e||{}));var i=t.type;if(this.listens(i)){for(var r=0,n=(t.target=this)._listeners&&this._listeners[i]?this._listeners[i].slice():[];r<n.length;r+=1)n[r].call(this,t);for(var o=0,a=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];o<a.length;o+=1){var s=a[o];kt(i,s,this._oneTimeListeners),s.call(this,t)}var l=this._eventedParent;l&&(d(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),l.fire(t))}else t instanceof Dt&&console.error(t.error);return this},Mt.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&0<this._listeners[t].length||this._oneTimeListeners&&this._oneTimeListeners[t]&&0<this._oneTimeListeners[t].length||this._eventedParent&&this._eventedParent.listens(t)};var Ot={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!(Mt.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this})},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Rt=function(t,e,i,r){this.message=(t?t+": ":"")+i,r&&(this.identifier=r),null!=e&&e.__line__&&(this.line=e.__line__)};function Nt(t){var e=t.value;return e?[new Rt(t.key,e,"constants have been deprecated as of v8")]:[]}function Bt(t){for(var e=[],i=arguments.length-1;0<i--;)e[i]=arguments[i+1];for(var r=0,n=e;r<n.length;r+=1){var o=n[r];for(var a in o)t[a]=o[a]}return t}function Ft(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Ut(t){if(Array.isArray(t))return t.map(Ut);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var e={};for(var i in t)e[i]=Ut(t[i]);return e}return Ft(t)}function jt(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var i=0,r=e;i<r.length;i+=1){var n=r[i];this.bindings[n[0]]=n[1]}}var qt,Vt=((qt=Error)&&(Gt.__proto__=qt),(Gt.prototype=Object.create(qt&&qt.prototype)).constructor=Gt);function Gt(t,e){qt.call(this,e),this.message=e,this.key=t}jt.prototype.concat=function(t){return new jt(this,t)},jt.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},jt.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var Zt={kind:"null"},Ht={kind:"number"},Wt={kind:"string"},Kt={kind:"boolean"},Xt={kind:"color"},Yt={kind:"object"},Jt={kind:"value"},Qt={kind:"collator"},$t={kind:"formatted"},te={kind:"resolvedImage"};function ee(t,e){return{kind:"array",itemType:t,N:e}}function ie(t){if("array"!==t.kind)return t.kind;var e=ie(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}var re=[Zt,Ht,Wt,Kt,Xt,$t,Yt,ee(Jt),te];function ne(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!ne(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var i=0,r=re;i<r.length;i+=1)if(!ne(r[i],e))return null}return"Expected "+ie(t)+" but found "+ie(e)+" instead."}function oe(e,t){return t.some(function(t){return t.kind===e.kind})}function ae(e,t){return t.some(function(t){return"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e})}var se=e(function(t,e){var d={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function f(t){return(t=Math.round(t))<0?0:255<t?255:t}function m(t){return f("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function g(t){return(e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:1<e?1:e;var e}function y(t,e,i){return i<0?i+=1:1<i&&--i,6*i<1?t+(e-t)*i*6:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}try{e.parseCSSColor=function(t){var e,i=t.replace(/ /g,"").toLowerCase();if(i in d)return d[i].slice();if("#"===i[0])return 4===i.length?0<=(e=parseInt(i.substr(1),16))&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===i.length&&0<=(e=parseInt(i.substr(1),16))&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var r=i.indexOf("("),n=i.indexOf(")");if(-1!==r&&n+1===i.length){var o=i.substr(0,r),a=i.substr(r+1,n-(r+1)).split(","),s=1;switch(o){case"rgba":if(4!==a.length)return null;s=g(a.pop());case"rgb":return 3!==a.length?null:[m(a[0]),m(a[1]),m(a[2]),s];case"hsla":if(4!==a.length)return null;s=g(a.pop());case"hsl":if(3!==a.length)return null;var l=(parseFloat(a[0])%360+360)%360/360,u=g(a[1]),c=g(a[2]),p=c<=.5?c*(u+1):c+u-c*u,h=2*c-p;return[f(255*y(h,p,l+1/3)),f(255*y(h,p,l)),f(255*y(h,p,l-1/3)),s];default:return null}}return null}}catch(t){}}).parseCSSColor,le=function(t,e,i,r){void 0===r&&(r=1),this.r=t,this.g=e,this.b=i,this.a=r};le.parse=function(t){if(t){if(t instanceof le)return t;if("string"==typeof t){var e=se(t);if(e)return new le(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},le.prototype.toString=function(){var t=this.toArray(),e=t[1],i=t[2],r=t[3];return"rgba("+Math.round(t[0])+","+Math.round(e)+","+Math.round(i)+","+r+")"},le.prototype.toArray=function(){var t=this.a;return 0===t?[0,0,0,0]:[255*this.r/t,255*this.g/t,255*this.b/t,t]},le.black=new le(0,0,0,1),le.white=new le(1,1,1,1),le.transparent=new le(0,0,0,0),le.red=new le(1,0,0,1);var ue=function(t,e,i){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};function ce(t,e,i,r,n){this.text=t,this.image=e,this.scale=i,this.fontStack=r,this.textColor=n}ue.prototype.compare=function(t,e){return this.collator.compare(t,e)},ue.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var pe=function(t){this.sections=t};pe.fromString=function(t){return new pe([new ce(t,null,null,null,null)])},pe.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length})},pe.factory=function(t){return t instanceof pe?t:pe.fromString(t)},pe.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(t){return t.text}).join("")},pe.prototype.serialize=function(){for(var t=["format"],e=0,i=this.sections;e<i.length;e+=1){var r=i[e];if(r.image)t.push(["image",r.image.name]);else{t.push(r.text);var n={};r.fontStack&&(n["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(n["font-scale"]=r.scale),r.textColor&&(n["text-color"]=["rgba"].concat(r.textColor.toArray())),t.push(n)}}return t};var he=function(t){this.name=t.name,this.available=t.available};function de(t,e,i,r){return"number"==typeof t&&0<=t&&t<=255&&"number"==typeof e&&0<=e&&e<=255&&"number"==typeof i&&0<=i&&i<=255?void 0===r||"number"==typeof r&&0<=r&&r<=1?null:"Invalid rgba value ["+[t,e,i,r].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof r?[t,e,i,r]:[t,e,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function fe(t){if(null===t)return 1;if("string"==typeof t)return 1;if("boolean"==typeof t)return 1;if("number"==typeof t)return 1;if(t instanceof le)return 1;if(t instanceof ue)return 1;if(t instanceof pe)return 1;if(t instanceof he)return 1;if(Array.isArray(t)){for(var e=0,i=t;e<i.length;e+=1)if(!fe(i[e]))return;return 1}if("object"==typeof t){for(var r in t)if(!fe(t[r]))return;return 1}}function me(t){if(null===t)return Zt;if("string"==typeof t)return Wt;if("boolean"==typeof t)return Kt;if("number"==typeof t)return Ht;if(t instanceof le)return Xt;if(t instanceof ue)return Qt;if(t instanceof pe)return $t;if(t instanceof he)return te;if(Array.isArray(t)){for(var e,i=t.length,r=0,n=t;r<n.length;r+=1){var o=me(n[r]);if(e){if(e===o)continue;e=Jt;break}e=o}return ee(e||Jt,i)}return Yt}function ge(t){var e=typeof t;return null===t?"":"string"==e||"number"==e||"boolean"==e?String(t):t instanceof le||t instanceof pe||t instanceof he?t.toString():JSON.stringify(t)}function ye(t,e){this.type=t,this.value=e}he.prototype.toString=function(){return this.name},he.fromString=function(t){return t?new he({name:t,available:!1}):null},he.prototype.serialize=function(){return["image",this.name]},ye.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!fe(t[1]))return e.error("invalid value");var i=t[1],r=me(i),n=e.expectedType;return"array"!==r.kind||0!==r.N||!n||"array"!==n.kind||"number"==typeof n.N&&0!==n.N||(r=n),new ye(r,i)},ye.prototype.evaluate=function(){return this.value},ye.prototype.eachChild=function(){},ye.prototype.outputDefined=function(){return!0},ye.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof le?["rgba"].concat(this.value.toArray()):this.value instanceof pe?this.value.serialize():this.value};var ve=function(t){this.name="ExpressionEvaluationError",this.message=t};function _e(t,e){this.type=t,this.args=e}ve.prototype.toJSON=function(){return this.message};var xe={string:Wt,number:Ht,boolean:Kt,object:Yt};function be(t){this.type=$t,this.sections=t}function we(t){this.type=te,this.input=t}function Se(t,e){this.type=t,this.args=e}_e.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var i,r=1,n=t[0];if("array"===n){var o,a;if(2<t.length){var s=t[1];if("string"!=typeof s||!(s in xe)||"object"===s)return e.error('The item type argument of "array" must be one of string, number, boolean',1);o=xe[s],r++}else o=Jt;if(3<t.length){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);a=t[2],r++}i=ee(o,a)}else i=xe[n];for(var l=[];r<t.length;r++){var u=e.parse(t[r],r,Jt);if(!u)return null;l.push(u)}return new _e(i,l)},_e.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var i=this.args[e].evaluate(t);if(!ne(this.type,me(i)))return i;if(e===this.args.length-1)throw new ve("Expected value to be of type "+ie(this.type)+", but found "+ie(me(i))+" instead.")}return null},_e.prototype.eachChild=function(t){this.args.forEach(t)},_e.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},_e.prototype.serialize=function(){var t=this.type,e=[t.kind];if("array"===t.kind){var i=t.itemType;if("string"===i.kind||"number"===i.kind||"boolean"===i.kind){e.push(i.kind);var r=t.N;("number"==typeof r||1<this.args.length)&&e.push(r)}}return e.concat(this.args.map(function(t){return t.serialize()}))},be.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var i=t[1];if(!Array.isArray(i)&&"object"==typeof i)return e.error("First argument must be an image or text section.");for(var r=[],n=!1,o=1;o<=t.length-1;++o){var a=t[o];if(n&&"object"==typeof a&&!Array.isArray(a)){n=!1;var s=null;if(a["font-scale"]&&!(s=e.parse(a["font-scale"],1,Ht)))return null;var l=null;if(a["text-font"]&&!(l=e.parse(a["text-font"],1,ee(Wt))))return null;var u=null;if(a["text-color"]&&!(u=e.parse(a["text-color"],1,Xt)))return null;var c=r[r.length-1];c.scale=s,c.font=l,c.textColor=u}else{var p=e.parse(t[o],1,Jt);if(!p)return null;var h=p.type.kind;if("string"!==h&&"value"!==h&&"null"!==h&&"resolvedImage"!==h)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");n=!0,r.push({content:p,scale:null,font:null,textColor:null})}}return new be(r)},be.prototype.evaluate=function(i){return new pe(this.sections.map(function(t){var e=t.content.evaluate(i);return me(e)===te?new ce("",e,null,null,null):new ce(ge(e),null,t.scale?t.scale.evaluate(i):null,t.font?t.font.evaluate(i).join(","):null,t.textColor?t.textColor.evaluate(i):null)}))},be.prototype.eachChild=function(t){for(var e=0,i=this.sections;e<i.length;e+=1){var r=i[e];t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor)}},be.prototype.outputDefined=function(){return!1},be.prototype.serialize=function(){for(var t=["format"],e=0,i=this.sections;e<i.length;e+=1){var r=i[e];t.push(r.content.serialize());var n={};r.scale&&(n["font-scale"]=r.scale.serialize()),r.font&&(n["text-font"]=r.font.serialize()),r.textColor&&(n["text-color"]=r.textColor.serialize()),t.push(n)}return t},we.parse=function(t,e){if(2!==t.length)return e.error("Expected two arguments.");var i=e.parse(t[1],1,Wt);return i?new we(i):e.error("No image name provided.")},we.prototype.evaluate=function(t){var e=this.input.evaluate(t),i=he.fromString(e);return i&&t.availableImages&&(i.available=-1<t.availableImages.indexOf(e)),i},we.prototype.eachChild=function(t){t(this.input)},we.prototype.outputDefined=function(){return!1},we.prototype.serialize=function(){return["image",this.input.serialize()]};var Te={"to-boolean":Kt,"to-color":Xt,"to-number":Ht,"to-string":Wt};function Ie(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}Se.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var i=t[0];if(("to-boolean"===i||"to-string"===i)&&2!==t.length)return e.error("Expected one argument.");for(var r=Te[i],n=[],o=1;o<t.length;o++){var a=e.parse(t[o],o,Jt);if(!a)return null;n.push(a)}return new Se(r,n)},Se.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var e,i,r=0,n=this.args;r<n.length;r+=1){if(i=null,(e=n[r].evaluate(t))instanceof le)return e;if("string"==typeof e){var o=t.parseColor(e);if(o)return o}else if(Array.isArray(e)&&!(i=e.length<3||4<e.length?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":de(e[0],e[1],e[2],e[3])))return new le(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new ve(i||"Could not parse color from value '"+("string"==typeof e?e:String(JSON.stringify(e)))+"'")}if("number"!==this.type.kind)return"formatted"===this.type.kind?pe.fromString(ge(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?he.fromString(ge(this.args[0].evaluate(t))):ge(this.args[0].evaluate(t));for(var a=null,s=0,l=this.args;s<l.length;s+=1){if(null===(a=l[s].evaluate(t)))return 0;var u=Number(a);if(!isNaN(u))return u}throw new ve("Could not convert "+JSON.stringify(a)+" to number.")},Se.prototype.eachChild=function(t){this.args.forEach(t)},Se.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},Se.prototype.serialize=function(){if("formatted"===this.type.kind)return new be([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new we(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var Ee=["Unknown","Point","LineString","Polygon"];Ie.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Ie.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?Ee[this.feature.type]:this.feature.type:null},Ie.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Ie.prototype.canonicalID=function(){return this.canonical},Ie.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Ie.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e=e||(this._parseColorCache[t]=le.parse(t))};var Ce=function(t,e,i,r){this.name=t,this.type=e,this._evaluate=i,this.args=r};function Ae(t,e,i){this.type=Qt,this.locale=i,this.caseSensitive=t,this.diacriticSensitive=e}function ke(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Pe(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Me(t,e){for(var i,r,n,o,a,s,l=!1,u=0,c=e.length;u<c;u++)for(var p=e[u],h=0,d=p.length;h<d-1;h++){if((n=t[0]-(i=p[h])[0])*(s=t[1]-(r=p[h+1])[1])-(a=t[0]-r[0])*(o=t[1]-i[1])==0&&n*a<=0&&o*s<=0)return;f=t,m=p[h],g=p[h+1],m[1]>f[1]!=g[1]>f[1]&&f[0]<(g[0]-m[0])*(f[1]-m[1])/(g[1]-m[1])+m[0]&&(l=!l)}var f,m,g;return l}function Le(t,e){for(var i=0;i<e.length;i++)if(Me(t,e[i]))return 1}function De(t,e,i,r){var n=r[0]-i[0],o=r[1]-i[1],a=(t[0]-i[0])*o-n*(t[1]-i[1]),s=(e[0]-i[0])*o-n*(e[1]-i[1]);return 0<a&&s<0||a<0&&0<s}function ze(t,e,i){for(var r=0,n=i;r<n.length;r+=1)for(var o=n[r],a=0;a<o.length-1;++a)if(0!=(u=[(l=o[a+1])[0]-(s=o[a])[0],l[1]-s[1]])[0]*(c=[e[0]-t[0],e[1]-t[1]])[1]-u[1]*c[0]&&De(t,e,s,l)&&De(s,l,t,e))return 1;var s,l,u,c}function Oe(t,e){for(var i=0;i<t.length;++i)if(!Me(t[i],e))return;for(var r=0;r<t.length-1;++r)if(ze(t[r],t[r+1],e))return;return 1}function Re(t,e){for(var i=0;i<e.length;i++)if(Oe(t,e[i]))return 1}function Ne(t,e,i){for(var r=[],n=0;n<t.length;n++){for(var o=[],a=0;a<t[n].length;a++){var s=(l=t[n][a],u=i,c=(180+l[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,h=Math.pow(2,u.z),[Math.round(c*h*8192),Math.round(p*h*8192)]);ke(e,s),o.push(s)}r.push(o)}var l,u,c,p,h;return r}function Be(t,e,i){for(var r=[],n=0;n<t.length;n++){var o=Ne(t[n],e,i);r.push(o)}return r}function Fe(t,e,i,r){if(t[0]<i[0]||t[0]>i[2]){var n=.5*r,o=t[0]-i[0]>n?-r:i[0]-t[0]>n?r:0;0===o&&(o=t[0]-i[2]>n?-r:i[2]-t[0]>n?r:0),t[0]+=o}ke(e,t)}function Ue(t,e,i,r){for(var n=8192*Math.pow(2,r.z),o=[8192*r.x,8192*r.y],a=[],s=0,l=t;s<l.length;s+=1)for(var u=0,c=l[s];u<c.length;u+=1){var p=c[u],h=[p.x+o[0],p.y+o[1]];Fe(h,e,i,n),a.push(h)}return a}function je(t,e,i,r){for(var n,o=8192*Math.pow(2,r.z),a=[8192*r.x,8192*r.y],s=[],l=0,u=t;l<u.length;l+=1){for(var c=[],p=0,h=u[l];p<h.length;p+=1){var d=h[p],f=[d.x+a[0],d.y+a[1]];ke(e,f),c.push(f)}s.push(c)}if(e[2]-e[0]<=o/2){(n=e)[0]=n[1]=1/0,n[2]=n[3]=-1/0;for(var m=0,g=s;m<g.length;m+=1)for(var y=0,v=g[m];y<v.length;y+=1)Fe(v[y],e,i,o)}return s}Ce.prototype.evaluate=function(t){return this._evaluate(t,this.args)},Ce.prototype.eachChild=function(t){this.args.forEach(t)},Ce.prototype.outputDefined=function(){return!1},Ce.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},Ce.parse=function(i,t){var e,r=i[0],n=Ce.definitions[r];if(!n)return t.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0);for(var o=Array.isArray(n)?n[0]:n.type,a=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,s=a.filter(function(t){var e=t[0];return!Array.isArray(e)||e.length===i.length-1}),l=null,u=0,c=s;u<c.length;u+=1){var p=c[u],h=p[0],d=p[1];l=new We(t.registry,t.path,null,t.scope);for(var f=[],m=!1,g=1;g<i.length;g++){var y=i[g],v=Array.isArray(h)?h[g-1]:h.type,_=l.parse(y,1+f.length,v);if(!_){m=!0;break}f.push(_)}if(!m)if(Array.isArray(h)&&h.length!==f.length)l.error("Expected "+h.length+" arguments, but found "+f.length+" instead.");else{for(var x=0;x<f.length;x++){var b=Array.isArray(h)?h[x]:h.type,w=f[x];l.concat(x+1).checkSubtype(b,w.type)}if(0===l.errors.length)return new Ce(r,o,d,f)}}if(1===s.length)(e=t.errors).push.apply(e,l.errors);else{for(var S=(s.length?s:a).map(function(t){var e;return e=t[0],Array.isArray(e)?"("+e.map(ie).join(", ")+")":"("+ie(e.type)+"...)"}).join(" | "),T=[],I=1;I<i.length;I++){var E=t.parse(i[I],1+T.length);if(!E)return null;T.push(ie(E.type))}t.error("Expected arguments of type "+S+", but found ("+T.join(", ")+") instead.")}return null},Ce.register=function(t,e){for(var i in Ce.definitions=e)t[i]=Ce},Ae.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var i=t[1];if("object"!=typeof i||Array.isArray(i))return e.error("Collator options argument must be an object.");var r=e.parse(void 0!==i["case-sensitive"]&&i["case-sensitive"],1,Kt);if(!r)return null;var n=e.parse(void 0!==i["diacritic-sensitive"]&&i["diacritic-sensitive"],1,Kt);if(!n)return null;var o=null;return i.locale&&!(o=e.parse(i.locale,1,Wt))?null:new Ae(r,n,o)},Ae.prototype.evaluate=function(t){return new ue(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},Ae.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},Ae.prototype.outputDefined=function(){return!1},Ae.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var qe=function(t,e){this.type=Kt,this.geojson=t,this.geometries=e};function Ve(t){if(t instanceof Ce){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof qe)return!1;var e=!0;return t.eachChild(function(t){e&&!Ve(t)&&(e=!1)}),e}function Ge(t){if(!(t instanceof Ce&&"feature-state"===t.name)){var e=!0;return t.eachChild(function(t){e&&!Ge(t)&&(e=!1)}),e}}function Ze(t,e){if(t instanceof Ce&&0<=e.indexOf(t.name))return!1;var i=!0;return t.eachChild(function(t){i&&!Ze(t,e)&&(i=!1)}),i}function He(t,e){this.type=e.type,this.name=t,this.boundExpression=e}qe.parse=function(t,e){if(2!==t.length)return e.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(fe(t[1])){var i=t[1];if("FeatureCollection"===i.type)for(var r=0;r<i.features.length;++r){var n=i.features[r].geometry.type;if("Polygon"===n||"MultiPolygon"===n)return new qe(i,i.features[r].geometry)}else if("Feature"===i.type){var o=i.geometry.type;if("Polygon"===o||"MultiPolygon"===o)return new qe(i,i.geometry)}else if("Polygon"===i.type||"MultiPolygon"===i.type)return new qe(i,i)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")},qe.prototype.evaluate=function(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){var i=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],n=t.canonicalID();if("Polygon"===e.type){var o=Ne(e.coordinates,r,n),a=Ue(t.geometry(),i,r,n);if(!Pe(i,r))return!1;for(var s=0,l=a;s<l.length;s+=1)if(!Me(l[s],o))return!1}if("MultiPolygon"===e.type){var u=Be(e.coordinates,r,n),c=Ue(t.geometry(),i,r,n);if(!Pe(i,r))return!1;for(var p=0,h=c;p<h.length;p+=1)if(!Le(h[p],u))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){var i=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],n=t.canonicalID();if("Polygon"===e.type){var o=Ne(e.coordinates,r,n),a=je(t.geometry(),i,r,n);if(!Pe(i,r))return!1;for(var s=0,l=a;s<l.length;s+=1)if(!Oe(l[s],o))return!1}if("MultiPolygon"===e.type){var u=Be(e.coordinates,r,n),c=je(t.geometry(),i,r,n);if(!Pe(i,r))return!1;for(var p=0,h=c;p<h.length;p+=1)if(!Re(h[p],u))return!1}return!0}(t,this.geometries)}return!1},qe.prototype.eachChild=function(){},qe.prototype.outputDefined=function(){return!0},qe.prototype.serialize=function(){return["within",this.geojson]},He.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var i=t[1];return e.scope.has(i)?new He(i,e.scope.get(i)):e.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},He.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},He.prototype.eachChild=function(){},He.prototype.outputDefined=function(){return!1},He.prototype.serialize=function(){return["var",this.name]};var We=function(t,e,i,r,n){void 0===e&&(e=[]),void 0===r&&(r=new jt),void 0===n&&(n=[]),this.registry=t,this.path=e,this.key=e.map(function(t){return"["+t+"]"}).join(""),this.scope=r,this.errors=n,this.expectedType=i};function Ke(t,e){for(var i,r=t.length-1,n=0,o=r,a=0;n<=o;)if((i=t[a=Math.floor((n+o)/2)])<=e){if(a===r||e<t[a+1])return a;n=a+1}else{if(!(e<i))throw new ve("Input is not a number.");o=a-1}return 0}We.prototype.parse=function(t,e,i,r,n){return void 0===n&&(n={}),e?this.concat(e,i,r)._parse(t,n):this._parse(t,n)},We.prototype._parse=function(t,e){function i(t,e,i){return"assert"===i?new _e(e,[t]):"coerce"===i?new Se(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var r=t[0];if("string"!=typeof r)return this.error("Expression name must be a string, but found "+typeof r+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var n=this.registry[r];if(n){var o=n.parse(t,this);if(!o)return null;if(this.expectedType){var a=this.expectedType,s=o.type;if("string"!==a.kind&&"number"!==a.kind&&"boolean"!==a.kind&&"object"!==a.kind&&"array"!==a.kind||"value"!==s.kind)if("color"!==a.kind&&"formatted"!==a.kind&&"resolvedImage"!==a.kind||"value"!==s.kind&&"string"!==s.kind){if(this.checkSubtype(a,s))return null}else o=i(o,a,e.typeAnnotation||"coerce");else o=i(o,a,e.typeAnnotation||"assert")}if(!(o instanceof ye)&&"resolvedImage"!==o.type.kind&&function e(t){if(t instanceof He)return e(t.boundExpression);if(t instanceof Ce&&"error"===t.name)return!1;if(t instanceof Ae)return!1;if(t instanceof qe)return!1;var i=t instanceof Se||t instanceof _e,r=!0;return t.eachChild(function(t){r=i?r&&e(t):r&&t instanceof ye}),!!r&&Ve(t)&&Ze(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(o)){var l=new Ie;try{o=new ye(o.type,o.evaluate(l))}catch(t){return this.error(t.message),null}}return o}return this.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof t+" instead.")},We.prototype.concat=function(t,e,i){var r="number"==typeof t?this.path.concat(t):this.path,n=i?this.scope.concat(i):this.scope;return new We(this.registry,r,e||null,n,this.errors)},We.prototype.error=function(t){for(var e=[],i=arguments.length-1;0<i--;)e[i]=arguments[i+1];var r=""+this.key+e.map(function(t){return"["+t+"]"}).join("");this.errors.push(new Vt(r,t))},We.prototype.checkSubtype=function(t,e){var i=ne(t,e);return i&&this.error(i),i};var Xe=function(t,e,i){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var r=0,n=i;r<n.length;r+=1){var o=n[r],a=o[1];this.labels.push(o[0]),this.outputs.push(a)}};function Ye(t,e,i){return t*(1-i)+e*i}Xe.parse=function(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");var i=e.parse(t[1],1,Ht);if(!i)return null;var r=[],n=null;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(var o=1;o<t.length;o+=2){var a=1===o?-1/0:t[o],s=t[o+1],l=o,u=o+1;if("number"!=typeof a)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',l);if(r.length&&r[r.length-1][0]>=a)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',l);var c=e.parse(s,u,n);if(!c)return null;n=n||c.type,r.push([a,c])}return new Xe(n,i,r)},Xe.prototype.evaluate=function(t){var e=this.labels,i=this.outputs;if(1===e.length)return i[0].evaluate(t);var r=this.input.evaluate(t);if(r<=e[0])return i[0].evaluate(t);var n=e.length;return r>=e[n-1]?i[n-1].evaluate(t):i[Ke(e,r)].evaluate(t)},Xe.prototype.eachChild=function(t){t(this.input);for(var e=0,i=this.outputs;e<i.length;e+=1)t(i[e])},Xe.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},Xe.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)0<e&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var Je=Object.freeze({__proto__:null,number:Ye,color:function(t,e,i){return new le(Ye(t.r,e.r,i),Ye(t.g,e.g,i),Ye(t.b,e.b,i),Ye(t.a,e.a,i))},array:function(t,i,r){return t.map(function(t,e){return Ye(t,i[e],r)})}}),Qe=6/29*3*(6/29),$e=Math.PI/180,ti=180/Math.PI;function ei(t){return.008856451679035631<t?Math.pow(t,1/3):t/Qe+4/29}function ii(t){return 6/29<t?t*t*t:Qe*(t-4/29)}function ri(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function ni(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function oi(t){var e=ni(t.r),i=ni(t.g),r=ni(t.b),n=ei((.4124564*e+.3575761*i+.1804375*r)/.95047),o=ei(.2126729*e+.7151522*i+.072175*r);return{l:116*o-16,a:500*(n-o),b:200*(o-ei((.0193339*e+.119192*i+.9503041*r)/1.08883)),alpha:t.a}}function ai(t){var e=(t.l+16)/116,i=isNaN(t.a)?e:e+t.a/500,r=isNaN(t.b)?e:e-t.b/200;return e=+ii(e),i=.95047*ii(i),r=1.08883*ii(r),new le(ri(3.2404542*i-1.5371385*e-.4985314*r),ri(-.969266*i+1.8760108*e+.041556*r),ri(.0556434*i-.2040259*e+1.0572252*r),t.alpha)}var si={forward:oi,reverse:ai,interpolate:function(t,e,i){return{l:Ye(t.l,e.l,i),a:Ye(t.a,e.a,i),b:Ye(t.b,e.b,i),alpha:Ye(t.alpha,e.alpha,i)}}},li={forward:function(t){var e=oi(t),i=e.l,r=e.a,n=e.b,o=Math.atan2(n,r)*ti;return{h:o<0?360+o:o,c:Math.sqrt(r*r+n*n),l:i,alpha:t.a}},reverse:function(t){var e=t.h*$e,i=t.c;return ai({l:t.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:t.alpha})},interpolate:function(t,e,i){return{h:(r=t.h,n=e.h,r+i*(180<(o=n-r)||o<-180?o-360*Math.round(o/360):o)),c:Ye(t.c,e.c,i),l:Ye(t.l,e.l,i),alpha:Ye(t.alpha,e.alpha,i)};var r,n,o}},ui=Object.freeze({__proto__:null,lab:si,hcl:li}),ci=function(t,e,i,r,n){this.type=t,this.operator=e,this.interpolation=i,this.input=r,this.labels=[],this.outputs=[];for(var o=0,a=n;o<a.length;o+=1){var s=a[o],l=s[1];this.labels.push(s[0]),this.outputs.push(l)}};function pi(t,e,i,r){var n=r-i,o=t-i;return 0==n?0:1===e?o/n:(Math.pow(e,o)-1)/(Math.pow(e,n)-1)}ci.interpolationFactor=function(t,e,i,r){var n=0;if("exponential"===t.name)n=pi(e,t.base,i,r);else if("linear"===t.name)n=pi(e,1,i,r);else if("cubic-bezier"===t.name){var o=t.controlPoints;n=new a(o[0],o[1],o[2],o[3]).solve(pi(e,1,i,r))}return n},ci.parse=function(t,e){var i=t[0],r=t[1],n=t[2],o=t.slice(3);if(!Array.isArray(r)||0===r.length)return e.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){var a=r[1];if("number"!=typeof a)return e.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:a}}else{if("cubic-bezier"!==r[0])return e.error("Unknown interpolation type "+String(r[0]),1,0);var s=r.slice(1);if(4!==s.length||s.some(function(t){return"number"!=typeof t||t<0||1<t}))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:s}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(n=e.parse(n,2,Ht)))return null;var l=[],u=null;"interpolate-hcl"===i||"interpolate-lab"===i?u=Xt:e.expectedType&&"value"!==e.expectedType.kind&&(u=e.expectedType);for(var c=0;c<o.length;c+=2){var p=o[c],h=o[c+1],d=c+3,f=c+4;if("number"!=typeof p)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',d);if(l.length&&l[l.length-1][0]>=p)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',d);var m=e.parse(h,f,u);if(!m)return null;u=u||m.type,l.push([p,m])}return"number"===u.kind||"color"===u.kind||"array"===u.kind&&"number"===u.itemType.kind&&"number"==typeof u.N?new ci(u,i,r,n,l):e.error("Type "+ie(u)+" is not interpolatable.")},ci.prototype.evaluate=function(t){var e=this.labels,i=this.outputs;if(1===e.length)return i[0].evaluate(t);var r=this.input.evaluate(t);if(r<=e[0])return i[0].evaluate(t);var n=e.length;if(r>=e[n-1])return i[n-1].evaluate(t);var o=Ke(e,r),a=ci.interpolationFactor(this.interpolation,r,e[o],e[o+1]),s=i[o].evaluate(t),l=i[o+1].evaluate(t);return"interpolate"===this.operator?Je[this.type.kind.toLowerCase()](s,l,a):"interpolate-hcl"===this.operator?li.reverse(li.interpolate(li.forward(s),li.forward(l),a)):si.reverse(si.interpolate(si.forward(s),si.forward(l),a))},ci.prototype.eachChild=function(t){t(this.input);for(var e=0,i=this.outputs;e<i.length;e+=1)t(i[e])},ci.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},ci.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],i=0;i<this.labels.length;i++)e.push(this.labels[i],this.outputs[i].serialize());return e};var hi=function(t,e){this.type=t,this.args=e};hi.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var i=null,r=e.expectedType;r&&"value"!==r.kind&&(i=r);for(var n=[],o=0,a=t.slice(1);o<a.length;o+=1){var s=e.parse(a[o],1+n.length,i,void 0,{typeAnnotation:"omit"});if(!s)return null;i=i||s.type,n.push(s)}var l=r&&n.some(function(t){return ne(r,t.type)});return new hi(l?Jt:i,n)},hi.prototype.evaluate=function(t){for(var e,i=null,r=0,n=0,o=this.args;n<o.length&&(r++,(i=o[n].evaluate(t))&&i instanceof he&&!i.available&&(e=e||i.name,i=null,r===this.args.length&&(i=e)),null===i);n+=1);return i},hi.prototype.eachChild=function(t){this.args.forEach(t)},hi.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},hi.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var di=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};function fi(t,e,i){this.type=t,this.index=e,this.input=i}function mi(t,e){this.type=Kt,this.needle=t,this.haystack=e}function gi(t,e,i){this.type=Ht,this.needle=t,this.haystack=e,this.fromIndex=i}function yi(t,e,i,r,n,o){this.inputType=t,this.type=e,this.input=i,this.cases=r,this.outputs=n,this.otherwise=o}function vi(t,e,i){this.type=t,this.branches=e,this.otherwise=i}function _i(t,e,i,r){this.type=t,this.input=e,this.beginIndex=i,this.endIndex=r}function xi(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function bi(t,e,i,r){return 0===r.compare(e,i)}function wi(s,l,u){var c="=="!==s&&"!="!==s;return a.parse=function(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");var i=t[0],r=e.parse(t[1],1,Jt);if(!r)return null;if(!xi(i,r.type))return e.concat(1).error('"'+i+"\" comparisons are not supported for type '"+ie(r.type)+"'.");var n=e.parse(t[2],2,Jt);if(!n)return null;if(!xi(i,n.type))return e.concat(2).error('"'+i+"\" comparisons are not supported for type '"+ie(n.type)+"'.");if(r.type.kind!==n.type.kind&&"value"!==r.type.kind&&"value"!==n.type.kind)return e.error("Cannot compare types '"+ie(r.type)+"' and '"+ie(n.type)+"'.");c&&("value"===r.type.kind&&"value"!==n.type.kind?r=new _e(n.type,[r]):"value"!==r.type.kind&&"value"===n.type.kind&&(n=new _e(r.type,[n])));var o=null;if(4===t.length){if("string"!==r.type.kind&&"string"!==n.type.kind&&"value"!==r.type.kind&&"value"!==n.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(o=e.parse(t[3],3,Qt)))return null}return new a(r,n,o)},a.prototype.evaluate=function(t){var e=this.lhs.evaluate(t),i=this.rhs.evaluate(t);if(c&&this.hasUntypedArgument){var r=me(e),n=me(i);if(r.kind!==n.kind||"string"!==r.kind&&"number"!==r.kind)throw new ve('Expected arguments for "'+s+'" to be (string, string) or (number, number), but found ('+r.kind+", "+n.kind+") instead.")}if(this.collator&&!c&&this.hasUntypedArgument){var o=me(e),a=me(i);if("string"!==o.kind||"string"!==a.kind)return l(t,e,i)}return this.collator?u(t,e,i,this.collator.evaluate(t)):l(t,e,i)},a.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},a.prototype.outputDefined=function(){return!0},a.prototype.serialize=function(){var e=[s];return this.eachChild(function(t){e.push(t.serialize())}),e},a;function a(t,e,i){this.type=Kt,this.lhs=t,this.rhs=e,this.collator=i,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}}function Si(t,e,i,r,n){this.type=Wt,this.number=t,this.locale=e,this.currency=i,this.minFractionDigits=r,this.maxFractionDigits=n}di.prototype.evaluate=function(t){return this.result.evaluate(t)},di.prototype.eachChild=function(t){for(var e=0,i=this.bindings;e<i.length;e+=1)t(i[e][1]);t(this.result)},di.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var i=[],r=1;r<t.length-1;r+=2){var n=t[r];if("string"!=typeof n)return e.error("Expected string, but found "+typeof n+" instead.",r);if(/[^a-zA-Z0-9_]/.test(n))return e.error("Variable names must contain only alphanumeric characters or '_'.",r);var o=e.parse(t[r+1],r+1);if(!o)return null;i.push([n,o])}var a=e.parse(t[t.length-1],t.length-1,e.expectedType,i);return a?new di(i,a):null},di.prototype.outputDefined=function(){return this.result.outputDefined()},di.prototype.serialize=function(){for(var t=["let"],e=0,i=this.bindings;e<i.length;e+=1){var r=i[e];t.push(r[0],r[1].serialize())}return t.push(this.result.serialize()),t},fi.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1,Ht),r=e.parse(t[2],2,ee(e.expectedType||Jt));return i&&r?new fi(r.type.itemType,i,r):null},fi.prototype.evaluate=function(t){var e=this.index.evaluate(t),i=this.input.evaluate(t);if(e<0)throw new ve("Array index out of bounds: "+e+" < 0.");if(e>=i.length)throw new ve("Array index out of bounds: "+e+" > "+(i.length-1)+".");if(e!==Math.floor(e))throw new ve("Array index must be an integer, but found "+e+" instead.");return i[e]},fi.prototype.eachChild=function(t){t(this.index),t(this.input)},fi.prototype.outputDefined=function(){return!1},fi.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]},mi.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1,Jt),r=e.parse(t[2],2,Jt);return i&&r?oe(i.type,[Kt,Wt,Ht,Zt,Jt])?new mi(i,r):e.error("Expected first argument to be of type boolean, string, number or null, but found "+ie(i.type)+" instead"):null},mi.prototype.evaluate=function(t){var e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!i)return!1;if(!ae(e,["boolean","string","number","null"]))throw new ve("Expected first argument to be of type boolean, string, number or null, but found "+ie(me(e))+" instead.");if(!ae(i,["string","array"]))throw new ve("Expected second argument to be of type array or string, but found "+ie(me(i))+" instead.");return 0<=i.indexOf(e)},mi.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},mi.prototype.outputDefined=function(){return!0},mi.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]},gi.parse=function(t,e){if(t.length<=2||5<=t.length)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1,Jt),r=e.parse(t[2],2,Jt);if(!i||!r)return null;if(!oe(i.type,[Kt,Wt,Ht,Zt,Jt]))return e.error("Expected first argument to be of type boolean, string, number or null, but found "+ie(i.type)+" instead");if(4!==t.length)return new gi(i,r);var n=e.parse(t[3],3,Ht);return n?new gi(i,r,n):null},gi.prototype.evaluate=function(t){var e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!ae(e,["boolean","string","number","null"]))throw new ve("Expected first argument to be of type boolean, string, number or null, but found "+ie(me(e))+" instead.");if(!ae(i,["string","array"]))throw new ve("Expected second argument to be of type array or string, but found "+ie(me(i))+" instead.");if(this.fromIndex){var r=this.fromIndex.evaluate(t);return i.indexOf(e,r)}return i.indexOf(e)},gi.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},gi.prototype.outputDefined=function(){return!1},gi.prototype.serialize=function(){if(null==this.fromIndex||void 0===this.fromIndex)return["index-of",this.needle.serialize(),this.haystack.serialize()];var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]},yi.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var i,r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(var n={},o=[],a=2;a<t.length-1;a+=2){var s=t[a],l=t[a+1];Array.isArray(s)||(s=[s]);var u=e.concat(a);if(0===s.length)return u.error("Expected at least one branch label.");for(var c=0,p=s;c<p.length;c+=1){var h=p[c];if("number"!=typeof h&&"string"!=typeof h)return u.error("Branch labels must be numbers or strings.");if("number"==typeof h&&Math.abs(h)>Number.MAX_SAFE_INTEGER)return u.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof h&&Math.floor(h)!==h)return u.error("Numeric branch labels must be integer values.");if(i){if(u.checkSubtype(i,me(h)))return null}else i=me(h);if(void 0!==n[String(h)])return u.error("Branch labels must be unique.");n[String(h)]=o.length}var d=e.parse(l,a,r);if(!d)return null;r=r||d.type,o.push(d)}var f=e.parse(t[1],1,Jt);if(!f)return null;var m=e.parse(t[t.length-1],t.length-1,r);return!m||"value"!==f.type.kind&&e.concat(1).checkSubtype(i,f.type)?null:new yi(i,r,f,n,o,m)},yi.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(me(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},yi.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},yi.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})&&this.otherwise.outputDefined()},yi.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],i=[],r={},n=0,o=Object.keys(this.cases).sort();n<o.length;n+=1){var a=o[n];void 0===(p=r[this.cases[a]])?(r[this.cases[a]]=i.length,i.push([this.cases[a],[a]])):i[p][1].push(a)}for(var s=function(t){return"number"===e.inputType.kind?Number(t):t},l=0,u=i;l<u.length;l+=1){var c=u[l],p=c[0],h=c[1];t.push(1===h.length?s(h[0]):h.map(s)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t},vi.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);for(var r=[],n=1;n<t.length-1;n+=2){var o=e.parse(t[n],n,Kt);if(!o)return null;var a=e.parse(t[n+1],n+1,i);if(!a)return null;r.push([o,a]),i=i||a.type}var s=e.parse(t[t.length-1],t.length-1,i);return s?new vi(i,r,s):null},vi.prototype.evaluate=function(t){for(var e=0,i=this.branches;e<i.length;e+=1){var r=i[e],n=r[1];if(r[0].evaluate(t))return n.evaluate(t)}return this.otherwise.evaluate(t)},vi.prototype.eachChild=function(t){for(var e=0,i=this.branches;e<i.length;e+=1){var r=i[e],n=r[1];t(r[0]),t(n)}t(this.otherwise)},vi.prototype.outputDefined=function(){return this.branches.every(function(t){return t[1].outputDefined()})&&this.otherwise.outputDefined()},vi.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e},_i.parse=function(t,e){if(t.length<=2||5<=t.length)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1,Jt),r=e.parse(t[2],2,Ht);if(!i||!r)return null;if(!oe(i.type,[ee(Jt),Wt,Jt]))return e.error("Expected first argument to be of type array or string, but found "+ie(i.type)+" instead");if(4!==t.length)return new _i(i.type,i,r);var n=e.parse(t[3],3,Ht);return n?new _i(i.type,i,r,n):null},_i.prototype.evaluate=function(t){var e=this.input.evaluate(t),i=this.beginIndex.evaluate(t);if(!ae(e,["string","array"]))throw new ve("Expected first argument to be of type array or string, but found "+ie(me(e))+" instead.");if(this.endIndex){var r=this.endIndex.evaluate(t);return e.slice(i,r)}return e.slice(i)},_i.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},_i.prototype.outputDefined=function(){return!1},_i.prototype.serialize=function(){if(null==this.endIndex||void 0===this.endIndex)return["slice",this.input.serialize(),this.beginIndex.serialize()];var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]};var Ti=wi("==",function(t,e,i){return e===i},bi),Ii=wi("!=",function(t,e,i){return e!==i},function(t,e,i,r){return!bi(0,e,i,r)}),Ei=wi("<",function(t,e,i){return e<i},function(t,e,i,r){return r.compare(e,i)<0}),Ci=wi(">",function(t,e,i){return i<e},function(t,e,i,r){return 0<r.compare(e,i)}),Ai=wi("<=",function(t,e,i){return e<=i},function(t,e,i,r){return r.compare(e,i)<=0}),ki=wi(">=",function(t,e,i){return i<=e},function(t,e,i,r){return 0<=r.compare(e,i)});function Pi(t){this.type=Ht,this.input=t}Si.parse=function(t,e){if(3!==t.length)return e.error("Expected two arguments.");var i=e.parse(t[1],1,Ht);if(!i)return null;var r=t[2];if("object"!=typeof r||Array.isArray(r))return e.error("NumberFormat options argument must be an object.");var n=null;if(r.locale&&!(n=e.parse(r.locale,1,Wt)))return null;var o=null;if(r.currency&&!(o=e.parse(r.currency,1,Wt)))return null;var a=null;if(r["min-fraction-digits"]&&!(a=e.parse(r["min-fraction-digits"],1,Ht)))return null;var s=null;return r["max-fraction-digits"]&&!(s=e.parse(r["max-fraction-digits"],1,Ht))?null:new Si(i,n,o,a,s)},Si.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},Si.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},Si.prototype.outputDefined=function(){return!1},Si.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]},Pi.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1);return i?"array"!==i.type.kind&&"string"!==i.type.kind&&"value"!==i.type.kind?e.error("Expected argument of type string or array, but found "+ie(i.type)+" instead."):new Pi(i):null},Pi.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new ve("Expected value to be of type string or array, but found "+ie(me(e))+" instead.")},Pi.prototype.eachChild=function(t){t(this.input)},Pi.prototype.outputDefined=function(){return!1},Pi.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Mi={"==":Ti,"!=":Ii,">":Ci,"<":Ei,">=":ki,"<=":Ai,array:_e,at:fi,boolean:_e,case:vi,coalesce:hi,collator:Ae,format:be,image:we,in:mi,"index-of":gi,interpolate:ci,"interpolate-hcl":ci,"interpolate-lab":ci,length:Pi,let:di,literal:ye,match:yi,number:_e,"number-format":Si,object:_e,slice:_i,step:Xe,string:_e,"to-boolean":Se,"to-color":Se,"to-number":Se,"to-string":Se,var:He,within:qe};function Li(t,e){var i=e[0],r=e[1],n=e[2],o=e[3];i=i.evaluate(t),r=r.evaluate(t),n=n.evaluate(t);var a=o?o.evaluate(t):1,s=de(i,r,n,a);if(s)throw new ve(s);return new le(i/255*a,r/255*a,n/255*a,a)}function Di(t,e){return t in e}function zi(t,e){var i=e[t];return void 0===i?null:i}function Oi(t){return{type:t}}function Ri(t){return{result:"success",value:t}}function Ni(t){return{result:"error",value:t}}function Bi(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function Fi(t){return t.expression&&-1<t.expression.parameters.indexOf("zoom")}function Ui(t){return t.expression&&t.expression.interpolated}function ji(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function qi(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Vi(t){return t}function Gi(t,e,i){return void 0!==t?t:void 0!==e?e:void 0!==i?i:void 0}function Zi(t,e,i,r,n){return Gi(typeof i===n?r[i]:void 0,t.default,e.default)}function Hi(t,e,i){if("number"!==ji(i))return Gi(t.default,e.default);var r=t.stops.length;if(1===r)return t.stops[0][1];if(i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[r-1][0])return t.stops[r-1][1];var n=Ke(t.stops.map(function(t){return t[0]}),i);return t.stops[n][1]}function Wi(t,e,i){var r=void 0!==t.base?t.base:1;if("number"!==ji(i))return Gi(t.default,e.default);var n=t.stops.length;if(1===n)return t.stops[0][1];if(i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[n-1][0])return t.stops[n-1][1];var o,a,s,l,u,c=Ke(t.stops.map(function(t){return t[0]}),i),p=(o=i,a=r,s=t.stops[c][0],l=t.stops[c+1][0]-s,u=o-s,0==l?0:1===a?u/l:(Math.pow(a,u)-1)/(Math.pow(a,l)-1)),h=t.stops[c][1],d=t.stops[c+1][1],f=Je[e.type]||Vi;if(t.colorSpace&&"rgb"!==t.colorSpace){var m=ui[t.colorSpace];f=function(t,e){return m.reverse(m.interpolate(m.forward(t),m.forward(e),p))}}return"function"==typeof h.evaluate?{evaluate:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=h.evaluate.apply(void 0,t),r=d.evaluate.apply(void 0,t);if(void 0!==i&&void 0!==r)return f(i,r,p)}}:f(h,d,p)}function Ki(t,e,i){return"color"===e.type?i=le.parse(i):"formatted"===e.type?i=pe.fromString(i.toString()):"resolvedImage"===e.type?i=he.fromString(i.toString()):ji(i)===e.type||"enum"===e.type&&e.values[i]||(i=void 0),Gi(i,t.default,e.default)}Ce.register(Mi,{error:[{kind:"error"},[Wt],function(t,e){throw new ve(e[0].evaluate(t))}],typeof:[Wt,[Jt],function(t,e){return ie(me(e[0].evaluate(t)))}],"to-rgba":[ee(Ht,4),[Xt],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[Xt,[Ht,Ht,Ht],Li],rgba:[Xt,[Ht,Ht,Ht,Ht],Li],has:{type:Kt,overloads:[[[Wt],function(t,e){return Di(e[0].evaluate(t),t.properties())}],[[Wt,Yt],function(t,e){var i=e[1];return Di(e[0].evaluate(t),i.evaluate(t))}]]},get:{type:Jt,overloads:[[[Wt],function(t,e){return zi(e[0].evaluate(t),t.properties())}],[[Wt,Yt],function(t,e){var i=e[1];return zi(e[0].evaluate(t),i.evaluate(t))}]]},"feature-state":[Jt,[Wt],function(t,e){return zi(e[0].evaluate(t),t.featureState||{})}],properties:[Yt,[],function(t){return t.properties()}],"geometry-type":[Wt,[],function(t){return t.geometryType()}],id:[Jt,[],function(t){return t.id()}],zoom:[Ht,[],function(t){return t.globals.zoom}],"heatmap-density":[Ht,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[Ht,[],function(t){return t.globals.lineProgress||0}],accumulated:[Jt,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[Ht,Oi(Ht),function(t,e){for(var i=0,r=0,n=e;r<n.length;r+=1)i+=n[r].evaluate(t);return i}],"*":[Ht,Oi(Ht),function(t,e){for(var i=1,r=0,n=e;r<n.length;r+=1)i*=n[r].evaluate(t);return i}],"-":{type:Ht,overloads:[[[Ht,Ht],function(t,e){var i=e[1];return e[0].evaluate(t)-i.evaluate(t)}],[[Ht],function(t,e){return-e[0].evaluate(t)}]]},"/":[Ht,[Ht,Ht],function(t,e){var i=e[1];return e[0].evaluate(t)/i.evaluate(t)}],"%":[Ht,[Ht,Ht],function(t,e){var i=e[1];return e[0].evaluate(t)%i.evaluate(t)}],ln2:[Ht,[],function(){return Math.LN2}],pi:[Ht,[],function(){return Math.PI}],e:[Ht,[],function(){return Math.E}],"^":[Ht,[Ht,Ht],function(t,e){var i=e[1];return Math.pow(e[0].evaluate(t),i.evaluate(t))}],sqrt:[Ht,[Ht],function(t,e){return Math.sqrt(e[0].evaluate(t))}],log10:[Ht,[Ht],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN10}],ln:[Ht,[Ht],function(t,e){return Math.log(e[0].evaluate(t))}],log2:[Ht,[Ht],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN2}],sin:[Ht,[Ht],function(t,e){return Math.sin(e[0].evaluate(t))}],cos:[Ht,[Ht],function(t,e){return Math.cos(e[0].evaluate(t))}],tan:[Ht,[Ht],function(t,e){return Math.tan(e[0].evaluate(t))}],asin:[Ht,[Ht],function(t,e){return Math.asin(e[0].evaluate(t))}],acos:[Ht,[Ht],function(t,e){return Math.acos(e[0].evaluate(t))}],atan:[Ht,[Ht],function(t,e){return Math.atan(e[0].evaluate(t))}],min:[Ht,Oi(Ht),function(e,t){return Math.min.apply(Math,t.map(function(t){return t.evaluate(e)}))}],max:[Ht,Oi(Ht),function(e,t){return Math.max.apply(Math,t.map(function(t){return t.evaluate(e)}))}],abs:[Ht,[Ht],function(t,e){return Math.abs(e[0].evaluate(t))}],round:[Ht,[Ht],function(t,e){var i=e[0].evaluate(t);return i<0?-Math.round(-i):Math.round(i)}],floor:[Ht,[Ht],function(t,e){return Math.floor(e[0].evaluate(t))}],ceil:[Ht,[Ht],function(t,e){return Math.ceil(e[0].evaluate(t))}],"filter-==":[Kt,[Wt,Jt],function(t,e){var i=e[0],r=e[1];return t.properties()[i.value]===r.value}],"filter-id-==":[Kt,[Jt],function(t,e){var i=e[0];return t.id()===i.value}],"filter-type-==":[Kt,[Wt],function(t,e){var i=e[0];return t.geometryType()===i.value}],"filter-<":[Kt,[Wt,Jt],function(t,e){var i=e[0],r=e[1],n=t.properties()[i.value],o=r.value;return typeof n==typeof o&&n<o}],"filter-id-<":[Kt,[Jt],function(t,e){var i=e[0],r=t.id(),n=i.value;return typeof r==typeof n&&r<n}],"filter->":[Kt,[Wt,Jt],function(t,e){var i=e[0],r=e[1],n=t.properties()[i.value],o=r.value;return typeof n==typeof o&&o<n}],"filter-id->":[Kt,[Jt],function(t,e){var i=e[0],r=t.id(),n=i.value;return typeof r==typeof n&&n<r}],"filter-<=":[Kt,[Wt,Jt],function(t,e){var i=e[0],r=e[1],n=t.properties()[i.value],o=r.value;return typeof n==typeof o&&n<=o}],"filter-id-<=":[Kt,[Jt],function(t,e){var i=e[0],r=t.id(),n=i.value;return typeof r==typeof n&&r<=n}],"filter->=":[Kt,[Wt,Jt],function(t,e){var i=e[0],r=e[1],n=t.properties()[i.value],o=r.value;return typeof n==typeof o&&o<=n}],"filter-id->=":[Kt,[Jt],function(t,e){var i=e[0],r=t.id(),n=i.value;return typeof r==typeof n&&n<=r}],"filter-has":[Kt,[Jt],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[Kt,[],function(t){return null!==t.id()&&void 0!==t.id()}],"filter-type-in":[Kt,[ee(Wt)],function(t,e){return 0<=e[0].value.indexOf(t.geometryType())}],"filter-id-in":[Kt,[ee(Jt)],function(t,e){return 0<=e[0].value.indexOf(t.id())}],"filter-in-small":[Kt,[Wt,ee(Jt)],function(t,e){var i=e[0];return 0<=e[1].value.indexOf(t.properties()[i.value])}],"filter-in-large":[Kt,[Wt,ee(Jt)],function(t,e){var i=e[0],r=e[1];return function(t,e,i,r){for(;i<=r;){var n=i+r>>1;if(e[n]===t)return!0;e[n]>t?r=n-1:i=1+n}return!1}(t.properties()[i.value],r.value,0,r.value.length-1)}],all:{type:Kt,overloads:[[[Kt,Kt],function(t,e){var i=e[1];return e[0].evaluate(t)&&i.evaluate(t)}],[Oi(Kt),function(t,e){for(var i=0,r=e;i<r.length;i+=1)if(!r[i].evaluate(t))return!1;return!0}]]},any:{type:Kt,overloads:[[[Kt,Kt],function(t,e){var i=e[1];return e[0].evaluate(t)||i.evaluate(t)}],[Oi(Kt),function(t,e){for(var i=0,r=e;i<r.length;i+=1)if(r[i].evaluate(t))return!0;return!1}]]},"!":[Kt,[Kt],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[Kt,[Wt],function(t,e){var i=t.globals&&t.globals.isSupportedScript;return!i||i(e[0].evaluate(t))}],upcase:[Wt,[Wt],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[Wt,[Wt],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[Wt,Oi(Jt),function(e,t){return t.map(function(t){return ge(t.evaluate(e))}).join("")}],"resolved-locale":[Wt,[Qt],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var Xi=function(t,e){var i;this.expression=t,this._warningHistory={},this._evaluator=new Ie,this._defaultValue=e?"color"===(i=e).type&&qi(i.default)?new le(0,0,0,0):"color"===i.type?le.parse(i.default)||null:void 0===i.default?null:i.default:null,this._enumValues=e&&"enum"===e.type?e.values:null};function Yi(t){return Array.isArray(t)&&0<t.length&&"string"==typeof t[0]&&t[0]in Mi}function Ji(t,e){var i,r=new We(Mi,[],e?(i={color:Xt,string:Wt,number:Ht,enum:Wt,boolean:Kt,formatted:$t,resolvedImage:te},"array"===e.type?ee(i[e.value]||Jt,e.length):i[e.type]):void 0),n=r.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return n?Ri(new Xi(n,e)):Ni(r.errors)}Xi.prototype.evaluateWithoutErrorHandling=function(t,e,i,r,n,o){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=i,this._evaluator.canonical=r,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)},Xi.prototype.evaluate=function(t,e,i,r,n,o){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=i||null,this._evaluator.canonical=r,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=o||null;try{var a=this.expression.evaluate(this._evaluator);if(null==a||"number"==typeof a&&a!=a)return this._defaultValue;if(this._enumValues&&!(a in this._enumValues))throw new ve("Expected value to be one of "+Object.keys(this._enumValues).map(function(t){return JSON.stringify(t)}).join(", ")+", but found "+JSON.stringify(a)+" instead.");return a}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}};var Qi=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Ge(e.expression)};Qi.prototype.evaluateWithoutErrorHandling=function(t,e,i,r,n,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,r,n,o)},Qi.prototype.evaluate=function(t,e,i,r,n,o){return this._styleExpression.evaluate(t,e,i,r,n,o)};var $i=function(t,e,i,r){this.kind=t,this.zoomStops=i,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Ge(e.expression),this.interpolationType=r};function tr(t,e){if("error"===(t=Ji(t,e)).result)return t;var i=t.value.expression,r=Ve(i);if(!r&&!Bi(e))return Ni([new Vt("","data expressions not supported")]);var n=Ze(i,["zoom"]);if(!n&&!Fi(e))return Ni([new Vt("","zoom expressions not supported")]);var o=function i(t){var r=null;if(t instanceof di)r=i(t.result);else if(t instanceof hi)for(var e=0,n=t.args;e<n.length&&!(r=i(n[e]));e+=1);else(t instanceof Xe||t instanceof ci)&&t.input instanceof Ce&&"zoom"===t.input.name&&(r=t);return r instanceof Vt||t.eachChild(function(t){var e=i(t);e instanceof Vt?r=e:!r&&e?r=new Vt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&e&&r!==e&&(r=new Vt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}(i);return o||n?o instanceof Vt?Ni([o]):o instanceof ci&&!Ui(e)?Ni([new Vt("",'"interpolate" expressions cannot be used with this property')]):Ri(o?new $i(r?"camera":"composite",t.value,o.labels,o instanceof ci?o.interpolation:void 0):new Qi(r?"constant":"source",t.value)):Ni([new Vt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}function er(t,e){this._parameters=t,this._specification=e,Bt(this,function t(r,n){var o,a,s,e="color"===n.type,i=r.stops&&"object"==typeof r.stops[0][0],l=i||!(i||void 0!==r.property),u=r.type||(Ui(n)?"exponential":"interval");if(e&&((r=Bt({},r)).stops&&(r.stops=r.stops.map(function(t){return[t[0],le.parse(t[1])]})),r.default=le.parse(r.default?r.default:n.default)),r.colorSpace&&"rgb"!==r.colorSpace&&!ui[r.colorSpace])throw new Error("Unknown color space: "+r.colorSpace);if("exponential"===u)o=Wi;else if("interval"===u)o=Hi;else if("categorical"===u){o=Zi,a=Object.create(null);for(var c=0,p=r.stops;c<p.length;c+=1){var h=p[c];a[h[0]]=h[1]}s=typeof r.stops[0][0]}else{if("identity"!==u)throw new Error('Unknown function type "'+u+'"');o=Ki}if(i){for(var d={},f=[],m=0;m<r.stops.length;m++){var g=r.stops[m],y=g[0].zoom;void 0===d[y]&&(d[y]={zoom:y,type:r.type,property:r.property,default:r.default,stops:[]},f.push(y)),d[y].stops.push([g[0].value,g[1]])}for(var v=[],_=0,x=f;_<x.length;_+=1){var b=x[_];v.push([d[b].zoom,t(d[b],n)])}var w={name:"linear"};return{kind:"composite",interpolationType:w,interpolationFactor:ci.interpolationFactor.bind(void 0,w),zoomStops:v.map(function(t){return t[0]}),evaluate:function(t,e){var i=t.zoom;return Wi({stops:v,base:r.base},n,i).evaluate(i,e)}}}if(l){var S="exponential"===u?{name:"exponential",base:void 0!==r.base?r.base:1}:null;return{kind:"camera",interpolationType:S,interpolationFactor:ci.interpolationFactor.bind(void 0,S),zoomStops:r.stops.map(function(t){return t[0]}),evaluate:function(t){return o(r,n,t.zoom,a,s)}}}return{kind:"source",evaluate:function(t,e){var i=e&&e.properties?e.properties[r.property]:void 0;return void 0===i?Gi(r.default,n.default):o(r,n,i,a,s)}}}(this._parameters,this._specification))}function ir(t){var e=t.key,i=t.value,r=t.valueSpec||{},n=t.objectElementValidators||{},o=t.style,a=t.styleSpec,s=[],l=ji(i);if("object"!==l)return[new Rt(e,i,"object expected, "+l+" found")];for(var u in i){var c=u.split(".")[0],p=r[c]||r["*"],h=void 0;if(n[c])h=n[c];else if(r[c])h=Cr;else if(n["*"])h=n["*"];else{if(!r["*"]){s.push(new Rt(e,i[u],'unknown property "'+u+'"'));continue}h=Cr}s=s.concat(h({key:(e?e+".":e)+u,value:i[u],valueSpec:p,style:o,styleSpec:a,object:i,objectKey:u},i))}for(var d in r)n[d]||r[d].required&&void 0===r[d].default&&void 0===i[d]&&s.push(new Rt(e,i,'missing required property "'+d+'"'));return s}function rr(t){var e=t.value,i=t.valueSpec,r=t.style,n=t.styleSpec,o=t.key,a=t.arrayElementValidator||Cr;if("array"!==ji(e))return[new Rt(o,e,"array expected, "+ji(e)+" found")];if(i.length&&e.length!==i.length)return[new Rt(o,e,"array length "+i.length+" expected, length "+e.length+" found")];if(i["min-length"]&&e.length<i["min-length"])return[new Rt(o,e,"array length at least "+i["min-length"]+" expected, length "+e.length+" found")];var s={type:i.value,values:i.values};n.$version<7&&(s.function=i.function),"object"===ji(i.value)&&(s=i.value);for(var l=[],u=0;u<e.length;u++)l=l.concat(a({array:e,arrayIndex:u,value:e[u],valueSpec:s,style:r,styleSpec:n,key:o+"["+u+"]"}));return l}function nr(t){var e=t.key,i=t.value,r=t.valueSpec,n=ji(i);return"number"===n&&i!=i&&(n="NaN"),"number"!==n?[new Rt(e,i,"number expected, "+n+" found")]:"minimum"in r&&i<r.minimum?[new Rt(e,i,i+" is less than the minimum value "+r.minimum)]:"maximum"in r&&i>r.maximum?[new Rt(e,i,i+" is greater than the maximum value "+r.maximum)]:[]}function or(t){var a,s,n,l=t.valueSpec,u=Ft(t.value.type),c={},e="categorical"!==u&&void 0===t.value.property,i=!e,o="array"===ji(t.value.stops)&&"array"===ji(t.value.stops[0])&&"object"===ji(t.value.stops[0][0]),r=ir({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===u)return[new Rt(t.key,t.value,'identity function may not have a "stops" property')];var e=[],i=t.value;return e=e.concat(rr({key:t.key,value:i,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:p})),"array"===ji(i)&&0===i.length&&e.push(new Rt(t.key,i,"array must have at least one stop")),e},default:function(t){return Cr({key:t.key,value:t.value,valueSpec:l,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===u&&e&&r.push(new Rt(t.key,t.value,'missing required property "property"')),"identity"===u||t.value.stops||r.push(new Rt(t.key,t.value,'missing required property "stops"')),"exponential"===u&&t.valueSpec.expression&&!Ui(t.valueSpec)&&r.push(new Rt(t.key,t.value,"exponential functions not supported")),8<=t.styleSpec.$version&&(i&&!Bi(t.valueSpec)?r.push(new Rt(t.key,t.value,"property functions not supported")):e&&!Fi(t.valueSpec)&&r.push(new Rt(t.key,t.value,"zoom functions not supported"))),"categorical"!==u&&!o||void 0!==t.value.property||r.push(new Rt(t.key,t.value,'"property" property is required')),r;function p(t){var e=[],i=t.value,r=t.key;if("array"!==ji(i))return[new Rt(r,i,"array expected, "+ji(i)+" found")];if(2!==i.length)return[new Rt(r,i,"array length 2 expected, length "+i.length+" found")];if(o){if("object"!==ji(i[0]))return[new Rt(r,i,"object expected, "+ji(i[0])+" found")];if(void 0===i[0].zoom)return[new Rt(r,i,"object stop key must have zoom")];if(void 0===i[0].value)return[new Rt(r,i,"object stop key must have value")];if(n&&n>Ft(i[0].zoom))return[new Rt(r,i[0].zoom,"stop zoom values must appear in ascending order")];Ft(i[0].zoom)!==n&&(n=Ft(i[0].zoom),s=void 0,c={}),e=e.concat(ir({key:r+"[0]",value:i[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:nr,value:h}}))}else e=e.concat(h({key:r+"[0]",value:i[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},i));return Yi(Ut(i[1]))?e.concat([new Rt(r+"[1]",i[1],"expressions are not allowed in function stops.")]):e.concat(Cr({key:r+"[1]",value:i[1],valueSpec:l,style:t.style,styleSpec:t.styleSpec}))}function h(t,e){var i=ji(t.value),r=Ft(t.value),n=null!==t.value?t.value:e;if(a){if(i!==a)return[new Rt(t.key,n,i+" stop domain type must match previous stop domain type "+a)]}else a=i;if("number"!==i&&"string"!==i&&"boolean"!==i)return[new Rt(t.key,n,"stop domain value must be a number, string, or boolean")];if("number"===i||"categorical"===u)return"categorical"!==u||"number"!==i||isFinite(r)&&Math.floor(r)===r?"categorical"!==u&&"number"===i&&void 0!==s&&r<s?[new Rt(t.key,n,"stop domain values must appear in ascending order")]:(s=r,"categorical"===u&&r in c?[new Rt(t.key,n,"stop domain values must be unique")]:(c[r]=!0,[])):[new Rt(t.key,n,"integer expected, found "+r)];var o="number expected, "+i+" found";return Bi(l)&&void 0===u&&(o+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Rt(t.key,n,o)]}}function ar(e){var t=("property"===e.expressionContext?tr:Ji)(Ut(e.value),e.valueSpec);if("error"===t.result)return t.value.map(function(t){return new Rt(""+e.key+t.key,e.value,t.message)});var i=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!i.outputDefined())return[new Rt(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===e.expressionContext&&"layout"===e.propertyType&&!Ge(i))return[new Rt(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!Ge(i))return[new Rt(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!Ze(i,["zoom","feature-state"]))return[new Rt(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!Ve(i))return[new Rt(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function sr(t){var e=t.key,i=t.value,r=t.valueSpec,n=[];return Array.isArray(r.values)?-1===r.values.indexOf(Ft(i))&&n.push(new Rt(e,i,"expected one of ["+r.values.join(", ")+"], "+JSON.stringify(i)+" found")):-1===Object.keys(r.values).indexOf(Ft(i))&&n.push(new Rt(e,i,"expected one of ["+Object.keys(r.values).join(", ")+"], "+JSON.stringify(i)+" found")),n}function lr(t){if(!0===t||!1===t)return 1;if(Array.isArray(t)&&0!==t.length)switch(t[0]){case"has":return 2<=t.length&&"$id"!==t[1]&&"$type"!==t[1];case"in":return 3<=t.length&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var e=0,i=t.slice(1);e<i.length;e+=1){var r=i[e];if(!lr(r)&&"boolean"!=typeof r)return}return 1;default:return 1}}$i.prototype.evaluateWithoutErrorHandling=function(t,e,i,r,n,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,r,n,o)},$i.prototype.evaluate=function(t,e,i,r,n,o){return this._styleExpression.evaluate(t,e,i,r,n,o)},$i.prototype.interpolationFactor=function(t,e,i){return this.interpolationType?ci.interpolationFactor(this.interpolationType,t,e,i):0},er.deserialize=function(t){return new er(t._parameters,t._specification)};var ur={type:"boolean",default:!(er.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}}),transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function cr(t){if(null==t)return{filter:function(){return!0},needGeometry:!1};lr(t)||(t=hr(t));var r=Ji(t,ur);if("error"===r.result)throw new Error(r.value.map(function(t){return t.key+": "+t.message}).join(", "));return{filter:function(t,e,i){return r.value.evaluate(t,e,{},i)},needGeometry:function t(e){if(!Array.isArray(e))return!1;if("within"===e[0])return!0;for(var i=1;i<e.length;i++)if(t(e[i]))return!0;return!1}(t)}}function pr(t,e){return t<e?-1:e<t?1:0}function hr(t){if(!t)return!0;var e,i=t[0];return t.length<=1?"any"!==i:"=="===i?dr(t[1],t[2],"=="):"!="===i?gr(dr(t[1],t[2],"==")):"<"===i||">"===i||"<="===i||">="===i?dr(t[1],t[2],i):"any"===i?(e=t.slice(1),["any"].concat(e.map(hr))):"all"===i?["all"].concat(t.slice(1).map(hr)):"none"===i?["all"].concat(t.slice(1).map(hr).map(gr)):"in"===i?fr(t[1],t.slice(2)):"!in"===i?gr(fr(t[1],t.slice(2))):"has"===i?mr(t[1]):"!has"===i?gr(mr(t[1])):"within"!==i||t}function dr(t,e,i){switch(t){case"$type":return["filter-type-"+i,e];case"$id":return["filter-id-"+i,e];default:return["filter-"+i,t,e]}}function fr(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return 200<e.length&&!e.some(function(t){return typeof t!=typeof e[0]})?["filter-in-large",t,["literal",e.sort(pr)]]:["filter-in-small",t,["literal",e]]}}function mr(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function gr(t){return["!",t]}function yr(t){return lr(Ut(t.value))?ar(Bt({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(e){var i=e.value,r=e.key;if("array"!==ji(i))return[new Rt(r,i,"array expected, "+ji(i)+" found")];var n,o=e.styleSpec,a=[];if(i.length<1)return[new Rt(r,i,"filter array must have at least 1 element")];switch(a=a.concat(sr({key:r+"[0]",value:i[0],valueSpec:o.filter_operator,style:e.style,styleSpec:e.styleSpec})),Ft(i[0])){case"<":case"<=":case">":case">=":2<=i.length&&"$type"===Ft(i[1])&&a.push(new Rt(r,i,'"$type" cannot be use with operator "'+i[0]+'"'));case"==":case"!=":3!==i.length&&a.push(new Rt(r,i,'filter array for operator "'+i[0]+'" must have 3 elements'));case"in":case"!in":2<=i.length&&"string"!==(n=ji(i[1]))&&a.push(new Rt(r+"[1]",i[1],"string expected, "+n+" found"));for(var s=2;s<i.length;s++)n=ji(i[s]),"$type"===Ft(i[1])?a=a.concat(sr({key:r+"["+s+"]",value:i[s],valueSpec:o.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==n&&"number"!==n&&"boolean"!==n&&a.push(new Rt(r+"["+s+"]",i[s],"string, number, or boolean expected, "+n+" found"));break;case"any":case"all":case"none":for(var l=1;l<i.length;l++)a=a.concat(t({key:r+"["+l+"]",value:i[l],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":n=ji(i[1]),2!==i.length?a.push(new Rt(r,i,'filter array for "'+i[0]+'" operator must have 2 elements')):"string"!==n&&a.push(new Rt(r+"[1]",i[1],"string expected, "+n+" found"));break;case"within":n=ji(i[1]),2!==i.length?a.push(new Rt(r,i,'filter array for "'+i[0]+'" operator must have 2 elements')):"object"!==n&&a.push(new Rt(r+"[1]",i[1],"object expected, "+n+" found"))}return a}(t)}function vr(t,e){var i=t.key,r=t.style,n=t.styleSpec,o=t.value,a=t.objectKey,s=n[e+"_"+t.layerType];if(!s)return[];var l=a.match(/^(.*)-transition$/);if("paint"===e&&l&&s[l[1]]&&s[l[1]].transition)return Cr({key:i,value:o,valueSpec:n.transition,style:r,styleSpec:n});var u,c=t.valueSpec||s[a];if(!c)return[new Rt(i,o,'unknown property "'+a+'"')];if("string"===ji(o)&&Bi(c)&&!c.tokens&&(u=/^{([^}]+)}$/.exec(o)))return[new Rt(i,o,'"'+a+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(u[1])+" }`.")];var p=[];return"symbol"===t.layerType&&("text-field"===a&&r&&!r.glyphs&&p.push(new Rt(i,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&qi(Ut(o))&&"identity"===Ft(o.type)&&p.push(new Rt(i,o,'"text-font" does not support identity functions'))),p.concat(Cr({key:t.key,value:o,valueSpec:c,style:r,styleSpec:n,expressionContext:"property",propertyType:e,propertyKey:a}))}function _r(t){return vr(t,"paint")}function xr(t){return vr(t,"layout")}function br(t){var e=[],i=t.value,r=t.key,n=t.style,o=t.styleSpec;i.type||i.ref||e.push(new Rt(r,i,'either "type" or "ref" is required'));var a,s=Ft(i.type),l=Ft(i.ref);if(i.id)for(var u=Ft(i.id),c=0;c<t.arrayIndex;c++){var p=n.layers[c];Ft(p.id)===u&&e.push(new Rt(r,i.id,'duplicate layer id "'+i.id+'", previously used at line '+p.id.__line__))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach(function(t){t in i&&e.push(new Rt(r,i[t],'"'+t+'" is prohibited for ref layers'))}),n.layers.forEach(function(t){Ft(t.id)===l&&(a=t)}),a?a.ref?e.push(new Rt(r,i.ref,"ref cannot reference another ref layer")):s=Ft(a.type):e.push(new Rt(r,i.ref,'ref layer "'+l+'" not found'));else if("background"!==s)if(i.source){var h=n.sources&&n.sources[i.source],d=h&&Ft(h.type);h?"vector"===d&&"raster"===s?e.push(new Rt(r,i.source,'layer "'+i.id+'" requires a raster source')):"raster"===d&&"raster"!==s?e.push(new Rt(r,i.source,'layer "'+i.id+'" requires a vector source')):"vector"!==d||i["source-layer"]?"raster-dem"===d&&"hillshade"!==s?e.push(new Rt(r,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!i.paint||!i.paint["line-gradient"]||"geojson"===d&&h.lineMetrics||e.push(new Rt(r,i,'layer "'+i.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new Rt(r,i,'layer "'+i.id+'" must specify a "source-layer"')):e.push(new Rt(r,i.source,'source "'+i.source+'" not found'))}else e.push(new Rt(r,i,'missing required property "source"'));return e=e.concat(ir({key:r,value:i,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Cr({key:r+".type",value:i.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,object:i,objectKey:"type"})},filter:yr,layout:function(t){return ir({layer:i,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return xr(Bt({layerType:s},t))}}})},paint:function(t){return ir({layer:i,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return _r(Bt({layerType:s},t))}}})}}}))}function wr(t){var e=t.value,i=t.key,r=ji(e);return"string"!==r?[new Rt(i,e,"string expected, "+r+" found")]:[]}var Sr={promoteId:function(t){var e=t.key,i=t.value;if("string"===ji(i))return wr({key:e,value:i});var r=[];for(var n in i)r.push.apply(r,wr({key:e+"."+n,value:i[n]}));return r}};function Tr(t){var e=t.value,i=t.key,r=t.styleSpec,n=t.style;if(!e.type)return[new Rt(i,e,'"type" is required')];var o,a=Ft(e.type);switch(a){case"vector":case"raster":case"raster-dem":return ir({key:i,value:e,valueSpec:r["source_"+a.replace("-","_")],style:t.style,styleSpec:r,objectElementValidators:Sr});case"geojson":if(o=ir({key:i,value:e,valueSpec:r.source_geojson,style:n,styleSpec:r,objectElementValidators:Sr}),e.cluster)for(var s in e.clusterProperties){var l=e.clusterProperties[s],u=l[0],c="string"==typeof u?[u,["accumulated"],["get",s]]:u;o.push.apply(o,ar({key:i+"."+s+".map",value:l[1],expressionContext:"cluster-map"})),o.push.apply(o,ar({key:i+"."+s+".reduce",value:c,expressionContext:"cluster-reduce"}))}return o;case"video":return ir({key:i,value:e,valueSpec:r.source_video,style:n,styleSpec:r});case"image":return ir({key:i,value:e,valueSpec:r.source_image,style:n,styleSpec:r});case"canvas":return[new Rt(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return sr({key:i+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:n,styleSpec:r})}}function Ir(t){var e=t.value,i=t.styleSpec,r=i.light,n=t.style,o=[],a=ji(e);if(void 0===e)return o;if("object"!==a)return o.concat([new Rt("light",e,"object expected, "+a+" found")]);for(var s in e){var l=s.match(/^(.*)-transition$/);o=o.concat(l&&r[l[1]]&&r[l[1]].transition?Cr({key:s,value:e[s],valueSpec:i.transition,style:n,styleSpec:i}):r[s]?Cr({key:s,value:e[s],valueSpec:r[s],style:n,styleSpec:i}):[new Rt(s,e[s],'unknown property "'+s+'"')])}return o}var Er={"*":function(){return[]},array:rr,boolean:function(t){var e=t.value,i=t.key,r=ji(e);return"boolean"!==r?[new Rt(i,e,"boolean expected, "+r+" found")]:[]},number:nr,color:function(t){var e=t.key,i=t.value,r=ji(i);return"string"!==r?[new Rt(e,i,"color expected, "+r+" found")]:null===se(i)?[new Rt(e,i,'color expected, "'+i+'" found')]:[]},constants:Nt,enum:sr,filter:yr,function:or,layer:br,object:ir,source:Tr,light:Ir,string:wr,formatted:function(t){return 0===wr(t).length?[]:ar(t)},resolvedImage:function(t){return 0===wr(t).length?[]:ar(t)}};function Cr(t){var e=t.value,i=t.valueSpec,r=t.styleSpec;return i.expression&&qi(Ft(e))?or(t):i.expression&&Yi(Ut(e))?ar(t):i.type&&Er[i.type]?Er[i.type](t):ir(Bt({},t,{valueSpec:i.type?r[i.type]:i}))}function Ar(t){var e=t.value,i=t.key,r=wr(t);return r.length||(-1===e.indexOf("{fontstack}")&&r.push(new Rt(i,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&r.push(new Rt(i,e,'"glyphs" url must include a "{range}" token'))),r}function kr(t,e){void 0===e&&(e=Ot);var i=[];return i=i.concat(Cr({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:Ar,"*":function(){return[]}}})),t.constants&&(i=i.concat(Nt({key:"constants",value:t.constants,style:t,styleSpec:e}))),Pr(i)}function Pr(t){return[].concat(t).sort(function(t,e){return t.line-e.line})}function Mr(i){return function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return Pr(i.apply(this,t))}}kr.source=Mr(Tr),kr.light=Mr(Ir),kr.layer=Mr(br),kr.filter=Mr(yr),kr.paintProperty=Mr(_r),kr.layoutProperty=Mr(xr);var Lr=kr,Dr=Lr.light,zr=Lr.paintProperty,Or=Lr.layoutProperty;function Rr(t,e){var i=!1;if(e&&e.length)for(var r=0,n=e;r<n.length;r+=1)t.fire(new Dt(new Error(n[r].message))),i=!0;return i}var Nr=Br;function Br(t,e,i){var r=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var n=new Int32Array(this.arrayBuffer);t=n[0],this.d=(e=n[1])+2*(i=n[2]);for(var o=0;o<this.d*this.d;o++){var a=n[3+o],s=n[3+o+1];r.push(a===s?null:n.subarray(a,s))}var l=n[3+r.length+1];this.keys=n.subarray(n[3+r.length],l),this.bboxes=n.subarray(l),this.insert=this._insertReadonly}else{this.d=e+2*i;for(var u=0;u<this.d*this.d;u++)r.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=i,this.scale=e/t,this.uid=0;var c=i/e*t;this.min=-c,this.max=t+c}Br.prototype.insert=function(t,e,i,r,n){this._forEachCell(e,i,r,n,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(r),this.bboxes.push(n)},Br.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Br.prototype._insertCell=function(t,e,i,r,n,o){this.cells[n].push(o)},Br.prototype.query=function(t,e,i,r,n){var o=this.min,a=this.max;if(t<=o&&e<=o&&a<=i&&a<=r&&!n)return Array.prototype.slice.call(this.keys);var s=[];return this._forEachCell(t,e,i,r,this._queryCell,s,{},n),s},Br.prototype._queryCell=function(t,e,i,r,n,o,a,s){var l=this.cells[n];if(null!==l)for(var u=this.keys,c=this.bboxes,p=0;p<l.length;p++){var h=l[p];if(void 0===a[h]){var d=4*h;(s?s(c[0+d],c[1+d],c[2+d],c[3+d]):t<=c[2+d]&&e<=c[3+d]&&i>=c[0+d]&&r>=c[1+d])?(a[h]=!0,o.push(u[h])):a[h]=!1}}},Br.prototype._forEachCell=function(t,e,i,r,n,o,a,s){for(var l=this._convertToCellCoord(t),u=this._convertToCellCoord(e),c=this._convertToCellCoord(i),p=this._convertToCellCoord(r),h=l;h<=c;h++)for(var d=u;d<=p;d++){var f=this.d*d+h;if((!s||s(this._convertFromCellCoord(h),this._convertFromCellCoord(d),this._convertFromCellCoord(h+1),this._convertFromCellCoord(d+1)))&&n.call(this,t,e,i,r,f,o,a,s))return}},Br.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Br.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Br.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,i=0,r=0;r<this.cells.length;r++)i+=this.cells[r].length;var n=new Int32Array(e+i+this.keys.length+this.bboxes.length);n[0]=this.extent,n[1]=this.n,n[2]=this.padding;for(var o=e,a=0;a<t.length;a++){var s=t[a];n[3+a]=o,n.set(s,o),o+=s.length}return n[3+t.length]=o,n.set(this.keys,o),n[3+t.length+1]=o+=this.keys.length,n.set(this.bboxes,o),o+=this.bboxes.length,n.buffer};var Fr=p.ImageData,Ur=p.ImageBitmap,jr={};function qr(t,e,i){void 0===i&&(i={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),jr[t]={klass:e,omit:i.omit||[],shallow:i.shallow||[]}}for(var Vr in qr("Object",Object),Nr.serialize=function(t,e){var i=t.toArrayBuffer();return e&&e.push(i),{buffer:i}},Nr.deserialize=function(t){return new Nr(t.buffer)},qr("Grid",Nr),qr("Color",le),qr("Error",Error),qr("ResolvedImage",he),qr("StylePropertyFunction",er),qr("StyleExpression",Xi,{omit:["_evaluator"]}),qr("ZoomDependentExpression",$i),qr("ZoomConstantExpression",Qi),qr("CompoundExpression",Ce,{omit:["_evaluate"]}),Mi)Mi[Vr]._classRegistryKey||qr("Expression_"+Vr,Mi[Vr]);function Gr(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function Zr(t){return Ur&&t instanceof Ur}function Hr(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Gr(t)||Zr(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var i=t;return e&&e.push(i.buffer),i}if(t instanceof Fr)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var r=[],n=0,o=t;n<o.length;n+=1)r.push(Hr(o[n],e));return r}if("object"!=typeof t)throw new Error("can't serialize object of type "+typeof t);var a=t.constructor,s=a._classRegistryKey;if(!s)throw new Error("can't serialize object of unregistered class");var l=a.serialize?a.serialize(t,e):{};if(!a.serialize){for(var u in t)if(t.hasOwnProperty(u)&&!(0<=jr[s].omit.indexOf(u))){var c=t[u];l[u]=0<=jr[s].shallow.indexOf(u)?c:Hr(c,e)}t instanceof Error&&(l.message=t.message)}if(l.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==s&&(l.$name=s),l}function Wr(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Gr(t)||Zr(t)||ArrayBuffer.isView(t)||t instanceof Fr)return t;if(Array.isArray(t))return t.map(Wr);if("object"!=typeof t)throw new Error("can't deserialize object of type "+typeof t);var e=t.$name||"Object",i=jr[e].klass;if(!i)throw new Error("can't deserialize unregistered class "+e);if(i.deserialize)return i.deserialize(t);for(var r=Object.create(i.prototype),n=0,o=Object.keys(t);n<o.length;n+=1){var a=o[n];if("$name"!==a){var s=t[a];r[a]=0<=jr[e].shallow.indexOf(a)?s:Wr(s)}}return r}function Kr(){this.first=!0}Kr.prototype.update=function(t,e){var i=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=i,!0))};var Xr={"Latin-1 Supplement":function(t){return 128<=t&&t<=255},Arabic:function(t){return 1536<=t&&t<=1791},"Arabic Supplement":function(t){return 1872<=t&&t<=1919},"Arabic Extended-A":function(t){return 2208<=t&&t<=2303},"Hangul Jamo":function(t){return 4352<=t&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return 5120<=t&&t<=5759},Khmer:function(t){return 6016<=t&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return 6320<=t&&t<=6399},"General Punctuation":function(t){return 8192<=t&&t<=8303},"Letterlike Symbols":function(t){return 8448<=t&&t<=8527},"Number Forms":function(t){return 8528<=t&&t<=8591},"Miscellaneous Technical":function(t){return 8960<=t&&t<=9215},"Control Pictures":function(t){return 9216<=t&&t<=9279},"Optical Character Recognition":function(t){return 9280<=t&&t<=9311},"Enclosed Alphanumerics":function(t){return 9312<=t&&t<=9471},"Geometric Shapes":function(t){return 9632<=t&&t<=9727},"Miscellaneous Symbols":function(t){return 9728<=t&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return 11008<=t&&t<=11263},"CJK Radicals Supplement":function(t){return 11904<=t&&t<=12031},"Kangxi Radicals":function(t){return 12032<=t&&t<=12255},"Ideographic Description Characters":function(t){return 12272<=t&&t<=12287},"CJK Symbols and Punctuation":function(t){return 12288<=t&&t<=12351},Hiragana:function(t){return 12352<=t&&t<=12447},Katakana:function(t){return 12448<=t&&t<=12543},Bopomofo:function(t){return 12544<=t&&t<=12591},"Hangul Compatibility Jamo":function(t){return 12592<=t&&t<=12687},Kanbun:function(t){return 12688<=t&&t<=12703},"Bopomofo Extended":function(t){return 12704<=t&&t<=12735},"CJK Strokes":function(t){return 12736<=t&&t<=12783},"Katakana Phonetic Extensions":function(t){return 12784<=t&&t<=12799},"Enclosed CJK Letters and Months":function(t){return 12800<=t&&t<=13055},"CJK Compatibility":function(t){return 13056<=t&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return 13312<=t&&t<=19903},"Yijing Hexagram Symbols":function(t){return 19904<=t&&t<=19967},"CJK Unified Ideographs":function(t){return 19968<=t&&t<=40959},"Yi Syllables":function(t){return 40960<=t&&t<=42127},"Yi Radicals":function(t){return 42128<=t&&t<=42191},"Hangul Jamo Extended-A":function(t){return 43360<=t&&t<=43391},"Hangul Syllables":function(t){return 44032<=t&&t<=55215},"Hangul Jamo Extended-B":function(t){return 55216<=t&&t<=55295},"Private Use Area":function(t){return 57344<=t&&t<=63743},"CJK Compatibility Ideographs":function(t){return 63744<=t&&t<=64255},"Arabic Presentation Forms-A":function(t){return 64336<=t&&t<=65023},"Vertical Forms":function(t){return 65040<=t&&t<=65055},"CJK Compatibility Forms":function(t){return 65072<=t&&t<=65103},"Small Form Variants":function(t){return 65104<=t&&t<=65135},"Arabic Presentation Forms-B":function(t){return 65136<=t&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return 65280<=t&&t<=65519}};function Yr(t){for(var e=0,i=t;e<i.length;e+=1)if(Jr(i[e].charCodeAt(0)))return!0;return!1}function Jr(t){return 746===t||747===t||!(t<4352)&&(Xr["Bopomofo Extended"](t)||Xr.Bopomofo(t)||Xr["CJK Compatibility Forms"](t)&&!(65097<=t&&t<=65103)||Xr["CJK Compatibility Ideographs"](t)||Xr["CJK Compatibility"](t)||Xr["CJK Radicals Supplement"](t)||Xr["CJK Strokes"](t)||!(!Xr["CJK Symbols and Punctuation"](t)||12296<=t&&t<=12305||12308<=t&&t<=12319||12336===t)||Xr["CJK Unified Ideographs Extension A"](t)||Xr["CJK Unified Ideographs"](t)||Xr["Enclosed CJK Letters and Months"](t)||Xr["Hangul Compatibility Jamo"](t)||Xr["Hangul Jamo Extended-A"](t)||Xr["Hangul Jamo Extended-B"](t)||Xr["Hangul Jamo"](t)||Xr["Hangul Syllables"](t)||Xr.Hiragana(t)||Xr["Ideographic Description Characters"](t)||Xr.Kanbun(t)||Xr["Kangxi Radicals"](t)||Xr["Katakana Phonetic Extensions"](t)||Xr.Katakana(t)&&12540!==t||!(!Xr["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||65306<=t&&t<=65310||65339===t||65341===t||65343===t||65371<=t&&t<=65503||65507===t||65512<=t&&t<=65519)||!(!Xr["Small Form Variants"](t)||65112<=t&&t<=65118||65123<=t&&t<=65126)||Xr["Unified Canadian Aboriginal Syllabics"](t)||Xr["Unified Canadian Aboriginal Syllabics Extended"](t)||Xr["Vertical Forms"](t)||Xr["Yijing Hexagram Symbols"](t)||Xr["Yi Syllables"](t)||Xr["Yi Radicals"](t))}function Qr(t){return!(Jr(t)||(e=t,Xr["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||Xr["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||Xr["Letterlike Symbols"](e)||Xr["Number Forms"](e)||Xr["Miscellaneous Technical"](e)&&(8960<=e&&e<=8967||8972<=e&&e<=8991||8996<=e&&e<=9e3||9003===e||9085<=e&&e<=9114||9150<=e&&e<=9165||9167===e||9169<=e&&e<=9179||9186<=e&&e<=9215)||Xr["Control Pictures"](e)&&9251!==e||Xr["Optical Character Recognition"](e)||Xr["Enclosed Alphanumerics"](e)||Xr["Geometric Shapes"](e)||Xr["Miscellaneous Symbols"](e)&&!(9754<=e&&e<=9759)||Xr["Miscellaneous Symbols and Arrows"](e)&&(11026<=e&&e<=11055||11088<=e&&e<=11097||11192<=e&&e<=11243)||Xr["CJK Symbols and Punctuation"](e)||Xr.Katakana(e)||Xr["Private Use Area"](e)||Xr["CJK Compatibility Forms"](e)||Xr["Small Form Variants"](e)||Xr["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||9984<=e&&e<=10087||10102<=e&&e<=10131||65532===e||65533===e));var e}function $r(t){return 1424<=t&&t<=2303||Xr["Arabic Presentation Forms-A"](t)||Xr["Arabic Presentation Forms-B"](t)}function tn(t){for(var e=0,i=t;e<i.length;e+=1)if($r(i[e].charCodeAt(0)))return 1}function en(t){t&&"string"==typeof t&&-1<t.indexOf("NetworkError")&&(nn="error"),rn&&rn(t)}var rn=null,nn="unavailable",on=null;function an(){cn.fire(new Pt("pluginStateChange",{pluginStatus:nn,pluginURL:on}))}function sn(){return nn}function ln(){if("deferred"!==nn||!on)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");nn="loading",an(),on&&St({url:on},function(t){t?en(t):(nn="loaded",an())})}function un(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Kr,this.transition={})}var cn=new Mt,pn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===nn||null!=pn.applyArabicShaping},isLoading:function(){return"loading"===nn},setState:function(t){nn=t.pluginStatus,on=t.pluginURL},isParsed:function(){return null!=pn.applyArabicShaping&&null!=pn.processBidirectionalText&&null!=pn.processStyledBidirectionalText},getPluginURL:function(){return on}};function hn(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(qi(t))return new er(t,e);if(Yi(t)){var i=tr(t,e);if("error"===i.result)throw new Error(i.value.map(function(t){return t.key+": "+t.message}).join(", "));return i.value}var r=t;return"string"==typeof t&&"color"===e.type&&(r=le.parse(t)),{kind:"constant",evaluate:function(){return r}}}(void 0===e?t.specification.default:e,t.specification)}function dn(t){this.property=t,this.value=new hn(t,void 0)}function fn(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}un.prototype.isSupportedScript=function(t){return function(t,e){for(var i=0,r=t;i<r.length;i+=1)if(n=r[i].charCodeAt(0),!e&&$r(n)||2304<=n&&n<=3583||3840<=n&&n<=4255||Xr.Khmer(n))return!1;var n;return!0}(t,pn.isLoaded())},un.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},un.prototype.getCrossfadeParameters=function(){var t=this.zoom,e=t-Math.floor(t),i=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*e}},hn.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},hn.prototype.possiblyEvaluate=function(t,e,i){return this.property.possiblyEvaluate(this,t,e,i)},dn.prototype.transitioned=function(t,e){return new mn(this.property,this.value,e,d({},t.transition,this.transition),t.now)},dn.prototype.untransitioned=function(){return new mn(this.property,this.value,null,{},0)},fn.prototype.getValue=function(t){return _(this._values[t].value.value)},fn.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new dn(this._values[t].property)),this._values[t].value=new hn(this._values[t].property,null===e?void 0:_(e))},fn.prototype.getTransition=function(t){return _(this._values[t].transition)},fn.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new dn(this._values[t].property)),this._values[t].transition=_(e)||void 0},fn.prototype.serialize=function(){for(var t={},e=0,i=Object.keys(this._values);e<i.length;e+=1){var r=i[e],n=this.getValue(r);void 0!==n&&(t[r]=n);var o=this.getTransition(r);void 0!==o&&(t[r+"-transition"]=o)}return t},fn.prototype.transitioned=function(t,e){for(var i=new gn(this._properties),r=0,n=Object.keys(this._values);r<n.length;r+=1){var o=n[r];i._values[o]=this._values[o].transitioned(t,e._values[o])}return i},fn.prototype.untransitioned=function(){for(var t=new gn(this._properties),e=0,i=Object.keys(this._values);e<i.length;e+=1){var r=i[e];t._values[r]=this._values[r].untransitioned()}return t};var mn=function(t,e,i,r,n){this.property=t,this.value=e,this.begin=n+r.delay||0,this.end=this.begin+r.duration||0,t.specification.transition&&(r.delay||r.duration)&&(this.prior=i)};mn.prototype.possiblyEvaluate=function(t,e,i){var r=t.now||0,n=this.value.possiblyEvaluate(t,e,i),o=this.prior;if(o){if(r>this.end)return this.prior=null,n;if(this.value.isDataDriven())return this.prior=null,n;if(r<this.begin)return o.possiblyEvaluate(t,e,i);var a=(r-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(t,e,i),n,function(){if(a<=0)return 0;if(1<=a)return 1;var t=a*a,e=t*a;return 4*(a<.5?e:3*(a-t)+e-.75)}())}return n};var gn=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};function yn(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}function vn(t,e,i){this.property=t,this.value=e,this.parameters=i}gn.prototype.possiblyEvaluate=function(t,e,i){for(var r=new _n(this._properties),n=0,o=Object.keys(this._values);n<o.length;n+=1){var a=o[n];r._values[a]=this._values[a].possiblyEvaluate(t,e,i)}return r},gn.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1)if(this._values[e[t]].prior)return!0;return!1},yn.prototype.getValue=function(t){return _(this._values[t].value)},yn.prototype.setValue=function(t,e){this._values[t]=new hn(this._values[t].property,null===e?void 0:_(e))},yn.prototype.serialize=function(){for(var t={},e=0,i=Object.keys(this._values);e<i.length;e+=1){var r=i[e],n=this.getValue(r);void 0!==n&&(t[r]=n)}return t},yn.prototype.possiblyEvaluate=function(t,e,i){for(var r=new _n(this._properties),n=0,o=Object.keys(this._values);n<o.length;n+=1){var a=o[n];r._values[a]=this._values[a].possiblyEvaluate(t,e,i)}return r},vn.prototype.isConstant=function(){return"constant"===this.value.kind},vn.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},vn.prototype.evaluate=function(t,e,i,r){return this.property.evaluate(this.value,this.parameters,t,e,i,r)};var _n=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};function xn(t){this.specification=t}function bn(t,e){this.specification=t,this.overrides=e}function wn(t){this.specification=t}_n.prototype.get=function(t){return this._values[t]},xn.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},xn.prototype.interpolate=function(t,e,i){var r=Je[this.specification.type];return r?r(t,e,i):t},bn.prototype.possiblyEvaluate=function(t,e,i,r){return new vn(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},i,r)}:t.expression,e)},bn.prototype.interpolate=function(t,e,i){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new vn(this,{kind:"constant",value:void 0},t.parameters);var r=Je[this.specification.type];return r?new vn(this,{kind:"constant",value:r(t.value.value,e.value.value,i)},t.parameters):t},bn.prototype.evaluate=function(t,e,i,r,n,o){return"constant"===t.kind?t.value:t.evaluate(e,i,r,n,o)};var Sn,Tn=(In.__proto__=Sn=bn,((In.prototype=Object.create(Sn&&Sn.prototype)).constructor=In).prototype.possiblyEvaluate=function(t,e,i,r){if(void 0===t.value)return new vn(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){var n=t.expression.evaluate(e,null,{},i,r),o="resolvedImage"===t.property.specification.type&&"string"!=typeof n?n.name:n,a=this._calculate(o,o,o,e);return new vn(this,{kind:"constant",value:a},e)}if("camera"!==t.expression.kind)return new vn(this,t.expression,e);var s=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new vn(this,{kind:"constant",value:s},e)},In.prototype.evaluate=function(t,e,i,r,n,o){if("source"!==t.kind)return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},i,r),t.evaluate({zoom:Math.floor(e.zoom)},i,r),t.evaluate({zoom:Math.floor(e.zoom)+1},i,r),e):t.value;var a=t.evaluate(e,i,r,n,o);return this._calculate(a,a,a,e)},In.prototype._calculate=function(t,e,i,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:i,to:e}},In.prototype.interpolate=function(t){return t},In);function In(){Sn.apply(this,arguments)}function En(t){this.specification=t}function Cn(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var i=t[e];i.specification.overridable&&this.overridableProperties.push(e);var r=this.defaultPropertyValues[e]=new hn(i,void 0),n=this.defaultTransitionablePropertyValues[e]=new dn(i);this.defaultTransitioningPropertyValues[e]=n.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=r.possiblyEvaluate({})}}function An(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}function kn(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}wn.prototype.possiblyEvaluate=function(t,e,i,r){if(void 0!==t.value){if("constant"!==t.expression.kind)return this._calculate(t.expression.evaluate(new un(Math.floor(e.zoom-1),e)),t.expression.evaluate(new un(Math.floor(e.zoom),e)),t.expression.evaluate(new un(Math.floor(e.zoom+1),e)),e);var n=t.expression.evaluate(e,null,{},i,r);return this._calculate(n,n,n,e)}},wn.prototype._calculate=function(t,e,i,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:i,to:e}},wn.prototype.interpolate=function(t){return t},En.prototype.possiblyEvaluate=function(t,e,i,r){return!!t.expression.evaluate(e,null,{},i,r)},En.prototype.interpolate=function(){return!1},qr("DataDrivenProperty",bn),qr("DataConstantProperty",xn),qr("CrossFadedDataDrivenProperty",Tn),qr("CrossFadedProperty",wn),qr("ColorRampProperty",En);var Pn,Mn=(Dn.__proto__=Pn=Mt,((Dn.prototype=Object.create(Pn&&Pn.prototype)).constructor=Dn).prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},Dn.prototype.getLayoutProperty=function(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)},Dn.prototype.setLayoutProperty=function(t,e,i){void 0===i&&(i={}),null!=e&&this._validate(Or,"layers."+this.id+".layout."+t,t,e,i)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e)},Dn.prototype.getPaintProperty=function(t){return g(t,"-transition")?this._transitionablePaint.getTransition(t.slice(0,-"-transition".length)):this._transitionablePaint.getValue(t)},Dn.prototype.setPaintProperty=function(t,e,i){if(void 0===i&&(i={}),null!=e&&this._validate(zr,"layers."+this.id+".paint."+t,t,e,i))return!1;if(g(t,"-transition"))return this._transitionablePaint.setTransition(t.slice(0,-"-transition".length),e||void 0),!1;var r=this._transitionablePaint._values[t],n="cross-faded-data-driven"===r.property.specification["property-type"],o=r.value.isDataDriven(),a=r.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);var s=this._transitionablePaint._values[t].value;return s.isDataDriven()||o||n||this._handleOverridablePaintPropertyUpdate(t,a,s)},Dn.prototype._handleSpecialPaintPropertyUpdate=function(t){},Dn.prototype._handleOverridablePaintPropertyUpdate=function(t,e,i){return!1},Dn.prototype.isHidden=function(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility},Dn.prototype.updateTransitions=function(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)},Dn.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},Dn.prototype.recalculate=function(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)},Dn.prototype.serialize=function(){var t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),v(t,function(t,e){return!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)})},Dn.prototype._validate=function(t,e,i,r,n){return void 0===n&&(n={}),(!n||!1!==n.validate)&&Rr(this,t.call(Lr,{key:e,layerType:this.type,objectKey:i,value:r,styleSpec:Ot,style:{glyphs:!0,sprite:!0}}))},Dn.prototype.is3D=function(){return!1},Dn.prototype.isTileClipped=function(){return!1},Dn.prototype.hasOffscreenPass=function(){return!1},Dn.prototype.resize=function(){},Dn.prototype.isStateDependent=function(){for(var t in this.paint._values){var e=this.paint.get(t);if(e instanceof vn&&Bi(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1},Dn),Ln={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};function Dn(t,e){if(Pn.call(this),this.id=t.id,this.type=t.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==t.type&&(this.metadata=(t=t).metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),e.layout&&(this._unevaluatedLayout=new yn(e.layout)),e.paint)){for(var i in this._transitionablePaint=new fn(e.paint),t.paint)this.setPaintProperty(i,t.paint[i],{validate:!1});for(var r in t.layout)this.setLayoutProperty(r,t.layout[r],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new _n(e.paint)}}function zn(t,n){void 0===n&&(n=1);var o=0,a=0;return{members:t.map(function(t){var e=Ln[t.type].BYTES_PER_ELEMENT,i=o=On(o,Math.max(n,e)),r=t.components||1;return a=Math.max(a,e),o+=e*r,{name:t.name,type:t.type,components:r,offset:i}}),size:On(o,Math.max(a,n)),alignment:n}}function On(t,e){return Math.ceil(t/e)*e}kn.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},kn.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},kn.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},kn.prototype.clear=function(){this.length=0},kn.prototype.resize=function(t){this.reserve(t),this.length=t},kn.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},kn.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Rn,Nn=(Bn.__proto__=Rn=kn,((Bn.prototype=Object.create(Rn&&Rn.prototype)).constructor=Bn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},Bn.prototype.emplaceBack=function(t,e){var i=this.length;return this.resize(i+1),this.emplace(i,t,e)},Bn.prototype.emplace=function(t,e,i){var r=2*t;return this.int16[0+r]=e,this.int16[1+r]=i,t},Bn);function Bn(){Rn.apply(this,arguments)}Nn.prototype.bytesPerElement=4,qr("StructArrayLayout2i4",Nn);var Fn,Un=(jn.__proto__=Fn=kn,((jn.prototype=Object.create(Fn&&Fn.prototype)).constructor=jn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},jn.prototype.emplaceBack=function(t,e,i,r){var n=this.length;return this.resize(n+1),this.emplace(n,t,e,i,r)},jn.prototype.emplace=function(t,e,i,r,n){var o=4*t;return this.int16[0+o]=e,this.int16[1+o]=i,this.int16[2+o]=r,this.int16[3+o]=n,t},jn);function jn(){Fn.apply(this,arguments)}Un.prototype.bytesPerElement=8,qr("StructArrayLayout4i8",Un);var qn,Vn=(Gn.__proto__=qn=kn,((Gn.prototype=Object.create(qn&&qn.prototype)).constructor=Gn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},Gn.prototype.emplaceBack=function(t,e,i,r,n,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,i,r,n,o)},Gn.prototype.emplace=function(t,e,i,r,n,o,a){var s=6*t;return this.int16[0+s]=e,this.int16[1+s]=i,this.int16[2+s]=r,this.int16[3+s]=n,this.int16[4+s]=o,this.int16[5+s]=a,t},Gn);function Gn(){qn.apply(this,arguments)}Vn.prototype.bytesPerElement=12,qr("StructArrayLayout2i4i12",Vn);var Zn,Hn=(Wn.__proto__=Zn=kn,((Wn.prototype=Object.create(Zn&&Zn.prototype)).constructor=Wn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},Wn.prototype.emplaceBack=function(t,e,i,r,n,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,i,r,n,o)},Wn.prototype.emplace=function(t,e,i,r,n,o,a){var s=4*t,l=8*t;return this.int16[0+s]=e,this.int16[1+s]=i,this.uint8[4+l]=r,this.uint8[5+l]=n,this.uint8[6+l]=o,this.uint8[7+l]=a,t},Wn);function Wn(){Zn.apply(this,arguments)}Hn.prototype.bytesPerElement=8,qr("StructArrayLayout2i4ub8",Hn);var Kn,Xn=(Yn.__proto__=Kn=kn,((Yn.prototype=Object.create(Kn&&Kn.prototype)).constructor=Yn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},Yn.prototype.emplaceBack=function(t,e,i,r,n,o,a,s,l,u){var c=this.length;return this.resize(c+1),this.emplace(c,t,e,i,r,n,o,a,s,l,u)},Yn.prototype.emplace=function(t,e,i,r,n,o,a,s,l,u,c){var p=10*t;return this.uint16[0+p]=e,this.uint16[1+p]=i,this.uint16[2+p]=r,this.uint16[3+p]=n,this.uint16[4+p]=o,this.uint16[5+p]=a,this.uint16[6+p]=s,this.uint16[7+p]=l,this.uint16[8+p]=u,this.uint16[9+p]=c,t},Yn);function Yn(){Kn.apply(this,arguments)}Xn.prototype.bytesPerElement=20,qr("StructArrayLayout10ui20",Xn);var Jn,Qn=($n.__proto__=Jn=kn,(($n.prototype=Object.create(Jn&&Jn.prototype)).constructor=$n).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},$n.prototype.emplaceBack=function(t,e,i,r,n,o,a,s,l,u,c,p){var h=this.length;return this.resize(h+1),this.emplace(h,t,e,i,r,n,o,a,s,l,u,c,p)},$n.prototype.emplace=function(t,e,i,r,n,o,a,s,l,u,c,p,h){var d=12*t;return this.int16[0+d]=e,this.int16[1+d]=i,this.int16[2+d]=r,this.int16[3+d]=n,this.uint16[4+d]=o,this.uint16[5+d]=a,this.uint16[6+d]=s,this.uint16[7+d]=l,this.int16[8+d]=u,this.int16[9+d]=c,this.int16[10+d]=p,this.int16[11+d]=h,t},$n);function $n(){Jn.apply(this,arguments)}Qn.prototype.bytesPerElement=24,qr("StructArrayLayout4i4ui4i24",Qn);var to,eo=(io.__proto__=to=kn,((io.prototype=Object.create(to&&to.prototype)).constructor=io).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},io.prototype.emplaceBack=function(t,e,i){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,i)},io.prototype.emplace=function(t,e,i,r){var n=3*t;return this.float32[0+n]=e,this.float32[1+n]=i,this.float32[2+n]=r,t},io);function io(){to.apply(this,arguments)}eo.prototype.bytesPerElement=12,qr("StructArrayLayout3f12",eo);var ro,no=(oo.__proto__=ro=kn,((oo.prototype=Object.create(ro&&ro.prototype)).constructor=oo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},oo.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},oo.prototype.emplace=function(t,e){return this.uint32[+t+0]=e,t},oo);function oo(){ro.apply(this,arguments)}no.prototype.bytesPerElement=4,qr("StructArrayLayout1ul4",no);var ao,so=(lo.__proto__=ao=kn,((lo.prototype=Object.create(ao&&ao.prototype)).constructor=lo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},lo.prototype.emplaceBack=function(t,e,i,r,n,o,a,s,l){var u=this.length;return this.resize(u+1),this.emplace(u,t,e,i,r,n,o,a,s,l)},lo.prototype.emplace=function(t,e,i,r,n,o,a,s,l,u){var c=10*t,p=5*t;return this.int16[0+c]=e,this.int16[1+c]=i,this.int16[2+c]=r,this.int16[3+c]=n,this.int16[4+c]=o,this.int16[5+c]=a,this.uint32[3+p]=s,this.uint16[8+c]=l,this.uint16[9+c]=u,t},lo);function lo(){ao.apply(this,arguments)}so.prototype.bytesPerElement=20,qr("StructArrayLayout6i1ul2ui20",so);var uo,co=(po.__proto__=uo=kn,((po.prototype=Object.create(uo&&uo.prototype)).constructor=po).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},po.prototype.emplaceBack=function(t,e,i,r,n,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,i,r,n,o)},po.prototype.emplace=function(t,e,i,r,n,o,a){var s=6*t;return this.int16[0+s]=e,this.int16[1+s]=i,this.int16[2+s]=r,this.int16[3+s]=n,this.int16[4+s]=o,this.int16[5+s]=a,t},po);function po(){uo.apply(this,arguments)}co.prototype.bytesPerElement=12,qr("StructArrayLayout2i2i2i12",co);var ho,fo=(mo.__proto__=ho=kn,((mo.prototype=Object.create(ho&&ho.prototype)).constructor=mo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},mo.prototype.emplaceBack=function(t,e,i,r,n){var o=this.length;return this.resize(o+1),this.emplace(o,t,e,i,r,n)},mo.prototype.emplace=function(t,e,i,r,n,o){var a=4*t,s=8*t;return this.float32[0+a]=e,this.float32[1+a]=i,this.float32[2+a]=r,this.int16[6+s]=n,this.int16[7+s]=o,t},mo);function mo(){ho.apply(this,arguments)}fo.prototype.bytesPerElement=16,qr("StructArrayLayout2f1f2i16",fo);var go,yo=(vo.__proto__=go=kn,((vo.prototype=Object.create(go&&go.prototype)).constructor=vo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},vo.prototype.emplaceBack=function(t,e,i,r){var n=this.length;return this.resize(n+1),this.emplace(n,t,e,i,r)},vo.prototype.emplace=function(t,e,i,r,n){var o=12*t,a=3*t;return this.uint8[0+o]=e,this.uint8[1+o]=i,this.float32[1+a]=r,this.float32[2+a]=n,t},vo);function vo(){go.apply(this,arguments)}yo.prototype.bytesPerElement=12,qr("StructArrayLayout2ub2f12",yo);var _o,xo=(bo.__proto__=_o=kn,((bo.prototype=Object.create(_o&&_o.prototype)).constructor=bo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},bo.prototype.emplaceBack=function(t,e,i){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,i)},bo.prototype.emplace=function(t,e,i,r){var n=3*t;return this.uint16[0+n]=e,this.uint16[1+n]=i,this.uint16[2+n]=r,t},bo);function bo(){_o.apply(this,arguments)}xo.prototype.bytesPerElement=6,qr("StructArrayLayout3ui6",xo);var wo,So=(To.__proto__=wo=kn,((To.prototype=Object.create(wo&&wo.prototype)).constructor=To).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},To.prototype.emplaceBack=function(t,e,i,r,n,o,a,s,l,u,c,p,h,d,f,m,g){var y=this.length;return this.resize(y+1),this.emplace(y,t,e,i,r,n,o,a,s,l,u,c,p,h,d,f,m,g)},To.prototype.emplace=function(t,e,i,r,n,o,a,s,l,u,c,p,h,d,f,m,g,y){var v=24*t,_=12*t,x=48*t;return this.int16[0+v]=e,this.int16[1+v]=i,this.uint16[2+v]=r,this.uint16[3+v]=n,this.uint32[2+_]=o,this.uint32[3+_]=a,this.uint32[4+_]=s,this.uint16[10+v]=l,this.uint16[11+v]=u,this.uint16[12+v]=c,this.float32[7+_]=p,this.float32[8+_]=h,this.uint8[36+x]=d,this.uint8[37+x]=f,this.uint8[38+x]=m,this.uint32[10+_]=g,this.int16[22+v]=y,t},To);function To(){wo.apply(this,arguments)}So.prototype.bytesPerElement=48,qr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",So);var Io,Eo=(Co.__proto__=Io=kn,((Co.prototype=Object.create(Io&&Io.prototype)).constructor=Co).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},Co.prototype.emplaceBack=function(t,e,i,r,n,o,a,s,l,u,c,p,h,d,f,m,g,y,v,_,x,b,w,S,T,I,E,C){var A=this.length;return this.resize(A+1),this.emplace(A,t,e,i,r,n,o,a,s,l,u,c,p,h,d,f,m,g,y,v,_,x,b,w,S,T,I,E,C)},Co.prototype.emplace=function(t,e,i,r,n,o,a,s,l,u,c,p,h,d,f,m,g,y,v,_,x,b,w,S,T,I,E,C,A){var k=34*t,P=17*t;return this.int16[0+k]=e,this.int16[1+k]=i,this.int16[2+k]=r,this.int16[3+k]=n,this.int16[4+k]=o,this.int16[5+k]=a,this.int16[6+k]=s,this.int16[7+k]=l,this.uint16[8+k]=u,this.uint16[9+k]=c,this.uint16[10+k]=p,this.uint16[11+k]=h,this.uint16[12+k]=d,this.uint16[13+k]=f,this.uint16[14+k]=m,this.uint16[15+k]=g,this.uint16[16+k]=y,this.uint16[17+k]=v,this.uint16[18+k]=_,this.uint16[19+k]=x,this.uint16[20+k]=b,this.uint16[21+k]=w,this.uint16[22+k]=S,this.uint32[12+P]=T,this.float32[13+P]=I,this.float32[14+P]=E,this.float32[15+P]=C,this.float32[16+P]=A,t},Co);function Co(){Io.apply(this,arguments)}Eo.prototype.bytesPerElement=68,qr("StructArrayLayout8i15ui1ul4f68",Eo);var Ao,ko=(Po.__proto__=Ao=kn,((Po.prototype=Object.create(Ao&&Ao.prototype)).constructor=Po).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},Po.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},Po.prototype.emplace=function(t,e){return this.float32[+t+0]=e,t},Po);function Po(){Ao.apply(this,arguments)}ko.prototype.bytesPerElement=4,qr("StructArrayLayout1f4",ko);var Mo,Lo=(Do.__proto__=Mo=kn,((Do.prototype=Object.create(Mo&&Mo.prototype)).constructor=Do).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},Do.prototype.emplaceBack=function(t,e,i){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,i)},Do.prototype.emplace=function(t,e,i,r){var n=3*t;return this.int16[0+n]=e,this.int16[1+n]=i,this.int16[2+n]=r,t},Do);function Do(){Mo.apply(this,arguments)}Lo.prototype.bytesPerElement=6,qr("StructArrayLayout3i6",Lo);var zo,Oo=(Ro.__proto__=zo=kn,((Ro.prototype=Object.create(zo&&zo.prototype)).constructor=Ro).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},Ro.prototype.emplaceBack=function(t,e,i){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,i)},Ro.prototype.emplace=function(t,e,i,r){var n=4*t;return this.uint32[2*t+0]=e,this.uint16[2+n]=i,this.uint16[3+n]=r,t},Ro);function Ro(){zo.apply(this,arguments)}Oo.prototype.bytesPerElement=8,qr("StructArrayLayout1ul2ui8",Oo);var No,Bo=(Fo.__proto__=No=kn,((Fo.prototype=Object.create(No&&No.prototype)).constructor=Fo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},Fo.prototype.emplaceBack=function(t,e){var i=this.length;return this.resize(i+1),this.emplace(i,t,e)},Fo.prototype.emplace=function(t,e,i){var r=2*t;return this.uint16[0+r]=e,this.uint16[1+r]=i,t},Fo);function Fo(){No.apply(this,arguments)}Bo.prototype.bytesPerElement=4,qr("StructArrayLayout2ui4",Bo);var Uo,jo=(qo.__proto__=Uo=kn,((qo.prototype=Object.create(Uo&&Uo.prototype)).constructor=qo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},qo.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},qo.prototype.emplace=function(t,e){return this.uint16[+t+0]=e,t},qo);function qo(){Uo.apply(this,arguments)}jo.prototype.bytesPerElement=2,qr("StructArrayLayout1ui2",jo);var Vo,Go=(Zo.__proto__=Vo=kn,((Zo.prototype=Object.create(Vo&&Vo.prototype)).constructor=Zo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},Zo.prototype.emplaceBack=function(t,e){var i=this.length;return this.resize(i+1),this.emplace(i,t,e)},Zo.prototype.emplace=function(t,e,i){var r=2*t;return this.float32[0+r]=e,this.float32[1+r]=i,t},Zo);function Zo(){Vo.apply(this,arguments)}Go.prototype.bytesPerElement=8,qr("StructArrayLayout2f8",Go);var Ho,Wo=(Ko.__proto__=Ho=kn,((Ko.prototype=Object.create(Ho&&Ho.prototype)).constructor=Ko).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},Ko.prototype.emplaceBack=function(t,e,i,r){var n=this.length;return this.resize(n+1),this.emplace(n,t,e,i,r)},Ko.prototype.emplace=function(t,e,i,r,n){var o=4*t;return this.float32[0+o]=e,this.float32[1+o]=i,this.float32[2+o]=r,this.float32[3+o]=n,t},Ko);function Ko(){Ho.apply(this,arguments)}Wo.prototype.bytesPerElement=16,qr("StructArrayLayout4f16",Wo);var Xo=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.anchorPoint.get=function(){return new G(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,i),e}(An);Xo.prototype.size=20;var Yo,Jo=((Yo=so)&&(Qo.__proto__=Yo),((Qo.prototype=Object.create(Yo&&Yo.prototype)).constructor=Qo).prototype.get=function(t){return new Xo(this,t)},Qo);function Qo(){Yo.apply(this,arguments)}qr("CollisionBoxArray",Jo);var $o=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},i.placedOrientation.set=function(t){this._structArray.uint8[this._pos1+37]=t},i.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},i.hidden.set=function(t){this._structArray.uint8[this._pos1+38]=t},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},i.crossTileID.set=function(t){this._structArray.uint32[this._pos4+10]=t},i.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(e.prototype,i),e}(An);$o.prototype.size=48;var ta,ea=((ta=So)&&(ia.__proto__=ta),((ia.prototype=Object.create(ta&&ta.prototype)).constructor=ia).prototype.get=function(t){return new $o(this,t)},ia);function ia(){ta.apply(this,arguments)}qr("PlacedSymbolArray",ea);var ra=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},i.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},i.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},i.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},i.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},i.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},i.key.get=function(){return this._structArray.uint16[this._pos2+8]},i.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},i.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},i.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},i.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},i.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},i.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},i.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},i.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},i.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},i.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},i.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},i.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},i.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},i.crossTileID.set=function(t){this._structArray.uint32[this._pos4+12]=t},i.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},i.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},i.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},i.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(e.prototype,i),e}(An);ra.prototype.size=68;var na,oa=((na=Eo)&&(aa.__proto__=na),((aa.prototype=Object.create(na&&na.prototype)).constructor=aa).prototype.get=function(t){return new ra(this,t)},aa);function aa(){na.apply(this,arguments)}qr("SymbolInstanceArray",oa);var sa,la=((sa=ko)&&(ua.__proto__=sa),((ua.prototype=Object.create(sa&&sa.prototype)).constructor=ua).prototype.getoffsetX=function(t){return this.float32[+t+0]},ua);function ua(){sa.apply(this,arguments)}qr("GlyphOffsetArray",la);var ca,pa=((ca=Lo)&&(ha.__proto__=ca),((ha.prototype=Object.create(ca&&ca.prototype)).constructor=ha).prototype.getx=function(t){return this.int16[3*t+0]},ha.prototype.gety=function(t){return this.int16[3*t+1]},ha.prototype.gettileUnitDistanceFromAnchor=function(t){return this.int16[3*t+2]},ha);function ha(){ca.apply(this,arguments)}qr("SymbolLineVertexArray",pa);var da=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(e.prototype,i),e}(An);da.prototype.size=8;var fa,ma=((fa=Oo)&&(ga.__proto__=fa),((ga.prototype=Object.create(fa&&fa.prototype)).constructor=ga).prototype.get=function(t){return new da(this,t)},ga);function ga(){fa.apply(this,arguments)}function ya(t){void 0===t&&(t=[]),this.segments=t}qr("FeatureIndexArray",ma);var va=zn([{name:"a_pos",components:2,type:"Int16"}],4).members;function _a(t,e){return 256*(t=u(Math.floor(t),0,255))+u(Math.floor(e),0,255)}ya.prototype.prepareSegment=function(t,e,i,r){var n=this.segments[this.segments.length-1];return ya.MAX_VERTEX_ARRAY_LENGTH<t&&pt("Max vertices per segment is "+ya.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!n||n.vertexLength+t>ya.MAX_VERTEX_ARRAY_LENGTH||n.sortKey!==r)&&(n={vertexOffset:e.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},void 0!==r&&(n.sortKey=r),this.segments.push(n)),n},ya.prototype.get=function(){return this.segments},ya.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var i=e[t];for(var r in i.vaos)i.vaos[r].destroy()}},ya.simpleSegment=function(t,e,i,r){return new ya([{vertexOffset:t,primitiveOffset:e,vertexLength:i,primitiveLength:r,vaos:{},sortKey:0}])},ya.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,qr("SegmentVector",ya);var xa=zn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),ba=e(function(t){t.exports=function(t,e){var i,r,n,o,a,s,l,u;for(r=t.length-(i=3&t.length),n=e,a=3432918353,s=461845907,u=0;u<r;)l=255&t.charCodeAt(u)|(255&t.charCodeAt(++u))<<8|(255&t.charCodeAt(++u))<<16|(255&t.charCodeAt(++u))<<24,++u,n=27492+(65535&(o=5*(65535&(n=(n^=l=(65535&(l=(l=(65535&l)*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|n>>>19))+((5*(n>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(l=0,i){case 3:l^=(255&t.charCodeAt(u+2))<<16;case 2:l^=(255&t.charCodeAt(u+1))<<8;case 1:n^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(u)))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return n^=t.length,n=2246822507*(65535&(n^=n>>>16))+((2246822507*(n>>>16)&65535)<<16)&4294967295,n=3266489909*(65535&(n^=n>>>13))+((3266489909*(n>>>16)&65535)<<16)&4294967295,(n^=n>>>16)>>>0}}),wa=e(function(t){t.exports=function(t,e){for(var i,r=t.length,n=e^r,o=0;4<=r;)i=1540483477*(65535&(i=255&t.charCodeAt(o)|(255&t.charCodeAt(++o))<<8|(255&t.charCodeAt(++o))<<16|(255&t.charCodeAt(++o))<<24))+((1540483477*(i>>>16)&65535)<<16),n=1540483477*(65535&n)+((1540483477*(n>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),r-=4,++o;switch(r){case 3:n^=(255&t.charCodeAt(o+2))<<16;case 2:n^=(255&t.charCodeAt(o+1))<<8;case 1:n=1540483477*(65535&(n^=255&t.charCodeAt(o)))+((1540483477*(n>>>16)&65535)<<16)}return n=1540483477*(65535&(n^=n>>>13))+((1540483477*(n>>>16)&65535)<<16),(n^=n>>>15)>>>0}}),Sa=ba,Ta=wa;function Ia(){this.ids=[],this.positions=[],this.indexed=!1}Sa.murmur3=ba,Sa.murmur2=Ta,Ia.prototype.add=function(t,e,i,r){this.ids.push(Ca(t)),this.positions.push(e,i,r)},Ia.prototype.getPositions=function(t){for(var e=Ca(t),i=0,r=this.ids.length-1;i<r;){var n=i+r>>1;this.ids[n]>=e?r=n:i=1+n}for(var o=[];this.ids[i]===e;)o.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return o},Ia.serialize=function(t,e){var i=new Float64Array(t.ids),r=new Uint32Array(t.positions);return function t(e,i,r,n){for(;r<n;){for(var o=e[r+n>>1],a=r-1,s=n+1;;){for(;e[++a]<o;);for(;e[--s]>o;);if(s<=a)break;Aa(e,a,s),Aa(i,3*a,3*s),Aa(i,3*a+1,3*s+1),Aa(i,3*a+2,3*s+2)}s-r<n-s?(t(e,i,r,s),r=s+1):(t(e,i,s+1,n),n=s)}}(i,r,0,i.length-1),e&&e.push(i.buffer,r.buffer),{ids:i,positions:r}},Ia.deserialize=function(t){var e=new Ia;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e};var Ea=Math.pow(2,53)-1;function Ca(t){var e=+t;return!isNaN(e)&&e<=Ea?e:Sa(String(t))}function Aa(t,e,i){var r=t[e];t[e]=t[i],t[i]=r}function ka(t,e){this.gl=t.gl,this.location=e}qr("FeaturePositionMap",Ia);var Pa,Ma,La,Da,za,Oa,Ra,Na=(Ja.__proto__=Ra=ka,((Ja.prototype=Object.create(Ra&&Ra.prototype)).constructor=Ja).prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))},Ja),Ba=(Ya.__proto__=Oa=ka,((Ya.prototype=Object.create(Oa&&Oa.prototype)).constructor=Ya).prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))},Ya),Fa=(Xa.__proto__=za=ka,((Xa.prototype=Object.create(za&&za.prototype)).constructor=Xa).prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))},Xa),Ua=(Ka.__proto__=Da=ka,((Ka.prototype=Object.create(Da&&Da.prototype)).constructor=Ka).prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))},Ka),ja=(Wa.__proto__=La=ka,((Wa.prototype=Object.create(La&&La.prototype)).constructor=Wa).prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))},Wa),qa=(Ha.__proto__=Ma=ka,((Ha.prototype=Object.create(Ma&&Ma.prototype)).constructor=Ha).prototype.set=function(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))},Ha),Va=new Float32Array(16),Ga=(Za.__proto__=Pa=ka,((Za.prototype=Object.create(Pa&&Pa.prototype)).constructor=Za).prototype.set=function(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(var e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}},Za);function Za(t,e){Pa.call(this,t,e),this.current=Va}function Ha(t,e){Ma.call(this,t,e),this.current=le.transparent}function Wa(t,e){La.call(this,t,e),this.current=[0,0,0,0]}function Ka(t,e){Da.call(this,t,e),this.current=[0,0,0]}function Xa(t,e){za.call(this,t,e),this.current=[0,0]}function Ya(t,e){Oa.call(this,t,e),this.current=0}function Ja(t,e){Ra.call(this,t,e),this.current=0}function Qa(t){return[_a(255*t.r,255*t.g),_a(255*t.b,255*t.a)]}function $a(t,e,i){this.value=t,this.uniformNames=e.map(function(t){return"u_"+t}),this.type=i}function ts(t,e){this.uniformNames=e.map(function(t){return"u_"+t}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}function es(t,e,i,r){this.expression=t,this.type=i,this.maxValue=0,this.paintVertexAttributes=e.map(function(t){return{name:"a_"+t,type:"Float32",components:"color"===i?2:1,offset:0}}),this.paintVertexArray=new r}function is(t,e,i,r,n,o){this.expression=t,this.uniformNames=e.map(function(t){return"u_"+t+"_t"}),this.type=i,this.useIntegerZoom=r,this.zoom=n,this.maxValue=0,this.paintVertexAttributes=e.map(function(t){return{name:"a_"+t,type:"Float32",components:"color"===i?4:2,offset:0}}),this.paintVertexArray=new o}function rs(t,e,i,r,n,o){this.expression=t,this.type=e,this.useIntegerZoom=i,this.zoom=r,this.layerId=o,this.zoomInPaintVertexArray=new n,this.zoomOutPaintVertexArray=new n}function ns(t,e,i){this.binders={},this._buffers=[];var r,n,o=[];for(var a in t.paint._values)if(i(a)){var s=t.paint.get(a);if(s instanceof vn&&Bi(s.property.specification)){var l=(r=a,n=t.type,{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(n+"-","").replace(/-/g,"_")]),u=s.value,c=s.property.specification.type,p=s.property.useIntegerZoom,h=s.property.specification["property-type"],d="cross-faded"===h||"cross-faded-data-driven"===h;if("constant"===u.kind)this.binders[a]=d?new ts(u.value,l):new $a(u.value,l,c),o.push("/u_"+a);else if("source"===u.kind||d){var f=as(a,c,"source");this.binders[a]=d?new rs(u,c,p,e,f,t.id):new es(u,l,c,f),o.push("/a_"+a)}else{var m=as(a,c,"composite");this.binders[a]=new is(u,l,c,p,e,m),o.push("/z_"+a)}}}this.cacheKey=o.sort().join("")}function os(t,e,i){void 0===i&&(i=function(){return!0}),this.programConfigurations={};for(var r=0,n=t;r<n.length;r+=1){var o=n[r];this.programConfigurations[o.id]=new ns(o,e,i)}this.needsUpload=!1,this._featureMap=new Ia,this._bufferOffset=0}function as(t,e,i){var r={color:{source:Go,composite:Wo},number:{source:ko,composite:Go}},n={"line-pattern":{source:Xn,composite:Xn},"fill-pattern":{source:Xn,composite:Xn},"fill-extrusion-pattern":{source:Xn,composite:Xn}}[t];return n&&n[i]||r[e][i]}$a.prototype.setUniform=function(t,e,i){t.set(i.constantOr(this.value))},$a.prototype.getBinding=function(t,e,i){return new("color"===this.type?qa:Ba)(t,e)},ts.prototype.setConstantPatternPositions=function(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr},ts.prototype.setUniform=function(t,e,i,r){var n="u_pattern_to"===r?this.patternTo:"u_pattern_from"===r?this.patternFrom:"u_pixel_ratio_to"===r?this.pixelRatioTo:"u_pixel_ratio_from"===r?this.pixelRatioFrom:null;n&&t.set(n)},ts.prototype.getBinding=function(t,e,i){return new("u_pattern"===i.substr(0,9)?ja:Ba)(t,e)},es.prototype.populatePaintArray=function(t,e,i,r,n){var o=this.paintVertexArray.length,a=this.expression.evaluate(new un(0),e,{},r,[],n);this.paintVertexArray.resize(t),this._setPaintValue(o,t,a)},es.prototype.updatePaintArray=function(t,e,i,r){var n=this.expression.evaluate({zoom:0},i,r);this._setPaintValue(t,e,n)},es.prototype._setPaintValue=function(t,e,i){if("color"===this.type)for(var r=Qa(i),n=t;n<e;n++)this.paintVertexArray.emplace(n,r[0],r[1]);else{for(var o=t;o<e;o++)this.paintVertexArray.emplace(o,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}},es.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},es.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},is.prototype.populatePaintArray=function(t,e,i,r,n){var o=this.expression.evaluate(new un(this.zoom),e,{},r,[],n),a=this.expression.evaluate(new un(this.zoom+1),e,{},r,[],n),s=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(s,t,o,a)},is.prototype.updatePaintArray=function(t,e,i,r){var n=this.expression.evaluate({zoom:this.zoom},i,r),o=this.expression.evaluate({zoom:this.zoom+1},i,r);this._setPaintValue(t,e,n,o)},is.prototype._setPaintValue=function(t,e,i,r){if("color"===this.type)for(var n=Qa(i),o=Qa(r),a=t;a<e;a++)this.paintVertexArray.emplace(a,n[0],n[1],o[0],o[1]);else{for(var s=t;s<e;s++)this.paintVertexArray.emplace(s,i,r);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(r))}},is.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},is.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},is.prototype.setUniform=function(t,e){var i=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,r=u(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);t.set(r)},is.prototype.getBinding=function(t,e,i){return new Ba(t,e)},rs.prototype.populatePaintArray=function(t,e,i){var r=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(r,t,e.patterns&&e.patterns[this.layerId],i)},rs.prototype.updatePaintArray=function(t,e,i,r,n){this._setPaintValues(t,e,i.patterns&&i.patterns[this.layerId],n)},rs.prototype._setPaintValues=function(t,e,i,r){if(r&&i){var n=r[i.min],o=r[i.mid],a=r[i.max];if(n&&o&&a)for(var s=t;s<e;s++)this.zoomInPaintVertexArray.emplace(s,o.tl[0],o.tl[1],o.br[0],o.br[1],n.tl[0],n.tl[1],n.br[0],n.br[1],o.pixelRatio,n.pixelRatio),this.zoomOutPaintVertexArray.emplace(s,o.tl[0],o.tl[1],o.br[0],o.br[1],a.tl[0],a.tl[1],a.br[0],a.br[1],o.pixelRatio,a.pixelRatio)}},rs.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,xa.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,xa.members,this.expression.isStateDependent))},rs.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()},ns.prototype.getMaxValue=function(t){var e=this.binders[t];return e instanceof es||e instanceof is?e.maxValue:0},ns.prototype.populatePaintArrays=function(t,e,i,r,n){for(var o in this.binders){var a=this.binders[o];(a instanceof es||a instanceof is||a instanceof rs)&&a.populatePaintArray(t,e,i,r,n)}},ns.prototype.setConstantPatternPositions=function(t,e){for(var i in this.binders){var r=this.binders[i];r instanceof ts&&r.setConstantPatternPositions(t,e)}},ns.prototype.updatePaintArrays=function(t,e,i,r,n){var o=!1;for(var a in t)for(var s=0,l=e.getPositions(a);s<l.length;s+=1){var u=l[s],c=i.feature(u.index);for(var p in this.binders){var h=this.binders[p];if((h instanceof es||h instanceof is||h instanceof rs)&&!0===h.expression.isStateDependent){var d=r.paint.get(p);h.expression=d.value,h.updatePaintArray(u.start,u.end,c,t[a],n),o=!0}}}return o},ns.prototype.defines=function(){var t=[];for(var e in this.binders){var i=this.binders[e];(i instanceof $a||i instanceof ts)&&t.push.apply(t,i.uniformNames.map(function(t){return"#define HAS_UNIFORM_"+t}))}return t},ns.prototype.getBinderAttributes=function(){var t=[];for(var e in this.binders){var i=this.binders[e];if(i instanceof es||i instanceof is)for(var r=0;r<i.paintVertexAttributes.length;r++)t.push(i.paintVertexAttributes[r].name);else if(i instanceof rs)for(var n=0;n<xa.members.length;n++)t.push(xa.members[n].name)}return t},ns.prototype.getBinderUniforms=function(){var t=[];for(var e in this.binders){var i=this.binders[e];if(i instanceof $a||i instanceof ts||i instanceof is)for(var r=0,n=i.uniformNames;r<n.length;r+=1)t.push(n[r])}return t},ns.prototype.getPaintVertexBuffers=function(){return this._buffers},ns.prototype.getUniforms=function(t,e){var i=[];for(var r in this.binders){var n=this.binders[r];if(n instanceof $a||n instanceof ts||n instanceof is)for(var o=0,a=n.uniformNames;o<a.length;o+=1){var s=a[o];if(e[s]){var l=n.getBinding(t,e[s],s);i.push({name:s,property:r,binding:l})}}}return i},ns.prototype.setUniforms=function(t,e,i,r){for(var n=0,o=e;n<o.length;n+=1){var a=o[n],s=a.name,l=a.property;this.binders[l].setUniform(a.binding,r,i.get(l),s)}},ns.prototype.updatePaintBuffers=function(t){for(var e in this._buffers=[],this.binders){var i=this.binders[e];if(t&&i instanceof rs){var r=2===t.fromScale?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;r&&this._buffers.push(r)}else(i instanceof es||i instanceof is)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}},ns.prototype.upload=function(t){for(var e in this.binders){var i=this.binders[e];(i instanceof es||i instanceof is||i instanceof rs)&&i.upload(t)}this.updatePaintBuffers()},ns.prototype.destroy=function(){for(var t in this.binders){var e=this.binders[t];(e instanceof es||e instanceof is||e instanceof rs)&&e.destroy()}},os.prototype.populatePaintArrays=function(t,e,i,r,n,o){for(var a in this.programConfigurations)this.programConfigurations[a].populatePaintArrays(t,e,r,n,o);void 0!==e.id&&this._featureMap.add(e.id,i,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},os.prototype.updatePaintArrays=function(t,e,i,r){for(var n=0,o=i;n<o.length;n+=1){var a=o[n];this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(t,this._featureMap,e,a,r)||this.needsUpload}},os.prototype.get=function(t){return this.programConfigurations[t]},os.prototype.upload=function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}},os.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},qr("ConstantBinder",$a),qr("CrossFadedConstantBinder",ts),qr("SourceExpressionBinder",es),qr("CrossFadedCompositeBinder",rs),qr("CompositeExpressionBinder",is),qr("ProgramConfiguration",ns,{omit:["_buffers"]}),qr("ProgramConfigurationSet",os);var ss=Math.pow(2,14)-1,ls=-ss-1;function us(t){for(var e=8192/t.extent,i=t.loadGeometry(),r=0;r<i.length;r++)for(var n=i[r],o=0;o<n.length;o++){var a=n[o],s=Math.round(a.x*e),l=Math.round(a.y*e);a.x=u(s,ls,ss),a.y=u(l,ls,ss),(s<a.x||s>a.x+1||l<a.y||l>a.y+1)&&pt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return i}function cs(t,e,i,r,n){t.emplaceBack(2*e+(r+1)/2,2*i+(n+1)/2)}function ps(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Nn,this.indexArray=new xo,this.segments=new ya,this.programConfigurations=new os(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})}function hs(t,e){for(var i=0;i<t.length;i++)if(_s(e,t[i]))return!0;for(var r=0;r<e.length;r++)if(_s(t,e[r]))return!0;return!!ms(t,e)}function ds(t,e){if(1===t.length)return vs(e,t[0]);for(var i=0;i<e.length;i++)for(var r=e[i],n=0;n<r.length;n++)if(_s(t,r[n]))return!0;for(var o=0;o<t.length;o++)if(vs(e,t[o]))return!0;for(var a=0;a<e.length;a++)if(ms(t,e[a]))return!0;return!1}function fs(t,e,i){if(1<t.length){if(ms(t,e))return 1;for(var r=0;r<e.length;r++)if(gs(e[r],t,i))return 1}for(var n=0;n<t.length;n++)if(gs(t[n],e,i))return 1}function ms(t,e){var i,r,n,o;if(0!==t.length&&0!==e.length)for(var a=0;a<t.length-1;a++)for(var s=t[a],l=t[a+1],u=0;u<e.length-1;u++)if(i=s,r=l,n=e[u],o=e[u+1],b(i,n,o)!==b(r,n,o)&&b(i,r,n)!==b(i,r,o))return 1}function gs(t,e,i){var r=i*i;if(1===e.length)return t.distSqr(e[0])<r;for(var n=1;n<e.length;n++)if(ys(t,e[n-1],e[n])<r)return 1}function ys(t,e,i){var r=e.distSqr(i);if(0===r)return t.distSqr(e);var n=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/r;return t.distSqr(n<0?e:1<n?i:i.sub(e)._mult(n)._add(e))}function vs(t,e){for(var i,r,n,o=!1,a=0;a<t.length;a++)for(var s=0,l=(i=t[a]).length-1;s<i.length;l=s++)(r=i[s]).y>e.y!=(n=i[l]).y>e.y&&e.x<(n.x-r.x)*(e.y-r.y)/(n.y-r.y)+r.x&&(o=!o);return o}function _s(t,e){for(var i=!1,r=0,n=t.length-1;r<t.length;n=r++){var o=t[r],a=t[n];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(i=!i)}return i}function xs(t,e,i){var r=i[0],n=i[2];if(!(t.x<r.x&&e.x<r.x||t.x>n.x&&e.x>n.x||t.y<r.y&&e.y<r.y||t.y>n.y&&e.y>n.y)){var o=b(t,e,i[0]);return o!==b(t,e,i[1])||o!==b(t,e,i[2])||o!==b(t,e,i[3])}}function bs(t,e,i){var r=e.paint.get(t).value;return"constant"===r.kind?r.value:i.programConfigurations.get(e.id).getMaxValue(t)}function ws(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Ss(t,e,i,r,n){if(!e[0]&&!e[1])return t;var o=G.convert(e)._mult(n);"viewport"===i&&o._rotate(-r);for(var a=[],s=0;s<t.length;s++)a.push(t[s].sub(o));return a}ps.prototype.populate=function(t,e,i){var r=this.layers[0],n=[],o=null;"circle"===r.type&&(o=r.layout.get("circle-sort-key"));for(var a=0,s=t;a<s.length;a+=1){var l=s[a],u=l.feature,c=l.id,p=l.index,h=l.sourceLayerIndex,d=this.layers[0]._featureFilter.needGeometry,f={type:u.type,id:c,properties:u.properties,geometry:d?us(u):[]};if(this.layers[0]._featureFilter.filter(new un(this.zoom),f,i)){d||(f.geometry=us(u));var m=o?o.evaluate(f,{},i):void 0;n.push({id:c,properties:u.properties,type:u.type,sourceLayerIndex:h,index:p,geometry:f.geometry,patterns:{},sortKey:m})}}o&&n.sort(function(t,e){return t.sortKey-e.sortKey});for(var g=0,y=n;g<y.length;g+=1){var v=y[g],_=v.geometry,x=v.index,b=v.sourceLayerIndex,w=t[x].feature;this.addFeature(v,_,x,i),e.featureIndex.insert(w,_,x,b,this.index)}},ps.prototype.update=function(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)},ps.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ps.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ps.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,va),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},ps.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ps.prototype.addFeature=function(t,e,i,r){for(var n=0,o=e;n<o.length;n+=1)for(var a=0,s=o[n];a<s.length;a+=1){var l=s[a],u=l.x,c=l.y;if(!(u<0||8192<=u||c<0||8192<=c)){var p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),h=p.vertexLength;cs(this.layoutVertexArray,u,c,-1,-1),cs(this.layoutVertexArray,u,c,1,-1),cs(this.layoutVertexArray,u,c,1,1),cs(this.layoutVertexArray,u,c,-1,1),this.indexArray.emplaceBack(h,h+1,h+2),this.indexArray.emplaceBack(h,h+3,h+2),p.vertexLength+=4,p.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,{},r)},qr("CircleBucket",ps,{omit:["layers"]});var Ts=new Cn({"circle-sort-key":new bn(Ot.layout_circle["circle-sort-key"])}),Is={paint:new Cn({"circle-radius":new bn(Ot.paint_circle["circle-radius"]),"circle-color":new bn(Ot.paint_circle["circle-color"]),"circle-blur":new bn(Ot.paint_circle["circle-blur"]),"circle-opacity":new bn(Ot.paint_circle["circle-opacity"]),"circle-translate":new xn(Ot.paint_circle["circle-translate"]),"circle-translate-anchor":new xn(Ot.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new xn(Ot.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new xn(Ot.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new bn(Ot.paint_circle["circle-stroke-width"]),"circle-stroke-color":new bn(Ot.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new bn(Ot.paint_circle["circle-stroke-opacity"])}),layout:Ts},Es="undefined"!=typeof Float32Array?Float32Array:Array;function Cs(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function As(t,e,i){var r=e[0],n=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],p=e[8],h=e[9],d=e[10],f=e[11],m=e[12],g=e[13],y=e[14],v=e[15],_=i[0],x=i[1],b=i[2],w=i[3];return t[0]=_*r+x*s+b*p+w*m,t[1]=_*n+x*l+b*h+w*g,t[2]=_*o+x*u+b*d+w*y,t[3]=_*a+x*c+b*f+w*v,t[4]=(_=i[4])*r+(x=i[5])*s+(b=i[6])*p+(w=i[7])*m,t[5]=_*n+x*l+b*h+w*g,t[6]=_*o+x*u+b*d+w*y,t[7]=_*a+x*c+b*f+w*v,t[8]=(_=i[8])*r+(x=i[9])*s+(b=i[10])*p+(w=i[11])*m,t[9]=_*n+x*l+b*h+w*g,t[10]=_*o+x*u+b*d+w*y,t[11]=_*a+x*c+b*f+w*v,t[12]=(_=i[12])*r+(x=i[13])*s+(b=i[14])*p+(w=i[15])*m,t[13]=_*n+x*l+b*h+w*g,t[14]=_*o+x*u+b*d+w*y,t[15]=_*a+x*c+b*f+w*v,t}Math.hypot||(Math.hypot=function(){for(var t=arguments,e=0,i=arguments.length;i--;)e+=t[i]*t[i];return Math.sqrt(e)});var ks,Ps,Ms=As;function Ls(t,e,i){var r=e[0],n=e[1],o=e[2],a=e[3];return t[0]=i[0]*r+i[4]*n+i[8]*o+i[12]*a,t[1]=i[1]*r+i[5]*n+i[9]*o+i[13]*a,t[2]=i[2]*r+i[6]*n+i[10]*o+i[14]*a,t[3]=i[3]*r+i[7]*n+i[11]*o+i[15]*a,t}ks=new Es(3),Es!=Float32Array&&(ks[0]=0,ks[1]=0,ks[2]=0),Ps=new Es(4),Es!=Float32Array&&(Ps[0]=0,Ps[1]=0,Ps[2]=0,Ps[3]=0);var Ds,zs,Os=(zs=new Es(2),Es!=Float32Array&&(zs[0]=0,zs[1]=0),Rs.__proto__=Ds=Mn,((Rs.prototype=Object.create(Ds&&Ds.prototype)).constructor=Rs).prototype.createBucket=function(t){return new ps(t)},Rs.prototype.queryRadius=function(t){var e=t;return bs("circle-radius",this,e)+bs("circle-stroke-width",this,e)+ws(this.paint.get("circle-translate"))},Rs.prototype.queryIntersectsFeature=function(t,e,i,r,n,o,a,s){for(var l=Ss(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,a),u=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i),c="map"===this.paint.get("circle-pitch-alignment"),p=c?l:function(e){return l.map(function(t){return Ns(t,e)})}(s),h=c?u*a:u,d=0,f=r;d<f.length;d+=1)for(var m=0,g=f[d];m<g.length;m+=1){var y=g[m],v=c?y:Ns(y,s),_=h,x=Ls([],[y.x,y.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?_*=x[3]/o.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(_*=o.cameraToCenterDistance/x[3]),S=_,_s(b=p,w=v)||gs(w,b,S))return!0}var b,w,S;return!1},Rs);function Rs(t){Ds.call(this,t,Is)}function Ns(t,e){var i=Ls([],[t.x,t.y,0,1],e);return new G(i[0]/i[3],i[1]/i[3])}var Bs,Fs=(Us.__proto__=Bs=ps,(Us.prototype=Object.create(Bs&&Bs.prototype)).constructor=Us);function Us(){Bs.apply(this,arguments)}function js(t,e,i,r){var n=e.width,o=e.height;if(r){if(r instanceof Uint8ClampedArray)r=new Uint8Array(r.buffer);else if(r.length!==n*o*i)throw new RangeError("mismatched image size")}else r=new Uint8Array(n*o*i);return t.width=n,t.height=o,t.data=r,t}function qs(t,e,i){var r=e.width,n=e.height;if(r!==t.width||n!==t.height){var o=js({},{width:r,height:n},i);Vs(t,o,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,r),height:Math.min(t.height,n)},i),t.width=r,t.height=n,t.data=o.data}}function Vs(t,e,i,r,n,o){if(0===n.width||0===n.height)return e;if(n.width>t.width||n.height>t.height||i.x>t.width-n.width||i.y>t.height-n.height)throw new RangeError("out of range source coordinates for image copy");if(n.width>e.width||n.height>e.height||r.x>e.width-n.width||r.y>e.height-n.height)throw new RangeError("out of range destination coordinates for image copy");for(var a=t.data,s=e.data,l=0;l<n.height;l++)for(var u=((i.y+l)*t.width+i.x)*o,c=((r.y+l)*e.width+r.x)*o,p=0;p<n.width*o;p++)s[c+p]=a[u+p];return e}qr("HeatmapBucket",Fs,{omit:["layers"]});var Gs=function(t,e){js(this,t,1,e)};function Zs(t,e){js(this,t,4,e)}Gs.prototype.resize=function(t){qs(this,t,1)},Gs.prototype.clone=function(){return new Gs({width:this.width,height:this.height},new Uint8Array(this.data))},Gs.copy=function(t,e,i,r,n){Vs(t,e,i,r,n,1)},Zs.prototype.resize=function(t){qs(this,t,4)},Zs.prototype.replace=function(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t},Zs.prototype.clone=function(){return new Zs({width:this.width,height:this.height},new Uint8Array(this.data))},Zs.copy=function(t,e,i,r,n){Vs(t,e,i,r,n,4)},qr("AlphaImage",Gs),qr("RGBAImage",Zs);var Hs={paint:new Cn({"heatmap-radius":new bn(Ot.paint_heatmap["heatmap-radius"]),"heatmap-weight":new bn(Ot.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new xn(Ot.paint_heatmap["heatmap-intensity"]),"heatmap-color":new En(Ot.paint_heatmap["heatmap-color"]),"heatmap-opacity":new xn(Ot.paint_heatmap["heatmap-opacity"])})};function Ws(t,e){for(var i=new Uint8Array(1024),r={},n=0,o=0;n<256;n++,o+=4){r[e]=n/255;var a=t.evaluate(r);i[o+0]=Math.floor(255*a.r/a.a),i[o+1]=Math.floor(255*a.g/a.a),i[o+2]=Math.floor(255*a.b/a.a),i[o+3]=Math.floor(255*a.a)}return new Zs({width:256,height:1},i)}var Ks,Xs,Ys=(rl.__proto__=Xs=Mn,((rl.prototype=Object.create(Xs&&Xs.prototype)).constructor=rl).prototype.createBucket=function(t){return new Fs(t)},rl.prototype._handleSpecialPaintPropertyUpdate=function(t){"heatmap-color"===t&&this._updateColorRamp()},rl.prototype._updateColorRamp=function(){this.colorRamp=Ws(this._transitionablePaint._values["heatmap-color"].value.expression,"heatmapDensity"),this.colorRampTexture=null},rl.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},rl.prototype.queryRadius=function(){return 0},rl.prototype.queryIntersectsFeature=function(){return!1},rl.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},rl),Js={paint:new Cn({"hillshade-illumination-direction":new xn(Ot.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new xn(Ot.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new xn(Ot.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new xn(Ot.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new xn(Ot.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new xn(Ot.paint_hillshade["hillshade-accent-color"])})},Qs=(il.__proto__=Ks=Mn,((il.prototype=Object.create(Ks&&Ks.prototype)).constructor=il).prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},il),$s=zn([{name:"a_pos",components:2,type:"Int16"}],4).members,tl=nl,el=nl;function il(t){Ks.call(this,t,Js)}function rl(t){Xs.call(this,t,Hs),this._updateColorRamp()}function nl(t,e,i){i=i||2;var r,n,o,a,s,l,u,c=e&&e.length,p=c?e[0]*i:t.length,h=ol(t,0,p,i,!0),d=[];if(!h||h.next===h.prev)return d;if(c&&(h=function(t,e,i,r){var n,o,a,s=[];for(n=0,o=e.length;n<o;n++)(a=ol(t,e[n]*r,n<o-1?e[n+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),s.push(ml(a));for(s.sort(hl),n=0;n<s.length;n++)dl(s[n],i),i=al(i,i.next);return i}(t,e,h,i)),t.length>80*i){r=o=t[0],n=a=t[1];for(var f=i;f<p;f+=i)(s=t[f])<r&&(r=s),(l=t[f+1])<n&&(n=l),o<s&&(o=s),a<l&&(a=l);u=0!==(u=Math.max(o-r,a-n))?1/u:0}return sl(h,d,i,r,n,u),d}function ol(t,e,i,r,n){var o,a;if(n===0<Cl(t,e,i,r))for(o=e;o<i;o+=r)a=Tl(o,t[o],t[o+1],a);else for(o=i-r;e<=o;o-=r)a=Tl(o,t[o],t[o+1],a);return a&&vl(a,a.next)&&(Il(a),a=a.next),a}function al(t,e){if(!t)return t;e=e||t;var i,r=t;do{if(i=!1,r.steiner||!vl(r,r.next)&&0!==yl(r.prev,r,r.next))r=r.next;else{if(Il(r),(r=e=r.prev)===r.next)break;i=!0}}while(i||r!==e);return e}function sl(t,e,i,r,n,o,a){if(t){!a&&o&&function(t,e,i,r){for(var n=t;null===n.z&&(n.z=fl(n.x,n.y,e,i,r)),n.prevZ=n.prev,n.nextZ=n.next,(n=n.next)!==t;);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,i,r,n,o,a,s,l,u=1;do{for(i=t,o=t=null,a=0;i;){for(a++,r=i,e=s=0;e<u&&(s++,r=r.nextZ);e++);for(l=u;0<s||0<l&&r;)0!==s&&(0===l||!r||i.z<=r.z)?(i=(n=i).nextZ,s--):(r=(n=r).nextZ,l--),o?o.nextZ=n:t=n,n.prevZ=o,o=n;i=r}o.nextZ=null,u*=2}while(1<a)}(n)}(t,r,n,o);for(var s,l,u=t;t.prev!==t.next;)if(s=t.prev,l=t.next,o?ul(t,r,n,o):ll(t))e.push(s.i/i),e.push(t.i/i),e.push(l.i/i),Il(t),t=l.next,u=l.next;else if((t=l)===u){a?1===a?sl(t=cl(al(t),e,i),e,i,r,n,o,2):2===a&&pl(t,e,i,r,n,o):sl(al(t),e,i,r,n,o,1);break}}}function ll(t){var e=t.prev,i=t,r=t.next;if(!(0<=yl(e,i,r))){for(var n=t.next.next;n!==t.prev;){if(gl(e.x,e.y,i.x,i.y,r.x,r.y,n.x,n.y)&&0<=yl(n.prev,n,n.next))return;n=n.next}return 1}}function ul(t,e,i,r){var n=t.prev,o=t,a=t.next;if(!(0<=yl(n,o,a))){for(var s=n.x>o.x?n.x>a.x?n.x:a.x:o.x>a.x?o.x:a.x,l=n.y>o.y?n.y>a.y?n.y:a.y:o.y>a.y?o.y:a.y,u=fl(n.x<o.x?n.x<a.x?n.x:a.x:o.x<a.x?o.x:a.x,n.y<o.y?n.y<a.y?n.y:a.y:o.y<a.y?o.y:a.y,e,i,r),c=fl(s,l,e,i,r),p=t.prevZ,h=t.nextZ;p&&p.z>=u&&h&&h.z<=c;){if(p!==t.prev&&p!==t.next&&gl(n.x,n.y,o.x,o.y,a.x,a.y,p.x,p.y)&&0<=yl(p.prev,p,p.next))return;if(p=p.prevZ,h!==t.prev&&h!==t.next&&gl(n.x,n.y,o.x,o.y,a.x,a.y,h.x,h.y)&&0<=yl(h.prev,h,h.next))return;h=h.nextZ}for(;p&&p.z>=u;){if(p!==t.prev&&p!==t.next&&gl(n.x,n.y,o.x,o.y,a.x,a.y,p.x,p.y)&&0<=yl(p.prev,p,p.next))return;p=p.prevZ}for(;h&&h.z<=c;){if(h!==t.prev&&h!==t.next&&gl(n.x,n.y,o.x,o.y,a.x,a.y,h.x,h.y)&&0<=yl(h.prev,h,h.next))return;h=h.nextZ}return 1}}function cl(t,e,i){var r=t;do{var n=r.prev,o=r.next.next;!vl(n,o)&&_l(n,r,r.next,o)&&wl(n,o)&&wl(o,n)&&(e.push(n.i/i),e.push(r.i/i),e.push(o.i/i),Il(r),Il(r.next),r=t=o),r=r.next}while(r!==t);return al(r)}function pl(t,e,i,r,n,o){var a,s,l=t;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&(s=u,(a=l).next.i!==s.i&&a.prev.i!==s.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&_l(i,i.next,t,e))return 1;i=i.next}while(i!==t)}(a,s)&&(wl(a,s)&&wl(s,a)&&function(t,e){for(var i=t,r=!1,n=(t.x+e.x)/2,o=(t.y+e.y)/2;i.y>o!=i.next.y>o&&i.next.y!==i.y&&n<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(r=!r),(i=i.next)!==t;);return r}(a,s)&&(yl(a.prev,a,s.prev)||yl(a,s.prev,s))||vl(a,s)&&0<yl(a.prev,a,a.next)&&0<yl(s.prev,s,s.next)))){var c=Sl(l,u);return l=al(l,l.next),c=al(c,c.next),sl(l,e,i,r,n,o),void sl(c,e,i,r,n,o)}u=u.next}l=l.next}while(l!==t)}function hl(t,e){return t.x-e.x}function dl(t,e){if(e=function(t,e){var i,r=e,n=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&a<s){if((a=s)===n){if(o===r.y)return r;if(o===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!i)return null;if(n===a)return i;var l,u,c,p=i,h=i.x,d=i.y,f=1/0;for(r=i;n>=r.x&&r.x>=h&&n!==r.x&&gl(o<d?n:a,o,h,d,o<d?a:n,o,r.x,r.y)&&(l=Math.abs(o-r.y)/(n-r.x),wl(r,t)&&(l<f||l===f&&(r.x>i.x||r.x===i.x&&(c=r,yl((u=i).prev,u,c.prev)<0&&yl(c.next,u,u.next)<0)))&&(i=r,f=l)),(r=r.next)!==p;);return i}(t,e)){var i=Sl(e,t);al(e,e.next),al(i,i.next)}}function fl(t,e,i,r,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function ml(t){for(var e=t,i=t;(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),(e=e.next)!==t;);return i}function gl(t,e,i,r,n,o,a,s){return 0<=(n-a)*(e-s)-(t-a)*(o-s)&&0<=(t-a)*(r-s)-(i-a)*(e-s)&&0<=(i-a)*(o-s)-(n-a)*(r-s)}function yl(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function vl(t,e){return t.x===e.x&&t.y===e.y}function _l(t,e,i,r){var n=bl(yl(t,e,i)),o=bl(yl(t,e,r)),a=bl(yl(i,r,t)),s=bl(yl(i,r,e));return n!==o&&a!==s||0===n&&xl(t,i,e)||0===o&&xl(t,r,e)||0===a&&xl(i,t,r)||0===s&&xl(i,e,r)}function xl(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function bl(t){return 0<t?1:t<0?-1:0}function wl(t,e){return yl(t.prev,t,t.next)<0?0<=yl(t,e,t.next)&&0<=yl(t,t.prev,e):yl(t,e,t.prev)<0||yl(t,t.next,e)<0}function Sl(t,e){var i=new El(t.i,t.x,t.y),r=new El(e.i,e.x,e.y),n=t.next,o=e.prev;return(t.next=e).prev=t,(i.next=n).prev=i,(r.next=i).prev=r,(o.next=r).prev=o,r}function Tl(t,e,i,r){var n=new El(t,e,i);return r?(n.next=r.next,(n.prev=r).next.prev=n,r.next=n):(n.prev=n).next=n,n}function Il(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function El(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Cl(t,e,i,r){for(var n=0,o=e,a=i-r;o<i;o+=r)n+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return n}function Al(t,e,i){var r=t[e];t[e]=t[i],t[i]=r}function kl(t,e){return t<e?-1:e<t?1:0}function Pl(t,e){var i,r,n,o,a,s=t.length;if(s<=1)return[t];for(var l,u,c=[],p=0;p<s;p++){var h=w(t[p]);0!==h&&(t[p].area=Math.abs(h),void 0===u&&(u=h<0),u===h<0?(l&&c.push(l),l=[t[p]]):l.push(t[p]))}if(l&&c.push(l),1<e)for(var d=0;d<c.length;d++)c[d].length<=e||(i=c[d],r=e,n=1,o=c[d].length-1,a=Ml,function t(e,i,r,n,o){for(;r<n;){if(600<n-r){var a=n-r+1,s=i-r+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(s-a/2<0?-1:1);t(e,i,Math.max(r,Math.floor(i-s*u/a+c)),Math.min(n,Math.floor(i+(a-s)*u/a+c)),o)}var p=e[i],h=r,d=n;for(Al(e,r,i),0<o(e[n],p)&&Al(e,r,n);h<d;){for(Al(e,h,d),h++,d--;o(e[h],p)<0;)h++;for(;0<o(e[d],p);)d--}0===o(e[r],p)?Al(e,r,d):Al(e,++d,n),d<=i&&(r=d+1),i<=d&&(n=d-1)}}(i,r,n||0,o||i.length-1,a||kl),c[d]=c[d].slice(0,e));return c}function Ml(t,e){return e.area-t.area}function Ll(t,e,i){for(var r=i.patternDependencies,n=!1,o=0,a=e;o<a.length;o+=1){var s=a[o].paint.get(t+"-pattern");s.isConstant()||(n=!0);var l=s.constantOr(null);l&&(n=!0,r[l.to]=!0,r[l.from]=!0)}return n}function Dl(t,e,i,r,n){for(var o=n.patternDependencies,a=0,s=e;a<s.length;a+=1){var l=s[a],u=l.paint.get(t+"-pattern").value;if("constant"!==u.kind){var c=u.evaluate({zoom:r-1},i,{},n.availableImages),p=u.evaluate({zoom:r},i,{},n.availableImages),h=u.evaluate({zoom:r+1},i,{},n.availableImages);p=p&&p.name?p.name:p,h=h&&h.name?h.name:h,o[c=c&&c.name?c.name:c]=!0,o[p]=!0,o[h]=!0,i.patterns[l.id]={min:c,mid:p,max:h}}}return i}function zl(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Nn,this.indexArray=new xo,this.indexArray2=new Bo,this.programConfigurations=new os(t.layers,t.zoom),this.segments=new ya,this.segments2=new ya,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})}nl.deviation=function(t,e,i,r){var n=e&&e.length,o=Math.abs(Cl(t,0,n?e[0]*i:t.length,i));if(n)for(var a=0,s=e.length;a<s;a++)o-=Math.abs(Cl(t,e[a]*i,a<s-1?e[a+1]*i:t.length,i));var l=0;for(a=0;a<r.length;a+=3){var u=r[a]*i,c=r[a+1]*i,p=r[a+2]*i;l+=Math.abs((t[u]-t[p])*(t[1+c]-t[1+u])-(t[u]-t[c])*(t[1+p]-t[1+u]))}return 0===o&&0===l?0:Math.abs((l-o)/o)},nl.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},r=0,n=0;n<t.length;n++){for(var o=0;o<t[n].length;o++)for(var a=0;a<e;a++)i.vertices.push(t[n][o][a]);0<n&&i.holes.push(r+=t[n-1].length)}return i},tl.default=el,zl.prototype.populate=function(t,e,i){this.hasPattern=Ll("fill",this.layers,e);for(var r=this.layers[0].layout.get("fill-sort-key"),n=[],o=0,a=t;o<a.length;o+=1){var s=a[o],l=s.feature,u=s.id,c=s.index,p=s.sourceLayerIndex,h=this.layers[0]._featureFilter.needGeometry,d={type:l.type,id:u,properties:l.properties,geometry:h?us(l):[]};if(this.layers[0]._featureFilter.filter(new un(this.zoom),d,i)){h||(d.geometry=us(l));var f=r?r.evaluate(d,{},i,e.availableImages):void 0;n.push({id:u,properties:l.properties,type:l.type,sourceLayerIndex:p,index:c,geometry:d.geometry,patterns:{},sortKey:f})}}r&&n.sort(function(t,e){return t.sortKey-e.sortKey});for(var m=0,g=n;m<g.length;m+=1){var y=g[m],v=y.geometry,_=y.index,x=y.sourceLayerIndex;if(this.hasPattern){var b=Dl("fill",this.layers,y,this.zoom,e);this.patternFeatures.push(b)}else this.addFeature(y,v,_,i,{});e.featureIndex.insert(t[_].feature,v,_,x,this.index)}},zl.prototype.update=function(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)},zl.prototype.addFeatures=function(t,e,i){for(var r=0,n=this.patternFeatures;r<n.length;r+=1){var o=n[r];this.addFeature(o,o.geometry,o.index,e,i)}},zl.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},zl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},zl.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,$s),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},zl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},zl.prototype.addFeature=function(t,e,i,r,n){for(var o=0,a=Pl(e,500);o<a.length;o+=1){for(var s=a[o],l=0,u=0,c=s;u<c.length;u+=1)l+=c[u].length;for(var p=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray),h=p.vertexLength,d=[],f=[],m=0,g=s;m<g.length;m+=1){var y=g[m];if(0!==y.length){y!==s[0]&&f.push(d.length/2);var v=this.segments2.prepareSegment(y.length,this.layoutVertexArray,this.indexArray2),_=v.vertexLength;this.layoutVertexArray.emplaceBack(y[0].x,y[0].y),this.indexArray2.emplaceBack(_+y.length-1,_),d.push(y[0].x),d.push(y[0].y);for(var x=1;x<y.length;x++)this.layoutVertexArray.emplaceBack(y[x].x,y[x].y),this.indexArray2.emplaceBack(_+x-1,_+x),d.push(y[x].x),d.push(y[x].y);v.vertexLength+=y.length,v.primitiveLength+=y.length}}for(var b=tl(d,f),w=0;w<b.length;w+=3)this.indexArray.emplaceBack(h+b[w],h+b[w+1],h+b[w+2]);p.vertexLength+=l,p.primitiveLength+=b.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,n,r)},qr("FillBucket",zl,{omit:["layers","patternFeatures"]});var Ol,Rl=new Cn({"fill-sort-key":new bn(Ot.layout_fill["fill-sort-key"])}),Nl={paint:new Cn({"fill-antialias":new xn(Ot.paint_fill["fill-antialias"]),"fill-opacity":new bn(Ot.paint_fill["fill-opacity"]),"fill-color":new bn(Ot.paint_fill["fill-color"]),"fill-outline-color":new bn(Ot.paint_fill["fill-outline-color"]),"fill-translate":new xn(Ot.paint_fill["fill-translate"]),"fill-translate-anchor":new xn(Ot.paint_fill["fill-translate-anchor"]),"fill-pattern":new Tn(Ot.paint_fill["fill-pattern"])}),layout:Rl},Bl=(jl.__proto__=Ol=Mn,((jl.prototype=Object.create(Ol&&Ol.prototype)).constructor=jl).prototype.recalculate=function(t,e){Ol.prototype.recalculate.call(this,t,e);var i=this.paint._values["fill-outline-color"];"constant"===i.value.kind&&void 0===i.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},jl.prototype.createBucket=function(t){return new zl(t)},jl.prototype.queryRadius=function(){return ws(this.paint.get("fill-translate"))},jl.prototype.queryIntersectsFeature=function(t,e,i,r,n,o,a){return ds(Ss(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,a),r)},jl.prototype.isTileClipped=function(){return!0},jl),Fl=zn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Ul=ql;function jl(t){Ol.call(this,t,Nl)}function ql(t,e,i,r,n){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=r,this._values=n,t.readFields(Vl,this,e)}function Vl(t,e,i){1==t?e.id=i.readVarint():2==t?function(t,e){for(var i=t.readVarint()+t.pos;t.pos<i;){var r=e._keys[t.readVarint()],n=e._values[t.readVarint()];e.properties[r]=n}}(i,e):3==t?e.type=i.readVarint():4==t&&(e._geometry=i.pos)}function Gl(t){for(var e,i,r=0,n=0,o=t.length,a=o-1;n<o;a=n++)r+=((i=t[a]).x-(e=t[n]).x)*(e.y+i.y);return r}ql.types=["Unknown","Point","LineString","Polygon"],ql.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,i=t.readVarint()+t.pos,r=1,n=0,o=0,a=0,s=[];t.pos<i;){if(n<=0){var l=t.readVarint();r=7&l,n=l>>3}if(n--,1===r||2===r)o+=t.readSVarint(),a+=t.readSVarint(),1===r&&(e&&s.push(e),e=[]),e.push(new G(o,a));else{if(7!==r)throw new Error("unknown command "+r);e&&e.push(e[0].clone())}}return e&&s.push(e),s},ql.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,r=0,n=0,o=0,a=1/0,s=-1/0,l=1/0,u=-1/0;t.pos<e;){if(r<=0){var c=t.readVarint();i=7&c,r=c>>3}if(r--,1===i||2===i)(n+=t.readSVarint())<a&&(a=n),s<n&&(s=n),(o+=t.readSVarint())<l&&(l=o),u<o&&(u=o);else if(7!==i)throw new Error("unknown command "+i)}return[a,l,s,u]},ql.prototype.toGeoJSON=function(t,e,i){var r,n,o=this.extent*Math.pow(2,i),a=this.extent*t,s=this.extent*e,l=this.loadGeometry(),u=ql.types[this.type];function c(t){for(var e=0;e<t.length;e++){var i=t[e];t[e]=[360*(i.x+a)/o-180,360/Math.PI*Math.atan(Math.exp((180-360*(i.y+s)/o)*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(r=0;r<l.length;r++)p[r]=l[r][0];c(l=p);break;case 2:for(r=0;r<l.length;r++)c(l[r]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var i,r,n=[],o=0;o<e;o++){var a=Gl(t[o]);0!==a&&(void 0===r&&(r=a<0),r===a<0?(i&&n.push(i),i=[t[o]]):i.push(t[o]))}return i&&n.push(i),n}(l),r=0;r<l.length;r++)for(n=0;n<l[r].length;n++)c(l[r][n])}1===l.length?l=l[0]:u="Multi"+u;var h={type:"Feature",geometry:{type:u,coordinates:l},properties:this.properties};return"id"in this&&(h.id=this.id),h};var Zl=Hl;function Hl(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Wl,this,e),this.length=this._features.length}function Wl(t,e,i){15===t?e.version=i.readVarint():1===t?e.name=i.readString():5===t?e.extent=i.readVarint():2===t?e._features.push(i.pos):3===t?e._keys.push(i.readString()):4===t&&e._values.push(function(t){for(var e=null,i=t.readVarint()+t.pos;t.pos<i;){var r=t.readVarint()>>3;e=1==r?t.readString():2==r?t.readFloat():3==r?t.readDouble():4==r?t.readVarint64():5==r?t.readVarint():6==r?t.readSVarint():7==r?t.readBoolean():null}return e}(i))}function Kl(t,e,i){if(3===t){var r=new Zl(i,i.readVarint()+i.pos);r.length&&(e[r.name]=r)}}Hl.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Ul(this._pbf,e,this.extent,this._keys,this._values)};var Xl={VectorTile:function(t,e){this.layers=t.readFields(Kl,{},e)},VectorTileFeature:Ul,VectorTileLayer:Zl},Yl=Xl.VectorTileFeature.types,Jl=Math.pow(2,13);function Ql(t,e,i,r,n,o,a,s){t.emplaceBack(e,i,2*Math.floor(r*Jl)+a,n*Jl*2,o*Jl*2,Math.round(s))}function $l(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Vn,this.indexArray=new xo,this.programConfigurations=new os(t.layers,t.zoom),this.segments=new ya,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})}$l.prototype.populate=function(t,e,i){this.features=[],this.hasPattern=Ll("fill-extrusion",this.layers,e);for(var r=0,n=t;r<n.length;r+=1){var o=n[r],a=o.feature,s=o.id,l=o.index,u=o.sourceLayerIndex,c=this.layers[0]._featureFilter.needGeometry,p={type:a.type,id:s,properties:a.properties,geometry:c?us(a):[]};if(this.layers[0]._featureFilter.filter(new un(this.zoom),p,i)){var h={id:s,sourceLayerIndex:u,index:l,geometry:c?p.geometry:us(a),properties:a.properties,type:a.type,patterns:{}};void 0!==a.id&&(h.id=a.id),this.hasPattern?this.features.push(Dl("fill-extrusion",this.layers,h,this.zoom,e)):this.addFeature(h,h.geometry,l,i,{}),e.featureIndex.insert(a,h.geometry,l,u,this.index,!0)}}},$l.prototype.addFeatures=function(t,e,i){for(var r=0,n=this.features;r<n.length;r+=1){var o=n[r];this.addFeature(o,o.geometry,o.index,e,i)}},$l.prototype.update=function(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)},$l.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},$l.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},$l.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Fl),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},$l.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},$l.prototype.addFeature=function(t,e,i,r,n){for(var o=0,a=Pl(e,500);o<a.length;o+=1){for(var s=a[o],l=0,u=0,c=s;u<c.length;u+=1)l+=c[u].length;for(var p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),h=0,d=s;h<d.length;h+=1){var f=d[h];if(0!==f.length&&!((z=f).every(function(t){return t.x<0})||z.every(function(t){return 8192<t.x})||z.every(function(t){return t.y<0})||z.every(function(t){return 8192<t.y})))for(var m=0,g=0;g<f.length;g++){var y=f[g];if(1<=g){var v=f[g-1];if(D=v,!((L=y).x===D.x&&(L.x<0||8192<L.x)||L.y===D.y&&(L.y<0||8192<L.y))){p.vertexLength+4>ya.MAX_VERTEX_ARRAY_LENGTH&&(p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var _=y.sub(v)._perp()._unit(),x=v.dist(y);32768<m+x&&(m=0),Ql(this.layoutVertexArray,y.x,y.y,_.x,_.y,0,0,m),Ql(this.layoutVertexArray,y.x,y.y,_.x,_.y,0,1,m),Ql(this.layoutVertexArray,v.x,v.y,_.x,_.y,0,0,m+=x),Ql(this.layoutVertexArray,v.x,v.y,_.x,_.y,0,1,m);var b=p.vertexLength;this.indexArray.emplaceBack(b,b+2,b+1),this.indexArray.emplaceBack(b+1,b+2,b+3),p.vertexLength+=4,p.primitiveLength+=2}}}}if(p.vertexLength+l>ya.MAX_VERTEX_ARRAY_LENGTH&&(p=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray)),"Polygon"===Yl[t.type]){for(var w=[],S=[],T=p.vertexLength,I=0,E=s;I<E.length;I+=1){var C=E[I];if(0!==C.length){C!==s[0]&&S.push(w.length/2);for(var A=0;A<C.length;A++){var k=C[A];Ql(this.layoutVertexArray,k.x,k.y,0,0,1,1,0),w.push(k.x),w.push(k.y)}}}for(var P=tl(w,S),M=0;M<P.length;M+=3)this.indexArray.emplaceBack(T+P[M],T+P[M+2],T+P[M+1]);p.primitiveLength+=P.length/3,p.vertexLength+=l}}var L,D,z;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,n,r)},qr("FillExtrusionBucket",$l,{omit:["layers","features"]});var tu,eu={paint:new Cn({"fill-extrusion-opacity":new xn(Ot["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new bn(Ot["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new xn(Ot["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new xn(Ot["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Tn(Ot["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new bn(Ot["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new bn(Ot["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new xn(Ot["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},iu=(ru.__proto__=tu=Mn,((ru.prototype=Object.create(tu&&tu.prototype)).constructor=ru).prototype.createBucket=function(t){return new $l(t)},ru.prototype.queryRadius=function(){return ws(this.paint.get("fill-extrusion-translate"))},ru.prototype.is3D=function(){return!0},ru.prototype.queryIntersectsFeature=function(t,e,i,r,n,o,a,s){var l=Ss(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,a),D=this.paint.get("fill-extrusion-height").evaluate(e,i),z=this.paint.get("fill-extrusion-base").evaluate(e,i),u=function(t){for(var e=[],i=0,r=l;i<r.length;i+=1){var n=r[i],o=[n.x,n.y,0,1];Ls(o,o,t),e.push(new G(o[0]/o[3],o[1]/o[3]))}return e}(s),c=function(t,e){for(var i=[],r=[],n=e[8]*z,o=e[9]*z,a=e[10]*z,s=e[11]*z,l=e[8]*D,u=e[9]*D,c=e[10]*D,p=e[11]*D,h=0,d=t;h<d.length;h+=1){for(var f=[],m=[],g=0,y=d[h];g<y.length;g+=1){var v=y[g],_=v.x,x=v.y,b=e[0]*_+e[4]*x+e[12],w=e[1]*_+e[5]*x+e[13],S=e[2]*_+e[6]*x+e[14],T=e[3]*_+e[7]*x+e[15],I=S+a,E=T+s,C=b+l,A=w+u,k=S+c,P=T+p,M=new G((b+n)/E,(w+o)/E);M.z=I/E,f.push(M);var L=new G(C/P,A/P);L.z=k/P,m.push(L)}i.push(f),r.push(m)}return[i,r]}(r,s);return function(t,e,i){var r=1/0;ds(i,e)&&(r=ou(i,e[0]));for(var n=0;n<e.length;n++)for(var o=e[n],a=t[n],s=0;s<o.length-1;s++){var l=o[s],u=[l,o[s+1],a[s+1],a[s],l];hs(i,u)&&(r=Math.min(r,ou(i,u)))}return r!==1/0&&r}(c[0],c[1],u)},ru);function ru(t){tu.call(this,t,eu)}function nu(t,e){return t.x*e.x+t.y*e.y}function ou(t,e){if(1===t.length){for(var i,r=0,n=e[r++];!i||n.equals(i);)if(!(i=e[r++]))return 1/0;for(;r<e.length;r++){var o=e[r],a=t[0],s=i.sub(n),l=o.sub(n),u=a.sub(n),c=nu(s,s),p=nu(s,l),h=nu(l,l),d=nu(u,s),f=nu(u,l),m=c*h-p*p,g=(h*d-p*f)/m,y=(c*f-p*d)/m,v=n.z*(1-g-y)+i.z*g+o.z*y;if(isFinite(v))return v}return 1/0}for(var _=1/0,x=0,b=e;x<b.length;x+=1)_=Math.min(_,b[x].z);return _}function au(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Hn,this.indexArray=new xo,this.programConfigurations=new os(t.layers,t.zoom),this.segments=new ya,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})}var su=zn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,lu=Xl.VectorTileFeature.types,uu=Math.cos(Math.PI/180*37.5),cu=Math.pow(2,14)/.5;au.prototype.populate=function(t,e,i){this.hasPattern=Ll("line",this.layers,e);for(var r=this.layers[0].layout.get("line-sort-key"),n=[],o=0,a=t;o<a.length;o+=1){var s=a[o],l=s.feature,u=s.id,c=s.index,p=s.sourceLayerIndex,h=this.layers[0]._featureFilter.needGeometry,d={type:l.type,id:u,properties:l.properties,geometry:h?us(l):[]};if(this.layers[0]._featureFilter.filter(new un(this.zoom),d,i)){h||(d.geometry=us(l));var f=r?r.evaluate(d,{},i):void 0;n.push({id:u,properties:l.properties,type:l.type,sourceLayerIndex:p,index:c,geometry:d.geometry,patterns:{},sortKey:f})}}r&&n.sort(function(t,e){return t.sortKey-e.sortKey});for(var m=0,g=n;m<g.length;m+=1){var y=g[m],v=y.geometry,_=y.index,x=y.sourceLayerIndex;if(this.hasPattern){var b=Dl("line",this.layers,y,this.zoom,e);this.patternFeatures.push(b)}else this.addFeature(y,v,_,i,{});e.featureIndex.insert(t[_].feature,v,_,x,this.index)}},au.prototype.update=function(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)},au.prototype.addFeatures=function(t,e,i){for(var r=0,n=this.patternFeatures;r<n.length;r+=1){var o=n[r];this.addFeature(o,o.geometry,o.index,e,i)}},au.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},au.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},au.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,su),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},au.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},au.prototype.addFeature=function(t,e,i,r,n){for(var o=this.layers[0].layout,a=o.get("line-join").evaluate(t,{}),s=o.get("line-cap"),l=o.get("line-miter-limit"),u=o.get("line-round-limit"),c=0,p=e;c<p.length;c+=1)this.addLine(p[c],t,a,s,l,u);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,n,r)},au.prototype.addLine=function(t,e,i,r,n,o){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+e.properties.mapbox_clip_start,this.clipEnd=+e.properties.mapbox_clip_end;for(var a=0;a<t.length-1;a++)this.totalDistance+=t[a].dist(t[a+1]);this.updateScaledDistance()}for(var s="Polygon"===lu[e.type],l=t.length;2<=l&&t[l-1].equals(t[l-2]);)l--;for(var u=0;u<l-1&&t[u].equals(t[u+1]);)u++;if(!(l<(s?3:2))){"bevel"===i&&(n=1.05);var c,p=this.overscaling<=16?122880/(512*this.overscaling):0,h=this.segments.prepareSegment(10*l,this.layoutVertexArray,this.indexArray),d=void 0,f=void 0,m=void 0,g=void 0;this.e1=this.e2=-1,s&&(g=t[u].sub(c=t[l-2])._unit()._perp());for(var y=u;y<l;y++)if(!(f=y===l-1?s?t[u+1]:void 0:t[y+1])||!t[y].equals(f)){g&&(m=g),c&&(d=c),c=t[y],g=f?f.sub(c)._unit()._perp():m;var v=(m=m||g).add(g);0===v.x&&0===v.y||v._unit();var _=m.x*g.x+m.y*g.y,x=v.x*g.x+v.y*g.y,b=0!=x?1/x:1/0,w=2*Math.sqrt(2-2*x),S=x<uu&&d&&f,T=0<m.x*g.y-m.y*g.x;if(S&&u<y){var I=c.dist(d);if(2*p<I){var E=c.sub(c.sub(d)._mult(p/I)._round());this.updateDistance(d,E),this.addCurrentVertex(E,m,0,0,h),d=E}}var C=d&&f,A=C?i:s?"butt":r;if(C&&"round"===A&&(b<o?A="miter":b<=2&&(A="fakeround")),"miter"===A&&n<b&&(A="bevel"),"bevel"===A&&(2<b&&(A="flipbevel"),b<n&&(A="miter")),d&&this.updateDistance(d,c),"miter"===A)v._mult(b),this.addCurrentVertex(c,v,0,0,h);else if("flipbevel"===A){if(100<b)v=g.mult(-1);else{var k=b*m.add(g).mag()/m.sub(g).mag();v._perp()._mult(k*(T?-1:1))}this.addCurrentVertex(c,v,0,0,h),this.addCurrentVertex(c,v.mult(-1),0,0,h)}else if("bevel"===A||"fakeround"===A){var P=-Math.sqrt(b*b-1),M=T?P:0,L=T?0:P;if(d&&this.addCurrentVertex(c,m,M,L,h),"fakeround"===A)for(var D=Math.round(180*w/Math.PI/20),z=1;z<D;z++){var O=z/D;if(.5!==O){var R=O-.5;O+=O*R*(O-1)*((1.0904+_*(_*(3.55645-1.43519*_)-3.2452))*R*R+(.848013+_*(.215638*_-1.06021)))}var N=g.sub(m)._mult(O)._add(m)._unit()._mult(T?-1:1);this.addHalfVertex(c,N.x,N.y,!1,T,0,h)}f&&this.addCurrentVertex(c,g,-M,-L,h)}else if("butt"===A)this.addCurrentVertex(c,v,0,0,h);else if("square"===A){var B=d?1:-1;this.addCurrentVertex(c,v,B,B,h)}else"round"===A&&(d&&(this.addCurrentVertex(c,m,0,0,h),this.addCurrentVertex(c,m,1,1,h,!0)),f&&(this.addCurrentVertex(c,g,-1,-1,h,!0),this.addCurrentVertex(c,g,0,0,h)));if(S&&y<l-1){var F=c.dist(f);if(2*p<F){var U=c.add(f.sub(c)._mult(p/F)._round());this.updateDistance(c,U),this.addCurrentVertex(U,g,0,0,h),c=U}}}}},au.prototype.addCurrentVertex=function(t,e,i,r,n,o){void 0===o&&(o=!1);var a=e.y*r-e.x,s=-e.y-e.x*r;this.addHalfVertex(t,e.x+e.y*i,e.y-e.x*i,o,!1,i,n),this.addHalfVertex(t,a,s,o,!0,-r,n),this.distance>cu/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(t,e,i,r,n,o))},au.prototype.addHalfVertex=function(t,e,i,r,n,o,a){var s=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((t.x<<1)+(r?1:0),(t.y<<1)+(n?1:0),Math.round(63*e)+128,Math.round(63*i)+128,1+(0===o?0:o<0?-1:1)|(63&s)<<2,s>>6);var l=a.vertexLength++;0<=this.e1&&0<=this.e2&&(this.indexArray.emplaceBack(this.e1,this.e2,l),a.primitiveLength++),n?this.e2=l:this.e1=l},au.prototype.updateScaledDistance=function(){this.scaledDistance=0<this.totalDistance?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(cu-1):this.distance},au.prototype.updateDistance=function(t,e){this.distance+=t.dist(e),this.updateScaledDistance()},qr("LineBucket",au,{omit:["layers","patternFeatures"]});var pu,hu=new Cn({"line-cap":new xn(Ot.layout_line["line-cap"]),"line-join":new bn(Ot.layout_line["line-join"]),"line-miter-limit":new xn(Ot.layout_line["line-miter-limit"]),"line-round-limit":new xn(Ot.layout_line["line-round-limit"]),"line-sort-key":new bn(Ot.layout_line["line-sort-key"])}),du={paint:new Cn({"line-opacity":new bn(Ot.paint_line["line-opacity"]),"line-color":new bn(Ot.paint_line["line-color"]),"line-translate":new xn(Ot.paint_line["line-translate"]),"line-translate-anchor":new xn(Ot.paint_line["line-translate-anchor"]),"line-width":new bn(Ot.paint_line["line-width"]),"line-gap-width":new bn(Ot.paint_line["line-gap-width"]),"line-offset":new bn(Ot.paint_line["line-offset"]),"line-blur":new bn(Ot.paint_line["line-blur"]),"line-dasharray":new wn(Ot.paint_line["line-dasharray"]),"line-pattern":new Tn(Ot.paint_line["line-pattern"]),"line-gradient":new En(Ot.paint_line["line-gradient"])}),layout:hu},fu=(mu.__proto__=pu=bn,((mu.prototype=Object.create(pu&&pu.prototype)).constructor=mu).prototype.possiblyEvaluate=function(t,e){return e=new un(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),pu.prototype.possiblyEvaluate.call(this,t,e)},mu.prototype.evaluate=function(t,e,i,r){return e=d({},e,{zoom:Math.floor(e.zoom)}),pu.prototype.evaluate.call(this,t,e,i,r)},new mu(du.paint.properties["line-width"].specification));function mu(){pu.apply(this,arguments)}fu.useIntegerZoom=!0;var gu,yu=(vu.__proto__=gu=Mn,((vu.prototype=Object.create(gu&&gu.prototype)).constructor=vu).prototype._handleSpecialPaintPropertyUpdate=function(t){"line-gradient"===t&&this._updateGradient()},vu.prototype._updateGradient=function(){this.gradient=Ws(this._transitionablePaint._values["line-gradient"].value.expression,"lineProgress"),this.gradientTexture=null},vu.prototype.recalculate=function(t,e){gu.prototype.recalculate.call(this,t,e),this.paint._values["line-floorwidth"]=fu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)},vu.prototype.createBucket=function(t){return new au(t)},vu.prototype.queryRadius=function(t){var e=t,i=_u(bs("line-width",this,e),bs("line-gap-width",this,e)),r=bs("line-offset",this,e);return i/2+Math.abs(r)+ws(this.paint.get("line-translate"))},vu.prototype.queryIntersectsFeature=function(t,e,i,r,n,o,a){var s=Ss(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,a),l=a/2*_u(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),u=this.paint.get("line-offset").evaluate(e,i);return u&&(r=function(t,e){for(var i=[],r=new G(0,0),n=0;n<t.length;n++){for(var o=t[n],a=[],s=0;s<o.length;s++){var l=o[s],u=o[s+1],c=0===s?r:l.sub(o[s-1])._unit()._perp(),p=s===o.length-1?r:u.sub(l)._unit()._perp(),h=c._add(p)._unit();h._mult(1/(h.x*p.x+h.y*p.y)),a.push(h._mult(e)._add(l))}i.push(a)}return i}(r,u*a)),function(t,e,i){for(var r=0;r<e.length;r++){var n=e[r];if(3<=t.length)for(var o=0;o<n.length;o++)if(_s(t,n[o]))return!0;if(fs(t,n,i))return!0}return!1}(s,r,l)},vu.prototype.isTileClipped=function(){return!0},vu);function vu(t){gu.call(this,t,du)}function _u(t,e){return 0<e?e+2*t:t}var xu=zn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),bu=zn([{name:"a_projected_pos",components:3,type:"Float32"}],4),wu=(zn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),zn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Su=(zn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),zn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Tu=zn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Iu(t,n,o){return t.sections.forEach(function(t){var e,i,r;t.text=(e=t.text,i=o,"uppercase"===(r=n.layout.get("text-transform").evaluate(i,{}))?e=e.toLocaleUpperCase():"lowercase"===r&&(e=e.toLocaleLowerCase()),pn.applyArabicShaping&&(e=pn.applyArabicShaping(e)),e)}),t}function Eu(t,e,i,r,n){var o,a,s=8*n-r-1,l=(1<<s)-1,u=l>>1,c=-7,p=i?n-1:0,h=i?-1:1,d=t[e+p];for(p+=h,o=d&(1<<-c)-1,d>>=-c,c+=s;0<c;o=256*o+t[e+p],p+=h,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;0<c;a=256*a+t[e+p],p+=h,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,r),o-=u}return(d?-1:1)*a*Math.pow(2,o-r)}function Cu(t,e,i,r,n,o){var a,s,l,u=8*o-n-1,c=(1<<u)-1,p=c>>1,h=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,f=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),2<=(e+=1<=a+p?h/l:h*Math.pow(2,1-p))*l&&(a++,l/=2),c<=a+p?(s=0,a=c):1<=a+p?(s=(e*l-1)*Math.pow(2,n),a+=p):(s=e*Math.pow(2,p-1)*Math.pow(2,n),a=0));8<=n;t[i+d]=255&s,d+=f,s/=256,n-=8);for(a=a<<n|s,u+=n;0<u;t[i+d]=255&a,d+=f,a/=256,u-=8);t[i+d-f]|=128*m}zn([{name:"triangle",components:3,type:"Uint16"}]),zn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),zn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),zn([{type:"Float32",name:"offsetX"}]),zn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Au={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},ku=Pu;function Pu(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Pu.Varint=0,Pu.Fixed64=1,Pu.Bytes=2,Pu.Fixed32=5;var Mu="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Lu(t){return t.type===Pu.Bytes?t.readVarint()+t.pos:t.pos+1}function Du(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function zu(t,e,i){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(r);for(var n=i.pos-1;t<=n;n--)i.buf[n+r]=i.buf[n]}function Ou(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function Ru(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function Nu(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function Bu(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function Fu(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function Uu(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function ju(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function qu(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function Vu(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function Gu(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Zu(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function Hu(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function Wu(t,e,i){1===t&&i.readMessage(Ku,e)}function Ku(t,e,i){if(3===t){var r=i.readMessage(Xu,{}),n=r.width,o=r.height,a=r.left,s=r.top,l=r.advance;e.push({id:r.id,bitmap:new Gs({width:n+6,height:o+6},r.bitmap),metrics:{width:n,height:o,left:a,top:s,advance:l}})}}function Xu(t,e,i){1===t?e.id=i.readVarint():2===t?e.bitmap=i.readBytes():3===t?e.width=i.readVarint():4===t?e.height=i.readVarint():5===t?e.left=i.readSVarint():6===t?e.top=i.readSVarint():7===t&&(e.advance=i.readVarint())}function Yu(t){for(var e=0,i=0,r=0,n=t;r<n.length;r+=1){var o=n[r];e+=o.w*o.h,i=Math.max(i,o.w)}t.sort(function(t,e){return e.h-t.h});for(var a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}],s=0,l=0,u=0,c=t;u<c.length;u+=1)for(var p=c[u],h=a.length-1;0<=h;h--){var d=a[h];if(!(p.w>d.w||p.h>d.h)){if(p.x=d.x,p.y=d.y,l=Math.max(l,p.y+p.h),s=Math.max(s,p.x+p.w),p.w===d.w&&p.h===d.h){var f=a.pop();h<a.length&&(a[h]=f)}else p.h===d.h?(d.x+=p.w,d.w-=p.w):(p.w===d.w||a.push({x:d.x+p.w,y:d.y,w:d.w-p.w,h:p.h}),d.y+=p.h,d.h-=p.h);break}}return{w:s,h:l,fill:e/(s*l)||0}}function Ju(t,e){var i=e.pixelRatio,r=e.version,n=e.stretchX,o=e.stretchY,a=e.content;this.paddedRect=t,this.pixelRatio=i,this.stretchX=n,this.stretchY=o,this.content=a,this.version=r}Pu.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var r=this.readVarint(),n=r>>3,o=this.pos;this.type=7&r,t(n,e,this),this.pos===o&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Gu(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Hu(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Gu(this.buf,this.pos)+4294967296*Gu(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=Gu(this.buf,this.pos)+4294967296*Hu(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Eu(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Eu(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,r=this.buf;return e=127&(i=r[this.pos++]),i<128?e:(e|=(127&(i=r[this.pos++]))<<7,i<128?e:(e|=(127&(i=r[this.pos++]))<<14,i<128?e:(e|=(127&(i=r[this.pos++]))<<21,i<128?e:function(t,e,i){var r,n,o=i.buf;if(r=(112&(n=o[i.pos++]))>>4,n<128)return Du(t,r,e);if(r|=(127&(n=o[i.pos++]))<<3,n<128)return Du(t,r,e);if(r|=(127&(n=o[i.pos++]))<<10,n<128)return Du(t,r,e);if(r|=(127&(n=o[i.pos++]))<<17,n<128)return Du(t,r,e);if(r|=(127&(n=o[i.pos++]))<<24,n<128)return Du(t,r,e);if(r|=(1&(n=o[i.pos++]))<<31,n<128)return Du(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t,e,i,r=this.readVarint()+this.pos,c=this.pos;return 12<=(this.pos=r)-c&&Mu?(t=this.buf,e=c,i=r,Mu.decode(t.subarray(e,i))):function(t,e){for(var i="",r=c;r<e;){var n,o,a,s=t[r],l=null,u=239<s?4:223<s?3:191<s?2:1;if(e<r+u)break;1===u?s<128&&(l=s):2===u?128==(192&(n=t[r+1]))&&(l=(31&s)<<6|63&n)<=127&&(l=null):3===u?(o=t[r+2],128==(192&(n=t[r+1]))&&128==(192&o)&&((l=(15&s)<<12|(63&n)<<6|63&o)<=2047||55296<=l&&l<=57343)&&(l=null)):4===u&&(o=t[r+2],a=t[r+3],128==(192&(n=t[r+1]))&&128==(192&o)&&128==(192&a)&&((l=(15&s)<<18|(63&n)<<12|(63&o)<<6|63&a)<=65535||1114112<=l)&&(l=null)),null===l?(l=65533,u=1):65535<l&&(l-=65536,i+=String.fromCharCode(l>>>10&1023|55296),l=56320|1023&l),i+=String.fromCharCode(l),r+=u}return i}(this.buf,r)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Pu.Bytes)return t.push(this.readVarint(e));var i=Lu(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Pu.Bytes)return t.push(this.readSVarint());var e=Lu(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Pu.Bytes)return t.push(this.readBoolean());var e=Lu(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Pu.Bytes)return t.push(this.readFloat());var e=Lu(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Pu.Bytes)return t.push(this.readDouble());var e=Lu(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Pu.Bytes)return t.push(this.readFixed32());var e=Lu(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Pu.Bytes)return t.push(this.readSFixed32());var e=Lu(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Pu.Bytes)return t.push(this.readFixed64());var e=Lu(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Pu.Bytes)return t.push(this.readSFixed64());var e=Lu(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Pu.Varint)for(;127<this.buf[this.pos++];);else if(e===Pu.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Pu.Fixed32)this.pos+=4;else{if(e!==Pu.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Zu(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Zu(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Zu(this.buf,-1&t,this.pos),Zu(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Zu(this.buf,-1&t,this.pos),Zu(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(l){268435455<(l=+l||0)||l<0?function(t){var e,i,r,n,o,a,s;if(0<=l?(e=l%4294967296|0,i=l/4294967296|0):(i=~(-l/4294967296),4294967295^(e=~(-l%4294967296))?e=e+1|0:i=i+1|(e=0)),0x10000000000000000<=l||l<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),a=e,(s=t).buf[s.pos++]=127&a|128,a>>>=7,s.buf[s.pos++]=127&a|128,a>>>=7,s.buf[s.pos++]=127&a|128,a>>>=7,s.buf[s.pos++]=127&a|128,s.buf[s.pos]=127&(a>>>=7),o=(7&(r=i))<<4,(n=t).buf[n.pos++]|=o|((r>>>=3)?128:0),r&&(n.buf[n.pos++]=127&r|((r>>>=7)?128:0),r&&(n.buf[n.pos++]=127&r|((r>>>=7)?128:0),r&&(n.buf[n.pos++]=127&r|((r>>>=7)?128:0),r&&(n.buf[n.pos++]=127&r|((r>>>=7)?128:0),r&&(n.buf[n.pos++]=127&r)))))}(this):(this.realloc(4),this.buf[this.pos++]=127&l|(127<l?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(127<l?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(127<l?128:0),l<=127||(this.buf[this.pos++]=l>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,i){for(var r,n,o=0;o<e.length;o++){if(55295<(r=e.charCodeAt(o))&&r<57344){if(!n){56319<r||o+1===e.length?(t[i++]=239,t[i++]=191,t[i++]=189):n=r;continue}if(r<56320){t[i++]=239,t[i++]=191,t[i++]=189,n=r;continue}r=n-55296<<10|r-56320|65536,n=null}else n&&(t[i++]=239,t[i++]=191,t[i++]=189,n=null);r<128?t[i++]=r:(r<2048?t[i++]=r>>6|192:(r<65536?t[i++]=r>>12|224:(t[i++]=r>>18|240,t[i++]=r>>12&63|128),t[i++]=r>>6&63|128),t[i++]=63&r|128)}return i}(this.buf,t,this.pos);var i=this.pos-e;128<=i&&zu(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),Cu(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Cu(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var r=this.pos-i;128<=r&&zu(i,r,this),this.pos=i-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,i){this.writeTag(t,Pu.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Ou,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Ru,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,Fu,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Nu,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Bu,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Uu,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,ju,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,qu,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,Vu,e)},writeBytesField:function(t,e){this.writeTag(t,Pu.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Pu.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Pu.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Pu.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Pu.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Pu.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Pu.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Pu.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Pu.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Pu.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var Qu={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};function $u(t,e){var i={},r={};this.haveRenderCallbacks=[];var n=[];this.addImages(t,i,n),this.addImages(e,r,n);var o=Yu(n),a=new Zs({width:o.w||1,height:o.h||1});for(var s in t){var l=t[s],u=i[s].paddedRect;Zs.copy(l.data,a,{x:0,y:0},{x:u.x+1,y:u.y+1},l.data)}for(var c in e){var p=e[c],h=r[c].paddedRect,d=h.x+1,f=h.y+1,m=p.data.width,g=p.data.height;Zs.copy(p.data,a,{x:0,y:0},{x:d,y:f},p.data),Zs.copy(p.data,a,{x:0,y:g-1},{x:d,y:f-1},{width:m,height:1}),Zs.copy(p.data,a,{x:0,y:0},{x:d,y:f+g},{width:m,height:1}),Zs.copy(p.data,a,{x:m-1,y:0},{x:d-1,y:f},{width:1,height:g}),Zs.copy(p.data,a,{x:0,y:0},{x:d+m,y:f},{width:1,height:g})}this.image=a,this.iconPositions=i,this.patternPositions=r}function tc(){this.scale=1,this.fontStack="",this.imageName=null}Qu.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Qu.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Qu.tlbr.get=function(){return this.tl.concat(this.br)},Qu.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Ju.prototype,Qu),$u.prototype.addImages=function(t,e,i){for(var r in t){var n=t[r],o={x:0,y:0,w:n.data.width+2,h:n.data.height+2};i.push(o),e[r]=new Ju(o,n),n.hasRenderCallback&&this.haveRenderCallbacks.push(r)}},$u.prototype.patchUpdatedImages=function(t,e){for(var i in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[i],t.getImage(i),e),this.patchUpdatedImage(this.patternPositions[i],t.getImage(i),e)},$u.prototype.patchUpdatedImage=function(t,e,i){if(t&&e&&t.version!==e.version){t.version=e.version;var r=t.tl;i.update(e.data,void 0,{x:r[0],y:r[1]})}},qr("ImagePosition",Ju),qr("ImageAtlas",$u);var ec={horizontal:1,vertical:2,horizontalOnly:3};function ic(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}function rc(t,e,i,r,n,o,a,s,K,l,u,c,p,h,d,f){var m,g=ic.fromFeature(t,n);c===ec.vertical&&g.verticalizePunctuation();var y=pn.processBidirectionalText,v=pn.processStyledBidirectionalText;if(y&&1===g.sections.length){m=[];for(var _=0,x=y(g.toString(),uc(g,l,o,e,r,h,d));_<x.length;_+=1){var b=x[_],w=new ic;w.text=b,w.sections=g.sections;for(var S=0;S<b.length;S++)w.sectionIndex.push(0);m.push(w)}}else if(v){m=[];for(var T=0,I=v(g.text,g.sectionIndex,uc(g,l,o,e,r,h,d));T<I.length;T+=1){var E=I[T],C=new ic;C.text=E[0],C.sectionIndex=E[1],C.sections=g.sections,m.push(C)}}else m=function(t,e){for(var i=[],r=t.text,n=0,o=0,a=e;o<a.length;o+=1){var s=a[o];i.push(t.substring(n,s)),n=s}return n<r.length&&i.push(t.substring(n,r.length)),i}(g,uc(g,l,o,e,r,h,d));var A=[],k={positionedLines:A,text:g.toString(),top:u[1],bottom:u[1],left:u[0],right:u[0],writingMode:c,iconsInText:!1,verticalizable:!1};return function(t,e,i,r,n,f,o,a,s,l,u){for(var c=0,p=-17,h=0,d=0,m="right"===K?1:"left"===K?0:.5,g=0,y=0,v=n;y<v.length;y+=1){var _=v[y];_.trim();var x=_.getMaxScale(),b=24*(x-1),w={positionedGlyphs:[],lineOffset:0},S=(t.positionedLines[g]=w).positionedGlyphs,T=0;if(_.length()){for(var I=0;I<_.length();I++){var E=_.getSection(I),C=_.getSectionIndex(I),A=_.getCharCode(I),k=0,P=null,M=null,L=null,D=24,z=!(a===ec.horizontal||!l&&!Jr(A)||l&&(nc[A]||(V=A,Xr.Arabic(V)||Xr["Arabic Supplement"](V)||Xr["Arabic Extended-A"](V)||Xr["Arabic Presentation Forms-A"](V)||Xr["Arabic Presentation Forms-B"](V))));if(E.imageName){var O=r[E.imageName];if(!O)continue;L=E.imageName,t.iconsInText=t.iconsInText||!0,M=O.paddedRect;var R=O.displaySize;E.scale=24*E.scale/u,k=b+(24-R[1]*E.scale),D=(P={width:R[0],height:R[1],left:1,top:-3,advance:z?R[1]:R[0]}).advance;var N=z?R[0]*E.scale-24*x:R[1]*E.scale-24*x;0<N&&T<N&&(T=N)}else{var B=i[E.fontStack],F=B&&B[A];if(F&&F.rect)M=F.rect,P=F.metrics;else{var U=e[E.fontStack],j=U&&U[A];if(!j)continue;P=j.metrics}k=24*(x-E.scale)}z?(t.verticalizable=!0,S.push({glyph:A,imageName:L,x:c,y:p+k,vertical:z,scale:E.scale,fontStack:E.fontStack,sectionIndex:C,metrics:P,rect:M}),c+=D*E.scale+s):(S.push({glyph:A,imageName:L,x:c,y:p+k,vertical:z,scale:E.scale,fontStack:E.fontStack,sectionIndex:C,metrics:P,rect:M}),c+=P.advance*E.scale+s)}0!==S.length&&(h=Math.max(c-s,h),pc(S,0,S.length-1,m,T)),c=0;var q=f*x+T;w.lineOffset=Math.max(T,b),p+=q,d=Math.max(q,d),++g}else p+=f,++g}var V,G=p- -17,Z=cc(o),H=Z.horizontalAlign,W=Z.verticalAlign;(function(t,e,i,r,n,o,a){var s,l=(e-i)*r;s=n!==f?-o*W+17:(-W*a+.5)*f;for(var u=0,c=t;u<c.length;u+=1)for(var p=0,h=c[u].positionedGlyphs;p<h.length;p+=1){var d=h[p];d.x+=l,d.y+=s}})(t.positionedLines,m,H,h,d,G,n.length),t.top+=-W*G,t.bottom=t.top+G,t.left+=-H*h,t.right=t.left+h}(k,e,i,r,m,a,s,c,l,p,f),!function(){for(var t=0,e=A;t<e.length;t+=1)if(0!==e[t].positionedGlyphs.length)return;return 1}()&&k}tc.forText=function(t,e){var i=new tc;return i.scale=t||1,i.fontStack=e,i},tc.forImage=function(t){var e=new tc;return e.imageName=t,e},ic.fromFeature=function(t,e){for(var i=new ic,r=0;r<t.sections.length;r++){var n=t.sections[r];n.image?i.addImageSection(n):i.addTextSection(n,e)}return i},ic.prototype.length=function(){return this.text.length},ic.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},ic.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},ic.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},ic.prototype.verticalizePunctuation=function(){this.text=function(t){for(var e="",i=0;i<t.length;i++){var r=t.charCodeAt(i+1)||null,n=t.charCodeAt(i-1)||null;e+=r&&Qr(r)&&!Au[t[i+1]]||n&&Qr(n)&&!Au[t[i-1]]||!Au[t[i]]?t[i]:Au[t[i]]}return e}(this.text)},ic.prototype.trim=function(){for(var t=0,e=0;e<this.text.length&&nc[this.text.charCodeAt(e)];e++)t++;for(var i=this.text.length,r=this.text.length-1;0<=r&&t<=r&&nc[this.text.charCodeAt(r)];r--)i--;this.text=this.text.substring(t,i),this.sectionIndex=this.sectionIndex.slice(t,i)},ic.prototype.substring=function(t,e){var i=new ic;return i.text=this.text.substring(t,e),i.sectionIndex=this.sectionIndex.slice(t,e),i.sections=this.sections,i},ic.prototype.toString=function(){return this.text},ic.prototype.getMaxScale=function(){var i=this;return this.sectionIndex.reduce(function(t,e){return Math.max(t,i.sections[e].scale)},0)},ic.prototype.addTextSection=function(t,e){this.text+=t.text,this.sections.push(tc.forText(t.scale,t.fontStack||e));for(var i=this.sections.length-1,r=0;r<t.text.length;++r)this.sectionIndex.push(i)},ic.prototype.addImageSection=function(t){var e=t.image?t.image.name:"";if(0!==e.length){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(tc.forImage(e)),this.sectionIndex.push(this.sections.length-1)):pt("Reached maximum number of images 6401")}else pt("Can't add FormattedSection with an empty image.")},ic.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?63743<=this.imageSectionID?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var nc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},oc={};function ac(t,e,i,r,n,o){if(e.imageName){var a=r[e.imageName];return a?a.displaySize[0]*e.scale*24/o+n:0}var s=i[e.fontStack],l=s&&s[t];return l?l.metrics.advance*e.scale+n:0}function sc(t,e,i,r){var n=Math.pow(t-e,2);return r?t<e?n/2:2*n:n+Math.abs(i)*i}function lc(t,e,i,r,n,o){for(var a=null,s=sc(e,i,n,o),l=0,u=r;l<u.length;l+=1){var c=u[l],p=sc(e-c.x,i,n,o)+c.badness;p<=s&&(a=c,s=p)}return{index:t,x:e,priorBreak:a,badness:s}}function uc(t,e,i,r,n,o,a){if("point"!==o)return[];if(!t)return[];for(var s,l=[],u=function(t,e,i,r,n,o){for(var a=0,s=0;s<t.length();s++){var l=t.getSection(s);a+=ac(t.getCharCode(s),l,r,n,e,o)}return a/Math.max(1,Math.ceil(a/i))}(t,e,i,r,n,a),c=0<=t.text.indexOf("​"),p=0,h=0;h<t.length();h++){var d=t.getSection(h),f=t.getCharCode(h);if(nc[f]||(p+=ac(f,d,r,n,e,a)),h<t.length()-1){var m=!((s=f)<11904||!(Xr["Bopomofo Extended"](s)||Xr.Bopomofo(s)||Xr["CJK Compatibility Forms"](s)||Xr["CJK Compatibility Ideographs"](s)||Xr["CJK Compatibility"](s)||Xr["CJK Radicals Supplement"](s)||Xr["CJK Strokes"](s)||Xr["CJK Symbols and Punctuation"](s)||Xr["CJK Unified Ideographs Extension A"](s)||Xr["CJK Unified Ideographs"](s)||Xr["Enclosed CJK Letters and Months"](s)||Xr["Halfwidth and Fullwidth Forms"](s)||Xr.Hiragana(s)||Xr["Ideographic Description Characters"](s)||Xr["Kangxi Radicals"](s)||Xr["Katakana Phonetic Extensions"](s)||Xr.Katakana(s)||Xr["Vertical Forms"](s)||Xr["Yi Radicals"](s)||Xr["Yi Syllables"](s)));(oc[f]||m||d.imageName)&&l.push(lc(h+1,p,u,l,(g=f,y=t.getCharCode(h+1),v=void 0,v=0,10===g&&(v-=1e4),m&&c&&(v+=150),40!==g&&65288!==g||(v+=50),41!==y&&65289!==y||(v+=50),v),!1))}}var g,y,v;return function t(e){return e?t(e.priorBreak).concat(e.index):[]}(lc(t.length(),p,u,l,0,!0))}function cc(t){var e=.5,i=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function pc(t,e,i,r,n){if(r||n)for(var o=t[i],a=(t[i].x+o.metrics.advance*o.scale)*r,s=e;s<=i;s++)t[s].x-=a,t[s].y+=n}function hc(t,e,i,r,n,o){var a,s=t.image;if(s.content){var l=s.content,u=s.pixelRatio||1;a=[l[0]/u,l[1]/u,s.displaySize[0]-l[2]/u,s.displaySize[1]-l[3]/u]}var c,p,h,d,f=e.left*o,m=e.right*o;p="width"===i||"both"===i?(d=n[0]+f-r[3],n[0]+m+r[1]):(d=n[0]+(f+m-s.displaySize[0])/2)+s.displaySize[0];var g=e.top*o,y=e.bottom*o;return h="height"===i||"both"===i?(c=n[1]+g-r[0],n[1]+y+r[2]):(c=n[1]+(g+y-s.displaySize[1])/2)+s.displaySize[1],{image:s,top:c,right:p,bottom:h,left:d,collisionPadding:a}}oc[10]=!0,oc[32]=!0,oc[38]=!0,oc[40]=!0,oc[41]=!0,oc[43]=!0,oc[45]=!0,oc[47]=!0,oc[173]=!0,oc[183]=!0,oc[8203]=!0,oc[8208]=!0,oc[8211]=!0,oc[8231]=!0;var dc,fc=((dc=G)&&(mc.__proto__=dc),((mc.prototype=Object.create(dc&&dc.prototype)).constructor=mc).prototype.clone=function(){return new mc(this.x,this.y,this.angle,this.segment)},mc);function mc(t,e,i,r){dc.call(this,t,e),this.angle=i,void 0!==r&&(this.segment=r)}function gc(t,e){var i=e.expression;if("constant"===i.kind)return{kind:"constant",layoutSize:i.evaluate(new un(t+1))};if("source"===i.kind)return{kind:"source"};for(var r=i.zoomStops,n=i.interpolationType,o=0;o<r.length&&r[o]<=t;)o++;for(var a=o=Math.max(0,o-1);a<r.length&&r[a]<t+1;)a++;a=Math.min(r.length-1,a);var s=r[o],l=r[a];return"composite"===i.kind?{kind:"composite",minZoom:s,maxZoom:l,interpolationType:n}:{kind:"camera",minZoom:s,maxZoom:l,minSize:i.evaluate(new un(s)),maxSize:i.evaluate(new un(l)),interpolationType:n}}function yc(t,e,i){var r=e.uSize,n=i.lowerSize;return"source"===t.kind?n/128:"composite"===t.kind?Ye(n/128,i.upperSize/128,e.uSizeT):r}function vc(t,e){var i=0,r=0;if("constant"===t.kind)r=t.layoutSize;else if("source"!==t.kind){var n=t.interpolationType,o=n?u(ci.interpolationFactor(n,e,t.minZoom,t.maxZoom),0,1):0;"camera"===t.kind?r=Ye(t.minSize,t.maxSize,o):i=o}return{uSizeT:i,uSize:r}}qr("Anchor",fc);var _c=Object.freeze({__proto__:null,getSizeData:gc,evaluateSizeForFeature:yc,evaluateSizeForZoom:vc,SIZE_PACK_FACTOR:128});function xc(t,e,i,r,n){if(void 0===e.segment)return 1;for(var o=e,a=e.segment+1,s=0;-i/2<s;){if(--a<0)return;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;for(var l=[],u=0;s<i/2;){var c=t[a],p=t[a+1];if(!p)return;var h=t[a-1].angleTo(c)-c.angleTo(p);for(h=Math.abs((h+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:h}),u+=h;s-l[0].distance>r;)u-=l.shift().angleDelta;if(n<u)return;a++,s+=c.dist(p)}return 1}function bc(t){for(var e=0,i=0;i<t.length-1;i++)e+=t[i].dist(t[i+1]);return e}function wc(t,e,i){return t?.6*e*i:0}function Sc(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Tc(t,e,i,r,n,o){for(var a=wc(i,n,o),s=Sc(i,r)*o,l=0,u=bc(t)/2,c=0;c<t.length-1;c++){var p=t[c],h=t[c+1],d=p.dist(h);if(u<l+d){var f=(u-l)/d,m=Ye(p.x,h.x,f),g=Ye(p.y,h.y,f),y=new fc(m,g,h.angleTo(p),c);return y._round(),!a||xc(t,y,s,a,e)?y:void 0}l+=d}}function Ic(t,e,i,r,n){for(var o=[],a=0;a<t.length;a++)for(var s=t[a],l=void 0,u=0;u<s.length-1;u++){var c=s[u],p=s[u+1];c.x<e&&p.x<e||(c.x<e?c=new G(e,c.y+(e-c.x)/(p.x-c.x)*(p.y-c.y))._round():p.x<e&&(p=new G(e,c.y+(e-c.x)/(p.x-c.x)*(p.y-c.y))._round()),c.y<i&&p.y<i||(c.y<i?c=new G(c.x+(i-c.y)/(p.y-c.y)*(p.x-c.x),i)._round():p.y<i&&(p=new G(c.x+(i-c.y)/(p.y-c.y)*(p.x-c.x),i)._round()),c.x>=r&&p.x>=r||(c.x>=r?c=new G(r,c.y+(r-c.x)/(p.x-c.x)*(p.y-c.y))._round():p.x>=r&&(p=new G(r,c.y+(r-c.x)/(p.x-c.x)*(p.y-c.y))._round()),c.y>=n&&p.y>=n||(c.y>=n?c=new G(c.x+(n-c.y)/(p.y-c.y)*(p.x-c.x),n)._round():p.y>=n&&(p=new G(c.x+(n-c.y)/(p.y-c.y)*(p.x-c.x),n)._round()),l&&c.equals(l[l.length-1])||o.push(l=[c]),l.push(p)))))}return o}function Ec(T,I,E,t){function e(t,e){return t+e[1]-e[0]}var i=[],C=T.image,A=C.pixelRatio,r=C.paddedRect.w-2,n=C.paddedRect.h-2,k=T.right-T.left,P=T.bottom-T.top,o=C.stretchX||[[0,r]],a=C.stretchY||[[0,n]],M=o.reduce(e,0),L=a.reduce(e,0),s=r-M,l=n-L,D=0,z=M,O=0,R=L,N=0,B=s,F=0,U=l;if(C.content&&t){var u=C.content;D=Cc(o,0,u[0]),O=Cc(a,0,u[1]),z=Cc(o,u[0],u[2]),R=Cc(a,u[1],u[3]),N=u[0]-D,F=u[1]-O,B=u[2]-u[0]-z,U=u[3]-u[1]-R}function c(t,e,i,r){var n=kc(t.stretch-D,z,k,T.left),o=Pc(t.fixed-N,B,t.stretch,M),a=kc(e.stretch-O,R,P,T.top),s=Pc(e.fixed-F,U,e.stretch,L),l=kc(i.stretch-D,z,k,T.left),u=Pc(i.fixed-N,B,i.stretch,M),c=kc(r.stretch-O,R,P,T.top),p=Pc(r.fixed-F,U,r.stretch,L),h=new G(n,a),d=new G(l,a),f=new G(l,c),m=new G(n,c),g=new G(o/A,s/A),y=new G(u/A,p/A),v=I*Math.PI/180;if(v){var _=Math.sin(v),x=Math.cos(v),b=[x,-_,_,x];h._matMult(b),d._matMult(b),m._matMult(b),f._matMult(b)}var w=t.stretch+t.fixed,S=e.stretch+e.fixed;return{tl:h,tr:d,bl:m,br:f,tex:{x:C.paddedRect.x+1+w,y:C.paddedRect.y+1+S,w:i.stretch+i.fixed-w,h:r.stretch+r.fixed-S},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:g,pixelOffsetBR:y,minFontScaleX:B/A/k,minFontScaleY:U/A/P,isSDF:E}}if(t&&(C.stretchX||C.stretchY))for(var p=Ac(o,s,M),h=Ac(a,l,L),d=0;d<p.length-1;d++)for(var f=p[d],m=p[d+1],g=0;g<h.length-1;g++)i.push(c(f,h[g],m,h[g+1]));else i.push(c({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:1+r},{fixed:0,stretch:1+n}));return i}function Cc(t,e,i){for(var r=0,n=0,o=t;n<o.length;n+=1){var a=o[n];r+=Math.max(e,Math.min(i,a[1]))-Math.max(e,Math.min(i,a[0]))}return r}function Ac(t,e,i){for(var r=[{fixed:-1,stretch:0}],n=0,o=t;n<o.length;n+=1){var a=o[n],s=a[0],l=a[1],u=r[r.length-1];r.push({fixed:s-u.stretch,stretch:u.stretch}),r.push({fixed:s-u.stretch,stretch:u.stretch+(l-s)})}return r.push({fixed:e+1,stretch:i}),r}function kc(t,e,i,r){return t/e*i+r}function Pc(t,e,i,r){return t-e*i/r}function Mc(t,e,i,r,n,o,a,s,l,u){if(this.boxStartIndex=t.length,l){var c=o.top,p=o.bottom,h=o.collisionPadding;h&&(c-=h[1],p+=h[3]);var d=p-c;0<d&&(d=Math.max(10,d),this.circleDiameter=d)}else{var f=o.top*a-s,m=o.bottom*a+s,g=o.left*a-s,y=o.right*a+s,v=o.collisionPadding;if(v&&(g-=v[0]*a,f-=v[1]*a,y+=v[2]*a,m+=v[3]*a),u){var _=new G(g,f),x=new G(y,f),b=new G(g,m),w=new G(y,m),S=u*Math.PI/180;_._rotate(S),x._rotate(S),b._rotate(S),w._rotate(S),g=Math.min(_.x,x.x,b.x,w.x),y=Math.max(_.x,x.x,b.x,w.x),f=Math.min(_.y,x.y,b.y,w.y),m=Math.max(_.y,x.y,b.y,w.y)}t.emplaceBack(e.x,e.y,g,f,y,m,i,r,n)}this.boxEndIndex=t.length}var Lc=function(t,e){if(void 0===t&&(t=[]),void 0===e&&(e=Dc),this.data=t,this.length=this.data.length,this.compare=e,0<this.length)for(var i=(this.length>>1)-1;0<=i;i--)this._down(i)};function Dc(t,e){return t<e?-1:e<t?1:0}function zc(t,e,i){void 0===e&&(e=1),void 0===i&&(i=!1);for(var r=1/0,n=1/0,o=-1/0,a=-1/0,s=t[0],l=0;l<s.length;l++){var u=s[l];(!l||u.x<r)&&(r=u.x),(!l||u.y<n)&&(n=u.y),(!l||u.x>o)&&(o=u.x),(!l||u.y>a)&&(a=u.y)}var c=Math.min(o-r,a-n),p=c/2,h=new Lc([],Oc);if(0===c)return new G(r,n);for(var d=r;d<o;d+=c)for(var f=n;f<a;f+=c)h.push(new Rc(d+p,f+p,p,t));for(var m=function(t){for(var e=0,i=0,r=0,n=t[0],o=0,a=n.length,s=a-1;o<a;s=o++){var l=n[o],u=n[s],c=l.x*u.y-u.x*l.y;i+=(l.x+u.x)*c,r+=(l.y+u.y)*c,e+=3*c}return new Rc(i/e,r/e,0,t)}(t),g=h.length;h.length;){var y=h.pop();(y.d>m.d||!m.d)&&(m=y,i&&console.log("found best %d after %d probes",Math.round(1e4*y.d)/1e4,g)),y.max-m.d<=e||(h.push(new Rc(y.p.x-(p=y.h/2),y.p.y-p,p,t)),h.push(new Rc(y.p.x+p,y.p.y-p,p,t)),h.push(new Rc(y.p.x-p,y.p.y+p,p,t)),h.push(new Rc(y.p.x+p,y.p.y+p,p,t)),g+=4)}return i&&(console.log("num probes: "+g),console.log("best distance: "+m.d)),m.p}function Oc(t,e){return e.max-t.max}function Rc(t,e,i,r){this.p=new G(t,e),this.h=i,this.d=function(t,e){for(var i=!1,r=1/0,n=0;n<e.length;n++)for(var o=e[n],a=0,s=o.length,l=s-1;a<s;l=a++){var u=o[a],c=o[l];u.y>t.y!=c.y>t.y&&t.x<(c.x-u.x)*(t.y-u.y)/(c.y-u.y)+u.x&&(i=!i),r=Math.min(r,ys(t,u,c))}return(i?1:-1)*Math.sqrt(r)}(this.p,r),this.max=this.d+this.h*Math.SQRT2}Lc.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},Lc.prototype.pop=function(){if(0!==this.length){var t=this.data[0],e=this.data.pop();return this.length--,0<this.length&&(this.data[0]=e,this._down(0)),t}},Lc.prototype.peek=function(){return this.data[0]},Lc.prototype._up=function(t){for(var e=this.data,i=this.compare,r=e[t];0<t;){var n=t-1>>1,o=e[n];if(0<=i(r,o))break;e[t]=o,t=n}e[t]=r},Lc.prototype._down=function(t){for(var e=this.data,i=this.compare,r=this.length>>1,n=e[t];t<r;){var o=1+(t<<1),a=e[o],s=o+1;if(s<this.length&&i(e[s],a)<0&&(a=e[o=s]),0<=i(a,n))break;e[t]=a,t=o}e[t]=n};var Nc=Number.POSITIVE_INFINITY;function Bc(t,e){return e[1]!==Nc?function(t,e,i){var r=0,n=0;switch(e=Math.abs(e),i=Math.abs(i),t){case"top-right":case"top-left":case"top":n=i-7;break;case"bottom-right":case"bottom-left":case"bottom":n=7-i}switch(t){case"top-right":case"bottom-right":case"right":r=-e;break;case"top-left":case"bottom-left":case"left":r=e}return[r,n]}(t,e[0],e[1]):function(t,e){var i=0,r=0;e<0&&(e=0);var n=e/Math.sqrt(2);switch(t){case"top-right":case"top-left":r=n-7;break;case"bottom-right":case"bottom-left":r=7-n;break;case"bottom":r=7-e;break;case"top":r=e-7}switch(t){case"top-right":case"bottom-right":i=-n;break;case"top-left":case"bottom-left":i=n;break;case"left":i=e;break;case"right":i=-e}return[i,r]}(t,e[0])}function Fc(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Uc(t,e,i,r,n,o,a,s,l,u,c,p,h,d,f){var m=function(t,e,i,r,n,o,a){for(var s=i.layout.get("text-rotate").evaluate(n,{})*Math.PI/180,l=[],u=0,c=t.positionedLines;u<c.length;u+=1)for(var p=c[u],h=0,d=p.positionedGlyphs;h<d.length;h+=1){var f=d[h];if(f.rect){var m=f.rect||{},g=4,y=!0,v=1,_=0,x=(r||a)&&f.vertical,b=f.metrics.advance*f.scale/2;if(a&&t.verticalizable&&(_=p.lineOffset/2-(f.imageName?-(24-f.metrics.width*f.scale)/2:24*(f.scale-1))),f.imageName){var w=o[f.imageName];y=w.sdf,g=1/(v=w.pixelRatio)}var S=r?[f.x+b,f.y]:[0,0],T=r?[0,0]:[f.x+b+e[0],f.y+e[1]-_],I=[0,0];x&&(I=T,T=[0,0]);var E=(f.metrics.left-g)*f.scale-b+T[0],C=(-f.metrics.top-g)*f.scale+T[1],A=E+m.w*f.scale/v,k=C+m.h*f.scale/v,P=new G(E,C),M=new G(A,C),L=new G(E,k),D=new G(A,k);if(x){var z=new G(-b,17+b),O=-Math.PI/2,R=12-b,N=new G(22-R,-(f.imageName?R:0)),B=new(Function.prototype.bind.apply(G,[null].concat(I)));P._rotateAround(O,z)._add(N)._add(B),M._rotateAround(O,z)._add(N)._add(B),L._rotateAround(O,z)._add(N)._add(B),D._rotateAround(O,z)._add(N)._add(B)}if(s){var F=Math.sin(s),U=Math.cos(s),j=[U,-F,F,U];P._matMult(j),M._matMult(j),L._matMult(j),D._matMult(j)}var q=new G(0,0),V=new G(0,0);l.push({tl:P,tr:M,bl:L,br:D,tex:m,writingMode:t.writingMode,glyphOffset:S,sectionIndex:f.sectionIndex,isSDF:y,pixelOffsetTL:q,pixelOffsetBR:V,minFontScaleX:0,minFontScaleY:0})}}return l}(i,s,n,o,a,r,t.allowVerticalPlacement),g=t.textSizeData,y=null;"source"===g.kind?32640<(y=[128*n.layout.get("text-size").evaluate(a,{})])[0]&&pt(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===g.kind&&(32640<(y=[128*d.compositeTextSizes[0].evaluate(a,{},f),128*d.compositeTextSizes[1].evaluate(a,{},f)])[0]||32640<y[1])&&pt(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),t.addSymbols(t.text,m,y,s,o,a,u,e,l.lineStartIndex,l.lineLength,h,f);for(var v=0,_=c;v<_.length;v+=1)p[_[v]]=t.text.placedSymbolArray.length-1;return 4*m.length}function jc(t){for(var e in t)return t[e];return null}function qc(t,e,i,r){var n=t.compareText;if(e in n){for(var o=n[e],a=o.length-1;0<=a;a--)if(r.dist(o[a])<i)return 1}else n[e]=[];return n[e].push(r),0}var Vc=Xl.VectorTileFeature.types,Gc=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Zc(t,e,i,r,n,o,a,s,l,u,c,p,h){var d=s?Math.min(32640,Math.round(s[0])):0,f=s?Math.min(32640,Math.round(s[1])):0;t.emplaceBack(e,i,Math.round(32*r),Math.round(32*n),o,a,(d<<1)+(l?1:0),f,16*u,16*c,256*p,256*h)}function Hc(t,e,i){t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i)}function Wc(t){for(var e=0,i=t.sections;e<i.length;e+=1)if(tn(i[e].text))return 1}function Kc(t){this.layoutVertexArray=new Qn,this.indexArray=new xo,this.programConfigurations=t,this.segments=new ya,this.dynamicLayoutVertexArray=new eo,this.opacityVertexArray=new no,this.placedSymbolArray=new ea}function Xc(t,e,i){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new i,this.segments=new ya,this.collisionVertexArray=new yo}function Yc(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Cs([]),this.placementViewportMatrix=Cs([]);var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=gc(this.zoom,e["text-size"]),this.iconSizeData=gc(this.zoom,e["icon-size"]);var i=this.layers[0].layout,r=i.get("symbol-sort-key"),n=i.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==n&&void 0!==r.constantOr(1),this.sortFeaturesByY=("viewport-y"===n||"auto"===n&&!this.sortFeaturesByKey)&&(i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement")),"point"===i.get("symbol-placement")&&(this.writingModes=i.get("text-writing-mode").map(function(t){return ec[t]})),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id}),this.sourceID=t.sourceID}function Jc(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Zt,this.defaultValue=t}Kc.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},Kc.prototype.upload=function(t,e,i,r){this.isEmpty()||(i&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,xu.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,bu.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Gc,!0),this.opacityVertexBuffer.itemSize=1),(i||r)&&this.programConfigurations.upload(t))},Kc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},qr("SymbolBuffers",Kc),Xc.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,wu.members,!0)},Xc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},qr("CollisionBuffers",Xc),Yc.prototype.createArrays=function(){this.text=new Kc(new os(this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new Kc(new os(this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.glyphOffsetArray=new la,this.lineVertexArray=new pa,this.symbolInstances=new oa},Yc.prototype.calculateGlyphDependencies=function(t,e,i,r,n){for(var o=0;o<t.length;o++)if(e[t.charCodeAt(o)]=!0,(i||r)&&n){var a=Au[t.charAt(o)];a&&(e[a.charCodeAt(0)]=!0)}},Yc.prototype.populate=function(t,e,i){var r=this.layers[0],n=r.layout,o=n.get("text-font"),a=n.get("text-field"),s=n.get("icon-image"),l=("constant"!==a.value.kind||a.value.value instanceof pe&&!a.value.value.isEmpty()||0<a.value.value.toString().length)&&("constant"!==o.value.kind||0<o.value.value.length),u="constant"!==s.value.kind||!!s.value.value||0<Object.keys(s.parameters).length,c=n.get("symbol-sort-key");if(this.features=[],l||u){for(var p=e.iconDependencies,h=e.glyphDependencies,d=e.availableImages,f=new un(this.zoom),m=0,g=t;m<g.length;m+=1){var y=g[m],v=y.feature,_=y.id,x=y.index,b=y.sourceLayerIndex,w=r._featureFilter.needGeometry,S={type:v.type,id:_,properties:v.properties,geometry:w?us(v):[]};if(r._featureFilter.filter(f,S,i)){w||(S.geometry=us(v));var T=void 0;if(l){var I=r.getValueAndResolveTokens("text-field",S,i,d),E=pe.factory(I);Wc(E)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===sn()||this.hasRTLText&&pn.isParsed())&&(T=Iu(E,r,S))}var C=void 0;if(u){var A=r.getValueAndResolveTokens("icon-image",S,i,d);C=A instanceof he?A:he.fromString(A)}if(T||C){var k=this.sortFeaturesByKey?c.evaluate(S,{},i):void 0,P={id:_,text:T,icon:C,index:x,sourceLayerIndex:b,geometry:us(v),properties:v.properties,type:Vc[v.type],sortKey:k};if(this.features.push(P),C&&(p[C.name]=!0),T){var M=o.evaluate(S,{},i).join(","),L="map"===n.get("text-rotation-alignment")&&"point"!==n.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&0<=this.writingModes.indexOf(ec.vertical);for(var D=0,z=T.sections;D<z.length;D+=1){var O=z[D];if(O.image)p[O.image.name]=!0;else{var R=Yr(T.toString()),N=O.fontStack||M,B=h[N]=h[N]||{};this.calculateGlyphDependencies(O.text,B,L,this.allowVerticalPlacement,R)}}}}}}"line"===n.get("symbol-placement")&&(this.features=function(e){var n={},o={},a=[],i=0;function t(t){a.push(e[t]),i++}function r(t,e,i){var r=o[t];return delete o[t],o[e]=r,a[r].geometry[0].pop(),a[r].geometry[0]=a[r].geometry[0].concat(i[0]),r}function s(t,e,i){var r=n[e];return delete n[e],n[t]=r,a[r].geometry[0].shift(),a[r].geometry[0]=i[0].concat(a[r].geometry[0]),r}function l(t,e,i){var r=i?e[0][e[0].length-1]:e[0][0];return t+":"+r.x+":"+r.y}for(var u=0;u<e.length;u++){var c=e[u],p=c.geometry,h=c.text?c.text.toString():null;if(h){var d=l(h,p),f=l(h,p,!0);if(d in o&&f in n&&o[d]!==n[f]){var m=s(d,f,p),g=r(d,f,a[m].geometry);delete n[d],delete o[f],o[l(h,a[g].geometry,!0)]=g,a[m].geometry=null}else d in o?r(d,f,p):f in n?s(d,f,p):(t(u),n[d]=i-1,o[f]=i-1)}else t(u)}return a.filter(function(t){return t.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(t,e){return t.sortKey-e.sortKey})}},Yc.prototype.update=function(t,e,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,i),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,i))},Yc.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},Yc.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Yc.prototype.upload=function(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Yc.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Yc.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Yc.prototype.addToLineVertexArray=function(t,e){var i=this.lineVertexArray.length;if(void 0!==t.segment){for(var r=t.dist(e[t.segment+1]),n=t.dist(e[t.segment]),o={},a=t.segment+1;a<e.length;a++)o[a]={x:e[a].x,y:e[a].y,tileUnitDistanceFromAnchor:r},a<e.length-1&&(r+=e[a+1].dist(e[a]));for(var s=t.segment||0;0<=s;s--)o[s]={x:e[s].x,y:e[s].y,tileUnitDistanceFromAnchor:n},0<s&&(n+=e[s-1].dist(e[s]));for(var l=0;l<e.length;l++){var u=o[l];this.lineVertexArray.emplaceBack(u.x,u.y,u.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}},Yc.prototype.addSymbols=function(t,e,i,r,n,o,a,s,l,u,c,p){for(var h=t.indexArray,d=t.layoutVertexArray,f=t.segments.prepareSegment(4*e.length,d,h,o.sortKey),m=this.glyphOffsetArray.length,g=f.vertexLength,y=this.allowVerticalPlacement&&a===ec.vertical?Math.PI/2:0,v=o.text&&o.text.sections,_=0;_<e.length;_++){var x=e[_],b=x.tl,w=x.tr,S=x.bl,T=x.br,I=x.tex,E=x.pixelOffsetTL,C=x.pixelOffsetBR,A=x.minFontScaleX,k=x.minFontScaleY,P=x.glyphOffset,M=x.isSDF,L=x.sectionIndex,D=f.vertexLength,z=P[1];Zc(d,s.x,s.y,b.x,z+b.y,I.x,I.y,i,M,E.x,E.y,A,k),Zc(d,s.x,s.y,w.x,z+w.y,I.x+I.w,I.y,i,M,C.x,E.y,A,k),Zc(d,s.x,s.y,S.x,z+S.y,I.x,I.y+I.h,i,M,E.x,C.y,A,k),Zc(d,s.x,s.y,T.x,z+T.y,I.x+I.w,I.y+I.h,i,M,C.x,C.y,A,k),Hc(t.dynamicLayoutVertexArray,s,y),h.emplaceBack(D,D+1,D+2),h.emplaceBack(D+1,D+2,D+3),f.vertexLength+=4,f.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(P[0]),_!==e.length-1&&L===e[_+1].sectionIndex||t.programConfigurations.populatePaintArrays(d.length,o,o.index,{},p,v&&v[L])}t.placedSymbolArray.emplaceBack(s.x,s.y,m,this.glyphOffsetArray.length-m,g,l,u,s.segment,i?i[0]:0,i?i[1]:0,r[0],r[1],a,0,!1,0,c)},Yc.prototype._addCollisionDebugVertex=function(t,e,i,r,n,o){return e.emplaceBack(0,0),t.emplaceBack(i.x,i.y,r,n,Math.round(o.x),Math.round(o.y))},Yc.prototype.addCollisionDebugVertices=function(t,e,i,r,n,o,a){var s=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),l=s.vertexLength,u=n.layoutVertexArray,c=n.collisionVertexArray,p=a.anchorX,h=a.anchorY;this._addCollisionDebugVertex(u,c,o,p,h,new G(t,e)),this._addCollisionDebugVertex(u,c,o,p,h,new G(i,e)),this._addCollisionDebugVertex(u,c,o,p,h,new G(i,r)),this._addCollisionDebugVertex(u,c,o,p,h,new G(t,r)),s.vertexLength+=4;var d=n.indexArray;d.emplaceBack(l,l+1),d.emplaceBack(l+1,l+2),d.emplaceBack(l+2,l+3),d.emplaceBack(l+3,l),s.primitiveLength+=4},Yc.prototype.addDebugCollisionBoxes=function(t,e,i,r){for(var n=t;n<e;n++){var o=this.collisionBoxArray.get(n);this.addCollisionDebugVertices(o.x1,o.y1,o.x2,o.y2,r?this.textCollisionBox:this.iconCollisionBox,o.anchorPoint,i)}},Yc.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Xc(co,Su.members,Bo),this.iconCollisionBox=new Xc(co,Su.members,Bo);for(var t=0;t<this.symbolInstances.length;t++){var e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}},Yc.prototype._deserializeCollisionBoxesForSymbol=function(t,e,i,r,n,o,a,s,l){for(var u={},c=e;c<i;c++){var p=t.get(c);u.textBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},u.textFeatureIndex=p.featureIndex;break}for(var h=r;h<n;h++){var d=t.get(h);u.verticalTextBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},u.verticalTextFeatureIndex=d.featureIndex;break}for(var f=o;f<a;f++){var m=t.get(f);u.iconBox={x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,anchorPointX:m.anchorPointX,anchorPointY:m.anchorPointY},u.iconFeatureIndex=m.featureIndex;break}for(var g=s;g<l;g++){var y=t.get(g);u.verticalIconBox={x1:y.x1,y1:y.y1,x2:y.x2,y2:y.y2,anchorPointX:y.anchorPointX,anchorPointY:y.anchorPointY},u.verticalIconFeatureIndex=y.featureIndex;break}return u},Yc.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var e=0;e<this.symbolInstances.length;e++){var i=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}},Yc.prototype.hasTextData=function(){return 0<this.text.segments.get().length},Yc.prototype.hasIconData=function(){return 0<this.icon.segments.get().length},Yc.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Yc.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&0<this.textCollisionBox.segments.get().length},Yc.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&0<this.iconCollisionBox.segments.get().length},Yc.prototype.addIndicesForPlacedSymbol=function(t,e){for(var i=t.placedSymbolArray.get(e),r=i.vertexStartIndex+4*i.numGlyphs,n=i.vertexStartIndex;n<r;n+=4)t.indexArray.emplaceBack(n,n+1,n+2),t.indexArray.emplaceBack(n+1,n+2,n+3)},Yc.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var e=Math.sin(t),i=Math.cos(t),r=[],n=[],o=[],a=0;a<this.symbolInstances.length;++a){o.push(a);var s=this.symbolInstances.get(a);r.push(0|Math.round(e*s.anchorX+i*s.anchorY)),n.push(s.featureIndex)}return o.sort(function(t,e){return r[t]-r[e]||n[e]-n[t]}),o},Yc.prototype.addToSortKeyRanges=function(t,e){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===e?i.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})},Yc.prototype.sortFeatures=function(t){var r=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(1<this.text.segments.get().length||1<this.icon.segments.get().length)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var e=0,i=this.symbolInstanceIndexes;e<i.length;e+=1){var n=this.symbolInstances.get(i[e]);this.featureSortOrder.push(n.featureIndex),[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach(function(t,e,i){0<=t&&i.indexOf(t)===e&&r.addIndicesForPlacedSymbol(r.text,t)}),0<=n.verticalPlacedTextSymbolIndex&&this.addIndicesForPlacedSymbol(this.text,n.verticalPlacedTextSymbolIndex),0<=n.placedIconSymbolIndex&&this.addIndicesForPlacedSymbol(this.icon,n.placedIconSymbolIndex),0<=n.verticalPlacedIconSymbolIndex&&this.addIndicesForPlacedSymbol(this.icon,n.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},qr("SymbolBucket",Yc,{omit:["layers","collisionBoxArray","features","compareText"]}),Yc.MAX_GLYPHS=65535,Yc.addDynamicAttributes=Hc;var Qc=new Cn({"symbol-placement":new xn(Ot.layout_symbol["symbol-placement"]),"symbol-spacing":new xn(Ot.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new xn(Ot.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new bn(Ot.layout_symbol["symbol-sort-key"]),"symbol-z-order":new xn(Ot.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new xn(Ot.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new xn(Ot.layout_symbol["icon-ignore-placement"]),"icon-optional":new xn(Ot.layout_symbol["icon-optional"]),"icon-rotation-alignment":new xn(Ot.layout_symbol["icon-rotation-alignment"]),"icon-size":new bn(Ot.layout_symbol["icon-size"]),"icon-text-fit":new xn(Ot.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new xn(Ot.layout_symbol["icon-text-fit-padding"]),"icon-image":new bn(Ot.layout_symbol["icon-image"]),"icon-rotate":new bn(Ot.layout_symbol["icon-rotate"]),"icon-padding":new xn(Ot.layout_symbol["icon-padding"]),"icon-keep-upright":new xn(Ot.layout_symbol["icon-keep-upright"]),"icon-offset":new bn(Ot.layout_symbol["icon-offset"]),"icon-anchor":new bn(Ot.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new xn(Ot.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new xn(Ot.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new xn(Ot.layout_symbol["text-rotation-alignment"]),"text-field":new bn(Ot.layout_symbol["text-field"]),"text-font":new bn(Ot.layout_symbol["text-font"]),"text-size":new bn(Ot.layout_symbol["text-size"]),"text-max-width":new bn(Ot.layout_symbol["text-max-width"]),"text-line-height":new xn(Ot.layout_symbol["text-line-height"]),"text-letter-spacing":new bn(Ot.layout_symbol["text-letter-spacing"]),"text-justify":new bn(Ot.layout_symbol["text-justify"]),"text-radial-offset":new bn(Ot.layout_symbol["text-radial-offset"]),"text-variable-anchor":new xn(Ot.layout_symbol["text-variable-anchor"]),"text-anchor":new bn(Ot.layout_symbol["text-anchor"]),"text-max-angle":new xn(Ot.layout_symbol["text-max-angle"]),"text-writing-mode":new xn(Ot.layout_symbol["text-writing-mode"]),"text-rotate":new bn(Ot.layout_symbol["text-rotate"]),"text-padding":new xn(Ot.layout_symbol["text-padding"]),"text-keep-upright":new xn(Ot.layout_symbol["text-keep-upright"]),"text-transform":new bn(Ot.layout_symbol["text-transform"]),"text-offset":new bn(Ot.layout_symbol["text-offset"]),"text-allow-overlap":new xn(Ot.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new xn(Ot.layout_symbol["text-ignore-placement"]),"text-optional":new xn(Ot.layout_symbol["text-optional"])}),$c={paint:new Cn({"icon-opacity":new bn(Ot.paint_symbol["icon-opacity"]),"icon-color":new bn(Ot.paint_symbol["icon-color"]),"icon-halo-color":new bn(Ot.paint_symbol["icon-halo-color"]),"icon-halo-width":new bn(Ot.paint_symbol["icon-halo-width"]),"icon-halo-blur":new bn(Ot.paint_symbol["icon-halo-blur"]),"icon-translate":new xn(Ot.paint_symbol["icon-translate"]),"icon-translate-anchor":new xn(Ot.paint_symbol["icon-translate-anchor"]),"text-opacity":new bn(Ot.paint_symbol["text-opacity"]),"text-color":new bn(Ot.paint_symbol["text-color"],{runtimeType:Xt,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new bn(Ot.paint_symbol["text-halo-color"]),"text-halo-width":new bn(Ot.paint_symbol["text-halo-width"]),"text-halo-blur":new bn(Ot.paint_symbol["text-halo-blur"]),"text-translate":new xn(Ot.paint_symbol["text-translate"]),"text-translate-anchor":new xn(Ot.paint_symbol["text-translate-anchor"])}),layout:Qc};function tp(t,e,i,r){this.context=t,this.format=i,this.texture=t.gl.createTexture(),this.update(e,r)}Jc.prototype.evaluate=function(t){if(t.formattedSection){var e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},Jc.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},Jc.prototype.outputDefined=function(){return!1},Jc.prototype.serialize=function(){return null},qr("FormatSectionOverride",Jc,{omit:["defaultValue"]});var ep,ip,rp,np,op=(xp.__proto__=np=Mn,((xp.prototype=Object.create(np&&np.prototype)).constructor=xp).prototype.recalculate=function(t,e){if(np.prototype.recalculate.call(this,t,e),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var i=this.layout.get("text-writing-mode");if(i){for(var r=[],n=0,o=i;n<o.length;n+=1){var a=o[n];r.indexOf(a)<0&&r.push(a)}this.layout._values["text-writing-mode"]=r}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},xp.prototype.getValueAndResolveTokens=function(t,e,i,r){var n,o=this.layout.get(t).evaluate(e,{},i,r),a=this._unevaluatedLayout._values[t];return a.isDataDriven()||Yi(a.value)||!o?o:(n=e.properties,o.replace(/{([^{}]+)}/g,function(t,e){return e in n?String(n[e]):""}))},xp.prototype.createBucket=function(t){return new Yc(t)},xp.prototype.queryRadius=function(){return 0},xp.prototype.queryIntersectsFeature=function(){return!1},xp.prototype._setPaintOverrides=function(){for(var t=0,e=$c.paint.overridableProperties;t<e.length;t+=1){var i=e[t];if(xp.hasPaintOverride(this.layout,i)){var r,n=this.paint.get(i),o=new Jc(n),a=new Xi(o,n.property.specification);r="constant"===n.value.kind||"source"===n.value.kind?new Qi("source",a):new $i("composite",a,n.value.zoomStops,n.value._interpolationType),this.paint._values[i]=new vn(n.property,r,n.parameters)}}},xp.prototype._handleOverridablePaintPropertyUpdate=function(t,e,i){return!(!this.layout||e.isDataDriven()||i.isDataDriven())&&xp.hasPaintOverride(this.layout,t)},xp.hasPaintOverride=function(t,e){function i(t){for(var e=0,i=t;e<i.length;e+=1)if(n.overrides&&n.overrides.hasOverride(i[e]))return o=!0,0}var r=t.get("text-field"),n=$c.paint.properties[e],o=!1;if("constant"===r.value.kind&&r.value.value instanceof pe)i(r.value.value.sections);else if("source"===r.value.kind){var a=function(t){o||(t instanceof ye&&me(t.value)===$t?i(t.value.sections):t instanceof be?i(t.sections):t.eachChild(a))},s=r.value;s._styleExpression&&a(s._styleExpression.expression)}return o},xp),ap={paint:new Cn({"background-color":new xn(Ot.paint_background["background-color"]),"background-pattern":new wn(Ot.paint_background["background-pattern"]),"background-opacity":new xn(Ot.paint_background["background-opacity"])})},sp=(_p.__proto__=rp=Mn,(_p.prototype=Object.create(rp&&rp.prototype)).constructor=_p),lp={paint:new Cn({"raster-opacity":new xn(Ot.paint_raster["raster-opacity"]),"raster-hue-rotate":new xn(Ot.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new xn(Ot.paint_raster["raster-brightness-min"]),"raster-brightness-max":new xn(Ot.paint_raster["raster-brightness-max"]),"raster-saturation":new xn(Ot.paint_raster["raster-saturation"]),"raster-contrast":new xn(Ot.paint_raster["raster-contrast"]),"raster-resampling":new xn(Ot.paint_raster["raster-resampling"]),"raster-fade-duration":new xn(Ot.paint_raster["raster-fade-duration"])})},up=(vp.__proto__=ip=Mn,(vp.prototype=Object.create(ip&&ip.prototype)).constructor=vp),cp=(yp.__proto__=ep=Mn,((yp.prototype=Object.create(ep&&ep.prototype)).constructor=yp).prototype.is3D=function(){return"3d"===this.implementation.renderingMode},yp.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},yp.prototype.recalculate=function(){},yp.prototype.updateTransitions=function(){},yp.prototype.hasTransition=function(){},yp.prototype.serialize=function(){},yp.prototype.onAdd=function(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},yp.prototype.onRemove=function(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)},yp),pp={circle:Os,heatmap:Ys,hillshade:Qs,fill:Bl,"fill-extrusion":iu,line:yu,symbol:op,background:sp,raster:up},hp=p.HTMLImageElement,dp=p.HTMLCanvasElement,fp=p.HTMLVideoElement,mp=p.ImageData,gp=p.ImageBitmap;function yp(t){ep.call(this,t,{}),this.implementation=t}function vp(t){ip.call(this,t,lp)}function _p(t){rp.call(this,t,ap)}function xp(t){np.call(this,t,$c)}function bp(t){var e=this;this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){e._triggered=!1,e._callback()})}function wp(t,e,i){this.target=t,this.parent=e,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},m(["receive","process"],this),this.invoker=new bp(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=S()?t:p}function Sp(t,e,i){var r=2*Math.PI*6378137/256/Math.pow(2,i);return[t*r-2*Math.PI*6378137/2,e*r-2*Math.PI*6378137/2]}function Tp(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}tp.prototype.update=function(t,e,i){var r=t.width,n=t.height,o=!(this.size&&this.size[0]===r&&this.size[1]===n||i),a=this.context,s=a.gl;if(this.useMipmap=Boolean(e&&e.useMipmap),s.bindTexture(s.TEXTURE_2D,this.texture),a.pixelStoreUnpackFlipY.set(!1),a.pixelStoreUnpack.set(1),a.pixelStoreUnpackPremultiplyAlpha.set(this.format===s.RGBA&&(!e||!1!==e.premultiply)),o)this.size=[r,n],t instanceof hp||t instanceof dp||t instanceof fp||t instanceof mp||gp&&t instanceof gp?s.texImage2D(s.TEXTURE_2D,0,this.format,this.format,s.UNSIGNED_BYTE,t):s.texImage2D(s.TEXTURE_2D,0,this.format,r,n,0,this.format,s.UNSIGNED_BYTE,t.data);else{var l=i||{x:0,y:0},u=l.x,c=l.y;t instanceof hp||t instanceof dp||t instanceof fp||t instanceof mp||gp&&t instanceof gp?s.texSubImage2D(s.TEXTURE_2D,0,u,c,s.RGBA,s.UNSIGNED_BYTE,t):s.texSubImage2D(s.TEXTURE_2D,0,u,c,r,n,s.RGBA,s.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&s.generateMipmap(s.TEXTURE_2D)},tp.prototype.bind=function(t,e,i){var r=this.context.gl;r.bindTexture(r.TEXTURE_2D,this.texture),i!==r.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=r.LINEAR),t!==this.filter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,i||t),this.filter=t),e!==this.wrap&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,e),this.wrap=e)},tp.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},tp.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null},bp.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){t._triggered=!1,t._callback()},0))},bp.prototype.remove=function(){delete this._channel,this._callback=function(){}},wp.prototype.send=function(t,e,i,r,n){var o=this;void 0===n&&(n=!1);var a=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[a]=i);var s=E(this.globalScope)?void 0:[];return this.target.postMessage({id:a,type:t,hasCallback:!!i,targetMapId:r,mustQueue:n,sourceMapId:this.mapId,data:Hr(e,s)},s),{cancel:function(){i&&delete o.callbacks[a],o.target.postMessage({id:a,type:"<cancel>",targetMapId:r,sourceMapId:o.mapId})}}},wp.prototype.receive=function(t){var e=t.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){delete this.tasks[i];var r=this.cancelCallbacks[i];delete this.cancelCallbacks[i],r&&r()}else S()||e.mustQueue?(this.tasks[i]=e,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,e)},wp.prototype.process=function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(t,e)}},wp.prototype.processTask=function(i,t){var r=this;if("<response>"===t.type){var e=this.callbacks[i];delete this.callbacks[i],e&&(t.error?e(Wr(t.error)):e(null,Wr(t.data)))}else{var n=!1,o=E(this.globalScope)?void 0:[],a=t.hasCallback?function(t,e){n=!0,delete r.cancelCallbacks[i],r.target.postMessage({id:i,type:"<response>",sourceMapId:r.mapId,error:t?Hr(t):null,data:Hr(e,o)},o)}:function(t){n=!0},s=null,l=Wr(t.data);if(this.parent[t.type])s=this.parent[t.type](t.sourceMapId,l,a);else if(this.parent.getWorkerSource){var u=t.type.split(".");s=this.parent.getWorkerSource(t.sourceMapId,u[0],l.source)[u[1]](l,a)}else a(new Error("Could not find function "+t.type));!n&&s&&s.cancel&&(this.cancelCallbacks[i]=s.cancel)}},wp.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)},Tp.prototype.setNorthEast=function(t){return this._ne=t instanceof Ip?new Ip(t.lng,t.lat):Ip.convert(t),this},Tp.prototype.setSouthWest=function(t){return this._sw=t instanceof Ip?new Ip(t.lng,t.lat):Ip.convert(t),this},Tp.prototype.extend=function(t){var e,i,r=this._sw,n=this._ne;if(t instanceof Ip)i=e=t;else{if(!(t instanceof Tp))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(Tp.convert(t)):this.extend(Ip.convert(t)):this;if(i=t._ne,!(e=t._sw)||!i)return this}return r||n?(r.lng=Math.min(e.lng,r.lng),r.lat=Math.min(e.lat,r.lat),n.lng=Math.max(i.lng,n.lng),n.lat=Math.max(i.lat,n.lat)):(this._sw=new Ip(e.lng,e.lat),this._ne=new Ip(i.lng,i.lat)),this},Tp.prototype.getCenter=function(){return new Ip((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Tp.prototype.getSouthWest=function(){return this._sw},Tp.prototype.getNorthEast=function(){return this._ne},Tp.prototype.getNorthWest=function(){return new Ip(this.getWest(),this.getNorth())},Tp.prototype.getSouthEast=function(){return new Ip(this.getEast(),this.getSouth())},Tp.prototype.getWest=function(){return this._sw.lng},Tp.prototype.getSouth=function(){return this._sw.lat},Tp.prototype.getEast=function(){return this._ne.lng},Tp.prototype.getNorth=function(){return this._ne.lat},Tp.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Tp.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Tp.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Tp.prototype.contains=function(t){var e=Ip.convert(t),i=e.lng,r=e.lat,n=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(n=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=r&&r<=this._ne.lat&&n},Tp.convert=function(t){return!t||t instanceof Tp?t:new Tp(t)};var Ip=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,90<this.lat||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Ip.prototype.wrap=function(){return new Ip(s(this.lng,-180,180),this.lat)},Ip.prototype.toArray=function(){return[this.lng,this.lat]},Ip.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Ip.prototype.distanceTo=function(t){var e=Math.PI/180,i=this.lat*e,r=t.lat*e,n=Math.sin(i)*Math.sin(r)+Math.cos(i)*Math.cos(r)*Math.cos((t.lng-this.lng)*e);return 6371008.8*Math.acos(Math.min(n,1))},Ip.prototype.toBounds=function(t){void 0===t&&(t=0);var e=360*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return new Tp(new Ip(this.lng-i,this.lat-e),new Ip(this.lng+i,this.lat+e))},Ip.convert=function(t){if(t instanceof Ip)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new Ip(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new Ip(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Ep=2*Math.PI*6371008.8;function Cp(t){return Ep*Math.cos(t*Math.PI/180)}function Ap(t){return(180+t)/360}function kp(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Pp(t,e){return t/Cp(e)}function Mp(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Lp(t,e,i){void 0===i&&(i=0),this.x=+t,this.y=+e,this.z=+i}function Dp(t,e,i){this.z=t,this.x=e,this.y=i,this.key=Rp(0,t,t,e,i)}function zp(t,e){this.wrap=t,this.canonical=e,this.key=Rp(t,e.z,e.z,e.x,e.y)}function Op(t,e,i,r,n){this.overscaledZ=t,this.wrap=e,this.canonical=new Dp(i,+r,+n),this.key=Rp(e,t,i,r,n)}function Rp(t,e,i,r,n){(t*=2)<0&&(t=-1*t-1);var o=1<<i;return(o*o*t+o*n+r).toString(36)+i.toString(36)+e.toString(36)}function Np(t,e,i){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(i&&"mapbox"!==i&&"terrarium"!==i)return pt('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=e.height;var r=this.dim=e.height-2;this.data=new Uint32Array(e.data.buffer),this.encoding=i||"mapbox";for(var n=0;n<r;n++)this.data[this._idx(-1,n)]=this.data[this._idx(0,n)],this.data[this._idx(r,n)]=this.data[this._idx(r-1,n)],this.data[this._idx(n,-1)]=this.data[this._idx(n,0)],this.data[this._idx(n,r)]=this.data[this._idx(n,r-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(r,-1)]=this.data[this._idx(r-1,0)],this.data[this._idx(-1,r)]=this.data[this._idx(0,r-1)],this.data[this._idx(r,r)]=this.data[this._idx(r-1,r-1)]}function Bp(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var i=t[e];this._stringToNumber[i]=e,this._numberToString[e]=i}}function Fp(t,e,i,r,n){this.type="Feature",(this._vectorTileFeature=t)._z=e,t._x=i,t._y=r,this.properties=t.properties,this.id=n}Lp.fromLngLat=function(t,e){void 0===e&&(e=0);var i=Ip.convert(t);return new Lp(Ap(i.lng),kp(i.lat),Pp(e,i.lat))},Lp.prototype.toLngLat=function(){return new Ip(360*this.x-180,Mp(this.y))},Lp.prototype.toAltitude=function(){return this.z*Cp(Mp(this.y))},Lp.prototype.meterInMercatorCoordinateUnits=function(){return 1/Ep*(t=Mp(this.y),1/Math.cos(t*Math.PI/180));var t},Dp.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},Dp.prototype.url=function(t,e){var i,r,n,o,a,s=(r=this.y,n=this.z,o=Sp(256*(i=this.x),256*(r=Math.pow(2,n)-r-1),n),a=Sp(256*(i+1),256*(r+1),n),o[0]+","+o[1]+","+a[0]+","+a[1]),l=function(t,e,i){for(var r,n="",o=t;0<o;o--)n+=(e&(r=1<<o-1)?1:0)+(i&r?2:0);return n}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",l).replace("{bbox-epsg-3857}",s)},Dp.prototype.getTilePoint=function(t){var e=Math.pow(2,this.z);return new G(8192*(t.x*e-this.x),8192*(t.y*e-this.y))},Dp.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y},Op.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},Op.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new Op(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Op(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},Op.prototype.calculateScaledKey=function(t,e){var i=this.canonical.z-t;return t>this.canonical.z?Rp(this.wrap*e,t,this.canonical.z,this.canonical.x,this.canonical.y):Rp(this.wrap*e,t,t,this.canonical.x>>i,this.canonical.y>>i)},Op.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},Op.prototype.children=function(t){if(this.overscaledZ>=t)return[new Op(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,i=2*this.canonical.x,r=2*this.canonical.y;return[new Op(e,this.wrap,e,i,r),new Op(e,this.wrap,e,1+i,r),new Op(e,this.wrap,e,i,1+r),new Op(e,this.wrap,e,1+i,1+r)]},Op.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},Op.prototype.wrapped=function(){return new Op(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Op.prototype.unwrapTo=function(t){return new Op(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},Op.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Op.prototype.toUnwrapped=function(){return new zp(this.wrap,this.canonical)},Op.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Op.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new Lp(t.x-this.wrap,t.y))},qr("CanonicalTileID",Dp),qr("OverscaledTileID",Op,{omit:["posMatrix"]}),Np.prototype.get=function(t,e){var i=new Uint8Array(this.data.buffer),r=4*this._idx(t,e);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(i[r],i[1+r],i[2+r])},Np.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Np.prototype._idx=function(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)},Np.prototype._unpackMapbox=function(t,e,i){return(256*t*256+256*e+i)/10-1e4},Np.prototype._unpackTerrarium=function(t,e,i){return 256*t+e+i/256-32768},Np.prototype.getPixels=function(){return new Zs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Np.prototype.backfillBorder=function(t,e,i){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var r=e*this.dim,n=e*this.dim+this.dim,o=i*this.dim,a=i*this.dim+this.dim;switch(e){case-1:r=n-1;break;case 1:n=r+1}switch(i){case-1:o=a-1;break;case 1:a=o+1}for(var s=-e*this.dim,l=-i*this.dim,u=o;u<a;u++)for(var c=r;c<n;c++)this.data[this._idx(c,u)]=t.data[this._idx(c+s,u+l)]},qr("DEMData",Np),Bp.prototype.encode=function(t){return this._stringToNumber[t]},Bp.prototype.decode=function(t){return this._numberToString[t]};var Up={geometry:{configurable:!0}};function jp(){this.state={},this.stateChanges={},this.deletedStates={}}function qp(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Nr(8192,16,0),this.grid3D=new Nr(8192,16,0),this.featureIndexArray=new ma,this.promoteId=e}function Vp(t,r,n,o,a){return y(t,function(t,e){var i=r instanceof _n?r.get(e):null;return i&&i.evaluate?i.evaluate(n,o,a):i})}function Gp(t){for(var e=1/0,i=1/0,r=-1/0,n=-1/0,o=0,a=t;o<a.length;o+=1){var s=a[o];e=Math.min(e,s.x),i=Math.min(i,s.y),r=Math.max(r,s.x),n=Math.max(n,s.y)}return{minX:e,minY:i,maxX:r,maxY:n}}function Zp(t,e){return e-t}function Hp(t,e){this.tileID=t,this.uid=c(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"}function Wp(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},Kp.mark(this._marks.start)}Up.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Up.geometry.set=function(t){this._geometry=t},Fp.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t},Object.defineProperties(Fp.prototype,Up),jp.prototype.updateState=function(t,e,i){var r=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][r]=this.stateChanges[t][r]||{},d(this.stateChanges[t][r],i),null===this.deletedStates[t])for(var n in this.deletedStates[t]={},this.state[t])n!==r&&(this.deletedStates[t][n]=null);else if(this.deletedStates[t]&&null===this.deletedStates[t][r])for(var o in this.deletedStates[t][r]={},this.state[t][r])i[o]||(this.deletedStates[t][r][o]=null);else for(var a in i)this.deletedStates[t]&&this.deletedStates[t][r]&&null===this.deletedStates[t][r][a]&&delete this.deletedStates[t][r][a]},jp.prototype.removeFeatureState=function(t,e,i){if(null!==this.deletedStates[t]){var r=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},i&&void 0!==e)null!==this.deletedStates[t][r]&&(this.deletedStates[t][r]=this.deletedStates[t][r]||{},this.deletedStates[t][r][i]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][r])for(i in this.deletedStates[t][r]={},this.stateChanges[t][r])this.deletedStates[t][r][i]=null;else this.deletedStates[t][r]=null;else this.deletedStates[t]=null}},jp.prototype.getState=function(t,e){var i=String(e),r=d({},(this.state[t]||{})[i],(this.stateChanges[t]||{})[i]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){var n=this.deletedStates[t][e];if(null===n)return{};for(var o in n)delete r[o]}return r},jp.prototype.initializeTileState=function(t,e){t.setFeatureState(this.state,e)},jp.prototype.coalesceChanges=function(t,e){var i={};for(var r in this.stateChanges){this.state[r]=this.state[r]||{};var n={};for(var o in this.stateChanges[r])this.state[r][o]||(this.state[r][o]={}),d(this.state[r][o],this.stateChanges[r][o]),n[o]=this.state[r][o];i[r]=n}for(var a in this.deletedStates){this.state[a]=this.state[a]||{};var s={};if(null===this.deletedStates[a])for(var l in this.state[a])s[l]={},this.state[a][l]={};else for(var u in this.deletedStates[a]){if(null===this.deletedStates[a][u])this.state[a][u]={};else for(var c=0,p=Object.keys(this.deletedStates[a][u]);c<p.length;c+=1)delete this.state[a][u][p[c]];s[u]=this.state[a][u]}i[a]=i[a]||{},d(i[a],s)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(i).length)for(var h in t)t[h].setFeatureState(i,e)},qp.prototype.insert=function(t,e,i,r,n,o){var a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,r,n);for(var s=o?this.grid3D:this.grid,l=0;l<e.length;l++){for(var u=e[l],c=[1/0,1/0,-1/0,-1/0],p=0;p<u.length;p++){var h=u[p];c[0]=Math.min(c[0],h.x),c[1]=Math.min(c[1],h.y),c[2]=Math.max(c[2],h.x),c[3]=Math.max(c[3],h.y)}c[0]<8192&&c[1]<8192&&0<=c[2]&&0<=c[3]&&s.insert(a,c[0],c[1],c[2],c[3])}},qp.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Xl.VectorTile(new ku(this.rawTileData)).layers,this.sourceLayerCoder=new Bp(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},qp.prototype.query=function(n,o,a,s){var l=this;this.loadVTLayers();for(var u=n.params||{},c=8192/n.tileSize/n.scale,p=cr(u.filter),h=n.queryGeometry,d=n.queryPadding*c,t=Gp(h),f=this.grid.query(t.minX-d,t.minY-d,t.maxX+d,t.maxY+d),e=Gp(n.cameraQueryGeometry),i=0,r=this.grid3D.query(e.minX-d,e.minY-d,e.maxX+d,e.maxY+d,function(t,e,i,r){return function(t,e,i,r,n){for(var o=0,a=t;o<a.length;o+=1){var s=a[o];if(e<=s.x&&i<=s.y&&r>=s.x&&n>=s.y)return!0}var l=[new G(e,i),new G(e,n),new G(r,n),new G(r,i)];if(2<t.length)for(var u=0,c=l;u<c.length;u+=1)if(_s(t,c[u]))return!0;for(var p=0;p<t.length-1;p++)if(xs(t[p],t[p+1],l))return!0;return!1}(n.cameraQueryGeometry,t-d,e-d,i+d,r+d)});i<r.length;i+=1)f.push(r[i]);f.sort(Zp);for(var m,g={},y=function(t){var e=f[t];if(e!==m){m=e;var i=l.featureIndexArray.get(e),r=null;l.loadMatchingFeature(g,i.bucketIndex,i.sourceLayerIndex,i.featureIndex,p,u.layers,u.availableImages,o,a,s,function(t,e,i){return r=r||us(t),e.queryIntersectsFeature(h,t,i,r,l.z,n.transform,c,n.pixelPosMatrix)})}},v=0;v<f.length;v++)y(v);return g},qp.prototype.loadMatchingFeature=function(t,e,i,r,n,o,a,s,l,u,c){var p=this.bucketLayerIDs[e];if(!o||function(t,e){for(var i=0;i<t.length;i++)if(0<=e.indexOf(t[i]))return 1}(o,p)){var h=this.sourceLayerCoder.decode(i),d=this.vtLayers[h].feature(r);if(n.filter(new un(this.tileID.overscaledZ),d))for(var f=this.getId(d,h),m=0;m<p.length;m++){var g=p[m];if(!(o&&o.indexOf(g)<0)){var y=s[g];if(y){var v={};void 0!==f&&u&&(v=u.getState(y.sourceLayer||"_geojsonTileLayer",f));var _=l[g];_.paint=Vp(_.paint,y.paint,d,v,a),_.layout=Vp(_.layout,y.layout,d,v,a);var x=!c||c(d,y,v);if(x){var b=new Fp(d,this.z,this.x,this.y,f);b.layer=_;var w=t[g];void 0===w&&(w=t[g]=[]),w.push({featureIndex:r,feature:b,intersectionZ:x})}}}}}},qp.prototype.lookupSymbolFeatures=function(t,e,i,r,n,o,a,s){var l={};this.loadVTLayers();for(var u=cr(n),c=0,p=t;c<p.length;c+=1)this.loadMatchingFeature(l,i,r,p[c],u,o,a,s,e);return l},qp.prototype.hasLayer=function(t){for(var e=0,i=this.bucketLayerIDs;e<i.length;e+=1)for(var r=0,n=i[e];r<n.length;r+=1)if(t===n[r])return!0;return!1},qp.prototype.getId=function(t,e){var i=t.id;return this.promoteId&&"boolean"==typeof(i=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]])&&(i=Number(i)),i},qr("FeatureIndex",qp,{omit:["rawTileData","sourceLayerCoder"]}),Hp.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<O.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},Hp.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},Hp.prototype.loadVectorData=function(t,e,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var r in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,n){var o={};if(!n)return o;for(var e=function(){var t=s[a],i=t.layerIds.map(function(t){return n.getLayer(t)}).filter(Boolean);if(0!==i.length){t.layers=i,t.stateDependentLayerIds&&(t.stateDependentLayers=t.stateDependentLayerIds.map(function(e){return i.filter(function(t){return t.id===e})[0]}));for(var e=0,r=i;e<r.length;e+=1)o[r[e].id]=t}},a=0,s=t;a<s.length;a+=1)e();return o}(t.buckets,e.style),this.hasSymbolBuckets=!1,this.buckets){var n=this.buckets[r];if(n instanceof Yc){if(this.hasSymbolBuckets=!0,!i)break;n.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var o in this.buckets){var a=this.buckets[o];if(a instanceof Yc&&a.hasRTLText){this.hasRTLText=!0,pn.isLoading()||pn.isLoaded()||"deferred"!==sn()||ln();break}}for(var s in this.queryPadding=0,this.buckets){var l=this.buckets[s];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(s).queryRadius(l))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new Jo},Hp.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Hp.prototype.getBucket=function(t){return this.buckets[t.id]},Hp.prototype.upload=function(t){for(var e in this.buckets){var i=this.buckets[e];i.uploadPending()&&i.upload(t)}var r=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new tp(t,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new tp(t,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)},Hp.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},Hp.prototype.queryRenderedFeatures=function(t,e,i,r,n,o,a,s,l,u){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:r,cameraQueryGeometry:n,scale:o,tileSize:this.tileSize,pixelPosMatrix:u,transform:s,params:a,queryPadding:this.queryPadding*l},t,e,i):{}},Hp.prototype.querySourceFeatures=function(t,e){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var r=i.loadVTLayers(),n=e?e.sourceLayer:"",o=r._geojsonTileLayer||r[n];if(o)for(var a=cr(e&&e.filter),s=this.tileID.canonical,l=s.z,u=s.x,c=s.y,p={z:l,x:u,y:c},h=0;h<o.length;h++){var d=o.feature(h);if(a.filter(new un(this.tileID.overscaledZ),d)){var f=i.getId(d,n),m=new Fp(d,l,u,c,f);m.tile=p,t.push(m)}}}},Hp.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},Hp.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Hp.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var i=T(t.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var r=Date.now(),n=!1;if(this.expirationTime>r)n=!1;else if(e)if(this.expirationTime<e)n=!0;else{var o=this.expirationTime-e;o?this.expirationTime=r+Math.max(o,3e4):n=!0}else n=!0;n?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Hp.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},Hp.prototype.setFeatureState=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var i=this.latestFeatureIndex.loadVTLayers();for(var r in this.buckets)if(e.style.hasLayer(r)){var n=this.buckets[r],o=n.layers[0].sourceLayer||"_geojsonTileLayer",a=i[o],s=t[o];if(a&&s&&0!==Object.keys(s).length){n.update(s,a,this.imageAtlas&&this.imageAtlas.patternPositions||{});var l=e&&e.style&&e.style.getLayer(r);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(n)))}}}},Hp.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},Hp.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<O.now()},Hp.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Hp.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=O.now()+t},Hp.prototype.setDependencies=function(t,e){for(var i={},r=0,n=e;r<n.length;r+=1)i[n[r]]=!0;this.dependencies[t]=i},Hp.prototype.hasDependency=function(t,e){for(var i=0,r=t;i<r.length;i+=1){var n=this.dependencies[r[i]];if(n)for(var o=0,a=e;o<a.length;o+=1)if(n[a[o]])return!0}return!1};var Kp=p.performance;Wp.prototype.finish=function(){Kp.mark(this._marks.end);var t=Kp.getEntriesByName(this._marks.measure);return 0===t.length&&(Kp.measure(this._marks.measure,this._marks.start,this._marks.end),t=Kp.getEntriesByName(this._marks.measure),Kp.clearMarks(this._marks.start),Kp.clearMarks(this._marks.end),Kp.clearMeasures(this._marks.measure)),t},t.Actor=wp,t.AlphaImage=Gs,t.CanonicalTileID=Dp,t.CollisionBoxArray=Jo,t.Color=le,t.DEMData=Np,t.DataConstantProperty=xn,t.DictionaryCoder=Bp,t.EXTENT=8192,t.ErrorEvent=Dt,t.EvaluationParameters=un,t.Event=Pt,t.Evented=Mt,t.FeatureIndex=qp,t.FillBucket=zl,t.FillExtrusionBucket=$l,t.ImageAtlas=$u,t.ImagePosition=Ju,t.LineBucket=au,t.LngLat=Ip,t.LngLatBounds=Tp,t.MercatorCoordinate=Lp,t.ONE_EM=24,t.OverscaledTileID=Op,t.Point=G,t.Point$1=G,t.Properties=Cn,t.Protobuf=ku,t.RGBAImage=Zs,t.RequestManager=j,t.RequestPerformance=Wp,t.ResourceType=yt,t.SegmentVector=ya,t.SourceFeatureState=jp,t.StructArrayLayout1ui2=jo,t.StructArrayLayout2f1f2i16=fo,t.StructArrayLayout2i4=Nn,t.StructArrayLayout3ui6=xo,t.StructArrayLayout4i8=Un,t.SymbolBucket=Yc,t.Texture=tp,t.Tile=Hp,t.Transitionable=fn,t.Uniform1f=Ba,t.Uniform1i=Na,t.Uniform2f=Fa,t.Uniform3f=Ua,t.Uniform4f=ja,t.UniformColor=qa,t.UniformMatrix4f=Ga,t.UnwrappedTileID=zp,t.ValidationError=Rt,t.WritingMode=ec,t.ZoomHistory=Kr,t.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t},t.addDynamicAttributes=Hc,t.asyncAll=function(t,e,r){if(!t.length)return r(null,[]);var n=t.length,o=new Array(t.length),a=null;t.forEach(function(t,i){e(t,function(t,e){t&&(a=t),o[i]=e,0==--n&&r(a,o)})})},t.bezier=n,t.bindAll=m,t.browser=O,t.cacheEntryPossiblyAdded=function(t){++mt>lt&&(t.getActor().send("enforceCacheSizeLimit",st),mt=0)},t.clamp=u,t.clearTileCache=function(t){var e=p.caches.delete("mapbox-tiles");t&&e.catch(t).then(function(){return t()})},t.clipLine=Ic,t.clone=function(t){var e=new Es(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.clone$1=_,t.clone$2=function(t){var e=new Es(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.collisionCircleLayout=Tu,t.config=R,t.create=function(){var t=new Es(16);return Es!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.create$1=function(){var t=new Es(9);return Es!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},t.create$2=function(){var t=new Es(4);return Es!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},t.createCommonjsModule=e,t.createExpression=Ji,t.createLayout=zn,t.createStyleLayer=function(t){return"custom"===t.type?new cp(t):new pp[t.type](t)},t.cross=function(t,e,i){var r=e[0],n=e[1],o=e[2],a=i[0],s=i[1],l=i[2];return t[0]=n*l-o*s,t[1]=o*a-r*l,t[2]=r*s-n*a,t},t.deepEqual=function t(e,i){if(Array.isArray(e)){if(!Array.isArray(i)||e.length!==i.length)return!1;for(var r=0;r<e.length;r++)if(!t(e[r],i[r]))return!1;return!0}if("object"!=typeof e||null===e||null===i)return e===i;if("object"!=typeof i)return!1;if(Object.keys(e).length!==Object.keys(i).length)return!1;for(var n in e)if(!t(e[n],i[n]))return!1;return!0},t.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},t.dot$1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},t.ease=o,t.emitValidationErrors=Rr,t.endsWith=g,t.enforceCacheSizeLimit=function(r){ht(),Q&&Q.then(function(i){i.keys().then(function(t){for(var e=0;e<t.length-r;e++)i.delete(t[e])})})},t.evaluateSizeForFeature=yc,t.evaluateSizeForZoom=vc,t.evaluateVariableOffset=Bc,t.evented=cn,t.extend=d,t.featureFilter=cr,t.filterObject=v,t.fromRotation=function(t,e){var i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=i,t[2]=0,t[3]=-i,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.getAnchorAlignment=cc,t.getAnchorJustification=Fc,t.getArrayBuffer=St,t.getImage=Ct,t.getJSON=function(t,e){return wt(d(t,{type:"json"}),e)},t.getRTLTextPluginStatus=sn,t.getReferrer=xt,t.getVideo=function(t,e){var i,r,n=p.document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(var o=0;o<t.length;o++){var a=p.document.createElement("source");i=t[o],r=void 0,(r=p.document.createElement("a")).href=i,r.protocol===p.document.location.protocol&&r.host===p.document.location.host||(n.crossOrigin="Anonymous"),a.src=t[o],n.appendChild(a)}return{cancel:function(){}}},t.identity=Cs,t.invert=function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=e[9],h=e[10],d=e[11],f=e[12],m=e[13],g=e[14],y=e[15],v=i*s-r*a,_=i*l-n*a,x=i*u-o*a,b=r*l-n*s,w=r*u-o*s,S=n*u-o*l,T=c*m-p*f,I=c*g-h*f,E=c*y-d*f,C=p*g-h*m,A=p*y-d*m,k=h*y-d*g,P=v*k-_*A+x*C+b*E-w*I+S*T;return P?(t[0]=(s*k-l*A+u*C)*(P=1/P),t[1]=(n*A-r*k-o*C)*P,t[2]=(m*S-g*w+y*b)*P,t[3]=(h*w-p*S-d*b)*P,t[4]=(l*E-a*k-u*I)*P,t[5]=(i*k-n*E+o*I)*P,t[6]=(g*x-f*S-y*_)*P,t[7]=(c*S-h*x+d*_)*P,t[8]=(a*A-s*E+u*T)*P,t[9]=(r*E-i*A-o*T)*P,t[10]=(f*w-m*x+y*v)*P,t[11]=(p*x-c*w-d*v)*P,t[12]=(s*I-a*C-l*T)*P,t[13]=(i*C-r*I+n*T)*P,t[14]=(m*_-f*b-g*v)*P,t[15]=(c*b-p*_+h*v)*P,t):null},t.isChar=Xr,t.isMapboxURL=V,t.keysDifference=function(t,e){var i=[];for(var r in t)r in e||i.push(r);return i},t.makeRequest=wt,t.mapObject=y,t.mercatorXfromLng=Ap,t.mercatorYfromLat=kp,t.mercatorZfromAltitude=Pp,t.mul=Ms,t.multiply=As,t.mvt=Xl,t.normalize=function(t,e){var i=e[0],r=e[1],n=e[2],o=i*i+r*r+n*n;return 0<o&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t},t.number=Ye,t.offscreenCanvasSupported=gt,t.ortho=function(t,e,i,r,n,o,a){var s=1/(e-i),l=1/(r-n),u=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+i)*s,t[13]=(n+r)*l,t[14]=(a+o)*u,t[15]=1,t},t.parseGlyphPBF=function(t){return new ku(t).readFields(Wu,[])},t.pbf=ku,t.performSymbolLayout=function(D,z,O,R,N,t,B){D.createArrays(),D.tilePixelRatio=8192/(512*D.overscaling),D.compareText={},D.iconsNeedLinear=!1;var F=D.layers[0].layout,e=D.layers[0]._unevaluatedLayout._values,U={};if("composite"===D.textSizeData.kind){var i=D.textSizeData,r=i.maxZoom;U.compositeTextSizes=[e["text-size"].possiblyEvaluate(new un(i.minZoom),B),e["text-size"].possiblyEvaluate(new un(r),B)]}if("composite"===D.iconSizeData.kind){var n=D.iconSizeData,o=n.maxZoom;U.compositeIconSizes=[e["icon-size"].possiblyEvaluate(new un(n.minZoom),B),e["icon-size"].possiblyEvaluate(new un(o),B)]}U.layoutTextSize=e["text-size"].possiblyEvaluate(new un(D.zoom+1),B),U.layoutIconSize=e["icon-size"].possiblyEvaluate(new un(D.zoom+1),B),U.textMaxSize=e["text-size"].possiblyEvaluate(new un(18));for(var j=24*F.get("text-line-height"),q="map"===F.get("text-rotation-alignment")&&"point"!==F.get("symbol-placement"),V=F.get("text-keep-upright"),G=F.get("text-size"),a=function(){var t=H[Z],e=F.get("text-font").evaluate(t,{},B).join(","),i=G.evaluate(t,{},B),r=U.layoutTextSize.evaluate(t,{},B),n=U.layoutIconSize.evaluate(t,{},B),o={horizontal:{},vertical:void 0},a=t.text,s=[0,0];if(a){var l=a.toString(),u=24*F.get("text-letter-spacing").evaluate(t,{},B),c=function(){for(var t=0,e=l;t<e.length;t+=1)if(i=e[t].charCodeAt(0),Xr.Arabic(i)||Xr["Arabic Supplement"](i)||Xr["Arabic Extended-A"](i)||Xr["Arabic Presentation Forms-A"](i)||Xr["Arabic Presentation Forms-B"](i))return;var i;return 1}()?u:0,p=F.get("text-anchor").evaluate(t,{},B),h=F.get("text-variable-anchor");if(!h){var d=F.get("text-radial-offset").evaluate(t,{},B);s=d?Bc(p,[24*d,Nc]):F.get("text-offset").evaluate(t,{},B).map(function(t){return 24*t})}var f=q?"center":F.get("text-justify").evaluate(t,{},B),m=F.get("symbol-placement"),g="point"===m?24*F.get("text-max-width").evaluate(t,{},B):0,y=function(){D.allowVerticalPlacement&&Yr(l)&&(o.vertical=rc(a,z,O,N,e,g,j,p,"left",c,s,ec.vertical,!0,m,r,i))};if(!q&&h){for(var v="auto"===f?h.map(function(t){return Fc(t)}):[f],_=!1,x=0;x<v.length;x++){var b=v[x];if(!o.horizontal[b])if(_)o.horizontal[b]=o.horizontal[0];else{var w=rc(a,z,O,N,e,g,j,"center",b,c,s,ec.horizontal,!1,m,r,i);w&&(_=1===(o.horizontal[b]=w).positionedLines.length)}}y()}else{"auto"===f&&(f=Fc(p));var S=rc(a,z,O,N,e,g,j,p,f,c,s,ec.horizontal,!1,m,r,i);S&&(o.horizontal[f]=S),y(),Yr(l)&&q&&V&&(o.vertical=rc(a,z,O,N,e,g,j,p,f,c,s,ec.vertical,!1,m,r,i))}}var T,I,E,C,A,k=void 0,P=!1;if(t.icon&&t.icon.name){var M=R[t.icon.name];M&&(T=N[t.icon.name],I=F.get("icon-offset").evaluate(t,{},B),E=cc(F.get("icon-anchor").evaluate(t,{},B)),C=I[0]-T.displaySize[0]*E.horizontalAlign,A=I[1]-T.displaySize[1]*E.verticalAlign,k={image:T,top:A,bottom:A+T.displaySize[1],left:C,right:C+T.displaySize[0]},P=M.sdf,void 0===D.sdfIcons?D.sdfIcons=M.sdf:D.sdfIcons!==M.sdf&&pt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),M.pixelRatio===D.pixelRatio&&0===F.get("icon-rotate").constantOr(1)||(D.iconsNeedLinear=!0))}var L=jc(o.horizontal)||o.vertical;D.iconsInText=!!L&&L.iconsInText,(L||k)&&function(i,r,n,o,a,s,l,t,u,c,p){var e=s.textMaxSize.evaluate(r,{});void 0===e&&(e=l);var h,d,f,m,g,y,v,_,x,b,w,S,T,I,E=i.layers[0].layout,C=E.get("icon-offset").evaluate(r,{},p),A=jc(n.horizontal),k=l/24,P=i.tilePixelRatio*k,M=i.tilePixelRatio*e/24,L=i.tilePixelRatio*t,D=i.tilePixelRatio*E.get("symbol-spacing"),z=E.get("text-padding")*i.tilePixelRatio,O=E.get("icon-padding")*i.tilePixelRatio,R=E.get("text-max-angle")/180*Math.PI,N="map"===E.get("text-rotation-alignment")&&"point"!==E.get("symbol-placement"),B="map"===E.get("icon-rotation-alignment")&&"point"!==E.get("symbol-placement"),F=E.get("symbol-placement"),U=D/2,j=E.get("icon-text-fit");function q(t,e){e.x<0||8192<=e.x||e.y<0||8192<=e.y||function(t,e,i,r,n,o,a,s,l,u,c,p,h,d,f,m,g,y,v,_,x,b,w,S,T){var I,E,C,A,k,P=t.addToLineVertexArray(e,i),M=0,L=0,D=0,z=0,O=-1,R=-1,N={},B=Sa(""),F=0,U=0;if(U=void 0===s._unevaluatedLayout.getValue("text-radial-offset")?(F=(I=s.layout.get("text-offset").evaluate(x,{},S).map(function(t){return 24*t}))[0],I[1]):(F=24*s.layout.get("text-radial-offset").evaluate(x,{},S),Nc),t.allowVerticalPlacement&&r.vertical){var j=s.layout.get("text-rotate").evaluate(x,{},S)+90;A=new Mc(l,e,u,c,p,r.vertical,h,d,f,j),a&&(k=new Mc(l,e,u,c,p,a,g,y,f,j))}if(n){var q=s.layout.get("icon-rotate").evaluate(x,{}),V="none"!==s.layout.get("icon-text-fit"),G=Ec(n,q,w,V),Z=a?Ec(a,q,w,V):void 0;C=new Mc(l,e,u,c,p,n,g,y,!1,q),M=4*G.length;var H=t.iconSizeData,W=null;"source"===H.kind?32640<(W=[128*s.layout.get("icon-size").evaluate(x,{})])[0]&&pt(t.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===H.kind&&(32640<(W=[128*b.compositeIconSizes[0].evaluate(x,{},S),128*b.compositeIconSizes[1].evaluate(x,{},S)])[0]||32640<W[1])&&pt(t.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),t.addSymbols(t.icon,G,W,_,v,x,!1,e,P.lineStartIndex,P.lineLength,-1,S),O=t.icon.placedSymbolArray.length-1,Z&&(L=4*Z.length,t.addSymbols(t.icon,Z,W,_,v,x,ec.vertical,e,P.lineStartIndex,P.lineLength,-1,S),R=t.icon.placedSymbolArray.length-1)}for(var K in r.horizontal){var X=r.horizontal[K];if(!E){B=Sa(X.text);var Y=s.layout.get("text-rotate").evaluate(x,{},S);E=new Mc(l,e,u,c,p,X,h,d,f,Y)}var J=1===X.positionedLines.length;if(D+=Uc(t,e,X,o,s,f,x,m,P,r.vertical?ec.horizontal:ec.horizontalOnly,J?Object.keys(r.horizontal):[K],N,O,b,S),J)break}function Q(t,e){return t&&t.circleDiameter?Math.max(t.circleDiameter,e):e}r.vertical&&(z+=Uc(t,e,r.vertical,o,s,f,x,m,P,ec.vertical,["vertical"],N,R,b,S));var $=E?E.boxStartIndex:t.collisionBoxArray.length,tt=E?E.boxEndIndex:t.collisionBoxArray.length,et=A?A.boxStartIndex:t.collisionBoxArray.length,it=A?A.boxEndIndex:t.collisionBoxArray.length,rt=C?C.boxStartIndex:t.collisionBoxArray.length,nt=C?C.boxEndIndex:t.collisionBoxArray.length,ot=k?k.boxStartIndex:t.collisionBoxArray.length,at=k?k.boxEndIndex:t.collisionBoxArray.length,st=-1,lt=-1<(st=Q(k,st=Q(C,st=Q(A,st=Q(E,st)))))?1:0;lt&&(st*=T/24),t.glyphOffsetArray.length>=Yc.MAX_GLYPHS&&pt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==x.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,x.sortKey),t.symbolInstances.emplaceBack(e.x,e.y,0<=N.right?N.right:-1,0<=N.center?N.center:-1,0<=N.left?N.left:-1,N.vertical||-1,O,R,B,$,tt,et,it,rt,nt,ot,at,u,D,z,M,L,lt,0,h,F,U,st)}(i,e,t,n,o,a,h,i.layers[0],i.collisionBoxArray,r.index,r.sourceLayerIndex,i.index,P,z,N,u,L,O,B,C,r,s,c,p,l)}if(o&&"none"!==j&&(i.allowVerticalPlacement&&n.vertical&&(h=hc(o,n.vertical,j,E.get("icon-text-fit-padding"),C,k)),A&&(o=hc(o,A,j,E.get("icon-text-fit-padding"),C,k))),"line"===F)for(var V=0,G=Ic(r.geometry,0,0,8192,8192);V<G.length;V+=1)for(var Z=G[V],H=0,W=(d=Z,f=D,m=R,g=n.vertical||A,y=o,v=24,_=M,x=i.overscaling,b=8192,w=wc(g,v,_),S=Sc(g,y),T=S*_,I=0===d[0].x||d[0].x===b||0===d[0].y||d[0].y===b,f-T<f/4&&(f=T+f/4),function t(e,i,r,n,o,a,s,l,u){for(var c=a/2,p=bc(e),h=0,d=i-r,f=[],m=0;m<e.length-1;m++){for(var g=e[m],y=e[m+1],v=g.dist(y),_=y.angleTo(g);d+r<h+v;){var x=((d+=r)-h)/v,b=Ye(g.x,y.x,x),w=Ye(g.y,y.y,x);if(0<=b&&b<u&&0<=w&&w<u&&0<=d-c&&d+c<=p){var S=new fc(b,w,_,m);S._round(),n&&!xc(e,S,a,n,o)||f.push(S)}}h+=v}return l||f.length||s||(f=t(e,h/2,r,n,o,a,s,!0,u)),f}(d,I?f/2*x%f:(S/2+2*v)*_*x%f,f,w,m,T,I,!1,b));H<W.length;H+=1){var K=W[H];A&&qc(i,A.text,U,K)||q(Z,K)}else if("line-center"===F)for(var X=0,Y=r.geometry;X<Y.length;X+=1){var J=Y[X];if(1<J.length){var Q=Tc(J,R,n.vertical||A,o,24,M);Q&&q(J,Q)}}else if("Polygon"===r.type)for(var $=0,tt=Pl(r.geometry,0);$<tt.length;$+=1){var et=tt[$],it=zc(et,16);q(et[0],new fc(it.x,it.y,0))}else if("LineString"===r.type)for(var rt=0,nt=r.geometry;rt<nt.length;rt+=1){var ot=nt[rt];q(ot,new fc(ot[0].x,ot[0].y,0))}else if("Point"===r.type)for(var at=0,st=r.geometry;at<st.length;at+=1)for(var lt=0,ut=st[at];lt<ut.length;lt+=1){var ct=ut[lt];q([ct],new fc(ct.x,ct.y,0))}}(D,t,o,k,R,U,r,n,s,P,B)},Z=0,H=D.features;Z<H.length;Z+=1)a();t&&D.generateCollisionDebugBuffers()},t.perspective=function(t,e,i,r,n){var o,a=1/Math.tan(e/2);return t[0]=a/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=n&&n!==1/0?(t[10]=(n+r)*(o=1/(r-n)),t[14]=2*n*r*o):(t[10]=-1,t[14]=-2*r),t},t.pick=function(t,e){for(var i={},r=0;r<e.length;r++){var n=e[r];n in t&&(i[n]=t[n])}return i},t.plugin=pn,t.polygonIntersectsPolygon=hs,t.postMapLoadEvent=at,t.postTurnstileEvent=nt,t.potpack=Yu,t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.register=qr,t.registerForPluginStateChange=function(t){return t({pluginStatus:nn,pluginURL:on}),cn.on("pluginStateChange",t),t},t.rotate=function(t,e,i){var r=e[0],n=e[1],o=e[2],a=e[3],s=Math.sin(i),l=Math.cos(i);return t[0]=r*l+o*s,t[1]=n*l+a*s,t[2]=r*-s+o*l,t[3]=n*-s+a*l,t},t.rotateX=function(t,e,i){var r=Math.sin(i),n=Math.cos(i),o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],p=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*n+u*r,t[5]=a*n+c*r,t[6]=s*n+p*r,t[7]=l*n+h*r,t[8]=u*n-o*r,t[9]=c*n-a*r,t[10]=p*n-s*r,t[11]=h*n-l*r,t},t.rotateZ=function(t,e,i){var r=Math.sin(i),n=Math.cos(i),o=e[0],a=e[1],s=e[2],l=e[3],u=e[4],c=e[5],p=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n+u*r,t[1]=a*n+c*r,t[2]=s*n+p*r,t[3]=l*n+h*r,t[4]=u*n-o*r,t[5]=c*n-a*r,t[6]=p*n-s*r,t[7]=h*n-l*r,t},t.scale=function(t,e,i){var r=i[0],n=i[1],o=i[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.scale$1=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t},t.scale$2=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t},t.setCacheLimits=function(t,e){st=t,lt=e},t.setRTLTextPlugin=function(t,e,i){if(void 0===i&&(i=!1),"deferred"===nn||"loading"===nn||"loaded"===nn)throw new Error("setRTLTextPlugin cannot be called multiple times.");on=O.resolveURL(t),nn="deferred",rn=e,an(),i||ln()},t.sphericalToCartesian=function(t){var e=t[0],i=t[1],r=t[2];return i+=90,i*=Math.PI/180,r*=Math.PI/180,{x:e*Math.cos(i)*Math.sin(r),y:e*Math.sin(i)*Math.sin(r),z:e*Math.cos(r)}},t.sqrLen=function(t){var e=t[0],i=t[1];return e*e+i*i},t.styleSpec=Ot,t.sub=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t},t.symbolSize=_c,t.transformMat3=function(t,e,i){var r=e[0],n=e[1],o=e[2];return t[0]=r*i[0]+n*i[3]+o*i[6],t[1]=r*i[1]+n*i[4]+o*i[7],t[2]=r*i[2]+n*i[5]+o*i[8],t},t.transformMat4=Ls,t.translate=function(t,e,i){var r,n,o,a,s,l,u,c,p,h,d,f,m=i[0],g=i[1],y=i[2];return e===t?(t[12]=e[0]*m+e[4]*g+e[8]*y+e[12],t[13]=e[1]*m+e[5]*g+e[9]*y+e[13],t[14]=e[2]*m+e[6]*g+e[10]*y+e[14],t[15]=e[3]*m+e[7]*g+e[11]*y+e[15]):(n=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],p=e[8],h=e[9],d=e[10],f=e[11],t[0]=r=e[0],t[1]=n,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=p,t[9]=h,t[10]=d,t[11]=f,t[12]=r*m+s*g+p*y+e[12],t[13]=n*m+l*g+h*y+e[13],t[14]=o*m+u*g+d*y+e[14],t[15]=a*m+c*g+f*y+e[15]),t},t.triggerPluginCompletionEvent=en,t.uniqueId=c,t.validateCustomStyleLayer=function(t){var e=[],i=t.id;return void 0===i&&e.push({message:"layers."+i+': missing required property "id"'}),void 0===t.render&&e.push({message:"layers."+i+': missing required method "render"'}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:"layers."+i+': property "renderingMode" must be either "2d" or "3d"'}),e},t.validateLight=Dr,t.validateStyle=Lr,t.values=function(t){var e=[];for(var i in t)e.push(t[i]);return e},t.vectorTile=Xl,t.version="1.11.1",t.warnOnce=pt,t.webpSupported=N,t.window=p,t.wrap=s}),i(0,function(P){function l(t){var e=typeof t;if("number"==e||"boolean"==e||"string"==e||null==t)return JSON.stringify(t);if(Array.isArray(t)){for(var i="[",r=0,n=t;r<n.length;r+=1)i+=l(n[r])+",";return i+"]"}for(var o=Object.keys(t).sort(),a="{",s=0;s<o.length;s++)a+=JSON.stringify(o[s])+":"+l(t[o[s]])+",";return a+"}"}function v(t){for(var e="",i=0,r=P.refProperties;i<r.length;i+=1)e+="/"+l(t[r[i]]);return e}function i(t){this.keyCache={},t&&this.replace(t)}function M(t){var e={},i=[];for(var r in t){var n=t[r],o=e[r]={};for(var a in n){var s=n[+a];if(s&&0!==s.bitmap.width&&0!==s.bitmap.height){var l={x:0,y:0,w:s.bitmap.width+2,h:s.bitmap.height+2};i.push(l),o[a]={rect:l,metrics:s.metrics}}}}var u=P.potpack(i),c=new P.AlphaImage({width:u.w||1,height:u.h||1});for(var p in t){var h=t[p];for(var d in h){var f=h[+d];if(f&&0!==f.bitmap.width&&0!==f.bitmap.height){var m=e[p][d].rect;P.AlphaImage.copy(f.bitmap,c,{x:0,y:0},{x:m.x+1,y:m.y+1},f.bitmap)}}}this.image=c,this.positions=e}function e(t){this.tileID=new P.OverscaledTileID(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId}function L(t,e,i){for(var r=new P.EvaluationParameters(e),n=0,o=t;n<o.length;n+=1)o[n].recalculate(r,i)}function n(t,n){var e=P.getArrayBuffer(t.request,function(t,e,i,r){t?n(t):e&&n(null,{vectorTile:new P.vectorTile.VectorTile(new P.pbf(e)),rawData:e,cacheControl:i,expires:r})});return function(){e.cancel(),n()}}function r(t,e,i,r){this.actor=t,this.layerIndex=e,this.availableImages=i,this.loadVectorData=r||n,this.loading={},this.loaded={}}function o(){this.loaded={}}i.prototype.replace=function(t){this._layerConfigs={},this._layers={},this.update(t,[])},i.prototype.update=function(t,e){for(var i=this,r=0,n=t;r<n.length;r+=1){var o=n[r];this._layerConfigs[o.id]=o;var a=this._layers[o.id]=P.createStyleLayer(o);a._featureFilter=P.featureFilter(a.filter),this.keyCache[o.id]&&delete this.keyCache[o.id]}for(var s=0,l=e;s<l.length;s+=1){var u=l[s];delete this.keyCache[u],delete this._layerConfigs[u],delete this._layers[u]}this.familiesBySource={};for(var c=0,p=function(t,e){for(var i={},r=0;r<t.length;r++){var n=e&&e[t[r].id]||v(t[r]);e&&(e[t[r].id]=n);var o=i[n];(o=o||(i[n]=[])).push(t[r])}var a=[];for(var s in i)a.push(i[s]);return a}(P.values(this._layerConfigs),this.keyCache);c<p.length;c+=1){var h=p[c].map(function(t){return i._layers[t.id]}),d=h[0];if("none"!==d.visibility){var f=d.source||"",m=this.familiesBySource[f];m=m||(this.familiesBySource[f]={});var g=d.sourceLayer||"_geojsonTileLayer",y=m[g];(y=y||(m[g]=[])).push(h)}}},P.register("GlyphAtlas",M),e.prototype.parse=function(t,e,n,i,o){var r=this;this.status="parsing",this.data=t,this.collisionBoxArray=new P.CollisionBoxArray;var a=new P.DictionaryCoder(Object.keys(t.layers).sort()),s=new P.FeatureIndex(this.tileID,this.promoteId);s.bucketLayerIDs=[];var l,u,c,p,h={},d={featureIndex:s,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:n},f=e.familiesBySource[this.source];for(var m in f){var g=t.layers[m];if(g){1===g.version&&P.warnOnce('Vector tile source "'+this.source+'" layer "'+m+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var y=a.encode(m),v=[],_=0;_<g.length;_++){var x=g.feature(_),b=s.getId(x,m);v.push({feature:x,id:b,index:_,sourceLayerIndex:y})}for(var w=0,S=f[m];w<S.length;w+=1){var T=S[w],I=T[0];I.minzoom&&this.zoom<Math.floor(I.minzoom)||I.maxzoom&&this.zoom>=I.maxzoom||"none"!==I.visibility&&(L(T,this.zoom,n),(h[I.id]=I.createBucket({index:s.bucketLayerIDs.length,layers:T,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:y,sourceID:this.source})).populate(v,d,this.tileID.canonical),s.bucketLayerIDs.push(T.map(function(t){return t.id})))}}}var E=P.mapObject(d.glyphDependencies,function(t){return Object.keys(t).map(Number)});Object.keys(E).length?i.send("getGlyphs",{uid:this.uid,stacks:E},function(t,e){l||(l=t,u=e,k.call(r))}):u={};var C=Object.keys(d.iconDependencies);C.length?i.send("getImages",{icons:C,source:this.source,tileID:this.tileID,type:"icons"},function(t,e){l||(l=t,c=e,k.call(r))}):c={};var A=Object.keys(d.patternDependencies);function k(){if(l)return o(l);if(u&&c&&p){var t=new M(u),e=new P.ImageAtlas(c,p);for(var i in h){var r=h[i];r instanceof P.SymbolBucket?(L(r.layers,this.zoom,n),P.performSymbolLayout(r,u,t.positions,c,e.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):r.hasPattern&&(r instanceof P.LineBucket||r instanceof P.FillBucket||r instanceof P.FillExtrusionBucket)&&(L(r.layers,this.zoom,n),r.addFeatures(d,this.tileID.canonical,e.patternPositions))}this.status="done",o(null,{buckets:P.values(h).filter(function(t){return!t.isEmpty()}),featureIndex:s,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:t.image,imageAtlas:e,glyphMap:this.returnDependencies?u:null,iconMap:this.returnDependencies?c:null,glyphPositions:this.returnDependencies?t.positions:null})}}A.length?i.send("getImages",{icons:A,source:this.source,tileID:this.tileID,type:"patterns"},function(t,e){l||(l=t,p=e,k.call(r))}):p={},k.call(this)},r.prototype.loadTile=function(t,a){var s=this,l=t.uid;this.loading||(this.loading={});var u=!!(t&&t.request&&t.request.collectResourceTiming)&&new P.RequestPerformance(t.request),c=this.loading[l]=new e(t);c.abort=this.loadVectorData(t,function(t,e){if(delete s.loading[l],t||!e)return c.status="done",s.loaded[l]=c,a(t);var i=e.rawData,r={};e.expires&&(r.expires=e.expires),e.cacheControl&&(r.cacheControl=e.cacheControl);var n={};if(u){var o=u.finish();o&&(n.resourceTiming=JSON.parse(JSON.stringify(o)))}c.vectorTile=e.vectorTile,c.parse(e.vectorTile,s.layerIndex,s.availableImages,s.actor,function(t,e){if(t||!e)return a(t);a(null,P.extend({rawTileData:i.slice(0)},e,r,n))}),s.loaded=s.loaded||{},s.loaded[l]=c})},r.prototype.reloadTile=function(t,r){var n=this,e=this.loaded,i=t.uid,o=this;if(e&&e[i]){var a=e[i];a.showCollisionBoxes=t.showCollisionBoxes;var s=function(t,e){var i=a.reloadCallback;i&&(delete a.reloadCallback,a.parse(a.vectorTile,o.layerIndex,n.availableImages,o.actor,i)),r(t,e)};"parsing"===a.status?a.reloadCallback=s:"done"===a.status&&(a.vectorTile?a.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}},r.prototype.abortTile=function(t,e){var i=this.loading,r=t.uid;i&&i[r]&&i[r].abort&&(i[r].abort(),delete i[r]),e()},r.prototype.removeTile=function(t,e){var i=this.loaded,r=t.uid;i&&i[r]&&delete i[r],e()};var s=P.window.ImageBitmap;function u(t,e){if(0!==t.length){a(t[0],e);for(var i=1;i<t.length;i++)a(t[i],!e)}}function a(t,e){for(var i=0,r=0,n=t.length,o=n-1;r<n;o=r++)i+=(t[r][0]-t[o][0])*(t[o][1]+t[r][1]);0<=i!=!!e&&t.reverse()}function c(t){this._feature=t,this.extent=P.EXTENT,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))}o.prototype.loadTile=function(t,e){var i=t.uid,r=t.encoding,n=t.rawImageData,o=s&&n instanceof s?this.getImageData(n):n,a=new P.DEMData(i,o,r);this.loaded=this.loaded||{},e(null,this.loaded[i]=a)},o.prototype.getImageData=function(t){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(t.width,t.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=t.width,this.offscreenCanvas.height=t.height,this.offscreenCanvasContext.drawImage(t,0,0,t.width,t.height);var e=this.offscreenCanvasContext.getImageData(-1,-1,t.width+2,t.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new P.RGBAImage({width:e.width,height:e.height},e.data)},o.prototype.removeTile=function(t){var e=this.loaded,i=t.uid;e&&e[i]&&delete e[i]};var p=P.vectorTile.VectorTileFeature.prototype.toGeoJSON;c.prototype.loadGeometry=function(){if(1===this._feature.type){for(var t=[],e=0,i=this._feature.geometry;e<i.length;e+=1){var r=i[e];t.push([new P.Point$1(r[0],r[1])])}return t}for(var n=[],o=0,a=this._feature.geometry;o<a.length;o+=1){for(var s=[],l=0,u=a[o];l<u.length;l+=1){var c=u[l];s.push(new P.Point$1(c[0],c[1]))}n.push(s)}return n},c.prototype.toGeoJSON=function(t,e,i){return p.call(this,t,e,i)};var h=function(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=P.EXTENT,this.length=t.length,this._features=t};h.prototype.feature=function(t){return new c(this._features[t])};var t=P.vectorTile.VectorTileFeature,d=f;function f(t,e){this.options=e||{},this.features=t,this.length=t.length}function m(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}f.prototype.feature=function(t){return new m(this.features[t],this.options.extent)},m.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var e=0;e<t.length;e++){for(var i=t[e],r=[],n=0;n<i.length;n++)r.push(new P.Point$1(i[n][0],i[n][1]));this.geometry.push(r)}return this.geometry},m.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,i=-1/0,r=1/0,n=-1/0,o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var l=a[s];e=Math.min(e,l.x),i=Math.max(i,l.x),r=Math.min(r,l.y),n=Math.max(n,l.y)}return[e,r,i,n]},m.prototype.toGeoJSON=t.prototype.toGeoJSON;var g=_,y=d;function _(t){var e=new P.pbf;return function(t,e){for(var i in t.layers)e.writeMessage(3,x,t.layers[i])}(t,e),e.finish()}function x(t,e){var i;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var r={keys:[],values:[],keycache:{},valuecache:{}};for(i=0;i<t.length;i++)r.feature=t.feature(i),e.writeMessage(2,b,r);var n=r.keys;for(i=0;i<n.length;i++)e.writeStringField(3,n[i]);var o=r.values;for(i=0;i<o.length;i++)e.writeMessage(4,E,o[i])}function b(t,e){var i=t.feature;void 0!==i.id&&e.writeVarintField(1,i.id),e.writeMessage(2,w,t),e.writeVarintField(3,i.type),e.writeMessage(4,I,i)}function w(t,e){var i=t.feature,r=t.keys,n=t.values,o=t.keycache,a=t.valuecache;for(var s in i.properties){var l=o[s];void 0===l&&(r.push(s),o[s]=l=r.length-1),e.writeVarint(l);var u=i.properties[s],c=typeof u;"string"!=c&&"boolean"!=c&&"number"!=c&&(u=JSON.stringify(u));var p=c+":"+u,h=a[p];void 0===h&&(n.push(u),a[p]=h=n.length-1),e.writeVarint(h)}}function S(t,e){return(e<<3)+(7&t)}function T(t){return t<<1^t>>31}function I(t,e){for(var i=t.loadGeometry(),r=t.type,n=0,o=0,a=i.length,s=0;s<a;s++){var l=i[s],u=1;1===r&&(u=l.length),e.writeVarint(S(1,u));for(var c=3===r?l.length-1:l.length,p=0;p<c;p++){1===p&&1!==r&&e.writeVarint(S(2,c-1));var h=l[p].x-n,d=l[p].y-o;e.writeVarint(T(h)),e.writeVarint(T(d)),n+=h,o+=d}3===r&&e.writeVarint(15)}}function E(t,e){var i=typeof t;"string"==i?e.writeStringField(1,t):"boolean"==i?e.writeBooleanField(7,t):"number"==i&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}function C(t,e,i,r){A(t,i,r),A(e,2*i,2*r),A(e,2*i+1,2*r+1)}function A(t,e,i){var r=t[e];t[e]=t[i],t[i]=r}function k(t,e,i,r){var n=t-i,o=e-r;return n*n+o*o}function D(t){return t[0]}function z(t){return t[1]}function O(t,e,i,r,n){void 0===e&&(e=D),void 0===i&&(i=z),void 0===r&&(r=64),void 0===n&&(n=Float64Array),this.nodeSize=r;for(var o=(this.points=t).length<65536?Uint16Array:Uint32Array,a=this.ids=new o(t.length),s=this.coords=new n(2*t.length),l=0;l<t.length;l++)s[2*(a[l]=l)]=e(t[l]),s[2*l+1]=i(t[l]);!function t(e,i,r,n,o,a){if(!(o-n<=r)){var s=n+o>>1;!function t(e,i,r,n,o,a){for(;n<o;){if(600<o-n){var s=o-n+1,l=r-n+1,u=Math.log(s),c=.5*Math.exp(2*u/3),p=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1);t(e,i,r,Math.max(n,Math.floor(r-l*c/s+p)),Math.min(o,Math.floor(r+(s-l)*c/s+p)),a)}var h=i[2*r+a],d=n,f=o;for(C(e,i,n,r),i[2*o+a]>h&&C(e,i,n,o);d<f;){for(C(e,i,d,f),d++,f--;i[2*d+a]<h;)d++;for(;i[2*f+a]>h;)f--}i[2*n+a]===h?C(e,i,n,f):C(e,i,++f,o),f<=r&&(n=f+1),r<=f&&(o=f-1)}}(e,i,s,n,o,a%2),t(e,i,r,n,s-1,a+1),t(e,i,r,1+s,o,a+1)}}(a,s,r,0,a.length-1,0)}function R(t){this.options=q(Object.create(N),t),this.trees=new Array(this.options.maxZoom+1)}g.fromVectorTileJs=_,g.fromGeojsonVt=function(t,e){e=e||{};var i={};for(var r in t)i[r]=new d(t[r].features,e),i[r].name=r,i[r].version=e.version,i[r].extent=e.extent;return _({layers:i})},g.GeoJSONWrapper=y,O.prototype.range=function(t,e,i,r){return function(t,e,i,r,n,o,a){for(var s,l,u=[0,t.length-1,0],c=[];u.length;){var p=u.pop(),h=u.pop(),d=u.pop();if(h-d<=a)for(var f=d;f<=h;f++)l=e[2*f+1],(s=e[2*f])>=i&&s<=n&&r<=l&&l<=o&&c.push(t[f]);else{var m=Math.floor((d+h)/2);l=e[2*m+1],(s=e[2*m])>=i&&s<=n&&r<=l&&l<=o&&c.push(t[m]);var g=(p+1)%2;(0===p?i<=s:r<=l)&&(u.push(d),u.push(m-1),u.push(g)),(0===p?s<=n:l<=o)&&(u.push(m+1),u.push(h),u.push(g))}}return c}(this.ids,this.coords,t,e,i,r,this.nodeSize)};var N={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!(O.prototype.within=function(t,e,i){return function(t,e,i,r,n,o){for(var a=[0,t.length-1,0],s=[],l=n*n;a.length;){var u=a.pop(),c=a.pop(),p=a.pop();if(c-p<=o)for(var h=p;h<=c;h++)k(e[2*h],e[2*h+1],i,r)<=l&&s.push(t[h]);else{var d=Math.floor((p+c)/2),f=e[2*d],m=e[2*d+1];k(f,m,i,r)<=l&&s.push(t[d]);var g=(u+1)%2;(0===u?i-n<=f:r-n<=m)&&(a.push(p),a.push(d-1),a.push(g)),(0===u?f<=i+n:m<=r+n)&&(a.push(d+1),a.push(c),a.push(g))}}return s}(this.ids,this.coords,t,e,i,this.nodeSize)}),generateId:!1,reduce:null,map:function(t){return t}};function B(t){return{type:"Feature",id:t.id,properties:F(t),geometry:{type:"Point",coordinates:[360*(t.x-.5),(e=(180-360*t.y)*Math.PI/180,360*Math.atan(Math.exp(e))/Math.PI-90)]}};var e}function F(t){var e=t.numPoints,i=1e4<=e?Math.round(e/1e3)+"k":1e3<=e?Math.round(e/100)/10+"k":e;return q(q({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:i})}function U(t){return t/360+.5}function j(t){var e=Math.sin(t*Math.PI/180),i=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return i<0?0:1<i?1:i}function q(t,e){for(var i in e)t[i]=e[i];return t}function V(t){return t.x}function G(t){return t.y}function Z(t,e,i,r,n,o){var a=n-i,s=o-r;if(0!==a||0!==s){var l=((t-i)*a+(e-r)*s)/(a*a+s*s);1<l?(i=n,r=o):0<l&&(i+=a*l,r+=s*l)}return(a=t-i)*a+(s=e-r)*s}function H(t,e,i,r){var n={id:void 0===t?null:t,type:e,geometry:i,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,i=t.type;if("Point"===i||"MultiPoint"===i||"LineString"===i)W(t,e);else if("Polygon"===i||"MultiLineString"===i)for(var r=0;r<e.length;r++)W(t,e[r]);else if("MultiPolygon"===i)for(r=0;r<e.length;r++)for(var n=0;n<e[r].length;n++)W(t,e[r][n])}(n),n}function W(t,e){for(var i=0;i<e.length;i+=3)t.minX=Math.min(t.minX,e[i]),t.minY=Math.min(t.minY,e[i+1]),t.maxX=Math.max(t.maxX,e[i]),t.maxY=Math.max(t.maxY,e[i+1])}function K(t,e,i,r){if(e.geometry){var n=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(i.tolerance/((1<<i.maxZoom)*i.extent),2),s=[],l=e.id;if(i.promoteId?l=e.properties[i.promoteId]:i.generateId&&(l=r||0),"Point"===o)X(n,s);else if("MultiPoint"===o)for(var u=0;u<n.length;u++)X(n[u],s);else if("LineString"===o)Y(n,s,a,!1);else if("MultiLineString"===o){if(i.lineMetrics){for(u=0;u<n.length;u++)Y(n[u],s=[],a,!1),t.push(H(l,"LineString",s,e.properties));return}J(n,s,a,!1)}else if("Polygon"===o)J(n,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"!==o)throw new Error("Input data is not a valid GeoJSON object.");for(u=0;u<e.geometry.geometries.length;u++)K(t,{id:l,geometry:e.geometry.geometries[u],properties:e.properties},i,r);return}for(u=0;u<n.length;u++){var c=[];J(n[u],c,a,!0),s.push(c)}}t.push(H(l,o,s,e.properties))}}function X(t,e){e.push(Q(t[0])),e.push($(t[1])),e.push(0)}function Y(t,e,i,r){for(var n,o,a=0,s=0;s<t.length;s++){var l=Q(t[s][0]),u=$(t[s][1]);e.push(l),e.push(u),e.push(0),0<s&&(a+=r?(n*u-l*o)/2:Math.sqrt(Math.pow(l-n,2)+Math.pow(u-o,2))),n=l,o=u}var c=e.length-3;e[2]=1,function t(e,i,r,n){for(var o,a=n,s=r-i>>1,l=r-i,u=e[i],c=e[i+1],p=e[r],h=e[r+1],d=i+3;d<r;d+=3){var f=Z(e[d],e[d+1],u,c,p,h);if(a<f)o=d,a=f;else if(f===a){var m=Math.abs(d-s);m<l&&(o=d,l=m)}}n<a&&(3<o-i&&t(e,i,o,n),e[o+2]=a,3<r-o&&t(e,o,r,n))}(e,0,c,i),e[2+c]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function J(t,e,i,r){for(var n=0;n<t.length;n++){var o=[];Y(t[n],o,i,r),e.push(o)}}function Q(t){return t/360+.5}function $(t){var e=Math.sin(t*Math.PI/180),i=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return i<0?0:1<i?1:i}function tt(t,e,i,r,n,o,a,s){if(r/=e,o>=(i/=e)&&a<r)return t;if(a<i||r<=o)return null;for(var l=[],u=0;u<t.length;u++){var c=t[u],p=c.geometry,h=c.type,d=0===n?c.minX:c.minY,f=0===n?c.maxX:c.maxY;if(i<=d&&f<r)l.push(c);else if(!(f<i||r<=d)){var m=[];if("Point"===h||"MultiPoint"===h)et(p,m,i,r,n);else if("LineString"===h)it(p,m,i,r,n,!1,s.lineMetrics);else if("MultiLineString"===h)nt(p,m,i,r,n,!1);else if("Polygon"===h)nt(p,m,i,r,n,!0);else if("MultiPolygon"===h)for(var g=0;g<p.length;g++){var y=[];nt(p[g],y,i,r,n,!0),y.length&&m.push(y)}if(m.length){if(s.lineMetrics&&"LineString"===h){for(g=0;g<m.length;g++)l.push(H(c.id,h,m[g],c.tags));continue}"LineString"!==h&&"MultiLineString"!==h||(1===m.length?(h="LineString",m=m[0]):h="MultiLineString"),"Point"!==h&&"MultiPoint"!==h||(h=3===m.length?"Point":"MultiPoint"),l.push(H(c.id,h,m,c.tags))}}}return l.length?l:null}function et(t,e,i,r,n){for(var o=0;o<t.length;o+=3){var a=t[o+n];i<=a&&a<=r&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function it(t,e,i,r,n,o,a){for(var s,l,u=rt(t),c=0===n?at:st,p=t.start,h=0;h<t.length-3;h+=3){var d=t[h],f=t[h+1],m=t[h+2],g=t[h+3],y=t[h+4],v=0===n?d:f,_=0===n?g:y,x=!1;a&&(s=Math.sqrt(Math.pow(d-g,2)+Math.pow(f-y,2))),v<i?i<_&&(l=c(u,d,f,g,y,i),a&&(u.start=p+s*l)):r<v?_<r&&(l=c(u,d,f,g,y,r),a&&(u.start=p+s*l)):ot(u,d,f,m),_<i&&i<=v&&(l=c(u,d,f,g,y,i),x=!0),r<_&&v<=r&&(l=c(u,d,f,g,y,r),x=!0),!o&&x&&(a&&(u.end=p+s*l),e.push(u),u=rt(t)),a&&(p+=s)}var b=t.length-3;d=t[b],f=t[b+1],m=t[b+2],(v=0===n?d:f)>=i&&v<=r&&ot(u,d,f,m),b=u.length-3,o&&3<=b&&(u[b]!==u[0]||u[b+1]!==u[1])&&ot(u,u[0],u[1],u[2]),u.length&&e.push(u)}function rt(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function nt(t,e,i,r,n,o){for(var a=0;a<t.length;a++)it(t[a],e,i,r,n,o,!1)}function ot(t,e,i,r){t.push(e),t.push(i),t.push(r)}function at(t,e,i,r,n,o){var a=(o-e)/(r-e);return t.push(o),t.push(i+(n-i)*a),t.push(1),a}function st(t,e,i,r,n,o){var a=(o-i)/(n-i);return t.push(e+(r-e)*a),t.push(o),t.push(1),a}function lt(t,e){for(var i=[],r=0;r<t.length;r++){var n,o=t[r],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)n=ut(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){n=[];for(var s=0;s<o.geometry.length;s++)n.push(ut(o.geometry[s],e))}else if("MultiPolygon"===a)for(n=[],s=0;s<o.geometry.length;s++){for(var l=[],u=0;u<o.geometry[s].length;u++)l.push(ut(o.geometry[s][u],e));n.push(l)}i.push(H(o.id,a,n,o.tags))}return i}function ut(t,e){var i=[];i.size=t.size,void 0!==t.start&&(i.start=t.start,i.end=t.end);for(var r=0;r<t.length;r+=3)i.push(t[r]+e,t[r+1],t[r+2]);return i}function ct(t,e){if(t.transformed)return t;var i,r,n,o=1<<t.z,a=t.x,s=t.y;for(i=0;i<t.features.length;i++){var l=t.features[i],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(r=0;r<u.length;r+=2)l.geometry.push(pt(u[r],u[r+1],e,o,a,s));else for(r=0;r<u.length;r++){var p=[];for(n=0;n<u[r].length;n+=2)p.push(pt(u[r][n],u[r][n+1],e,o,a,s));l.geometry.push(p)}}return t.transformed=!0,t}function pt(t,e,i,r,n,o){return[Math.round(i*(t*r-n)),Math.round(i*(e*r-o))]}function ht(t,e,i,r,n){for(var o=e===n.maxZoom?0:n.tolerance/((1<<e)*n.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:i,y:r,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,dt(a,t[s],o,n);var l=t[s].minX,u=t[s].minY,c=t[s].maxX,p=t[s].maxY;l<a.minX&&(a.minX=l),u<a.minY&&(a.minY=u),c>a.maxX&&(a.maxX=c),p>a.maxY&&(a.maxY=p)}return a}function dt(t,e,i,r){var n=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<n.length;s+=3)a.push(n[s]),a.push(n[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)ft(a,n,t,i,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<n.length;s++)ft(a,n[s],t,i,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var l=0;l<n.length;l++){var u=n[l];for(s=0;s<u.length;s++)ft(a,u[s],t,i,!0,0===s)}if(a.length){var c=e.tags||null;if("LineString"===o&&r.lineMetrics){for(var p in c={},e.tags)c[p]=e.tags[p];c.mapbox_clip_start=n.start/n.size,c.mapbox_clip_end=n.end/n.size}var h={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:c};null!==e.id&&(h.id=e.id),t.features.push(h)}}function ft(t,e,i,r,n,o){var a=r*r;if(0<r&&e.size<(n?a:r))i.numPoints+=e.length/3;else{for(var s=[],l=0;l<e.length;l+=3)(0===r||e[l+2]>a)&&(i.numSimplified++,s.push(e[l]),s.push(e[l+1])),i.numPoints++;n&&function(t,e){for(var i=0,r=0,n=t.length,o=n-2;r<n;o=r,r+=2)i+=(t[r]-t[o])*(t[r+1]+t[o+1]);if(0<i===e)for(r=0,n=t.length;r<n/2;r+=2){var a=t[r],s=t[r+1];t[r]=t[n-2-r],t[r+1]=t[n-1-r],t[n-2-r]=a,t[n-1-r]=s}}(s,o),t.push(s)}}function mt(t,e){var i=(e=this.options=function(t,e){for(var i in e)t[i]=e[i];return t}(Object.create(this.options),e)).debug;if(i&&console.time("preprocess data"),e.maxZoom<0||24<e.maxZoom)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var r,n,o,a,s,l,u=function(t,e){var i=[];if("FeatureCollection"===t.type)for(var r=0;r<t.features.length;r++)K(i,t.features[r],e,r);else K(i,"Feature"===t.type?t:{geometry:t},e);return i}(t,e);this.tiles={},this.tileCoords=[],i&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),r=u,o=(n=e).buffer/n.extent,s=tt(a=r,1,-1-o,o,0,-1,2,n),l=tt(r,1,1-o,2+o,0,-1,2,n),(s||l)&&(a=tt(r,1,-o,1+o,0,-1,2,n)||[],s&&(a=lt(s,1).concat(a)),l&&(a=a.concat(lt(l,-1)))),(u=a).length&&this.splitTile(u,0,0,0),i&&(u.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function gt(t,e,i){return 32*((1<<t)*i+e)+t}function yt(t,e){var i=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);var r=this._geoJSONIndex.getTile(i.z,i.x,i.y);if(!r)return e(null,null);var n=new h(r.features),o=g(n);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),e(null,{vectorTile:n,rawData:o.buffer})}function vt(t){var i=this;this.self=t,this.actor=new P.Actor(t,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:r,geojson:xt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(t,e){if(i.workerSourceTypes[t])throw new Error('Worker source with name "'+t+'" already registered.');i.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=function(t){if(P.plugin.isParsed())throw new Error("RTL text plugin already registered.");P.plugin.applyArabicShaping=t.applyArabicShaping,P.plugin.processBidirectionalText=t.processBidirectionalText,P.plugin.processStyledBidirectionalText=t.processStyledBidirectionalText}}R.prototype.load=function(t){var e=this.options,i=e.log,r=e.minZoom,n=e.maxZoom,o=e.nodeSize;i&&console.time("total time");var a,s,l,u,c="prepare "+t.length+" points";i&&console.time(c),this.points=t;for(var p=[],h=0;h<t.length;h++)t[h].geometry&&p.push((a=t[h],s=h,l=a.geometry.coordinates,u=l[1],{x:U(l[0]),y:j(u),zoom:1/0,index:s,parentId:-1}));this.trees[n+1]=new O(p,V,G,o,Float32Array),i&&console.timeEnd(c);for(var d=n;r<=d;d--){var f=+Date.now();p=this._cluster(p,d),this.trees[d]=new O(p,V,G,o,Float32Array),i&&console.log("z%d: %d clusters in %dms",d,p.length,Date.now()-f)}return i&&console.timeEnd("total time"),this},R.prototype.getClusters=function(t,e){var i=((t[0]+180)%360+360)%360-180,r=Math.max(-90,Math.min(90,t[1])),n=180===t[2]?180:((t[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,t[3]));if(360<=t[2]-t[0])i=-180,n=180;else if(n<i){var a=this.getClusters([i,r,180,o],e),s=this.getClusters([-180,r,n,o],e);return a.concat(s)}for(var l=this.trees[this._limitZoom(e)],u=[],c=0,p=l.range(U(i),j(o),U(n),j(r));c<p.length;c+=1){var h=l.points[p[c]];u.push(h.numPoints?B(h):this.points[h.index])}return u},R.prototype.getChildren=function(t){var e=this._getOriginId(t),i=this._getOriginZoom(t),r="No cluster with the specified id.",n=this.trees[i];if(!n)throw new Error(r);var o=n.points[e];if(!o)throw new Error(r);for(var a=this.options.radius/(this.options.extent*Math.pow(2,i-1)),s=[],l=0,u=n.within(o.x,o.y,a);l<u.length;l+=1){var c=n.points[u[l]];c.parentId===t&&s.push(c.numPoints?B(c):this.points[c.index])}if(0===s.length)throw new Error(r);return s},R.prototype.getLeaves=function(t,e,i){var r=[];return this._appendLeaves(r,t,e=e||10,i=i||0,0),r},R.prototype.getTile=function(t,e,i){var r=this.trees[this._limitZoom(t)],n=Math.pow(2,t),o=this.options,a=o.radius/o.extent,s=(i-a)/n,l=(i+1+a)/n,u={features:[]};return this._addTileFeatures(r.range((e-a)/n,s,(e+1+a)/n,l),r.points,e,i,n,u),0===e&&this._addTileFeatures(r.range(1-a/n,s,1,l),r.points,n,i,n,u),e===n-1&&this._addTileFeatures(r.range(0,s,a/n,l),r.points,-1,i,n,u),u.features.length?u:null},R.prototype.getClusterExpansionZoom=function(t){for(var e=this._getOriginZoom(t)-1;e<=this.options.maxZoom;){var i=this.getChildren(t);if(e++,1!==i.length)break;t=i[0].properties.cluster_id}return e},R.prototype._appendLeaves=function(t,e,i,r,n){for(var o=0,a=this.getChildren(e);o<a.length;o+=1){var s=a[o],l=s.properties;if(l&&l.cluster?n+l.point_count<=r?n+=l.point_count:n=this._appendLeaves(t,l.cluster_id,i,r,n):n<r?n++:t.push(s),t.length===i)break}return n},R.prototype._addTileFeatures=function(t,e,i,r,n,o){for(var a=0,s=t;a<s.length;a+=1){var l=e[s[a]],u=l.numPoints,c={type:1,geometry:[[Math.round(this.options.extent*(l.x*n-i)),Math.round(this.options.extent*(l.y*n-r))]],tags:u?F(l):this.points[l.index].properties},p=void 0;u?p=l.id:this.options.generateId?p=l.index:this.points[l.index].id&&(p=this.points[l.index].id),void 0!==p&&(c.id=p),o.features.push(c)}},R.prototype._limitZoom=function(t){return Math.max(this.options.minZoom,Math.min(+t,this.options.maxZoom+1))},R.prototype._cluster=function(t,e){for(var i=[],r=this.options,n=r.reduce,o=r.minPoints,a=r.radius/(r.extent*Math.pow(2,e)),s=0;s<t.length;s++){var l=t[s];if(!(l.zoom<=e)){l.zoom=e;for(var u=this.trees[e+1],c=u.within(l.x,l.y,a),p=l.numPoints||1,h=p,d=0,f=c;d<f.length;d+=1){var m=u.points[f[d]];m.zoom>e&&(h+=m.numPoints||1)}if(o<=h){for(var g=l.x*p,y=l.y*p,v=n&&1<p?this._map(l,!0):null,_=(s<<5)+(e+1)+this.points.length,x=0,b=c;x<b.length;x+=1){var w=u.points[b[x]];if(!(w.zoom<=e)){w.zoom=e;var S=w.numPoints||1;g+=w.x*S,y+=w.y*S,w.parentId=_,n&&n(v=v||this._map(l,!0),this._map(w))}}l.parentId=_,i.push({x:g/h,y:y/h,zoom:1/0,id:_,parentId:-1,numPoints:h,properties:v})}else if(i.push(l),1<h)for(var T=0,I=c;T<I.length;T+=1){var E=u.points[I[T]];E.zoom<=e||(E.zoom=e,i.push(E))}}}return i},R.prototype._getOriginId=function(t){return t-this.points.length>>5},R.prototype._getOriginZoom=function(t){return(t-this.points.length)%32},mt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!(R.prototype._map=function(t,e){if(t.numPoints)return e?q({},t.properties):t.properties;var i=this.points[t.index].properties,r=this.options.map(i);return e&&r===i?q({},r):r}),promoteId:null,generateId:!1,debug:0},mt.prototype.splitTile=function(t,e,i,r,n,o,a){for(var s=[t,e,i,r],l=this.options,u=l.debug;s.length;){r=s.pop(),i=s.pop(),e=s.pop(),t=s.pop();var c=1<<e,p=gt(e,i,r),h=this.tiles[p];if(!h&&(1<u&&console.time("creation"),h=this.tiles[p]=ht(t,e,i,r,l),this.tileCoords.push({z:e,x:i,y:r}),u)){1<u&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,i,r,h.numFeatures,h.numPoints,h.numSimplified),console.timeEnd("creation"));var d="z"+e;this.stats[d]=(this.stats[d]||0)+1,this.total++}if(h.source=t,n){if(e===l.maxZoom||e===n)continue;var f=1<<n-e;if(i!==Math.floor(o/f)||r!==Math.floor(a/f))continue}else if(e===l.indexMaxZoom||h.numPoints<=l.indexMaxPoints)continue;if(h.source=null,0!==t.length){1<u&&console.time("clipping");var m,g,y,v,_,x,b=.5*l.buffer/l.extent,w=.5-b,S=.5+b,T=1+b;m=g=y=v=null,_=tt(t,c,i-b,i+S,0,h.minX,h.maxX,l),x=tt(t,c,i+w,i+T,0,h.minX,h.maxX,l),t=null,_&&(m=tt(_,c,r-b,r+S,1,h.minY,h.maxY,l),g=tt(_,c,r+w,r+T,1,h.minY,h.maxY,l),_=null),x&&(y=tt(x,c,r-b,r+S,1,h.minY,h.maxY,l),v=tt(x,c,r+w,r+T,1,h.minY,h.maxY,l),x=null),1<u&&console.timeEnd("clipping"),s.push(m||[],e+1,2*i,2*r),s.push(g||[],e+1,2*i,2*r+1),s.push(y||[],e+1,2*i+1,2*r),s.push(v||[],e+1,2*i+1,2*r+1)}}},mt.prototype.getTile=function(t,e,i){var r=this.options,n=r.extent,o=r.debug;if(t<0||24<t)return null;var a=1<<t,s=gt(t,e=(e%a+a)%a,i);if(this.tiles[s])return ct(this.tiles[s],n);1<o&&console.log("drilling down to z%d-%d-%d",t,e,i);for(var l,u=t,c=e,p=i;!l&&0<u;)u--,c=Math.floor(c/2),p=Math.floor(p/2),l=this.tiles[gt(u,c,p)];return l&&l.source?(1<o&&console.log("found parent tile z%d-%d-%d",u,c,p),1<o&&console.time("drilling down"),this.splitTile(l.source,u,c,p,t,e,i),1<o&&console.timeEnd("drilling down"),this.tiles[s]?ct(this.tiles[s],n):null):null};var _t,xt=(bt.__proto__=_t=r,((bt.prototype=Object.create(_t&&_t.prototype)).constructor=bt).prototype.loadData=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=e,this._pendingLoadDataParams=t,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},bt.prototype._loadData=function(){var n=this;if(this._pendingCallback&&this._pendingLoadDataParams){var o=this._pendingCallback,f=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var a=!!(f&&f.request&&f.request.collectResourceTiming)&&new P.RequestPerformance(f.request);this.loadGeoJSON(f,function(t,e){if(t||!e)return o(t);if("object"!=typeof e)return o(new Error("Input data given to '"+f.source+"' is not a valid GeoJSON object."));!function t(e,i){var r,n=e&&e.type;if("FeatureCollection"===n)for(r=0;r<e.features.length;r++)t(e.features[r],i);else if("GeometryCollection"===n)for(r=0;r<e.geometries.length;r++)t(e.geometries[r],i);else if("Feature"===n)t(e.geometry,i);else if("Polygon"===n)u(e.coordinates,i);else if("MultiPolygon"===n)for(r=0;r<e.coordinates.length;r++)u(e.coordinates[r],i);return e}(e,!0);try{n._geoJSONIndex=f.cluster?new R(function(){var t=f.superclusterOptions,e=f.clusterProperties;if(!e||!t)return t;for(var o={},a={},s={accumulated:null,zoom:0},l={properties:null},u=Object.keys(e),i=0,r=u;i<r.length;i+=1){var n=r[i],c=e[n],p=c[0],h=P.createExpression(c[1]),d=P.createExpression("string"==typeof p?[p,["accumulated"],["get",n]]:p);o[n]=h.value,a[n]=d.value}return t.map=function(t){l.properties=t;for(var e={},i=0,r=u;i<r.length;i+=1){var n=r[i];e[n]=o[n].evaluate(s,l)}return e},t.reduce=function(t,e){l.properties=e;for(var i=0,r=u;i<r.length;i+=1){var n=r[i];s.accumulated=t[n],t[n]=a[n].evaluate(s,l)}},t}()).load(e.features):new mt(e,f.geojsonVtOptions)}catch(t){return o(t)}n.loaded={};var i={};if(a){var r=a.finish();r&&(i.resourceTiming={},i.resourceTiming[f.source]=JSON.parse(JSON.stringify(r)))}o(null,i)})}},bt.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},bt.prototype.reloadTile=function(t,e){var i=this.loaded;return i&&i[t.uid]?_t.prototype.reloadTile.call(this,t,e):this.loadTile(t,e)},bt.prototype.loadGeoJSON=function(e,i){if(e.request)P.getJSON(e.request,i);else{if("string"!=typeof e.data)return i(new Error("Input data given to '"+e.source+"' is not a valid GeoJSON object."));try{return i(null,JSON.parse(e.data))}catch(t){return i(new Error("Input data given to '"+e.source+"' is not a valid GeoJSON object."))}}},bt.prototype.removeSource=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()},bt.prototype.getClusterExpansionZoom=function(t,e){try{e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))}catch(t){e(t)}},bt.prototype.getClusterChildren=function(t,e){try{e(null,this._geoJSONIndex.getChildren(t.clusterId))}catch(t){e(t)}},bt.prototype.getClusterLeaves=function(t,e){try{e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))}catch(t){e(t)}},bt);function bt(t,e,i,r){_t.call(this,t,e,i,yt),r&&(this.loadGeoJSON=r)}return vt.prototype.setReferrer=function(t,e){this.referrer=e},vt.prototype.setImages=function(t,e,i){for(var r in this.availableImages[t]=e,this.workerSources[t]){var n=this.workerSources[t][r];for(var o in n)n[o].availableImages=e}i()},vt.prototype.setLayers=function(t,e,i){this.getLayerIndex(t).replace(e),i()},vt.prototype.updateLayers=function(t,e,i){this.getLayerIndex(t).update(e.layers,e.removedIds),i()},vt.prototype.loadTile=function(t,e,i){this.getWorkerSource(t,e.type,e.source).loadTile(e,i)},vt.prototype.loadDEMTile=function(t,e,i){this.getDEMWorkerSource(t,e.source).loadTile(e,i)},vt.prototype.reloadTile=function(t,e,i){this.getWorkerSource(t,e.type,e.source).reloadTile(e,i)},vt.prototype.abortTile=function(t,e,i){this.getWorkerSource(t,e.type,e.source).abortTile(e,i)},vt.prototype.removeTile=function(t,e,i){this.getWorkerSource(t,e.type,e.source).removeTile(e,i)},vt.prototype.removeDEMTile=function(t,e){this.getDEMWorkerSource(t,e.source).removeTile(e)},vt.prototype.removeSource=function(t,e,i){if(this.workerSources[t]&&this.workerSources[t][e.type]&&this.workerSources[t][e.type][e.source]){var r=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==r.removeSource?r.removeSource(e,i):i()}},vt.prototype.loadWorkerSource=function(t,e,i){try{this.self.importScripts(e.url),i()}catch(t){i(t.toString())}},vt.prototype.syncRTLPluginState=function(t,e,i){try{P.plugin.setState(e);var r=P.plugin.getPluginURL();if(P.plugin.isLoaded()&&!P.plugin.isParsed()&&null!=r){this.self.importScripts(r);var n=P.plugin.isParsed();i(n?void 0:new Error("RTL Text Plugin failed to import scripts from "+r),n)}}catch(t){i(t.toString())}},vt.prototype.getAvailableImages=function(t){var e=this.availableImages[t];return e=e||[]},vt.prototype.getLayerIndex=function(t){var e=this.layerIndexes[t];return e=e||(this.layerIndexes[t]=new i)},vt.prototype.getWorkerSource=function(r,t,e){var n=this;return this.workerSources[r]||(this.workerSources[r]={}),this.workerSources[r][t]||(this.workerSources[r][t]={}),this.workerSources[r][t][e]||(this.workerSources[r][t][e]=new this.workerSourceTypes[t]({send:function(t,e,i){n.actor.send(t,e,i,r)}},this.getLayerIndex(r),this.getAvailableImages(r))),this.workerSources[r][t][e]},vt.prototype.getDEMWorkerSource=function(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new o),this.demWorkerSources[t][e]},vt.prototype.enforceCacheSizeLimit=function(t,e){P.enforceCacheSizeLimit(e)},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new vt(self)),vt}),i(0,function(vt){var i=vt.createCommonjsModule(function(t){function a(t){return!e(t)}function e(t){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if("Worker"in window&&"Blob"in window&&"URL"in window){var t,e,i=new Blob([""],{type:"text/javascript"}),r=URL.createObjectURL(i);try{e=new Worker(r),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(r),t}}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var t=document.createElement("canvas");t.width=t.height=1;var e=t.getContext("2d");if(e){var i=e.getImageData(0,0,1,1);return i&&i.width===t.width}}()?(void 0===i[o=t&&t.failIfMajorPerformanceCaveat]&&(i[o]=function(){var t,e,i,r=(t=o,e=document.createElement("canvas"),(i=Object.create(a.webGLContextAttributes)).failIfMajorPerformanceCaveat=t,e.probablySupportsContext?e.probablySupportsContext("webgl",i)||e.probablySupportsContext("experimental-webgl",i):e.supportsContext?e.supportsContext("webgl",i)||e.supportsContext("experimental-webgl",i):e.getContext("webgl",i)||e.getContext("experimental-webgl",i));if(!r)return!1;var n=r.createShader(r.VERTEX_SHADER);return!(!n||r.isContextLost())&&(r.shaderSource(n,"void main() {}"),r.compileShader(n),!0===r.getShaderParameter(n,r.COMPILE_STATUS))}()),i[o]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var o}t.exports?t.exports=a:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=a,window.mapboxgl.notSupportedReason=e);var i={};a.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),_={create:function(t,e,i){var r=vt.window.document.createElement(t);return void 0!==e&&(r.className=e),i&&i.appendChild(r),r},createNS:function(t,e){return vt.window.document.createElementNS(t,e)}},r=vt.window.document&&vt.window.document.documentElement.style;function t(t){if(!r)return t[0];for(var e=0;e<t.length;e++)if(t[e]in r)return t[e];return t[0]}var e,n=t(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);_.disableDrag=function(){r&&n&&(e=r[n],r[n]="none")},_.enableDrag=function(){r&&n&&(r[n]=e)};var o=t(["transform","WebkitTransform"]),a=!(_.setTransform=function(t,e){t.style[o]=e});try{var s=Object.defineProperty({},"passive",{get:function(){a=!0}});vt.window.addEventListener("test",s,s),vt.window.removeEventListener("test",s,s)}catch(vt){a=!1}_.addEventListener=function(t,e,i,r){void 0===r&&(r={}),t.addEventListener(e,i,"passive"in r&&a?r:r.capture)},_.removeEventListener=function(t,e,i,r){void 0===r&&(r={}),t.removeEventListener(e,i,"passive"in r&&a?r:r.capture)};var l=function(t){t.preventDefault(),t.stopPropagation(),vt.window.removeEventListener("click",l,!0)};_.suppressClick=function(){vt.window.addEventListener("click",l,!0),vt.window.setTimeout(function(){vt.window.removeEventListener("click",l,!0)},0)},_.mousePos=function(t,e){var i=t.getBoundingClientRect();return new vt.Point(e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop)},_.touchPos=function(t,e){for(var i=t.getBoundingClientRect(),r=[],n=0;n<e.length;n++)r.push(new vt.Point(e[n].clientX-i.left-t.clientLeft,e[n].clientY-i.top-t.clientTop));return r},_.mouseButton=function(t){return void 0!==vt.window.InstallTrigger&&2===t.button&&t.ctrlKey&&0<=vt.window.navigator.platform.toUpperCase().indexOf("MAC")?0:t.button},_.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)};var u,c=((u=vt.Evented)&&(f.__proto__=u),((f.prototype=Object.create(u&&u.prototype)).constructor=f).prototype.isLoaded=function(){return this.loaded},f.prototype.setLoaded=function(t){if(this.loaded!==t&&(this.loaded=t)){for(var e=0,i=this.requestors;e<i.length;e+=1){var r=i[e];this._notify(r.ids,r.callback)}this.requestors=[]}},f.prototype.getImage=function(t){return this.images[t]},f.prototype.addImage=function(t,e){this._validate(t,e)&&(this.images[t]=e)},f.prototype._validate=function(t,e){var i=!0;return this._validateStretch(e.stretchX,e.data&&e.data.width)||(this.fire(new vt.ErrorEvent(new Error('Image "'+t+'" has invalid "stretchX" value'))),i=!1),this._validateStretch(e.stretchY,e.data&&e.data.height)||(this.fire(new vt.ErrorEvent(new Error('Image "'+t+'" has invalid "stretchY" value'))),i=!1),this._validateContent(e.content,e)||(this.fire(new vt.ErrorEvent(new Error('Image "'+t+'" has invalid "content" value'))),i=!1),i},f.prototype._validateStretch=function(t,e){if(!t)return!0;for(var i=0,r=0,n=t;r<n.length;r+=1){var o=n[r];if(o[0]<i||o[1]<o[0]||e<o[1])return!1;i=o[1]}return!0},f.prototype._validateContent=function(t,e){return!(t&&(4!==t.length||t[0]<0||e.data.width<t[0]||t[1]<0||e.data.height<t[1]||t[2]<0||e.data.width<t[2]||t[3]<0||e.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))},f.prototype.updateImage=function(t,e){e.version=this.images[t].version+1,this.images[t]=e,this.updatedImages[t]=!0},f.prototype.removeImage=function(t){var e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()},f.prototype.listImages=function(){return Object.keys(this.images)},f.prototype.getImages=function(t,e){var i=!0;if(!this.isLoaded())for(var r=0,n=t;r<n.length;r+=1)this.images[n[r]]||(i=!1);this.isLoaded()||i?this._notify(t,e):this.requestors.push({ids:t,callback:e})},f.prototype._notify=function(t,e){for(var i={},r=0,n=t;r<n.length;r+=1){var o=n[r];this.images[o]||this.fire(new vt.Event("styleimagemissing",{id:o}));var a=this.images[o];a?i[o]={data:a.data.clone(),pixelRatio:a.pixelRatio,sdf:a.sdf,version:a.version,stretchX:a.stretchX,stretchY:a.stretchY,content:a.content,hasRenderCallback:Boolean(a.userImage&&a.userImage.render)}:vt.warnOnce('Image "'+o+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}e(null,i)},f.prototype.getPixelSize=function(){var t=this.atlasImage;return{width:t.width,height:t.height}},f.prototype.getPattern=function(t){var e=this.patterns[t],i=this.getImage(t);if(!i)return null;if(e&&e.position.version===i.version)return e.position;if(e)e.position.version=i.version;else{var r={w:i.data.width+2,h:i.data.height+2,x:0,y:0},n=new vt.ImagePosition(r,i);this.patterns[t]={bin:r,position:n}}return this._updatePatternAtlas(),this.patterns[t].position},f.prototype.bind=function(t){var e=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new vt.Texture(t,this.atlasImage,e.RGBA),this.atlasTexture.bind(e.LINEAR,e.CLAMP_TO_EDGE)},f.prototype._updatePatternAtlas=function(){var t=[];for(var e in this.patterns)t.push(this.patterns[e].bin);var i=vt.potpack(t),r=i.w,n=i.h,o=this.atlasImage;for(var a in o.resize({width:r||1,height:n||1}),this.patterns){var s=this.patterns[a].bin,l=s.x+1,u=s.y+1,c=this.images[a].data,p=c.width,h=c.height;vt.RGBAImage.copy(c,o,{x:0,y:0},{x:l,y:u},{width:p,height:h}),vt.RGBAImage.copy(c,o,{x:0,y:h-1},{x:l,y:u-1},{width:p,height:1}),vt.RGBAImage.copy(c,o,{x:0,y:0},{x:l,y:u+h},{width:p,height:1}),vt.RGBAImage.copy(c,o,{x:p-1,y:0},{x:l-1,y:u},{width:1,height:h}),vt.RGBAImage.copy(c,o,{x:0,y:0},{x:l+p,y:u},{width:1,height:h})}this.dirty=!0},f.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},f.prototype.dispatchRenderCallbacks=function(t){for(var e=0,i=t;e<i.length;e+=1){var r=i[e];if(!this.callbackDispatchedThisFrame[r]){this.callbackDispatchedThisFrame[r]=!0;var n=this.images[r];a=void 0,(a=(o=n).userImage)&&a.render&&a.render()&&(o.data.replace(new Uint8Array(a.data.buffer)),1)&&this.updateImage(r,n)}}var o,a},f),p=m,h=m,d=1e20;function f(){u.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new vt.RGBAImage({width:1,height:1}),this.dirty=!0}function m(t,e,i,r,n,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=r||.25,this.fontFamily=n||"sans-serif",this.fontWeight=o||"normal",this.radius=i||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(0<=navigator.userAgent.indexOf("Gecko/")?1.2:1))}function g(t,e,i,r,n,o,a){for(var s=0;s<e;s++){for(var l=0;l<i;l++)r[l]=t[l*e+s];for(y(r,n,o,a,i),l=0;l<i;l++)t[l*e+s]=n[l]}for(l=0;l<i;l++){for(s=0;s<e;s++)r[s]=t[l*e+s];for(y(r,n,o,a,e),s=0;s<e;s++)t[l*e+s]=Math.sqrt(n[s])}}function y(t,e,i,r,n){r[i[0]=0]=-d,r[1]=+d;for(var o=1,a=0;o<n;o++){for(var s=(t[o]+o*o-(t[i[a]]+i[a]*i[a]))/(2*o-2*i[a]);s<=r[a];)a--,s=(t[o]+o*o-(t[i[a]]+i[a]*i[a]))/(2*o-2*i[a]);i[++a]=o,r[a]=s,r[a+1]=+d}for(a=o=0;o<n;o++){for(;r[a+1]<o;)a++;e[o]=(o-i[a])*(o-i[a])+t[i[a]]}}function v(t,e){this.requestManager=t,this.localIdeographFontFamily=e,this.entries={}}function x(){this.specification=vt.styleSpec.light.position}function b(t,e){this.width=t,this.height=e,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}m.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),i=new Uint8ClampedArray(this.size*this.size),r=0;r<this.size*this.size;r++){var n=e.data[4*r+3]/255;this.gridOuter[r]=1==n?0:0==n?d:Math.pow(Math.max(0,.5-n),2),this.gridInner[r]=1==n?d:0==n?0:Math.pow(Math.max(0,n-.5),2)}for(g(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),g(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),r=0;r<this.size*this.size;r++)i[r]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[r]-this.gridInner[r])/this.radius+this.cutoff))));return i},p.default=h,v.prototype.setURL=function(t){this.url=t},v.prototype.getGlyphs=function(t,u){var l=this,e=[];for(var i in t)for(var r=0,n=t[i];r<n.length;r+=1)e.push({stack:i,id:n[r]});vt.asyncAll(e,function(t,i){var r=t.stack,n=t.id,o=l.entries[r],e=(o=o||(l.entries[r]={glyphs:{},requests:{},ranges:{}})).glyphs[n];if(void 0===e){if(e=l._tinySDF(o,r,n))return o.glyphs[n]=e,void i(null,{stack:r,id:n,glyph:e});var a=Math.floor(n/256);if(65535<256*a)i(new Error("glyphs > 65535 not supported"));else if(o.ranges[a])i(null,{stack:r,id:n,glyph:e});else{var s=o.requests[a];s||(s=o.requests[a]=[],v.loadGlyphRange(r,a,l.url,l.requestManager,function(t,e){if(e){for(var i in e)l._doesCharSupportLocalGlyph(+i)||(o.glyphs[+i]=e[+i]);o.ranges[a]=!0}for(var r=0,n=s;r<n.length;r+=1)(0,n[r])(t,e);delete o.requests[a]})),s.push(function(t,e){t?i(t):e&&i(null,{stack:r,id:n,glyph:e[n]||null})})}}else i(null,{stack:r,id:n,glyph:e})},function(t,e){if(t)u(t);else if(e){for(var i={},r=0,n=e;r<n.length;r+=1){var o=n[r],a=o.stack,s=o.id,l=o.glyph;(i[a]||(i[a]={}))[s]=l&&{id:l.id,bitmap:l.bitmap.clone(),metrics:l.metrics}}u(null,i)}})},v.prototype._doesCharSupportLocalGlyph=function(t){return!!this.localIdeographFontFamily&&(vt.isChar["CJK Unified Ideographs"](t)||vt.isChar["Hangul Syllables"](t)||vt.isChar.Hiragana(t)||vt.isChar.Katakana(t))},v.prototype._tinySDF=function(t,e,i){var r=this.localIdeographFontFamily;if(r&&this._doesCharSupportLocalGlyph(i)){var n=t.tinySDF;if(!n){var o="400";/bold/i.test(e)?o="900":/medium/i.test(e)?o="500":/light/i.test(e)&&(o="200"),n=t.tinySDF=new v.TinySDF(24,3,8,.25,r,o)}return{id:i,bitmap:new vt.AlphaImage({width:30,height:30},n.draw(String.fromCharCode(i))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},v.loadGlyphRange=function(t,e,i,r,a){var n=256*e,o=255+n,s=r.transformRequest(r.normalizeGlyphsURL(i).replace("{fontstack}",t).replace("{range}",n+"-"+o),vt.ResourceType.Glyphs);vt.getArrayBuffer(s,function(t,e){if(t)a(t);else if(e){for(var i={},r=0,n=vt.parseGlyphPBF(e);r<n.length;r+=1){var o=n[r];i[o.id]=o}a(null,i)}})},v.TinySDF=p,x.prototype.possiblyEvaluate=function(t,e){return vt.sphericalToCartesian(t.expression.evaluate(e))},x.prototype.interpolate=function(t,e,i){return{x:vt.number(t.x,e.x,i),y:vt.number(t.y,e.y,i),z:vt.number(t.z,e.z,i)}};var w,S=new vt.Properties({anchor:new vt.DataConstantProperty(vt.styleSpec.light.anchor),position:new x,color:new vt.DataConstantProperty(vt.styleSpec.light.color),intensity:new vt.DataConstantProperty(vt.styleSpec.light.intensity)}),T=((w=vt.Evented)&&(I.__proto__=w),((I.prototype=Object.create(w&&w.prototype)).constructor=I).prototype.getLight=function(){return this._transitionable.serialize()},I.prototype.setLight=function(t,e){if(void 0===e&&(e={}),!this._validate(vt.validateLight,t,e))for(var i in t){var r=t[i];vt.endsWith(i,"-transition")?this._transitionable.setTransition(i.slice(0,-"-transition".length),r):this._transitionable.setValue(i,r)}},I.prototype.updateTransitions=function(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)},I.prototype.hasTransition=function(){return this._transitioning.hasTransition()},I.prototype.recalculate=function(t){this.properties=this._transitioning.possiblyEvaluate(t)},I.prototype._validate=function(t,e,i){return(!i||!1!==i.validate)&&vt.emitValidationErrors(this,t.call(vt.validateStyle,vt.extend({value:e,style:{glyphs:!0,sprite:!0},styleSpec:vt.styleSpec})))},I);function I(t){w.call(this),this._transitionable=new vt.Transitionable(S),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}function E(t,e){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=vt.uniqueId();for(var i=this.workerPool.acquire(this.id),r=0;r<i.length;r++){var n=new E.Actor(i[r],e,this.id);n.name="Worker "+r,this.actors.push(n)}}function C(r,n,o){function t(t,e){if(t)return o(t);if(e){var i=vt.pick(vt.extend(e,r),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);e.vector_layers&&(i.vectorLayers=e.vector_layers,i.vectorLayerIds=i.vectorLayers.map(function(t){return t.id})),i.tiles=n.canonicalizeTileset(i,r.url),o(null,i)}}return r.url?vt.getJSON(n.transformRequest(n.normalizeSourceURL(r.url),vt.ResourceType.Source),t):vt.browser.frame(function(){return t(null,r)})}function A(t,e,i){this.bounds=vt.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=e||0,this.maxzoom=i||24}b.prototype.getDash=function(t,e){var i=t.join(",")+String(e);return this.dashEntry[i]||(this.dashEntry[i]=this.addDash(t,e)),this.dashEntry[i]},b.prototype.getDashRanges=function(t,e,i){var r=[],n=t.length%2==1?-t[t.length-1]*i:0,o=t[0]*i,a=!0;r.push({left:n,right:o,isDash:a,zeroLength:0===t[0]});for(var s=t[0],l=1;l<t.length;l++){var u=t[l];r.push({left:n=s*i,right:o=(s+=u)*i,isDash:a=!a,zeroLength:0===u})}return r},b.prototype.addRoundDash=function(t,e,i){for(var r=e/2,n=-i;n<=i;n++)for(var o=this.width*(this.nextRow+i+n),a=0,s=t[a],l=0;l<this.width;l++){1<l/s.right&&(s=t[++a]);var u=Math.abs(l-s.left),c=Math.abs(l-s.right),p=Math.min(u,c),h=void 0,d=n/i*(1+r);if(s.isDash){var f=r-Math.abs(d);h=Math.sqrt(p*p+f*f)}else h=r-Math.sqrt(p*p+d*d);this.data[o+l]=Math.max(0,Math.min(255,h+128))}},b.prototype.addRegularDash=function(t){for(var e=t.length-1;0<=e;--e){var i=t[e],r=t[e+1];i.zeroLength?t.splice(e,1):r&&r.isDash===i.isDash&&(r.left=i.left,t.splice(e,1))}var n=t[0],o=t[t.length-1];n.isDash===o.isDash&&(n.left=o.left-this.width,o.right=n.right+this.width);for(var a=this.width*this.nextRow,s=0,l=t[s],u=0;u<this.width;u++){1<u/l.right&&(l=t[++s]);var c=Math.abs(u-l.left),p=Math.abs(u-l.right),h=Math.min(c,p);this.data[a+u]=Math.max(0,Math.min(255,(l.isDash?h:-h)+128))}},b.prototype.addDash=function(t,e){var i=e?7:0,r=2*i+1;if(this.nextRow+r>this.height)return vt.warnOnce("LineAtlas out of space"),null;for(var n=0,o=0;o<t.length;o++)n+=t[o];if(0!==n){var a=this.width/n,s=this.getDashRanges(t,this.width,a);e?this.addRoundDash(s,a,i):this.addRegularDash(s)}var l={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:n};return this.nextRow+=r,this.dirty=!0,l},b.prototype.bind=function(t){var e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.ALPHA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.ALPHA,this.width,this.height,0,e.ALPHA,e.UNSIGNED_BYTE,this.data))},E.prototype.broadcast=function(i,r,t){vt.asyncAll(this.actors,function(t,e){t.send(i,r,e)},t=t||function(){})},E.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},E.prototype.remove=function(){this.actors.forEach(function(t){t.remove()}),this.actors=[],this.workerPool.release(this.id)},E.Actor=vt.Actor,A.prototype.validateBounds=function(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]},A.prototype.contains=function(t){var e=Math.pow(2,t.z),i=Math.floor(vt.mercatorXfromLng(this.bounds.getWest())*e),r=Math.floor(vt.mercatorYfromLat(this.bounds.getNorth())*e),n=Math.ceil(vt.mercatorXfromLng(this.bounds.getEast())*e),o=Math.ceil(vt.mercatorYfromLat(this.bounds.getSouth())*e);return t.x>=i&&t.x<n&&t.y>=r&&t.y<o};var k,P,M,L,D,z,O,R=((O=vt.Evented)&&(J.__proto__=O),((J.prototype=Object.create(O&&O.prototype)).constructor=J).prototype.load=function(){var i=this;this._loaded=!1,this.fire(new vt.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=C(this._options,this.map._requestManager,function(t,e){i._tileJSONRequest=null,i._loaded=!0,t?i.fire(new vt.ErrorEvent(t)):e&&(vt.extend(i,e),e.bounds&&(i.tileBounds=new A(e.bounds,i.minzoom,i.maxzoom)),vt.postTurnstileEvent(e.tiles,i.map._requestManager._customAccessToken),vt.postMapLoadEvent(e.tiles,i.map._getMapId(),i.map._requestManager._skuToken,i.map._requestManager._customAccessToken),i.fire(new vt.Event("data",{dataType:"source",sourceDataType:"metadata"})),i.fire(new vt.Event("data",{dataType:"source",sourceDataType:"content"})))})},J.prototype.loaded=function(){return this._loaded},J.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},J.prototype.onAdd=function(t){this.map=t,this.load()},J.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},J.prototype.serialize=function(){return vt.extend({},this._options)},J.prototype.loadTile=function(i,r){var t=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme)),e={request:this.map._requestManager.transformRequest(t,vt.ResourceType.Tile),uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:vt.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function n(t,e){return delete i.request,i.aborted?r(null):t&&404!==t.status?r(t):(e&&e.resourceTiming&&(i.resourceTiming=e.resourceTiming),this.map._refreshExpiredTiles&&e&&i.setExpiryData(e),i.loadVectorData(e,this.map.painter),vt.cacheEntryPossiblyAdded(this.dispatcher),r(null),void(i.reloadCallback&&(this.loadTile(i,i.reloadCallback),i.reloadCallback=null)))}e.request.collectResourceTiming=this._collectResourceTiming,i.actor&&"expired"!==i.state?"loading"===i.state?i.reloadCallback=r:i.request=i.actor.send("reloadTile",e,n.bind(this)):(i.actor=this.dispatcher.getActor(),i.request=i.actor.send("loadTile",e,n.bind(this)))},J.prototype.abortTile=function(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0)},J.prototype.unloadTile=function(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0)},J.prototype.hasTransition=function(){return!1},J),N=((z=vt.Evented)&&(Y.__proto__=z),((Y.prototype=Object.create(z&&z.prototype)).constructor=Y).prototype.load=function(){var i=this;this._loaded=!1,this.fire(new vt.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=C(this._options,this.map._requestManager,function(t,e){i._tileJSONRequest=null,i._loaded=!0,t?i.fire(new vt.ErrorEvent(t)):e&&(vt.extend(i,e),e.bounds&&(i.tileBounds=new A(e.bounds,i.minzoom,i.maxzoom)),vt.postTurnstileEvent(e.tiles),vt.postMapLoadEvent(e.tiles,i.map._getMapId(),i.map._requestManager._skuToken),i.fire(new vt.Event("data",{dataType:"source",sourceDataType:"metadata"})),i.fire(new vt.Event("data",{dataType:"source",sourceDataType:"content"})))})},Y.prototype.loaded=function(){return this._loaded},Y.prototype.onAdd=function(t){this.map=t,this.load()},Y.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},Y.prototype.serialize=function(){return vt.extend({},this._options)},Y.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},Y.prototype.loadTile=function(n,o){var a=this,t=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);n.request=vt.getImage(this.map._requestManager.transformRequest(t,vt.ResourceType.Tile),function(t,e){if(delete n.request,n.aborted)n.state="unloaded",o(null);else if(t)n.state="errored",o(t);else if(e){a.map._refreshExpiredTiles&&n.setExpiryData(e),delete e.cacheControl,delete e.expires;var i=a.map.painter.context,r=i.gl;n.texture=a.map.painter.getTileTexture(e.width),n.texture?n.texture.update(e,{useMipmap:!0}):(n.texture=new vt.Texture(i,e,r.RGBA,{useMipmap:!0}),n.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE,r.LINEAR_MIPMAP_NEAREST),i.extTextureFilterAnisotropic&&r.texParameterf(r.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax)),n.state="loaded",vt.cacheEntryPossiblyAdded(a.dispatcher),o(null)}})},Y.prototype.abortTile=function(t,e){t.request&&(t.request.cancel(),delete t.request),e()},Y.prototype.unloadTile=function(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()},Y.prototype.hasTransition=function(){return!1},Y),B=(X.__proto__=D=N,((X.prototype=Object.create(D&&D.prototype)).constructor=X).prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},X.prototype.loadTile=function(n,o){var t=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);n.request=vt.getImage(this.map._requestManager.transformRequest(t,vt.ResourceType.Tile),function(t,e){if(delete n.request,n.aborted)n.state="unloaded",o(null);else if(t)n.state="errored",o(t);else if(e){this.map._refreshExpiredTiles&&n.setExpiryData(e),delete e.cacheControl,delete e.expires;var i=vt.window.ImageBitmap&&e instanceof vt.window.ImageBitmap&&vt.offscreenCanvasSupported()?e:vt.browser.getImageData(e,1),r={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:i,encoding:this.encoding};n.actor&&"expired"!==n.state||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",r,function(t,e){t&&(n.state="errored",o(t)),e&&(n.dem=e,n.needsHillshadePrepare=!0,n.state="loaded",o(null))}.bind(this)))}}.bind(this)),n.neighboringTiles=this._getNeighboringTiles(n.tileID)},X.prototype._getNeighboringTiles=function(t){var e=t.canonical,i=Math.pow(2,e.z),r=(e.x-1+i)%i,n=0===e.x?t.wrap-1:t.wrap,o=(e.x+1+i)%i,a=e.x+1===i?t.wrap+1:t.wrap,s={};return s[new vt.OverscaledTileID(t.overscaledZ,n,e.z,r,e.y).key]={backfilled:!1},s[new vt.OverscaledTileID(t.overscaledZ,a,e.z,o,e.y).key]={backfilled:!1},0<e.y&&(s[new vt.OverscaledTileID(t.overscaledZ,n,e.z,r,e.y-1).key]={backfilled:!1},s[new vt.OverscaledTileID(t.overscaledZ,t.wrap,e.z,e.x,e.y-1).key]={backfilled:!1},s[new vt.OverscaledTileID(t.overscaledZ,a,e.z,o,e.y-1).key]={backfilled:!1}),e.y+1<i&&(s[new vt.OverscaledTileID(t.overscaledZ,n,e.z,r,e.y+1).key]={backfilled:!1},s[new vt.OverscaledTileID(t.overscaledZ,t.wrap,e.z,e.x,e.y+1).key]={backfilled:!1},s[new vt.OverscaledTileID(t.overscaledZ,a,e.z,o,e.y+1).key]={backfilled:!1}),s},X.prototype.unloadTile=function(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})},X),F=((L=vt.Evented)&&(K.__proto__=L),((K.prototype=Object.create(L&&L.prototype)).constructor=K).prototype.load=function(){var i=this;this.fire(new vt.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(t){if(t)i.fire(new vt.ErrorEvent(t));else{var e={dataType:"source",sourceDataType:"metadata"};i._collectResourceTiming&&i._resourceTiming&&0<i._resourceTiming.length&&(e.resourceTiming=i._resourceTiming,i._resourceTiming=[]),i.fire(new vt.Event("data",e))}})},K.prototype.onAdd=function(t){this.map=t,this.load()},K.prototype.setData=function(t){var i=this;return this._data=t,this.fire(new vt.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(t){if(t)i.fire(new vt.ErrorEvent(t));else{var e={dataType:"source",sourceDataType:"content"};i._collectResourceTiming&&i._resourceTiming&&0<i._resourceTiming.length&&(e.resourceTiming=i._resourceTiming,i._resourceTiming=[]),i.fire(new vt.Event("data",e))}}),this},K.prototype.getClusterExpansionZoom=function(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e),this},K.prototype.getClusterChildren=function(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e),this},K.prototype.getClusterLeaves=function(t,e,i,r){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:i},r),this},K.prototype._updateWorkerData=function(i){var r=this;this._loaded=!1;var n=vt.extend({},this.workerOptions),t=this._data;"string"==typeof t?(n.request=this.map._requestManager.transformRequest(vt.browser.resolveURL(t),vt.ResourceType.Source),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(t),this.actor.send(this.type+".loadData",n,function(t,e){r._removed||e&&e.abandoned||(r._loaded=!0,e&&e.resourceTiming&&e.resourceTiming[r.id]&&(r._resourceTiming=e.resourceTiming[r.id].slice(0)),r.actor.send(r.type+".coalesce",{source:n.source},null),i(t))})},K.prototype.loaded=function(){return this._loaded},K.prototype.loadTile=function(i,r){var n=this,o=i.actor?"reloadTile":"loadTile";i.actor=this.actor,i.request=this.actor.send(o,{type:this.type,uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:vt.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(t,e){return delete i.request,i.unloadVectorData(),i.aborted?r(null):t?r(t):(i.loadVectorData(e,n.map.painter,"reloadTile"==o),r(null))})},K.prototype.abortTile=function(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0},K.prototype.unloadTile=function(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})},K.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},K.prototype.serialize=function(){return vt.extend({},this._options,{type:this.type,data:this._data})},K.prototype.hasTransition=function(){return!1},K),U=vt.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),j=((M=vt.Evented)&&(W.__proto__=M),((W.prototype=Object.create(M&&M.prototype)).constructor=W).prototype.load=function(i,r){var n=this;this._loaded=!1,this.fire(new vt.Event("dataloading",{dataType:"source"})),this.url=this.options.url,vt.getImage(this.map._requestManager.transformRequest(this.url,vt.ResourceType.Image),function(t,e){n._loaded=!0,t?n.fire(new vt.ErrorEvent(t)):e&&(n.image=e,i&&(n.coordinates=i),r&&r(),n._finishLoading())})},W.prototype.loaded=function(){return this._loaded},W.prototype.updateImage=function(t){var e=this;return this.image&&t.url&&(this.options.url=t.url,this.load(t.coordinates,function(){e.texture=null})),this},W.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new vt.Event("data",{dataType:"source",sourceDataType:"metadata"})))},W.prototype.onAdd=function(t){this.map=t,this.load()},W.prototype.setCoordinates=function(t){var e=this,c=(this.coordinates=t).map(vt.MercatorCoordinate.fromLngLat);this.tileID=function(){for(var t=1/0,e=1/0,i=-1/0,r=-1/0,n=0,o=c;n<o.length;n+=1){var a=o[n];t=Math.min(t,a.x),e=Math.min(e,a.y),i=Math.max(i,a.x),r=Math.max(r,a.y)}var s=Math.max(i-t,r-e),l=Math.max(0,Math.floor(-Math.log(s)/Math.LN2)),u=Math.pow(2,l);return new vt.CanonicalTileID(l,Math.floor((t+i)/2*u),Math.floor((e+r)/2*u))}(),this.minzoom=this.maxzoom=this.tileID.z;var i=c.map(function(t){return e.tileID.getTilePoint(t)._round()});return this._boundsArray=new vt.StructArrayLayout4i8,this._boundsArray.emplaceBack(i[0].x,i[0].y,0,0),this._boundsArray.emplaceBack(i[1].x,i[1].y,vt.EXTENT,0),this._boundsArray.emplaceBack(i[3].x,i[3].y,0,vt.EXTENT),this._boundsArray.emplaceBack(i[2].x,i[2].y,vt.EXTENT,vt.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new vt.Event("data",{dataType:"source",sourceDataType:"content"})),this},W.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var t=this.map.painter.context,e=t.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,U.members)),this.boundsSegments||(this.boundsSegments=vt.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new vt.Texture(t,this.image,e.RGBA),this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE)),this.tiles){var r=this.tiles[i];"loaded"!==r.state&&(r.state="loaded",r.texture=this.texture)}}},W.prototype.loadTile=function(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t).buckets={}:t.state="errored",e(null)},W.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},W.prototype.hasTransition=function(){return!1},W),q=(H.__proto__=P=j,((H.prototype=Object.create(P&&P.prototype)).constructor=H).prototype.load=function(){var i=this;this._loaded=!1;var t=this.options;this.urls=[];for(var e=0,r=t.urls;e<r.length;e+=1)this.urls.push(this.map._requestManager.transformRequest(r[e],vt.ResourceType.Source).url);vt.getVideo(this.urls,function(t,e){i._loaded=!0,t?i.fire(new vt.ErrorEvent(t)):e&&(i.video=e,i.video.loop=!0,i.video.addEventListener("playing",function(){i.map.triggerRepaint()}),i.map&&i.video.play(),i._finishLoading())})},H.prototype.pause=function(){this.video&&this.video.pause()},H.prototype.play=function(){this.video&&this.video.play()},H.prototype.seek=function(t){if(this.video){var e=this.video.seekable;t<e.start(0)||t>e.end(0)?this.fire(new vt.ErrorEvent(new vt.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+e.start(0)+" and "+e.end(0)+"-second mark."))):this.video.currentTime=t}},H.prototype.getVideo=function(){return this.video},H.prototype.onAdd=function(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},H.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var t=this.map.painter.context,e=t.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,U.members)),this.boundsSegments||(this.boundsSegments=vt.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE),e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,this.video)):(this.texture=new vt.Texture(t,this.video,e.RGBA),this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE)),this.tiles){var r=this.tiles[i];"loaded"!==r.state&&(r.state="loaded",r.texture=this.texture)}}},H.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},H.prototype.hasTransition=function(){return this.video&&!this.video.paused},H),V=(Z.__proto__=k=j,((Z.prototype=Object.create(k&&k.prototype)).constructor=Z).prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof vt.window.HTMLCanvasElement?this.options.canvas:vt.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new vt.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},Z.prototype.getCanvas=function(){return this.canvas},Z.prototype.onAdd=function(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()},Z.prototype.onRemove=function(){this.pause()},Z.prototype.prepare=function(){var t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var e=this.map.painter.context,i=e.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,U.members)),this.boundsSegments||(this.boundsSegments=vt.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new vt.Texture(e,this.canvas,i.RGBA,{premultiply:!0}),this.tiles){var n=this.tiles[r];"loaded"!==n.state&&(n.state="loaded",n.texture=this.texture)}}},Z.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},Z.prototype.hasTransition=function(){return this._playing},Z.prototype._hasInvalidDimensions=function(){for(var t=0,e=[this.canvas.width,this.canvas.height];t<e.length;t+=1){var i=e[t];if(isNaN(i)||i<=0)return!0}return!1},Z),G={vector:R,raster:N,"raster-dem":B,geojson:F,video:q,image:j,canvas:V};function Z(t,e,i,r){k.call(this,t,e,i,r),e.coordinates?Array.isArray(e.coordinates)&&4===e.coordinates.length&&!e.coordinates.some(function(t){return!Array.isArray(t)||2!==t.length||t.some(function(t){return"number"!=typeof t})})||this.fire(new vt.ErrorEvent(new vt.ValidationError("sources."+t,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new vt.ErrorEvent(new vt.ValidationError("sources."+t,null,'missing required property "coordinates"'))),e.animate&&"boolean"!=typeof e.animate&&this.fire(new vt.ErrorEvent(new vt.ValidationError("sources."+t,null,'optional "animate" property must be a boolean value'))),e.canvas?"string"==typeof e.canvas||e.canvas instanceof vt.window.HTMLCanvasElement||this.fire(new vt.ErrorEvent(new vt.ValidationError("sources."+t,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new vt.ErrorEvent(new vt.ValidationError("sources."+t,null,'missing required property "canvas"'))),this.options=e,this.animate=void 0===e.animate||e.animate}function H(t,e,i,r){P.call(this,t,e,i,r),this.roundZoom=!0,this.type="video",this.options=e}function W(t,e,i,r){M.call(this),this.id=t,this.dispatcher=i,this.coordinates=e.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(r),this.options=e}function K(t,e,i,r){L.call(this),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=i.getActor(),this.setEventedParent(r),this._data=e.data,this._options=vt.extend({},e),this._collectResourceTiming=e.collectResourceTiming,this._resourceTiming=[],void 0!==e.maxzoom&&(this.maxzoom=e.maxzoom),e.type&&(this.type=e.type),e.attribution&&(this.attribution=e.attribution),this.promoteId=e.promoteId;var n=vt.EXTENT/this.tileSize;this.workerOptions=vt.extend({source:this.id,cluster:e.cluster||!1,geojsonVtOptions:{buffer:(void 0!==e.buffer?e.buffer:128)*n,tolerance:(void 0!==e.tolerance?e.tolerance:.375)*n,extent:vt.EXTENT,maxZoom:this.maxzoom,lineMetrics:e.lineMetrics||!1,generateId:e.generateId||!1},superclusterOptions:{maxZoom:void 0!==e.clusterMaxZoom?Math.min(e.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,e.clusterMinPoints||2),extent:vt.EXTENT,radius:(e.clusterRadius||50)*n,log:!1,generateId:e.generateId||!1},clusterProperties:e.clusterProperties},e.workerOptions)}function X(t,e,i,r){D.call(this,t,e,i,r),this.type="raster-dem",this.maxzoom=22,this._options=vt.extend({type:"raster-dem"},e),this.encoding=e.encoding||"mapbox"}function Y(t,e,i,r){z.call(this),this.id=t,this.dispatcher=i,this.setEventedParent(r),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=vt.extend({type:"raster"},e),vt.extend(this,vt.pick(e,["url","scheme","tileSize"]))}function J(t,e,i,r){if(O.call(this),this.id=t,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,vt.extend(this,vt.pick(e,["url","scheme","tileSize","promoteId"])),this._options=vt.extend({type:"vector"},e),this._collectResourceTiming=e.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(r)}function Q(r,t,e,i,n,o){var a,s,l,u=function(t,e,i){if(t)for(var r=0,n=t;r<n.length;r+=1){var o=e[n[r]];if(o&&o.source===i&&"fill-extrusion"===o.type)return!0}else for(var a in e){var s=e[a];if(s.source===i&&"fill-extrusion"===s.type)return!0}return!1}(n&&n.layers,t,r.id),c=o.maxPitchScaleFactor(),p=r.tilesIn(i,c,u);p.sort($);for(var m=[],h=0,d=p;h<d.length;h+=1){var f=d[h];m.push({wrappedTileID:f.tileID.wrapped().key,queryResults:f.tile.queryRenderedFeatures(t,e,r._state,f.queryGeometry,f.cameraQueryGeometry,f.scale,n,o,c,(a=r.transform,s=f.tileID,l=vt.identity([]),vt.translate(l,l,[1,1,0]),vt.scale(l,l,[.5*a.width,.5*a.height,1]),vt.multiply(l,l,a.calculatePosMatrix(s.toUnwrapped()))))})}var g=function(){for(var t={},e={},i=0,r=m;i<r.length;i+=1){var n=r[i],o=n.queryResults,a=n.wrappedTileID,s=e[a]=e[a]||{};for(var l in o)for(var u=o[l],c=s[l]=s[l]||{},p=t[l]=t[l]||[],h=0,d=u;h<d.length;h+=1){var f=d[h];c[f.featureIndex]||(c[f.featureIndex]=!0,p.push(f))}}return t}();for(var y in g)g[y].forEach(function(t){var e=t.feature,i=r.getFeatureState(e.layer["source-layer"],e.id);e.source=e.layer.source,e.layer["source-layer"]&&(e.sourceLayer=e.layer["source-layer"]),e.state=i});return g}function $(t,e){var i=t.tileID,r=e.tileID;return i.overscaledZ-r.overscaledZ||i.canonical.y-r.canonical.y||i.wrap-r.wrap||i.canonical.x-r.canonical.x}function tt(t,e){this.max=t,this.onRemove=e,this.reset()}function et(t,e,i){var r=(this.context=t).gl;this.buffer=r.createBuffer(),this.dynamicDraw=Boolean(i),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}function it(t,e,i,r){this.length=e.length,this.attributes=i,this.itemSize=e.bytesPerElement,this.dynamicDraw=r;var n=(this.context=t).gl;this.buffer=n.createBuffer(),t.bindVertexBuffer.set(this.buffer),n.bufferData(n.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}tt.prototype.reset=function(){for(var t in this.data)for(var e=0,i=this.data[t];e<i.length;e+=1){var r=i[e];r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value)}return this.data={},this.order=[],this},tt.prototype.add=function(t,e,i){var r=this,n=t.wrapped().key;void 0===this.data[n]&&(this.data[n]=[]);var o={value:e,timeout:void 0};if(void 0!==i&&(o.timeout=setTimeout(function(){r.remove(t,o)},i)),this.data[n].push(o),this.order.push(n),this.order.length>this.max){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},tt.prototype.has=function(t){return t.wrapped().key in this.data},tt.prototype.getAndRemove=function(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null},tt.prototype._getAndRemoveByKey=function(t){var e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value},tt.prototype.getByKey=function(t){var e=this.data[t];return e?e[0].value:null},tt.prototype.get=function(t){return this.has(t)?this.data[t.wrapped().key][0].value:null},tt.prototype.remove=function(t,e){if(!this.has(t))return this;var i=t.wrapped().key,r=void 0===e?0:this.data[i].indexOf(e),n=this.data[i][r];return this.data[i].splice(r,1),n.timeout&&clearTimeout(n.timeout),0===this.data[i].length&&delete this.data[i],this.onRemove(n.value),this.order.splice(this.order.indexOf(i),1),this},tt.prototype.setMaxSize=function(t){for(this.max=t;this.order.length>this.max;){var e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this},tt.prototype.filter=function(t){var e=[];for(var i in this.data)for(var r=0,n=this.data[i];r<n.length;r+=1){var o=n[r];t(o.value)||e.push(o)}for(var a=0,s=e;a<s.length;a+=1){var l=s[a];this.remove(l.value.tileID,l)}},et.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},et.prototype.updateData=function(t){var e=this.context.gl;this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)},et.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var rt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};function nt(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}function ot(t,e,i,r){this.context=t,this.width=e,this.height=i;var n=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new _e(t,n),r&&(this.depthAttachment=new xe(t,n))}it.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},it.prototype.updateData=function(t){var e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)},it.prototype.enableAttributes=function(t,e){for(var i=0;i<this.attributes.length;i++){var r=e.attributes[this.attributes[i].name];void 0!==r&&t.enableVertexAttribArray(r)}},it.prototype.setVertexAttribPointers=function(t,e,i){for(var r=0;r<this.attributes.length;r++){var n=this.attributes[r],o=e.attributes[n.name];void 0!==o&&t.vertexAttribPointer(o,n.components,t[rt[n.type]],!1,this.itemSize,n.offset+this.itemSize*(i||0))}},it.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)},nt.prototype.get=function(){return this.current},nt.prototype.set=function(t){},nt.prototype.getDefault=function(){return this.default},nt.prototype.setDefault=function(){this.set(this.default)};var at,st,lt,ut,ct,pt,ht,dt,ft,mt,gt,yt,_t,xt,bt,wt,St,Tt,It,Et,Ct,At,kt,Pt,Mt,Lt,Dt,zt,Ot,Rt,Nt,Bt,Ft,Ut,jt=(ti.__proto__=Ut=nt,((ti.prototype=Object.create(Ut&&Ut.prototype)).constructor=ti).prototype.getDefault=function(){return vt.Color.transparent},ti.prototype.set=function(t){var e=this.current;t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a&&!this.dirty||(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)},ti),qt=($e.__proto__=Ft=nt,(($e.prototype=Object.create(Ft&&Ft.prototype)).constructor=$e).prototype.getDefault=function(){return 1},$e.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.clearDepth(t),this.current=t,this.dirty=!1)},$e),Vt=(Qe.__proto__=Bt=nt,((Qe.prototype=Object.create(Bt&&Bt.prototype)).constructor=Qe).prototype.getDefault=function(){return 0},Qe.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.clearStencil(t),this.current=t,this.dirty=!1)},Qe),Gt=(Je.__proto__=Nt=nt,((Je.prototype=Object.create(Nt&&Nt.prototype)).constructor=Je).prototype.getDefault=function(){return[!0,!0,!0,!0]},Je.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&!this.dirty||(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)},Je),Zt=(Ye.__proto__=Rt=nt,((Ye.prototype=Object.create(Rt&&Rt.prototype)).constructor=Ye).prototype.getDefault=function(){return!0},Ye.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.depthMask(t),this.current=t,this.dirty=!1)},Ye),Ht=(Xe.__proto__=Ot=nt,((Xe.prototype=Object.create(Ot&&Ot.prototype)).constructor=Xe).prototype.getDefault=function(){return 255},Xe.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.stencilMask(t),this.current=t,this.dirty=!1)},Xe),Wt=(Ke.__proto__=zt=nt,((Ke.prototype=Object.create(zt&&zt.prototype)).constructor=Ke).prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},Ke.prototype.set=function(t){var e=this.current;t.func===e.func&&t.ref===e.ref&&t.mask===e.mask&&!this.dirty||(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)},Ke),Kt=(We.__proto__=Dt=nt,((We.prototype=Object.create(Dt&&Dt.prototype)).constructor=We).prototype.getDefault=function(){var t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]},We.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&!this.dirty||(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)},We),Xt=(He.__proto__=Lt=nt,((He.prototype=Object.create(Lt&&Lt.prototype)).constructor=He).prototype.getDefault=function(){return!1},He.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}},He),Yt=(Ze.__proto__=Mt=nt,((Ze.prototype=Object.create(Mt&&Mt.prototype)).constructor=Ze).prototype.getDefault=function(){return[0,1]},Ze.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&!this.dirty||(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)},Ze),Jt=(Ge.__proto__=Pt=nt,((Ge.prototype=Object.create(Pt&&Pt.prototype)).constructor=Ge).prototype.getDefault=function(){return!1},Ge.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}},Ge),Qt=(Ve.__proto__=kt=nt,((Ve.prototype=Object.create(kt&&kt.prototype)).constructor=Ve).prototype.getDefault=function(){return this.gl.LESS},Ve.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.depthFunc(t),this.current=t,this.dirty=!1)},Ve),$t=(qe.__proto__=At=nt,((qe.prototype=Object.create(At&&At.prototype)).constructor=qe).prototype.getDefault=function(){return!1},qe.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}},qe),te=(je.__proto__=Ct=nt,((je.prototype=Object.create(Ct&&Ct.prototype)).constructor=je).prototype.getDefault=function(){var t=this.gl;return[t.ONE,t.ZERO]},je.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&!this.dirty||(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)},je),ee=(Ue.__proto__=Et=nt,((Ue.prototype=Object.create(Et&&Et.prototype)).constructor=Ue).prototype.getDefault=function(){return vt.Color.transparent},Ue.prototype.set=function(t){var e=this.current;t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a&&!this.dirty||(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)},Ue),ie=(Fe.__proto__=It=nt,((Fe.prototype=Object.create(It&&It.prototype)).constructor=Fe).prototype.getDefault=function(){return this.gl.FUNC_ADD},Fe.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.blendEquation(t),this.current=t,this.dirty=!1)},Fe),re=(Be.__proto__=Tt=nt,((Be.prototype=Object.create(Tt&&Tt.prototype)).constructor=Be).prototype.getDefault=function(){return!1},Be.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}},Be),ne=(Ne.__proto__=St=nt,((Ne.prototype=Object.create(St&&St.prototype)).constructor=Ne).prototype.getDefault=function(){return this.gl.BACK},Ne.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.cullFace(t),this.current=t,this.dirty=!1)},Ne),oe=(Re.__proto__=wt=nt,((Re.prototype=Object.create(wt&&wt.prototype)).constructor=Re).prototype.getDefault=function(){return this.gl.CCW},Re.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.frontFace(t),this.current=t,this.dirty=!1)},Re),ae=(Oe.__proto__=bt=nt,((Oe.prototype=Object.create(bt&&bt.prototype)).constructor=Oe).prototype.getDefault=function(){return null},Oe.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.useProgram(t),this.current=t,this.dirty=!1)},Oe),se=(ze.__proto__=xt=nt,((ze.prototype=Object.create(xt&&xt.prototype)).constructor=ze).prototype.getDefault=function(){return this.gl.TEXTURE0},ze.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.activeTexture(t),this.current=t,this.dirty=!1)},ze),le=(De.__proto__=_t=nt,((De.prototype=Object.create(_t&&_t.prototype)).constructor=De).prototype.getDefault=function(){var t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]},De.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&!this.dirty||(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)},De),ue=(Le.__proto__=yt=nt,((Le.prototype=Object.create(yt&&yt.prototype)).constructor=Le).prototype.getDefault=function(){return null},Le.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}},Le),ce=(Me.__proto__=gt=nt,((Me.prototype=Object.create(gt&&gt.prototype)).constructor=Me).prototype.getDefault=function(){return null},Me.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},Me),pe=(Pe.__proto__=mt=nt,((Pe.prototype=Object.create(mt&&mt.prototype)).constructor=Pe).prototype.getDefault=function(){return null},Pe.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}},Pe),he=(ke.__proto__=ft=nt,((ke.prototype=Object.create(ft&&ft.prototype)).constructor=ke).prototype.getDefault=function(){return null},ke.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}},ke),de=(Ae.__proto__=dt=nt,((Ae.prototype=Object.create(dt&&dt.prototype)).constructor=Ae).prototype.getDefault=function(){return null},Ae.prototype.set=function(t){var e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1},Ae),fe=(Ce.__proto__=ht=nt,((Ce.prototype=Object.create(ht&&ht.prototype)).constructor=Ce).prototype.getDefault=function(){return null},Ce.prototype.set=function(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)},Ce),me=(Ee.__proto__=pt=nt,((Ee.prototype=Object.create(pt&&pt.prototype)).constructor=Ee).prototype.getDefault=function(){return 4},Ee.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}},Ee),ge=(Ie.__proto__=ct=nt,((Ie.prototype=Object.create(ct&&ct.prototype)).constructor=Ie).prototype.getDefault=function(){return!1},Ie.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}},Ie),ye=(Te.__proto__=ut=nt,((Te.prototype=Object.create(ut&&ut.prototype)).constructor=Te).prototype.getDefault=function(){return!1},Te.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}},Te),ve=(Se.__proto__=lt=nt,((Se.prototype=Object.create(lt&&lt.prototype)).constructor=Se).prototype.getDefault=function(){return null},Se),_e=(we.__proto__=st=ve,((we.prototype=Object.create(st&&st.prototype)).constructor=we).prototype.setDirty=function(){this.dirty=!0},we.prototype.set=function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}},we),xe=(be.__proto__=at=ve,((be.prototype=Object.create(at&&at.prototype)).constructor=be).prototype.set=function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},be);function be(){at.apply(this,arguments)}function we(){st.apply(this,arguments)}function Se(t,e){lt.call(this,t),this.context=t,this.parent=e}function Te(){ut.apply(this,arguments)}function Ie(){ct.apply(this,arguments)}function Ee(){pt.apply(this,arguments)}function Ce(t){ht.call(this,t),this.vao=t.extVertexArrayObject}function Ae(){dt.apply(this,arguments)}function ke(){ft.apply(this,arguments)}function Pe(){mt.apply(this,arguments)}function Me(){gt.apply(this,arguments)}function Le(){yt.apply(this,arguments)}function De(){_t.apply(this,arguments)}function ze(){xt.apply(this,arguments)}function Oe(){bt.apply(this,arguments)}function Re(){wt.apply(this,arguments)}function Ne(){St.apply(this,arguments)}function Be(){Tt.apply(this,arguments)}function Fe(){It.apply(this,arguments)}function Ue(){Et.apply(this,arguments)}function je(){Ct.apply(this,arguments)}function qe(){At.apply(this,arguments)}function Ve(){kt.apply(this,arguments)}function Ge(){Pt.apply(this,arguments)}function Ze(){Mt.apply(this,arguments)}function He(){Lt.apply(this,arguments)}function We(){Dt.apply(this,arguments)}function Ke(){zt.apply(this,arguments)}function Xe(){Ot.apply(this,arguments)}function Ye(){Rt.apply(this,arguments)}function Je(){Nt.apply(this,arguments)}function Qe(){Bt.apply(this,arguments)}function $e(){Ft.apply(this,arguments)}function ti(){Ut.apply(this,arguments)}ot.prototype.destroy=function(){var t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){var i=this.depthAttachment.get();i&&t.deleteRenderbuffer(i)}t.deleteFramebuffer(this.framebuffer)};var ei=function(t,e,i){this.func=t,this.mask=e,this.range=i};ei.ReadOnly=!1,ei.ReadWrite=!0,ei.disabled=new ei(519,ei.ReadOnly,[0,1]);var ii=function(t,e,i,r,n,o){this.test=t,this.ref=e,this.mask=i,this.fail=r,this.depthFail=n,this.pass=o};ii.disabled=new ii({func:519,mask:0},0,0,7680,7680,7680);var ri=function(t,e,i){this.blendFunction=t,this.blendColor=e,this.mask=i};ri.disabled=new ri(ri.Replace=[1,0],vt.Color.transparent,[!1,!1,!1,!1]),ri.unblended=new ri(ri.Replace,vt.Color.transparent,[!0,!0,!0,!0]),ri.alphaBlended=new ri([1,771],vt.Color.transparent,[!0,!0,!0,!0]);var ni=function(t,e,i){this.enable=t,this.mode=e,this.frontFace=i};function oi(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new jt(this),this.clearDepth=new qt(this),this.clearStencil=new Vt(this),this.colorMask=new Gt(this),this.depthMask=new Zt(this),this.stencilMask=new Ht(this),this.stencilFunc=new Wt(this),this.stencilOp=new Kt(this),this.stencilTest=new Xt(this),this.depthRange=new Yt(this),this.depthTest=new Jt(this),this.depthFunc=new Qt(this),this.blend=new $t(this),this.blendFunc=new te(this),this.blendColor=new ee(this),this.blendEquation=new ie(this),this.cullFace=new re(this),this.cullFaceSide=new ne(this),this.frontFace=new oe(this),this.program=new ae(this),this.activeTexture=new se(this),this.viewport=new le(this),this.bindFramebuffer=new ue(this),this.bindRenderbuffer=new ce(this),this.bindTexture=new pe(this),this.bindVertexBuffer=new he(this),this.bindElementBuffer=new de(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new fe(this),this.pixelStoreUnpack=new me(this),this.pixelStoreUnpackPremultiplyAlpha=new ge(this),this.pixelStoreUnpackFlipY=new ye(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query")}ni.disabled=new ni(!1,1029,2305),ni.backCCW=new ni(!0,1029,2305),oi.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},oi.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},oi.prototype.createIndexBuffer=function(t,e){return new et(this,t,e)},oi.prototype.createVertexBuffer=function(t,e,i){return new it(this,t,e,i)},oi.prototype.createRenderbuffer=function(t,e,i){var r=this.gl,n=r.createRenderbuffer();return this.bindRenderbuffer.set(n),r.renderbufferStorage(r.RENDERBUFFER,t,e,i),this.bindRenderbuffer.set(null),n},oi.prototype.createFramebuffer=function(t,e,i){return new ot(this,t,e,i)},oi.prototype.clear=function(t){var e=t.color,i=t.depth,r=this.gl,n=0;e&&(n|=r.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==i&&(n|=r.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),r.clear(n)},oi.prototype.setCullFace=function(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))},oi.prototype.setDepthMode=function(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)},oi.prototype.setStencilMode=function(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)},oi.prototype.setColorMode=function(t){vt.deepEqual(t.blendFunction,ri.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)},oi.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var ai,si=((ai=vt.Evented)&&(li.__proto__=ai),((li.prototype=Object.create(ai&&ai.prototype)).constructor=li).prototype.onAdd=function(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)},li.prototype.onRemove=function(t){this._source&&this._source.onRemove&&this._source.onRemove(t)},li.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var t in this._tiles){var e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0},li.prototype.getSource=function(){return this._source},li.prototype.pause=function(){this._paused=!0},li.prototype.resume=function(){if(this._paused){var t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}},li.prototype._loadTile=function(t,e){return this._source.loadTile(t,e)},li.prototype._unloadTile=function(t){if(this._source.unloadTile)return this._source.unloadTile(t,function(){})},li.prototype._abortTile=function(t){if(this._source.abortTile)return this._source.abortTile(t,function(){})},li.prototype.serialize=function(){return this._source.serialize()},li.prototype.prepare=function(t){for(var e in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var i=this._tiles[e];i.upload(t),i.prepare(this.map.style.imageManager)}},li.prototype.getIds=function(){return vt.values(this._tiles).map(function(t){return t.tileID}).sort(ui).map(function(t){return t.key})},li.prototype.getRenderableIds=function(t){var a=this,e=[];for(var i in this._tiles)this._isIdRenderable(i,t)&&e.push(this._tiles[i]);return t?e.sort(function(t,e){var i=t.tileID,r=e.tileID,n=new vt.Point(i.canonical.x,i.canonical.y)._rotate(a.transform.angle),o=new vt.Point(r.canonical.x,r.canonical.y)._rotate(a.transform.angle);return i.overscaledZ-r.overscaledZ||o.y-n.y||o.x-n.x}).map(function(t){return t.tileID.key}):e.map(function(t){return t.tileID}).sort(ui).map(function(t){return t.key})},li.prototype.hasRenderableParent=function(t){var e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)},li.prototype._isIdRenderable=function(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())},li.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var t in this._cache.reset(),this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(t,"reloading")},li.prototype._reloadTile=function(t,e){var i=this._tiles[t];i&&("loading"!==i.state&&(i.state=e),this._loadTile(i,this._tileLoaded.bind(this,i,t,e)))},li.prototype._tileLoaded=function(t,e,i,r){if(r)return t.state="errored",void(404!==r.status?this._source.fire(new vt.ErrorEvent(r,{tile:t})):this.update(this.transform));t.timeAdded=vt.browser.now(),"expired"===i&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(e,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new vt.Event("data",{dataType:"source",tile:t,coord:t.tileID}))},li.prototype._backfillDEM=function(t){for(var e=this.getRenderableIds(),i=0;i<e.length;i++){var r=e[i];if(t.neighboringTiles&&t.neighboringTiles[r]){var n=this.getTileByID(r);o(t,n),o(n,t)}}function o(t,e){t.needsHillshadePrepare=!0;var i=e.tileID.canonical.x-t.tileID.canonical.x,r=e.tileID.canonical.y-t.tileID.canonical.y,n=Math.pow(2,t.tileID.canonical.z),o=e.tileID.key;0===i&&0==r||1<Math.abs(r)||(1<Math.abs(i)&&(1===Math.abs(i+n)?i+=n:1===Math.abs(i-n)&&(i-=n)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,i,r),t.neighboringTiles&&t.neighboringTiles[o]&&(t.neighboringTiles[o].backfilled=!0)))}},li.prototype.getTile=function(t){return this.getTileByID(t.key)},li.prototype.getTileByID=function(t){return this._tiles[t]},li.prototype._retainLoadedChildren=function(t,e,i,r){for(var n in this._tiles){var o=this._tiles[n];if(!(r[n]||!o.hasData()||o.tileID.overscaledZ<=e||o.tileID.overscaledZ>i)){for(var a=o.tileID;o&&o.tileID.overscaledZ>e+1;){var s=o.tileID.scaledTo(o.tileID.overscaledZ-1);(o=this._tiles[s.key])&&o.hasData()&&(a=s)}for(var l=a;l.overscaledZ>e;)if(t[(l=l.scaledTo(l.overscaledZ-1)).key]){r[a.key]=a;break}}}},li.prototype.findLoadedParent=function(t,e){if(t.key in this._loadedParentTiles){var i=this._loadedParentTiles[t.key];return i&&i.tileID.overscaledZ>=e?i:null}for(var r=t.overscaledZ-1;e<=r;r--){var n=t.scaledTo(r),o=this._getLoadedTile(n);if(o)return o}},li.prototype._getLoadedTile=function(t){var e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(t.wrapped().key)},li.prototype.updateCacheSize=function(t){var e=Math.ceil(t.width/this._source.tileSize)+1,i=Math.ceil(t.height/this._source.tileSize)+1,r=Math.floor(e*i*5),n="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(n)},li.prototype.handleWrapJump=function(t){var e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){var i={};for(var r in this._tiles){var n=this._tiles[r];n.tileID=n.tileID.unwrapTo(n.tileID.wrap+e),i[n.tileID.key]=n}for(var o in this._tiles=i,this._timers)clearTimeout(this._timers[o]),delete this._timers[o];for(var a in this._tiles)this._setTileReloadTimer(a,this._tiles[a])}},li.prototype.update=function(t){var e=this;if(this.transform=t,this._sourceLoaded&&!this._paused){var i;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?i=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(t){return new vt.OverscaledTileID(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)}):(i=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(i=i.filter(function(t){return e._source.hasTile(t)}))):i=[];var r=t.coveringZoomLevel(this._source),n=Math.max(r-li.maxOverzooming,this._source.minzoom),o=Math.max(r+li.maxUnderzooming,this._source.minzoom),a=this._updateRetainedTiles(i,r);if(ci(this._source.type)){for(var s={},l={},u=0,c=Object.keys(a);u<c.length;u+=1){var p=c[u],h=a[p],d=this._tiles[p];if(d&&!(d.fadeEndTime&&d.fadeEndTime<=vt.browser.now())){var f=this.findLoadedParent(h,n);f&&(this._addTile(f.tileID),s[f.tileID.key]=f.tileID),l[p]=h}}for(var m in this._retainLoadedChildren(l,r,o,a),s)a[m]||(this._coveredTiles[m]=!0,a[m]=s[m])}for(var g in a)this._tiles[g].clearFadeHold();for(var y=0,v=vt.keysDifference(this._tiles,a);y<v.length;y+=1){var _=v[y],x=this._tiles[_];x.hasSymbolBuckets&&!x.holdingForFade()?x.setHoldDuration(this.map._fadeDuration):x.hasSymbolBuckets&&!x.symbolFadeFinished()||this._removeTile(_)}this._updateLoadedParentTileCache()}},li.prototype.releaseSymbolFadeTiles=function(){for(var t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)},li.prototype._updateRetainedTiles=function(t,e){for(var i={},r={},n=Math.max(e-li.maxOverzooming,this._source.minzoom),o=Math.max(e+li.maxUnderzooming,this._source.minzoom),a={},s=0,l=t;s<l.length;s+=1){var u=l[s],c=this._addTile(u);i[u.key]=u,c.hasData()||e<this._source.maxzoom&&(a[u.key]=u)}this._retainLoadedChildren(a,e,o,i);for(var p=0,h=t;p<h.length;p+=1){var d=h[p],f=this._tiles[d.key];if(!f.hasData()){if(e+1>this._source.maxzoom){var m=d.children(this._source.maxzoom)[0],g=this.getTile(m);if(g&&g.hasData()){i[m.key]=m;continue}}else{var y=d.children(this._source.maxzoom);if(i[y[0].key]&&i[y[1].key]&&i[y[2].key]&&i[y[3].key])continue}for(var v=f.wasRequested(),_=d.overscaledZ-1;n<=_;--_){var x=d.scaledTo(_);if(r[x.key])break;if(r[x.key]=!0,!(f=this.getTile(x))&&v&&(f=this._addTile(x)),f&&(i[x.key]=x,v=f.wasRequested(),f.hasData()))break}}}return i},li.prototype._updateLoadedParentTileCache=function(){for(var t in this._loadedParentTiles={},this._tiles){for(var e=[],i=void 0,r=this._tiles[t].tileID;0<r.overscaledZ;){if(r.key in this._loadedParentTiles){i=this._loadedParentTiles[r.key];break}e.push(r.key);var n=r.scaledTo(r.overscaledZ-1);if(i=this._getLoadedTile(n))break;r=n}for(var o=0,a=e;o<a.length;o+=1)this._loadedParentTiles[a[o]]=i}},li.prototype._addTile=function(t){var e=this._tiles[t.key];if(e)return e;(e=this._cache.getAndRemove(t))&&(this._setTileReloadTimer(t.key,e),e.tileID=t,this._state.initializeTileState(e,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,e)));var i=Boolean(e);return i||(e=new vt.Tile(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(e,this._tileLoaded.bind(this,e,t.key,e.state))),e?(e.uses++,this._tiles[t.key]=e,i||this._source.fire(new vt.Event("dataloading",{tile:e,coord:e.tileID,dataType:"source"})),e):null},li.prototype._setTileReloadTimer=function(t,e){var i=this;t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);var r=e.getExpiryTimeout();r&&(this._timers[t]=setTimeout(function(){i._reloadTile(t,"expired"),delete i._timers[t]},r))},li.prototype._removeTile=function(t){var e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),0<e.uses||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))},li.prototype.clearTiles=function(){for(var t in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(t);this._cache.reset()},li.prototype.tilesIn=function(t,l,e){var u=this,c=[],p=this.transform;if(!p)return c;for(var i=e?p.getCameraQueryGeometry(t):t,h=t.map(function(t){return p.pointCoordinate(t)}),d=i.map(function(t){return p.pointCoordinate(t)}),f=this.getIds(),m=1/0,g=1/0,y=-1/0,v=-1/0,r=0,n=d;r<n.length;r+=1){var o=n[r];m=Math.min(m,o.x),g=Math.min(g,o.y),y=Math.max(y,o.x),v=Math.max(v,o.y)}for(var a=function(t){var e=u._tiles[f[t]];if(!e.holdingForFade()){var i=e.tileID,r=Math.pow(2,p.zoom-e.tileID.overscaledZ),n=l*e.queryPadding*vt.EXTENT/e.tileSize/r,o=[i.getTilePoint(new vt.MercatorCoordinate(m,g)),i.getTilePoint(new vt.MercatorCoordinate(y,v))];if(o[0].x-n<vt.EXTENT&&o[0].y-n<vt.EXTENT&&0<=o[1].x+n&&0<=o[1].y+n){var a=h.map(function(t){return i.getTilePoint(t)}),s=d.map(function(t){return i.getTilePoint(t)});c.push({tile:e,tileID:i,queryGeometry:a,cameraQueryGeometry:s,scale:r})}}},s=0;s<f.length;s++)a(s);return c},li.prototype.getVisibleCoordinates=function(t){for(var e=this,i=this.getRenderableIds(t).map(function(t){return e._tiles[t].tileID}),r=0,n=i;r<n.length;r+=1){var o=n[r];o.posMatrix=this.transform.calculatePosMatrix(o.toUnwrapped())}return i},li.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(ci(this._source.type))for(var t in this._tiles){var e=this._tiles[t];if(void 0!==e.fadeEndTime&&e.fadeEndTime>=vt.browser.now())return!0}return!1},li.prototype.setFeatureState=function(t,e,i){this._state.updateState(t=t||"_geojsonTileLayer",e,i)},li.prototype.removeFeatureState=function(t,e,i){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,i)},li.prototype.getFeatureState=function(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)},li.prototype.setDependencies=function(t,e,i){var r=this._tiles[t];r&&r.setDependencies(e,i)},li.prototype.reloadTilesForDependencies=function(e,i){for(var t in this._tiles)this._tiles[t].hasDependency(e,i)&&this._reloadTile(t,"reloading");this._cache.filter(function(t){return!t.hasDependency(e,i)})},li);function li(t,n,e){var i=this;ai.call(this),this.id=t,this.dispatcher=e,this.on("data",function(t){"source"===t.dataType&&"metadata"===t.sourceDataType&&(i._sourceLoaded=!0),i._sourceLoaded&&!i._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(i.reload(),i.transform&&i.update(i.transform))}),this.on("error",function(){i._sourceErrored=!0}),this._source=function(t,e,i){var r=new G[n.type](t,n,e,i);if(r.id!==t)throw new Error("Expected Source id to be "+t+" instead of "+r.id);return vt.bindAll(["load","abort","unload","serialize","prepare"],r),r}(t,e,this),this._tiles={},this._cache=new tt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new vt.SourceFeatureState}function ui(t,e){var i=Math.abs(2*t.wrap)-(t.wrap<0),r=Math.abs(2*e.wrap)-(e.wrap<0);return t.overscaledZ-e.overscaledZ||r-i||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function ci(t){return"raster"===t||"image"===t||"video"===t}function pi(){return new vt.window.Worker(Da.workerUrl)}si.maxOverzooming=10,si.maxUnderzooming=3;var hi="mapboxgl_preloaded_worker_pool",di=function(){this.active={}};di.prototype.acquire=function(t){if(!this.workers)for(this.workers=[];this.workers.length<di.workerCount;)this.workers.push(new pi);return this.active[t]=!0,this.workers.slice()},di.prototype.release=function(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach(function(t){t.terminate()}),this.workers=null)},di.prototype.isPreloaded=function(){return!!this.active[hi]},di.prototype.numActive=function(){return Object.keys(this.active).length};var fi,mi=Math.floor(vt.browser.hardwareConcurrency/2);function gi(){return fi=fi||new di}function yi(t,e){var i={};for(var r in t)"ref"!==r&&(i[r]=t[r]);return vt.refProperties.forEach(function(t){t in e&&(i[t]=e[t])}),i}function vi(t){t=t.slice();for(var e=Object.create(null),i=0;i<t.length;i++)e[t[i].id]=t[i];for(var r=0;r<t.length;r++)"ref"in t[r]&&(t[r]=yi(t[r],e[t[r].ref]));return t}di.workerCount=Math.max(Math.min(mi,6),1);var _i={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function xi(t,e,i){i.push({command:_i.addSource,args:[t,e[t]]})}function bi(t,e,i){e.push({command:_i.removeSource,args:[t]}),i[t]=!0}function wi(t,e,i){var r;for(r in t[i])if(t[i].hasOwnProperty(r)&&"data"!==r&&!vt.deepEqual(t[i][r],e[i][r]))return;for(r in e[i])if(e[i].hasOwnProperty(r)&&"data"!==r&&!vt.deepEqual(t[i][r],e[i][r]))return;return 1}function Si(t,e,i,r,n,o){var a;for(a in e=e||{},t=t||{})t.hasOwnProperty(a)&&(vt.deepEqual(t[a],e[a])||i.push({command:o,args:[r,a,e[a],n]}));for(a in e)e.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(vt.deepEqual(t[a],e[a])||i.push({command:o,args:[r,a,e[a],n]}))}function Ti(t){return t.id}function Ii(t,e){return t[e.id]=e,t}function Ei(t,e){this.reset(t,e)}function Ci(t,e,i){var r=this.boxCells=[],n=this.circleCells=[];this.xCellCount=Math.ceil(t/i),this.yCellCount=Math.ceil(e/i);for(var o=0;o<this.xCellCount*this.yCellCount;o++)r.push([]),n.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0}function Ai(t,e,i,r,n){var o=vt.create();return e?(vt.scale(o,o,[1/n,1/n,1]),i||vt.rotateZ(o,o,r.angle)):vt.multiply(o,r.labelPlaneMatrix,t),o}function ki(t,e,i,r,n){if(e){var o=vt.clone(t);return vt.scale(o,o,[n,n,1]),i||vt.rotateZ(o,o,-r.angle),o}return r.glCoordMatrix}function Pi(t,e){var i=[t.x,t.y,0,1];Ui(i,i,e);var r=i[3];return{point:new vt.Point(i[0]/r,i[1]/r),signedDistanceFromCamera:r}}function Mi(t,e){return.5+t/e*.5}function Li(t,e,i,r,n,o,a,s){var l,u,c,p,h=r?t.textSizeData:t.iconSizeData,d=vt.evaluateSizeForZoom(h,i.transform.zoom),f=[256/i.width*2+1,256/i.height*2+1],m=r?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;m.clear();for(var g=t.lineVertexArray,y=r?t.text.placedSymbolArray:t.icon.placedSymbolArray,v=i.transform.width/i.transform.height,_=!1,x=0;x<y.length;x++){var b=y.get(x);if(b.hidden||b.writingMode===vt.WritingMode.vertical&&!_)Fi(b.numGlyphs,m);else{_=!1;var w=[b.anchorX,b.anchorY,0,1];if(vt.transformMat4(w,w,e),u=f,c=(l=w)[0]/l[3],p=l[1]/l[3],c>=-u[0]&&c<=u[0]&&p>=-u[1]&&p<=u[1]){var S=Mi(i.transform.cameraToCenterDistance,w[3]),T=vt.evaluateSizeForFeature(h,d,b),I=a?T/S:T*S,E=new vt.Point(b.anchorX,b.anchorY),C=Pi(E,n).point,A={},k=Oi(b,I,!1,s,e,n,o,t.glyphOffsetArray,g,m,C,E,A,v);_=k.useVertical,(k.notEnoughRoom||_||k.needsFlipping&&Oi(b,I,!0,s,e,n,o,t.glyphOffsetArray,g,m,C,E,A,v).notEnoughRoom)&&Fi(b.numGlyphs,m)}else Fi(b.numGlyphs,m)}}r?t.text.dynamicLayoutVertexBuffer.updateData(m):t.icon.dynamicLayoutVertexBuffer.updateData(m)}function Di(t,e,i,r,n,o,a,s,l,u,c){var p=s.glyphStartIndex+s.numGlyphs,h=s.lineStartIndex,d=s.lineStartIndex+s.lineLength,f=e.getoffsetX(s.glyphStartIndex),m=e.getoffsetX(p-1),g=Ni(t*f,i,r,n,o,a,s.segment,h,d,l,u,c);if(!g)return null;var y=Ni(t*m,i,r,n,o,a,s.segment,h,d,l,u,c);return y?{first:g,last:y}:null}function zi(t,e,i,r){return t===vt.WritingMode.horizontal&&Math.abs(i.y-e.y)>Math.abs(i.x-e.x)*r?{useVertical:!0}:(t===vt.WritingMode.vertical?e.y<i.y:e.x>i.x)?{needsFlipping:!0}:null}function Oi(t,e,i,r,n,o,a,s,l,u,c,p,h,d){var f,m=e/24,g=t.lineOffsetX*m,y=t.lineOffsetY*m;if(1<t.numGlyphs){var v=t.glyphStartIndex+t.numGlyphs,_=t.lineStartIndex,x=t.lineStartIndex+t.lineLength,b=Di(m,s,g,y,i,c,p,t,l,o,h);if(!b)return{notEnoughRoom:!0};var w=Pi(b.first.point,a).point,S=Pi(b.last.point,a).point;if(r&&!i){var T=zi(t.writingMode,w,S,d);if(T)return T}f=[b.first];for(var I=t.glyphStartIndex+1;I<v-1;I++)f.push(Ni(m*s.getoffsetX(I),g,y,i,c,p,t.segment,_,x,l,o,h));f.push(b.last)}else{if(r&&!i){var E=Pi(p,n).point,C=t.lineStartIndex+t.segment+1,A=new vt.Point(l.getx(C),l.gety(C)),k=Pi(A,n),P=0<k.signedDistanceFromCamera?k.point:Ri(p,A,E,1,n),M=zi(t.writingMode,E,P,d);if(M)return M}var L=Ni(m*s.getoffsetX(t.glyphStartIndex),g,y,i,c,p,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,l,o,h);if(!L)return{notEnoughRoom:!0};f=[L]}for(var D=0,z=f;D<z.length;D+=1){var O=z[D];vt.addDynamicAttributes(u,O.point,O.angle)}return{}}function Ri(t,e,i,r,n){var o=Pi(t.add(t.sub(e)._unit()),n).point,a=i.sub(o);return i.add(a._mult(r/a.mag()))}function Ni(t,e,i,r,n,o,a,s,l,u,c,p){var h=r?t-e:t+e,d=0<h?1:-1,f=0;r&&(d*=-1,f=Math.PI),d<0&&(f+=Math.PI);for(var m=0<d?s+a:s+a+1,g=n,y=n,v=0,_=0,x=Math.abs(h),b=[];v+_<=x;){if((m+=d)<s||l<=m)return null;if(y=g,b.push(g),void 0===(g=p[m])){var w=new vt.Point(u.getx(m),u.gety(m)),S=Pi(w,c);if(0<S.signedDistanceFromCamera)g=p[m]=S.point;else{var T=m-d;g=Ri(0===v?o:new vt.Point(u.getx(T),u.gety(T)),w,y,x-v+1,c)}}v+=_,_=y.dist(g)}var I=(x-v)/_,E=g.sub(y),C=E.mult(I)._add(y);C._add(E._unit()._perp()._mult(i*d));var A=f+Math.atan2(g.y-y.y,g.x-y.x);return b.push(C),{point:C,angle:A,path:b}}Ei.prototype.reset=function(t,e){this.points=t||[],this._distances=[0];for(var i=1;i<this.points.length;i++)this._distances[i]=this._distances[i-1]+this.points[i].dist(this.points[i-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Ei.prototype.lerp=function(t){if(1===this.points.length)return this.points[0];t=vt.clamp(t,0,1);for(var e=1,i=this._distances[e],r=t*this.paddedLength+this.padding;i<r&&e<this._distances.length;)i=this._distances[++e];var n=e-1,o=this._distances[n],a=i-o,s=0<a?(r-o)/a:0;return this.points[n].mult(1-s).add(this.points[e].mult(s))},Ci.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Ci.prototype.insert=function(t,e,i,r,n){this._forEachCell(e,i,r,n,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(r),this.bboxes.push(n)},Ci.prototype.insertCircle=function(t,e,i,r){this._forEachCell(e-r,i-r,e+r,i+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(i),this.circles.push(r)},Ci.prototype._insertBoxCell=function(t,e,i,r,n,o){this.boxCells[n].push(o)},Ci.prototype._insertCircleCell=function(t,e,i,r,n,o){this.circleCells[n].push(o)},Ci.prototype._query=function(t,e,i,r,n,o){if(i<0||t>this.width||r<0||e>this.height)return!n&&[];var a=[];if(t<=0&&e<=0&&this.width<=i&&this.height<=r){if(n)return!0;for(var s=0;s<this.boxKeys.length;s++)a.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var l=0;l<this.circleKeys.length;l++){var u=this.circles[3*l],c=this.circles[3*l+1],p=this.circles[3*l+2];a.push({key:this.circleKeys[l],x1:u-p,y1:c-p,x2:u+p,y2:c+p})}return o?a.filter(o):a}return this._forEachCell(t,e,i,r,this._queryCell,a,{hitTest:n,seenUids:{box:{},circle:{}}},o),n?0<a.length:a},Ci.prototype._queryCircle=function(t,e,i,r,n){var o=t-i,a=t+i,s=e-i,l=e+i;if(a<0||o>this.width||l<0||s>this.height)return!r&&[];var u=[];return this._forEachCell(o,s,a,l,this._queryCellCircle,u,{hitTest:r,circle:{x:t,y:e,radius:i},seenUids:{box:{},circle:{}}},n),r?0<u.length:u},Ci.prototype.query=function(t,e,i,r,n){return this._query(t,e,i,r,!1,n)},Ci.prototype.hitTest=function(t,e,i,r,n){return this._query(t,e,i,r,!0,n)},Ci.prototype.hitTestCircle=function(t,e,i,r){return this._queryCircle(t,e,i,!0,r)},Ci.prototype._queryCell=function(t,e,i,r,n,o,a,s){var l=a.seenUids,u=this.boxCells[n];if(null!==u)for(var c=this.bboxes,p=0,h=u;p<h.length;p+=1){var d=h[p];if(!l.box[d]){l.box[d]=!0;var f=4*d;if(t<=c[2+f]&&e<=c[3+f]&&i>=c[0+f]&&r>=c[1+f]&&(!s||s(this.boxKeys[d]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[d],x1:c[f],y1:c[1+f],x2:c[2+f],y2:c[3+f]})}}}var m=this.circleCells[n];if(null!==m)for(var g=this.circles,y=0,v=m;y<v.length;y+=1){var _=v[y];if(!l.circle[_]){l.circle[_]=!0;var x=3*_;if(this._circleAndRectCollide(g[x],g[1+x],g[2+x],t,e,i,r)&&(!s||s(this.circleKeys[_]))){if(a.hitTest)return o.push(!0),!0;var b=g[x],w=g[1+x],S=g[2+x];o.push({key:this.circleKeys[_],x1:b-S,y1:w-S,x2:b+S,y2:w+S})}}}},Ci.prototype._queryCellCircle=function(t,e,i,r,n,o,a,s){var l=a.circle,u=a.seenUids,c=this.boxCells[n];if(null!==c)for(var p=this.bboxes,h=0,d=c;h<d.length;h+=1){var f=d[h];if(!u.box[f]){u.box[f]=!0;var m=4*f;if(this._circleAndRectCollide(l.x,l.y,l.radius,p[0+m],p[1+m],p[2+m],p[3+m])&&(!s||s(this.boxKeys[f])))return o.push(!0),!0}}var g=this.circleCells[n];if(null!==g)for(var y=this.circles,v=0,_=g;v<_.length;v+=1){var x=_[v];if(!u.circle[x]){u.circle[x]=!0;var b=3*x;if(this._circlesCollide(y[b],y[1+b],y[2+b],l.x,l.y,l.radius)&&(!s||s(this.circleKeys[x])))return o.push(!0),!0}}},Ci.prototype._forEachCell=function(t,e,i,r,n,o,a,s){for(var l=this._convertToXCellCoord(t),u=this._convertToYCellCoord(e),c=this._convertToXCellCoord(i),p=this._convertToYCellCoord(r),h=l;h<=c;h++)for(var d=u;d<=p;d++)if(n.call(this,t,e,i,r,this.xCellCount*d+h,o,a,s))return},Ci.prototype._convertToXCellCoord=function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))},Ci.prototype._convertToYCellCoord=function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))},Ci.prototype._circlesCollide=function(t,e,i,r,n,o){var a=r-t,s=n-e,l=i+o;return a*a+s*s<l*l},Ci.prototype._circleAndRectCollide=function(t,e,i,r,n,o,a){var s=(o-r)/2,l=Math.abs(t-(r+s));if(s+i<l)return!1;var u=(a-n)/2,c=Math.abs(e-(n+u));if(u+i<c)return!1;if(l<=s||c<=u)return!0;var p=l-s,h=c-u;return p*p+h*h<=i*i};var Bi=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Fi(t,e){for(var i=0;i<t;i++){var r=e.length;e.resize(r+4),e.float32.set(Bi,3*r)}}function Ui(t,e,i){var r=e[0],n=e[1];return t[0]=i[0]*r+i[4]*n+i[12],t[1]=i[1]*r+i[5]*n+i[13],t[3]=i[3]*r+i[7]*n+i[15],t}function ji(t,e,i){void 0===e&&(e=new Ci(t.width+200,t.height+200,25)),void 0===i&&(i=new Ci(t.width+200,t.height+200,25)),this.transform=t,this.grid=e,this.ignoredGrid=i,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+100,this.screenBottomBoundary=t.height+100,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200}function qi(t,e,i){return e*(vt.EXTENT/(t.tileSize*Math.pow(2,i-t.tileID.overscaledZ)))}function Vi(t,e,i,r){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):r&&i?1:0,this.placed=i}function Gi(t,e,i,r,n){this.text=new Vi(t?t.text:null,e,i,n),this.icon=new Vi(t?t.icon:null,e,r,n)}function Zi(t,e,i){this.text=t,this.icon=e,this.skipFade=i}function Hi(){this.invProjMatrix=vt.create(),this.viewportMatrix=vt.create(),this.circles=[]}function Wi(t,e,i,r,n){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=i,this.bucketIndex=r,this.tileID=n}function Ki(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}function Xi(t,e,i,r,n){var o=vt.getAnchorAlignment(t),a=-(o.horizontalAlign-.5)*e,s=-(o.verticalAlign-.5)*i,l=vt.evaluateVariableOffset(t,r);return new vt.Point(a+l[0]*n,s+l[1]*n)}function Yi(t,e,i,r,n,o){var a=t.x1,s=t.x2,l=t.y1,u=t.y2,c=t.anchorPointX,p=t.anchorPointY,h=new vt.Point(e,i);return r&&h._rotate(n?o:-o),{x1:a+h.x,y1:l+h.y,x2:s+h.x,y2:u+h.y,anchorPointX:c,anchorPointY:p}}function Ji(t,e,i,r){this.transform=t.clone(),this.collisionIndex=new ji(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new Ki(i),this.collisionCircleArrays={},(this.prevPlacement=r)&&(r.prevPlacement=void 0),this.placedOrientations={}}function Qi(t,e,i,r,n){t.emplaceBack(e?1:0,i?1:0,r||0,n||0),t.emplaceBack(e?1:0,i?1:0,r||0,n||0),t.emplaceBack(e?1:0,i?1:0,r||0,n||0),t.emplaceBack(e?1:0,i?1:0,r||0,n||0)}ji.prototype.placeCollisionBox=function(t,e,i,r,n){var o=this.projectAndGetPerspectiveRatio(r,t.anchorPointX,t.anchorPointY),a=i*o.perspectiveRatio,s=t.x1*a+o.point.x,l=t.y1*a+o.point.y,u=t.x2*a+o.point.x,c=t.y2*a+o.point.y;return!this.isInsideGrid(s,l,u,c)||!e&&this.grid.hitTest(s,l,u,c,n)?{box:[],offscreen:!1}:{box:[s,l,u,c],offscreen:this.isOffscreen(s,l,u,c)}},ji.prototype.placeCollisionCircles=function(t,e,i,r,n,o,a,s,l,u,c,p,h){var d=[],f=new vt.Point(e.anchorX,e.anchorY),m=Pi(f,o),g=Mi(this.transform.cameraToCenterDistance,m.signedDistanceFromCamera),y=(u?n/g:n*g)/vt.ONE_EM,v=Pi(f,a).point,_=Di(y,r,e.lineOffsetX*y,e.lineOffsetY*y,!1,v,f,e,i,a,{}),x=!1,b=!1,w=!0;if(_){for(var S=.5*p*g+h,T=new vt.Point(-100,-100),I=new vt.Point(this.screenRightBoundary,this.screenBottomBoundary),E=new Ei,C=_.first,A=_.last,k=[],P=C.path.length-1;1<=P;P--)k.push(C.path[P]);for(var M=1;M<A.path.length;M++)k.push(A.path[M]);var L=2.5*S;if(s){var D=k.map(function(t){return Pi(t,s)});k=D.some(function(t){return t.signedDistanceFromCamera<=0})?[]:D.map(function(t){return t.point})}var z=[];if(0<k.length){for(var O=k[0].clone(),R=k[0].clone(),N=1;N<k.length;N++)O.x=Math.min(O.x,k[N].x),O.y=Math.min(O.y,k[N].y),R.x=Math.max(R.x,k[N].x),R.y=Math.max(R.y,k[N].y);z=O.x>=T.x&&R.x<=I.x&&O.y>=T.y&&R.y<=I.y?[k]:R.x<T.x||O.x>I.x||R.y<T.y||O.y>I.y?[]:vt.clipLine([k],T.x,T.y,I.x,I.y)}for(var B=0,F=z;B<F.length;B+=1){var U;E.reset(F[B],.25*S),U=E.length<=.5*S?1:Math.ceil(E.paddedLength/L)+1;for(var j=0;j<U;j++){var q=j/Math.max(U-1,1),V=E.lerp(q),G=V.x+100,Z=V.y+100;d.push(G,Z,S,0);var H=G-S,W=Z-S,K=G+S,X=Z+S;if(w=w&&this.isOffscreen(H,W,K,X),b=b||this.isInsideGrid(H,W,K,X),!t&&this.grid.hitTestCircle(G,Z,S,c)&&(x=!0,!l))return{circles:[],offscreen:!1,collisionDetected:x}}}}return{circles:!l&&x||!b?[]:d,offscreen:w,collisionDetected:x}},ji.prototype.queryRenderedSymbols=function(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var e=[],i=1/0,r=1/0,n=-1/0,o=-1/0,a=0,s=t;a<s.length;a+=1){var l=s[a],u=new vt.Point(l.x+100,l.y+100);i=Math.min(i,u.x),r=Math.min(r,u.y),n=Math.max(n,u.x),o=Math.max(o,u.y),e.push(u)}for(var c={},p={},h=0,d=this.grid.query(i,r,n,o).concat(this.ignoredGrid.query(i,r,n,o));h<d.length;h+=1){var f=d[h],m=f.key;if(void 0===c[m.bucketInstanceId]&&(c[m.bucketInstanceId]={}),!c[m.bucketInstanceId][m.featureIndex]){var g=[new vt.Point(f.x1,f.y1),new vt.Point(f.x2,f.y1),new vt.Point(f.x2,f.y2),new vt.Point(f.x1,f.y2)];vt.polygonIntersectsPolygon(e,g)&&(c[m.bucketInstanceId][m.featureIndex]=!0,void 0===p[m.bucketInstanceId]&&(p[m.bucketInstanceId]=[]),p[m.bucketInstanceId].push(m.featureIndex))}}return p},ji.prototype.insertCollisionBox=function(t,e,i,r,n){(e?this.ignoredGrid:this.grid).insert({bucketInstanceId:i,featureIndex:r,collisionGroupID:n},t[0],t[1],t[2],t[3])},ji.prototype.insertCollisionCircles=function(t,e,i,r,n){for(var o=e?this.ignoredGrid:this.grid,a={bucketInstanceId:i,featureIndex:r,collisionGroupID:n},s=0;s<t.length;s+=4)o.insertCircle(a,t[s],t[s+1],t[s+2])},ji.prototype.projectAndGetPerspectiveRatio=function(t,e,i){var r=[e,i,0,1];return Ui(r,r,t),{point:new vt.Point((r[0]/r[3]+1)/2*this.transform.width+100,(-r[1]/r[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/r[3]*.5}},ji.prototype.isOffscreen=function(t,e,i,r){return i<100||t>=this.screenRightBoundary||r<100||e>this.screenBottomBoundary},ji.prototype.isInsideGrid=function(t,e,i,r){return 0<=i&&t<this.gridRightBoundary&&0<=r&&e<this.gridBottomBoundary},ji.prototype.getViewportMatrix=function(){var t=vt.identity([]);return vt.translate(t,t,[-100,-100,0]),t},Vi.prototype.isHidden=function(){return 0===this.opacity&&!this.placed},Gi.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()},Ki.prototype.get=function(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){var e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:function(t){return t.collisionGroupID===e}}}return this.collisionGroups[t]},Ji.prototype.getBucketParts=function(t,e,i,r){var n=i.getBucket(e),o=i.latestFeatureIndex;if(n&&o&&e.id===n.layerIds[0]){var a=i.collisionBoxArray,s=n.layers[0].layout,l=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),u=i.tileSize/vt.EXTENT,c=this.transform.calculatePosMatrix(i.tileID.toUnwrapped()),p="map"===s.get("text-pitch-alignment"),h="map"===s.get("text-rotation-alignment"),d=qi(i,1,this.transform.zoom),f=Ai(c,p,h,this.transform,d),m=null;if(p){var g=ki(c,p,h,this.transform,d);m=vt.multiply([],this.transform.labelPlaneMatrix,g)}this.retainedQueryData[n.bucketInstanceId]=new Wi(n.bucketInstanceId,o,n.sourceLayerIndex,n.index,i.tileID);var y={bucket:n,layout:s,posMatrix:c,textLabelPlaneMatrix:f,labelToScreenMatrix:m,scale:l,textPixelRatio:u,holdingForFade:i.holdingForFade(),collisionBoxArray:a,partiallyEvaluatedTextSize:vt.evaluateSizeForZoom(n.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(n.sourceID)};if(r)for(var v=0,_=n.sortKeyRanges;v<_.length;v+=1){var x=_[v];t.push({sortKey:x.sortKey,symbolInstanceStart:x.symbolInstanceStart,symbolInstanceEnd:x.symbolInstanceEnd,parameters:y})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:n.symbolInstances.length,parameters:y})}},Ji.prototype.attemptAnchorPlacement=function(t,e,i,r,n,o,a,s,l,u,c,p,h,d,f){var m,g=[p.textOffset0,p.textOffset1],y=Xi(t,i,r,g,n),v=this.collisionIndex.placeCollisionBox(Yi(e,y.x,y.y,o,a,this.transform.angle),c,s,l,u.predicate);if(!f||0!==this.collisionIndex.placeCollisionBox(Yi(f,y.x,y.y,o,a,this.transform.angle),c,s,l,u.predicate).box.length)return 0<v.box.length?(this.prevPlacement&&this.prevPlacement.variableOffsets[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID].text&&(m=this.prevPlacement.variableOffsets[p.crossTileID].anchor),this.variableOffsets[p.crossTileID]={textOffset:g,width:i,height:r,anchor:t,textBoxScale:n,prevAnchor:m},this.markUsedJustification(h,t,p,d),h.allowVerticalPlacement&&(this.markUsedOrientation(h,d,p),this.placedOrientations[p.crossTileID]=d),{shift:y,placedGlyphBoxes:v}):void 0},Ji.prototype.placeLayerBucketPart=function(t,L,D){var z=this,e=t.parameters,O=e.bucket,R=e.layout,N=e.posMatrix,B=e.textLabelPlaneMatrix,F=e.labelToScreenMatrix,U=e.textPixelRatio,j=e.holdingForFade,i=e.collisionBoxArray,q=e.partiallyEvaluatedTextSize,V=e.collisionGroup,G=R.get("text-optional"),Z=R.get("icon-optional"),H=R.get("text-allow-overlap"),W=R.get("icon-allow-overlap"),K="map"===R.get("text-rotation-alignment"),X="map"===R.get("text-pitch-alignment"),Y="none"!==R.get("icon-text-fit"),r="viewport-y"===R.get("symbol-z-order"),J=H&&(W||!O.hasIconData()||Z),Q=W&&(H||!O.hasTextData()||G);function n(p,n){if(!L[p.crossTileID])if(j)z.placements[p.crossTileID]=new Zi(!1,!1,!1);else{var t,h=!1,e=!1,i=!0,d=null,o={box:null,offscreen:null},a={box:null,offscreen:null},r=null,s=null,l=0,u=0,c=0;n.textFeatureIndex?l=n.textFeatureIndex:p.useRuntimeCollisionCircles&&(l=p.featureIndex),n.verticalTextFeatureIndex&&(u=n.verticalTextFeatureIndex);var f=n.textBox;if(f){var m=function(t){var e=vt.WritingMode.horizontal;if(O.allowVerticalPlacement&&!t&&z.prevPlacement){var i=z.prevPlacement.placedOrientations[p.crossTileID];i&&(z.placedOrientations[p.crossTileID]=i,z.markUsedOrientation(O,e=i,p))}return e},g=function(t,e){if(O.allowVerticalPlacement&&0<p.numVerticalGlyphVertices&&n.verticalTextBox)for(var i=0,r=O.writingModes;i<r.length&&(r[i]===vt.WritingMode.vertical?(o=e(),a=o):o=t(),!(o&&o.box&&o.box.length));i+=1);else o=t()};if(R.get("text-variable-anchor")){var y=R.get("text-variable-anchor");if(z.prevPlacement&&z.prevPlacement.variableOffsets[p.crossTileID]){var v=z.prevPlacement.variableOffsets[p.crossTileID];0<y.indexOf(v.anchor)&&(y=y.filter(function(t){return t!==v.anchor})).unshift(v.anchor)}var _=function(t,e,i){for(var r=t.x2-t.x1,n=t.y2-t.y1,o=p.textBoxScale,a=Y&&!W?e:null,s={box:[],offscreen:!1},l=H?2*y.length:y.length,u=0;u<l;++u){var c=z.attemptAnchorPlacement(y[u%y.length],t,r,n,o,K,X,U,N,V,u>=y.length,p,O,i,a);if(c&&(s=c.placedGlyphBoxes)&&s.box&&s.box.length){h=!0,d=c.shift;break}}return s};g(function(){return _(f,n.iconBox,vt.WritingMode.horizontal)},function(){var t=n.verticalTextBox;return O.allowVerticalPlacement&&!(o&&o.box&&o.box.length)&&0<p.numVerticalGlyphVertices&&t?_(t,n.verticalIconBox,vt.WritingMode.vertical):{box:null,offscreen:null}}),o&&(h=o.box,i=o.offscreen);var x=m(o&&o.box);if(!h&&z.prevPlacement){var b=z.prevPlacement.variableOffsets[p.crossTileID];b&&(z.variableOffsets[p.crossTileID]=b,z.markUsedJustification(O,b.anchor,p,x))}}else{var w=function(t,e){var i=z.collisionIndex.placeCollisionBox(t,H,U,N,V.predicate);return i&&i.box&&i.box.length&&(z.markUsedOrientation(O,e,p),z.placedOrientations[p.crossTileID]=e),i};g(function(){return w(f,vt.WritingMode.horizontal)},function(){var t=n.verticalTextBox;return O.allowVerticalPlacement&&0<p.numVerticalGlyphVertices&&t?w(t,vt.WritingMode.vertical):{box:null,offscreen:null}}),m(o&&o.box&&o.box.length)}}if(h=(t=o)&&t.box&&0<t.box.length,i=t&&t.offscreen,p.useRuntimeCollisionCircles){var S=O.text.placedSymbolArray.get(p.centerJustifiedTextSymbolIndex),T=vt.evaluateSizeForFeature(O.textSizeData,q,S),I=R.get("text-padding");r=z.collisionIndex.placeCollisionCircles(H,S,O.lineVertexArray,O.glyphOffsetArray,T,N,B,F,D,X,V.predicate,p.collisionCircleDiameter,I),h=H||0<r.circles.length&&!r.collisionDetected,i=i&&r.offscreen}if(n.iconFeatureIndex&&(c=n.iconFeatureIndex),n.iconBox){var E=function(t){var e=Y&&d?Yi(t,d.x,d.y,K,X,z.transform.angle):t;return z.collisionIndex.placeCollisionBox(e,W,U,N,V.predicate)};e=a&&a.box&&a.box.length&&n.verticalIconBox?0<(s=E(n.verticalIconBox)).box.length:0<(s=E(n.iconBox)).box.length,i=i&&s.offscreen}var C=G||0===p.numHorizontalGlyphVertices&&0===p.numVerticalGlyphVertices,A=Z||0===p.numIconVertices;if(C||A?A?C||(e=e&&h):h=e&&h:e=h=e&&h,h&&t&&t.box&&z.collisionIndex.insertCollisionBox(t.box,R.get("text-ignore-placement"),O.bucketInstanceId,a&&a.box&&u?u:l,V.ID),e&&s&&z.collisionIndex.insertCollisionBox(s.box,R.get("icon-ignore-placement"),O.bucketInstanceId,c,V.ID),r&&(h&&z.collisionIndex.insertCollisionCircles(r.circles,R.get("text-ignore-placement"),O.bucketInstanceId,l,V.ID),D)){var k=O.bucketInstanceId,P=z.collisionCircleArrays[k];void 0===P&&(P=z.collisionCircleArrays[k]=new Hi);for(var M=0;M<r.circles.length;M+=4)P.circles.push(r.circles[M+0]),P.circles.push(r.circles[M+1]),P.circles.push(r.circles[M+2]),P.circles.push(r.collisionDetected?1:0)}z.placements[p.crossTileID]=new Zi(h||J,e||Q,i||O.justReloaded),L[p.crossTileID]=!0}}if(!O.collisionArrays&&i&&O.deserializeCollisionBoxes(i),r)for(var o=O.getSortedSymbolIndexes(this.transform.angle),a=o.length-1;0<=a;--a){var s=o[a];n(O.symbolInstances.get(s),O.collisionArrays[s])}else for(var l=t.symbolInstanceStart;l<t.symbolInstanceEnd;l++)n(O.symbolInstances.get(l),O.collisionArrays[l]);if(D&&O.bucketInstanceId in this.collisionCircleArrays){var u=this.collisionCircleArrays[O.bucketInstanceId];vt.invert(u.invProjMatrix,N),u.viewportMatrix=this.collisionIndex.getViewportMatrix()}O.justReloaded=!1},Ji.prototype.markUsedJustification=function(t,e,i,r){var n;n=r===vt.WritingMode.vertical?i.verticalPlacedTextSymbolIndex:{left:i.leftJustifiedTextSymbolIndex,center:i.centerJustifiedTextSymbolIndex,right:i.rightJustifiedTextSymbolIndex}[vt.getAnchorJustification(e)];for(var o=0,a=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex,i.verticalPlacedTextSymbolIndex];o<a.length;o+=1){var s=a[o];0<=s&&(t.text.placedSymbolArray.get(s).crossTileID=0<=n&&s!==n?0:i.crossTileID)}},Ji.prototype.markUsedOrientation=function(t,e,i){for(var r=e===vt.WritingMode.horizontal||e===vt.WritingMode.horizontalOnly?e:0,n=e===vt.WritingMode.vertical?e:0,o=0,a=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex];o<a.length;o+=1)t.text.placedSymbolArray.get(a[o]).placedOrientation=r;i.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).placedOrientation=n)},Ji.prototype.commit=function(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;var e=this.prevPlacement,i=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;var r=e?e.symbolFadeChange(t):1,n=e?e.opacities:{},o=e?e.variableOffsets:{},a=e?e.placedOrientations:{};for(var s in this.placements){var l=this.placements[s],u=n[s];i=u?(this.opacities[s]=new Gi(u,r,l.text,l.icon),i||l.text!==u.text.placed||l.icon!==u.icon.placed):(this.opacities[s]=new Gi(null,r,l.text,l.icon,l.skipFade),i||l.text||l.icon)}for(var c in n){var p=n[c];if(!this.opacities[c]){var h=new Gi(p,r,!1,!1);h.isHidden()||(this.opacities[c]=h,i=i||p.text.placed||p.icon.placed)}}for(var d in o)this.variableOffsets[d]||!this.opacities[d]||this.opacities[d].isHidden()||(this.variableOffsets[d]=o[d]);for(var f in a)this.placedOrientations[f]||!this.opacities[f]||this.opacities[f].isHidden()||(this.placedOrientations[f]=a[f]);i?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)},Ji.prototype.updateLayerOpacities=function(t,e){for(var i={},r=0,n=e;r<n.length;r+=1){var o=n[r],a=o.getBucket(t);a&&o.latestFeatureIndex&&t.id===a.layerIds[0]&&this.updateBucketOpacities(a,i,o.collisionBoxArray)}},Ji.prototype.updateBucketOpacities=function(b,w,t){var S=this;b.hasTextData()&&b.text.opacityVertexArray.clear(),b.hasIconData()&&b.icon.opacityVertexArray.clear(),b.hasIconCollisionBoxData()&&b.iconCollisionBox.collisionVertexArray.clear(),b.hasTextCollisionBoxData()&&b.textCollisionBox.collisionVertexArray.clear();var e=b.layers[0].layout,T=new Gi(null,0,!1,!1,!0),i=e.get("text-allow-overlap"),r=e.get("icon-allow-overlap"),I=e.get("text-variable-anchor"),E="map"===e.get("text-rotation-alignment"),C="map"===e.get("text-pitch-alignment"),A="none"!==e.get("icon-text-fit"),k=new Gi(null,0,i&&(r||!b.hasIconData()||e.get("icon-optional")),r&&(i||!b.hasTextData()||e.get("text-optional")),!0);!b.collisionArrays&&t&&(b.hasIconCollisionBoxData()||b.hasTextCollisionBoxData())&&b.deserializeCollisionBoxes(t);for(var P=function(t,e,i){for(var r=0;r<e/4;r++)t.opacityVertexArray.emplaceBack(i)},n=function(t){var e=b.symbolInstances.get(t),i=e.numHorizontalGlyphVertices,r=e.numVerticalGlyphVertices,n=e.crossTileID,o=S.opacities[n];w[n]?o=T:o||(S.opacities[n]=o=k),w[n]=!0;var a=0<e.numIconVertices,s=S.placedOrientations[e.crossTileID],l=s===vt.WritingMode.vertical,u=s===vt.WritingMode.horizontal||s===vt.WritingMode.horizontalOnly;if(0<i||0<r){var c=ar(o.text);P(b.text,i,l?lr:c),P(b.text,r,u?lr:c);var p=o.text.isHidden();[e.rightJustifiedTextSymbolIndex,e.centerJustifiedTextSymbolIndex,e.leftJustifiedTextSymbolIndex].forEach(function(t){0<=t&&(b.text.placedSymbolArray.get(t).hidden=p||l?1:0)}),0<=e.verticalPlacedTextSymbolIndex&&(b.text.placedSymbolArray.get(e.verticalPlacedTextSymbolIndex).hidden=p||u?1:0);var h=S.variableOffsets[e.crossTileID];h&&S.markUsedJustification(b,h.anchor,e,s);var d=S.placedOrientations[e.crossTileID];d&&(S.markUsedJustification(b,"left",e,d),S.markUsedOrientation(b,d,e))}if(a){var f=ar(o.icon),m=!(A&&e.verticalPlacedIconSymbolIndex&&l);0<=e.placedIconSymbolIndex&&(P(b.icon,e.numIconVertices,m?f:lr),b.icon.placedSymbolArray.get(e.placedIconSymbolIndex).hidden=o.icon.isHidden()),0<=e.verticalPlacedIconSymbolIndex&&(P(b.icon,e.numVerticalIconVertices,m?lr:f),b.icon.placedSymbolArray.get(e.verticalPlacedIconSymbolIndex).hidden=o.icon.isHidden())}if(b.hasIconCollisionBoxData()||b.hasTextCollisionBoxData()){var g=b.collisionArrays[t];if(g){var y=new vt.Point(0,0);if(g.textBox||g.verticalTextBox){var v=!0;if(I){var _=S.variableOffsets[n];_?(y=Xi(_.anchor,_.width,_.height,_.textOffset,_.textBoxScale),E&&y._rotate(C?S.transform.angle:-S.transform.angle)):v=!1}g.textBox&&Qi(b.textCollisionBox.collisionVertexArray,o.text.placed,!v||l,y.x,y.y),g.verticalTextBox&&Qi(b.textCollisionBox.collisionVertexArray,o.text.placed,!v||u,y.x,y.y)}var x=Boolean(!u&&g.verticalIconBox);g.iconBox&&Qi(b.iconCollisionBox.collisionVertexArray,o.icon.placed,x,A?y.x:0,A?y.y:0),g.verticalIconBox&&Qi(b.iconCollisionBox.collisionVertexArray,o.icon.placed,!x,A?y.x:0,A?y.y:0)}}},o=0;o<b.symbolInstances.length;o++)n(o);if(b.sortFeatures(this.transform.angle),this.retainedQueryData[b.bucketInstanceId]&&(this.retainedQueryData[b.bucketInstanceId].featureSortOrder=b.featureSortOrder),b.hasTextData()&&b.text.opacityVertexBuffer&&b.text.opacityVertexBuffer.updateData(b.text.opacityVertexArray),b.hasIconData()&&b.icon.opacityVertexBuffer&&b.icon.opacityVertexBuffer.updateData(b.icon.opacityVertexArray),b.hasIconCollisionBoxData()&&b.iconCollisionBox.collisionVertexBuffer&&b.iconCollisionBox.collisionVertexBuffer.updateData(b.iconCollisionBox.collisionVertexArray),b.hasTextCollisionBoxData()&&b.textCollisionBox.collisionVertexBuffer&&b.textCollisionBox.collisionVertexBuffer.updateData(b.textCollisionBox.collisionVertexArray),b.bucketInstanceId in this.collisionCircleArrays){var a=this.collisionCircleArrays[b.bucketInstanceId];b.placementInvProjMatrix=a.invProjMatrix,b.placementViewportMatrix=a.viewportMatrix,b.collisionCircleArray=a.circles,delete this.collisionCircleArrays[b.bucketInstanceId]}},Ji.prototype.symbolFadeChange=function(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Ji.prototype.zoomAdjustment=function(t){return Math.max(0,(this.transform.zoom-t)/1.5)},Ji.prototype.hasTransitions=function(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration},Ji.prototype.stillRecent=function(t,e){var i=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*i>t},Ji.prototype.setStale=function(){this.stale=!0};var $i=Math.pow(2,25),tr=Math.pow(2,24),er=Math.pow(2,17),ir=Math.pow(2,16),rr=Math.pow(2,9),nr=Math.pow(2,8),or=Math.pow(2,1);function ar(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;var e=t.placed?1:0,i=Math.floor(127*t.opacity);return i*$i+e*tr+i*er+e*ir+i*rr+e*nr+i*or+e}function sr(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}var lr=0;function ur(t,e,i,r,n,o,a){this.placement=new Ji(t,n,o,a),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=i,this._showCollisionBoxes=r,this._done=!1}function cr(t,e,i){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=i;for(var r=0;r<e.length;r++){var n=e.get(r),o=n.key;this.indexedSymbolInstances[o]||(this.indexedSymbolInstances[o]=[]),this.indexedSymbolInstances[o].push({crossTileID:n.crossTileID,coord:this.getScaledCoordinates(n,t)})}}sr.prototype.continuePlacement=function(t,e,i,r,n){for(var o=this._bucketParts;this._currentTileIndex<t.length;)if(e.getBucketParts(o,r,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,n())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort(function(t,e){return t.sortKey-e.sortKey}));this._currentPartIndex<o.length;)if(e.placeLayerBucketPart(o[this._currentPartIndex],this._seenCrossTileIDs,i),this._currentPartIndex++,n())return!0;return!1},ur.prototype.isDone=function(){return this._done},ur.prototype.continuePlacement=function(t,e,i){for(var r=this,n=vt.browser.now(),o=function(){var t=vt.browser.now()-n;return!r._forceFullPlacement&&2<t};0<=this._currentPlacementIndex;){var a=e[t[this._currentPlacementIndex]],s=this.placement.collisionIndex.transform.zoom;if("symbol"===a.type&&(!a.minzoom||a.minzoom<=s)&&(!a.maxzoom||a.maxzoom>s)){if(this._inProgressLayer||(this._inProgressLayer=new sr(a)),this._inProgressLayer.continuePlacement(i[a.source],this.placement,this._showCollisionBoxes,a,o))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},ur.prototype.commit=function(t){return this.placement.commit(t),this.placement};var pr=512/vt.EXTENT/2;function hr(){this.maxCrossTileID=0}function dr(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}function fr(){this.layerIndexes={},this.crossTileIDs=new hr,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}function mr(t,e){return vt.emitValidationErrors(t,e&&e.filter(function(t){return"source.canvas"!==t.identifier}))}cr.prototype.getScaledCoordinates=function(t,e){var i=pr/Math.pow(2,e.canonical.z-this.tileID.canonical.z);return{x:Math.floor((e.canonical.x*vt.EXTENT+t.anchorX)*i),y:Math.floor((e.canonical.y*vt.EXTENT+t.anchorY)*i)}},cr.prototype.findMatches=function(t,e,i){for(var r=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z),n=0;n<t.length;n++){var o=t.get(n);if(!o.crossTileID){var a=this.indexedSymbolInstances[o.key];if(a)for(var s=this.getScaledCoordinates(o,e),l=0,u=a;l<u.length;l+=1){var c=u[l];if(Math.abs(c.coord.x-s.x)<=r&&Math.abs(c.coord.y-s.y)<=r&&!i[c.crossTileID]){i[c.crossTileID]=!0,o.crossTileID=c.crossTileID;break}}}}},hr.prototype.generate=function(){return++this.maxCrossTileID},dr.prototype.handleWrapJump=function(t){var e=Math.round((t-this.lng)/360);if(0!==e)for(var i in this.indexes){var r=this.indexes[i],n={};for(var o in r){var a=r[o];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+e),n[a.tileID.key]=a}this.indexes[i]=n}this.lng=t},dr.prototype.addBucket=function(t,e,i){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(var r=0;r<e.symbolInstances.length;r++)e.symbolInstances.get(r).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});var n=this.usedCrossTileIDs[t.overscaledZ];for(var o in this.indexes){var a=this.indexes[o];if(Number(o)>t.overscaledZ)for(var s in a){var l=a[s];l.tileID.isChildOf(t)&&l.findMatches(e.symbolInstances,t,n)}else{var u=a[t.scaledTo(Number(o)).key];u&&u.findMatches(e.symbolInstances,t,n)}}for(var c=0;c<e.symbolInstances.length;c++){var p=e.symbolInstances.get(c);p.crossTileID||(p.crossTileID=i.generate(),n[p.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new cr(t,e.symbolInstances,e.bucketInstanceId),!0},dr.prototype.removeBucketCrossTileIDs=function(t,e){for(var i in e.indexedSymbolInstances)for(var r=0,n=e.indexedSymbolInstances[i];r<n.length;r+=1)delete this.usedCrossTileIDs[t][n[r].crossTileID]},dr.prototype.removeStaleBuckets=function(t){var e=!1;for(var i in this.indexes){var r=this.indexes[i];for(var n in r)t[r[n].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,r[n]),delete r[n],e=!0)}return e},fr.prototype.addLayer=function(t,e,i){var r=this.layerIndexes[t.id];void 0===r&&(r=this.layerIndexes[t.id]=new dr);var n=!1,o={};r.handleWrapJump(i);for(var a=0,s=e;a<s.length;a+=1){var l=s[a],u=l.getBucket(t);u&&t.id===u.layerIds[0]&&(u.bucketInstanceId||(u.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(l.tileID,u,this.crossTileIDs)&&(n=!0),o[u.bucketInstanceId]=!0)}return r.removeStaleBuckets(o)&&(n=!0),n},fr.prototype.pruneUnusedLayers=function(t){var e={};for(var i in t.forEach(function(t){e[t]=!0}),this.layerIndexes)e[i]||delete this.layerIndexes[i]};var gr,yr=vt.pick(_i,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),vr=vt.pick(_i,["setCenter","setZoom","setBearing","setPitch"]),_r=function(){var t={},e=vt.styleSpec.$version;for(var i in vt.styleSpec.$root){var r,n=vt.styleSpec.$root[i];n.required&&null!=(r="version"===i?e:"array"===n.type?[]:{})&&(t[i]=r)}return t}(),xr=((gr=vt.Evented)&&(br.__proto__=gr),((br.prototype=Object.create(gr&&gr.prototype)).constructor=br).prototype.loadURL=function(t,e){var i=this;void 0===e&&(e={}),this.fire(new vt.Event("dataloading",{dataType:"style"}));var r="boolean"==typeof e.validate?e.validate:!vt.isMapboxURL(t);t=this.map._requestManager.normalizeStyleURL(t,e.accessToken);var n=this.map._requestManager.transformRequest(t,vt.ResourceType.Style);this._request=vt.getJSON(n,function(t,e){i._request=null,t?i.fire(new vt.ErrorEvent(t)):e&&i._load(e,r)})},br.prototype.loadJSON=function(t,e){var i=this;void 0===e&&(e={}),this.fire(new vt.Event("dataloading",{dataType:"style"})),this._request=vt.browser.frame(function(){i._request=null,i._load(t,!1!==e.validate)})},br.prototype.loadEmpty=function(){this.fire(new vt.Event("dataloading",{dataType:"style"})),this._load(_r,!1)},br.prototype._load=function(t,e){if(!e||!mr(this,vt.validateStyle(t))){for(var i in this._loaded=!0,(this.stylesheet=t).sources)this.addSource(i,t.sources[i],{validate:!1});t.sprite?this._loadSprite(t.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(t.glyphs);var r=vi(this.stylesheet.layers);this._order=r.map(function(t){return t.id}),this._layers={},this._serializedLayers={};for(var n=0,o=r;n<o.length;n+=1){var a=o[n];(a=vt.createStyleLayer(a)).setEventedParent(this,{layer:{id:a.id}}),this._layers[a.id]=a,this._serializedLayers[a.id]=a.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new T(this.stylesheet.light),this.fire(new vt.Event("data",{dataType:"style"})),this.fire(new vt.Event("style.load"))}},br.prototype._loadSprite=function(t){var e,i,f,m,g,y,r,n,o,a=this;function s(){if(y)f(y);else if(m&&g){var t=vt.browser.getImageData(g),e={};for(var i in m){var r=m[i],n=r.width,o=r.height,a=r.x,s=r.y,l=r.sdf,u=r.pixelRatio,c=r.stretchX,p=r.stretchY,h=r.content,d=new vt.RGBAImage({width:n,height:o});vt.RGBAImage.copy(t,d,{x:a,y:s},{x:0,y:0},{width:n,height:o}),e[i]={data:d,pixelRatio:u,sdf:l,stretchX:c,stretchY:p,content:h}}f(null,e)}}this._spriteRequest=(e=t,i=this.map._requestManager,f=function(t,e){if(a._spriteRequest=null,t)a.fire(new vt.ErrorEvent(t));else if(e)for(var i in e)a.imageManager.addImage(i,e[i]);a.imageManager.setLoaded(!0),a._availableImages=a.imageManager.listImages(),a.dispatcher.broadcast("setImages",a._availableImages),a.fire(new vt.Event("data",{dataType:"style"}))},r=1<vt.browser.devicePixelRatio?"@2x":"",n=vt.getJSON(i.transformRequest(i.normalizeSpriteURL(e,r,".json"),vt.ResourceType.SpriteJSON),function(t,e){n=null,y||(y=t,m=e,s())}),o=vt.getImage(i.transformRequest(i.normalizeSpriteURL(e,r,".png"),vt.ResourceType.SpriteImage),function(t,e){o=null,y||(y=t,g=e,s())}),{cancel:function(){n&&(n.cancel(),n=null),o&&(o.cancel(),o=null)}})},br.prototype._validateLayer=function(t){var e=this.sourceCaches[t.source];if(e){var i=t.sourceLayer;if(i){var r=e.getSource();("geojson"===r.type||r.vectorLayerIds&&-1===r.vectorLayerIds.indexOf(i))&&this.fire(new vt.ErrorEvent(new Error('Source layer "'+i+'" does not exist on source "'+r.id+'" as specified by style layer "'+t.id+'"')))}}},br.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()},br.prototype._serializeLayers=function(t){for(var e=[],i=0,r=t;i<r.length;i+=1){var n=this._layers[r[i]];"custom"!==n.type&&e.push(n.serialize())}return e},br.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(var e in this._layers)if(this._layers[e].hasTransition())return!0;return!1},br.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},br.prototype.update=function(t){if(this._loaded){var e=this._changed;if(this._changed){var i=Object.keys(this._updatedLayers),r=Object.keys(this._removedLayers);for(var n in(i.length||r.length)&&this._updateWorkerLayers(i,r),this._updatedSources){var o=this._updatedSources[n];"reload"===o?this._reloadSource(n):"clear"===o&&this._clearSource(n)}for(var a in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[a].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}for(var s in this.sourceCaches)this.sourceCaches[s].used=!1;for(var l=0,u=this._order;l<u.length;l+=1){var c=this._layers[u[l]];c.recalculate(t,this._availableImages),!c.isHidden(t.zoom)&&c.source&&(this.sourceCaches[c.source].used=!0)}this.light.recalculate(t),this.z=t.zoom,e&&this.fire(new vt.Event("data",{dataType:"style"}))}},br.prototype._updateTilesForChangedImages=function(){var t=Object.keys(this._changedImages);if(t.length){for(var e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}},br.prototype._updateWorkerLayers=function(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})},br.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},br.prototype.setState=function(t){var e=this;if(this._checkLoaded(),mr(this,vt.validateStyle(t)))return!1;(t=vt.clone$1(t)).layers=vi(t.layers);var i=function(t,e){if(!t)return[{command:_i.setStyle,args:[e]}];var i=[];try{if(!vt.deepEqual(t.version,e.version))return[{command:_i.setStyle,args:[e]}];vt.deepEqual(t.center,e.center)||i.push({command:_i.setCenter,args:[e.center]}),vt.deepEqual(t.zoom,e.zoom)||i.push({command:_i.setZoom,args:[e.zoom]}),vt.deepEqual(t.bearing,e.bearing)||i.push({command:_i.setBearing,args:[e.bearing]}),vt.deepEqual(t.pitch,e.pitch)||i.push({command:_i.setPitch,args:[e.pitch]}),vt.deepEqual(t.sprite,e.sprite)||i.push({command:_i.setSprite,args:[e.sprite]}),vt.deepEqual(t.glyphs,e.glyphs)||i.push({command:_i.setGlyphs,args:[e.glyphs]}),vt.deepEqual(t.transition,e.transition)||i.push({command:_i.setTransition,args:[e.transition]}),vt.deepEqual(t.light,e.light)||i.push({command:_i.setLight,args:[e.light]});var r={},n=[];!function(t,e,i,r){var n,o,a,s;for(n in e=e||{},t=t||{})t.hasOwnProperty(n)&&(e.hasOwnProperty(n)||bi(n,i,r));for(n in e)e.hasOwnProperty(n)&&(t.hasOwnProperty(n)?vt.deepEqual(t[n],e[n])||("geojson"===t[n].type&&"geojson"===e[n].type&&wi(t,e,n)?i.push({command:_i.setGeoJSONSourceData,args:[n,e[n].data]}):(a=e,bi(o=n,s=i,r),xi(o,a,s))):xi(n,e,i))}(t.sources,e.sources,n,r);var o=[];t.layers&&t.layers.forEach(function(t){r[t.source]?i.push({command:_i.removeLayer,args:[t.id]}):o.push(t)}),i=i.concat(n),function(t,e,i){e=e||[];var r,n,o,a,s,l,u,c=(t=t||[]).map(Ti),p=e.map(Ti),h=t.reduce(Ii,{}),d=e.reduce(Ii,{}),f=c.slice(),m=Object.create(null);for(n=r=0;r<c.length;r++)d.hasOwnProperty(o=c[r])?n++:(i.push({command:_i.removeLayer,args:[o]}),f.splice(f.indexOf(o,n),1));for(n=r=0;r<p.length;r++)f[f.length-1-r]!==(o=p[p.length-1-r])&&(h.hasOwnProperty(o)?(i.push({command:_i.removeLayer,args:[o]}),f.splice(f.lastIndexOf(o,f.length-n),1)):n++,i.push({command:_i.addLayer,args:[d[o],l=f[f.length-r]]}),f.splice(f.length-r,0,o),m[o]=!0);for(r=0;r<p.length;r++)if(a=h[o=p[r]],s=d[o],!m[o]&&!vt.deepEqual(a,s))if(vt.deepEqual(a.source,s.source)&&vt.deepEqual(a["source-layer"],s["source-layer"])&&vt.deepEqual(a.type,s.type)){for(u in Si(a.layout,s.layout,i,o,null,_i.setLayoutProperty),Si(a.paint,s.paint,i,o,null,_i.setPaintProperty),vt.deepEqual(a.filter,s.filter)||i.push({command:_i.setFilter,args:[o,s.filter]}),vt.deepEqual(a.minzoom,s.minzoom)&&vt.deepEqual(a.maxzoom,s.maxzoom)||i.push({command:_i.setLayerZoomRange,args:[o,s.minzoom,s.maxzoom]}),a)a.hasOwnProperty(u)&&"layout"!==u&&"paint"!==u&&"filter"!==u&&"metadata"!==u&&"minzoom"!==u&&"maxzoom"!==u&&(0===u.indexOf("paint.")?Si(a[u],s[u],i,o,u.slice(6),_i.setPaintProperty):vt.deepEqual(a[u],s[u])||i.push({command:_i.setLayerProperty,args:[o,u,s[u]]}));for(u in s)s.hasOwnProperty(u)&&!a.hasOwnProperty(u)&&"layout"!==u&&"paint"!==u&&"filter"!==u&&"metadata"!==u&&"minzoom"!==u&&"maxzoom"!==u&&(0===u.indexOf("paint.")?Si(a[u],s[u],i,o,u.slice(6),_i.setPaintProperty):vt.deepEqual(a[u],s[u])||i.push({command:_i.setLayerProperty,args:[o,u,s[u]]}))}else i.push({command:_i.removeLayer,args:[o]}),l=f[f.lastIndexOf(o)+1],i.push({command:_i.addLayer,args:[s,l]})}(o,e.layers,i)}catch(t){console.warn("Unable to compute style diff:",t),i=[{command:_i.setStyle,args:[e]}]}return i}(this.serialize(),t).filter(function(t){return!(t.command in vr)});if(0===i.length)return!1;var r=i.filter(function(t){return!(t.command in yr)});if(0<r.length)throw new Error("Unimplemented: "+r.map(function(t){return t.command}).join(", ")+".");return i.forEach(function(t){"setTransition"!==t.command&&e[t.command].apply(e,t.args)}),this.stylesheet=t,!0},br.prototype.addImage=function(t,e){if(this.getImage(t))return this.fire(new vt.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(t,e),this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.fire(new vt.Event("data",{dataType:"style"}))},br.prototype.updateImage=function(t,e){this.imageManager.updateImage(t,e)},br.prototype.getImage=function(t){return this.imageManager.getImage(t)},br.prototype.removeImage=function(t){if(!this.getImage(t))return this.fire(new vt.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(t),this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.fire(new vt.Event("data",{dataType:"style"}))},br.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},br.prototype.addSource=function(t,e,i){var r=this;if(void 0===i&&(i={}),this._checkLoaded(),void 0!==this.sourceCaches[t])throw new Error("There is already a source with this ID");if(!e.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(e).join(", ")+".");if(!(0<=["vector","raster","geojson","video","image"].indexOf(e.type)&&this._validate(vt.validateStyle.source,"sources."+t,e,null,i))){this.map&&this.map._collectResourceTiming&&(e.collectResourceTiming=!0);var n=this.sourceCaches[t]=new si(t,e,this.dispatcher);n.style=this,n.setEventedParent(this,function(){return{isSourceLoaded:r.loaded(),source:n.serialize(),sourceId:t}}),n.onAdd(this.map),this._changed=!0}},br.prototype.removeSource=function(t){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error("There is no source with this ID");for(var e in this._layers)if(this._layers[e].source===t)return this.fire(new vt.ErrorEvent(new Error('Source "'+t+'" cannot be removed while layer "'+e+'" is using it.')));var i=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],i.fire(new vt.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),i.setEventedParent(null),i.clearTiles(),i.onRemove&&i.onRemove(this.map),this._changed=!0},br.prototype.setGeoJSONSourceData=function(t,e){this._checkLoaded(),this.sourceCaches[t].getSource().setData(e),this._changed=!0},br.prototype.getSource=function(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()},br.prototype.addLayer=function(t,e,i){void 0===i&&(i={}),this._checkLoaded();var r=t.id;if(this.getLayer(r))this.fire(new vt.ErrorEvent(new Error('Layer with id "'+r+'" already exists on this map')));else{var n;if("custom"===t.type){if(mr(this,vt.validateCustomStyleLayer(t)))return;n=vt.createStyleLayer(t)}else{if("object"==typeof t.source&&(this.addSource(r,t.source),t=vt.clone$1(t),t=vt.extend(t,{source:r})),this._validate(vt.validateStyle.layer,"layers."+r,t,{arrayIndex:-1},i))return;n=vt.createStyleLayer(t),this._validateLayer(n),n.setEventedParent(this,{layer:{id:r}}),this._serializedLayers[n.id]=n.serialize()}var o=e?this._order.indexOf(e):this._order.length;if(e&&-1===o)this.fire(new vt.ErrorEvent(new Error('Layer with id "'+e+'" does not exist on this map.')));else{if(this._order.splice(o,0,r),this._layerOrderChanged=!0,this._layers[r]=n,this._removedLayers[r]&&n.source&&"custom"!==n.type){var a=this._removedLayers[r];delete this._removedLayers[r],a.type!==n.type?this._updatedSources[n.source]="clear":(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause())}this._updateLayer(n),n.onAdd&&n.onAdd(this.map)}}},br.prototype.moveLayer=function(t,e){if(this._checkLoaded(),this._changed=!0,this._layers[t]){if(t!==e){var i=this._order.indexOf(t);this._order.splice(i,1);var r=e?this._order.indexOf(e):this._order.length;e&&-1===r?this.fire(new vt.ErrorEvent(new Error('Layer with id "'+e+'" does not exist on this map.'))):(this._order.splice(r,0,t),this._layerOrderChanged=!0)}}else this.fire(new vt.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be moved.")))},br.prototype.removeLayer=function(t){this._checkLoaded();var e=this._layers[t];if(e){e.setEventedParent(null);var i=this._order.indexOf(t);this._order.splice(i,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=e,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],e.onRemove&&e.onRemove(this.map)}else this.fire(new vt.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be removed.")))},br.prototype.getLayer=function(t){return this._layers[t]},br.prototype.hasLayer=function(t){return t in this._layers},br.prototype.setLayerZoomRange=function(t,e,i){this._checkLoaded();var r=this.getLayer(t);r?r.minzoom===e&&r.maxzoom===i||(null!=e&&(r.minzoom=e),null!=i&&(r.maxzoom=i),this._updateLayer(r)):this.fire(new vt.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot have zoom extent.")))},br.prototype.setFilter=function(t,e,i){void 0===i&&(i={}),this._checkLoaded();var r=this.getLayer(t);if(r){if(!vt.deepEqual(r.filter,e))return null==e?(r.filter=void 0,void this._updateLayer(r)):void(this._validate(vt.validateStyle.filter,"layers."+r.id+".filter",e,null,i)||(r.filter=vt.clone$1(e),this._updateLayer(r)))}else this.fire(new vt.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be filtered.")))},br.prototype.getFilter=function(t){return vt.clone$1(this.getLayer(t).filter)},br.prototype.setLayoutProperty=function(t,e,i,r){void 0===r&&(r={}),this._checkLoaded();var n=this.getLayer(t);n?vt.deepEqual(n.getLayoutProperty(e),i)||(n.setLayoutProperty(e,i,r),this._updateLayer(n)):this.fire(new vt.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")))},br.prototype.getLayoutProperty=function(t,e){var i=this.getLayer(t);if(i)return i.getLayoutProperty(e);this.fire(new vt.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style.")))},br.prototype.setPaintProperty=function(t,e,i,r){void 0===r&&(r={}),this._checkLoaded();var n=this.getLayer(t);n?vt.deepEqual(n.getPaintProperty(e),i)||(n.setPaintProperty(e,i,r)&&this._updateLayer(n),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new vt.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")))},br.prototype.getPaintProperty=function(t,e){return this.getLayer(t).getPaintProperty(e)},br.prototype.setFeatureState=function(t,e){this._checkLoaded();var i=t.source,r=t.sourceLayer,n=this.sourceCaches[i];if(void 0!==n){var o=n.getSource().type;"geojson"===o&&r?this.fire(new vt.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==o||r?(void 0===t.id&&this.fire(new vt.ErrorEvent(new Error("The feature id parameter must be provided."))),n.setFeatureState(r,t.id,e)):this.fire(new vt.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new vt.ErrorEvent(new Error("The source '"+i+"' does not exist in the map's style.")))},br.prototype.removeFeatureState=function(t,e){this._checkLoaded();var i=t.source,r=this.sourceCaches[i];if(void 0!==r){var n=r.getSource().type,o="vector"===n?t.sourceLayer:void 0;"vector"!==n||o?e&&"string"!=typeof t.id&&"number"!=typeof t.id?this.fire(new vt.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):r.removeFeatureState(o,t.id,e):this.fire(new vt.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new vt.ErrorEvent(new Error("The source '"+i+"' does not exist in the map's style.")))},br.prototype.getFeatureState=function(t){this._checkLoaded();var e=t.source,i=t.sourceLayer,r=this.sourceCaches[e];if(void 0!==r){if("vector"!==r.getSource().type||i)return void 0===t.id&&this.fire(new vt.ErrorEvent(new Error("The feature id parameter must be provided."))),r.getFeatureState(i,t.id);this.fire(new vt.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new vt.ErrorEvent(new Error("The source '"+e+"' does not exist in the map's style.")))},br.prototype.getTransition=function(){return vt.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},br.prototype.serialize=function(){return vt.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:vt.mapObject(this.sourceCaches,function(t){return t.serialize()}),layers:this._serializeLayers(this._order)},function(t){return void 0!==t})},br.prototype._updateLayer=function(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&"raster"!==this.sourceCaches[t.source].getSource().type&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0},br.prototype._flattenAndSortRenderedFeatures=function(t){for(var e=this,i=function(t){return"fill-extrusion"===e._layers[t].type},r={},n=[],o=this._order.length-1;0<=o;o--){var a=this._order[o];if(i(a)){r[a]=o;for(var s=0,l=t;s<l.length;s+=1){var u=l[s][a];if(u)for(var c=0,p=u;c<p.length;c+=1)n.push(p[c])}}}n.sort(function(t,e){return e.intersectionZ-t.intersectionZ});for(var h=[],d=this._order.length-1;0<=d;d--){var f=this._order[d];if(i(f))for(var m=n.length-1;0<=m;m--){var g=n[m].feature;if(r[g.layer.id]<d)break;h.push(g),n.pop()}else for(var y=0,v=t;y<v.length;y+=1){var _=v[y][f];if(_)for(var x=0,b=_;x<b.length;x+=1)h.push(b[x].feature)}}return h},br.prototype.queryRenderedFeatures=function(t,e,i){e&&e.filter&&this._validate(vt.validateStyle.filter,"queryRenderedFeatures.filter",e.filter,null,e);var r={};if(e&&e.layers){if(!Array.isArray(e.layers))return this.fire(new vt.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var n=0,o=e.layers;n<o.length;n+=1){var a=o[n],s=this._layers[a];if(!s)return this.fire(new vt.ErrorEvent(new Error("The layer '"+a+"' does not exist in the map's style and cannot be queried for features."))),[];r[s.source]=!0}}var l=[];for(var u in e.availableImages=this._availableImages,this.sourceCaches)e.layers&&!r[u]||l.push(Q(this.sourceCaches[u],this._layers,this._serializedLayers,t,e,i));return this.placement&&l.push(function(s,l,n,t,u,e,i){for(var c={},p=e.queryRenderedSymbols(t),r=[],o=0,a=Object.keys(p).map(Number);o<a.length;o+=1)r.push(i[a[o]]);r.sort($);for(var h=function(){var n=f[d],t=n.featureIndex.lookupSymbolFeatures(p[n.bucketInstanceId],l,n.bucketIndex,n.sourceLayerIndex,u.filter,u.layers,u.availableImages,s);for(var e in t){var i=c[e]=c[e]||[],r=t[e];r.sort(function(t,e){var i=n.featureSortOrder;if(i){var r=i.indexOf(t.featureIndex);return i.indexOf(e.featureIndex)-r}return e.featureIndex-t.featureIndex});for(var o=0,a=r;o<a.length;o+=1)i.push(a[o])}},d=0,f=r;d<f.length;d+=1)h();function m(r){c[r].forEach(function(t){var e=t.feature,i=n[s[r].source].getFeatureState(e.layer["source-layer"],e.id);e.source=e.layer.source,e.layer["source-layer"]&&(e.sourceLayer=e.layer["source-layer"]),e.state=i})}for(var g in c)m(g);return c}(this._layers,this._serializedLayers,this.sourceCaches,t,e,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(l)},br.prototype.querySourceFeatures=function(t,e){e&&e.filter&&this._validate(vt.validateStyle.filter,"querySourceFeatures.filter",e.filter,null,e);var i=this.sourceCaches[t];return i?function(e,t){for(var i=e.getRenderableIds().map(function(t){return e.getTileByID(t)}),r=[],n={},o=0;o<i.length;o++){var a=i[o],s=a.tileID.canonical.key;n[s]||(n[s]=!0,a.querySourceFeatures(r,t))}return r}(i,e):[]},br.prototype.addSourceType=function(t,e,i){return br.getSourceType(t)?i(new Error('A source type called "'+t+'" already exists.')):(br.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},i):i(null,null))},br.prototype.getLight=function(){return this.light.getLight()},br.prototype.setLight=function(t,e){void 0===e&&(e={}),this._checkLoaded();var i=this.light.getLight(),r=!1;for(var n in t)if(!vt.deepEqual(t[n],i[n])){r=!0;break}if(r){var o={now:vt.browser.now(),transition:vt.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,e),this.light.updateTransitions(o)}},br.prototype._validate=function(t,e,i,r,n){return void 0===n&&(n={}),(!n||!1!==n.validate)&&mr(this,t.call(vt.validateStyle,vt.extend({key:e,style:this.serialize(),value:i,styleSpec:vt.styleSpec},r)))},br.prototype._remove=function(){for(var t in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),vt.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[t].setEventedParent(null);for(var e in this.sourceCaches)this.sourceCaches[e].clearTiles(),this.sourceCaches[e].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},br.prototype._clearSource=function(t){this.sourceCaches[t].clearTiles()},br.prototype._reloadSource=function(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()},br.prototype._updateSources=function(t){for(var e in this.sourceCaches)this.sourceCaches[e].update(t)},br.prototype._generateCollisionBoxes=function(){for(var t in this.sourceCaches)this._reloadSource(t)},br.prototype._updatePlacement=function(t,e,i,r,n){void 0===n&&(n=!1);for(var o=!1,a=!1,s={},l=0,u=this._order;l<u.length;l+=1){var c=this._layers[u[l]];if("symbol"===c.type){if(!s[c.source]){var p=this.sourceCaches[c.source];s[c.source]=p.getRenderableIds(!0).map(function(t){return p.getTileByID(t)}).sort(function(t,e){return e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)})}var h=this.crossTileSymbolIndex.addLayer(c,s[c.source],t.center.lng);o=o||h}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((n=n||this._layerOrderChanged||0===i)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(vt.browser.now(),t.zoom))&&(this.pauseablePlacement=new ur(t,this._order,n,e,i,r,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,s),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(vt.browser.now()),a=!0),o&&this.pauseablePlacement.placement.setStale()),a||o)for(var d=0,f=this._order;d<f.length;d+=1){var m=this._layers[f[d]];"symbol"===m.type&&this.placement.updateLayerOpacities(m,s[m.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(vt.browser.now())},br.prototype._releaseSymbolFadeTiles=function(){for(var t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()},br.prototype.getImages=function(t,e,i){this.imageManager.getImages(e.icons,i),this._updateTilesForChangedImages();var r=this.sourceCaches[e.source];r&&r.setDependencies(e.tileID.key,e.type,e.icons)},br.prototype.getGlyphs=function(t,e,i){this.glyphManager.getGlyphs(e.stacks,i)},br.prototype.getResource=function(t,e,i){return vt.makeRequest(e,i)},br);function br(t,e){var o=this;void 0===e&&(e={}),gr.call(this),this.map=t,this.dispatcher=new E(gi(),this),this.imageManager=new c,this.imageManager.setEventedParent(this),this.glyphManager=new v(t._requestManager,e.localIdeographFontFamily),this.lineAtlas=new b(256,512),this.crossTileSymbolIndex=new fr,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new vt.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",vt.getReferrer());var r=this;this._rtlTextPluginCallback=br.registerForPluginStateChange(function(t){r.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:t.pluginStatus,pluginURL:t.pluginURL},function(t,e){if(vt.triggerPluginCompletionEvent(t),e&&e.every(function(t){return t}))for(var i in r.sourceCaches)r.sourceCaches[i].reload()})}),this.on("data",function(t){if("source"===t.dataType&&"metadata"===t.sourceDataType){var e=o.sourceCaches[t.sourceId];if(e){var i=e.getSource();if(i&&i.vectorLayerIds)for(var r in o._layers){var n=o._layers[r];n.source===i.id&&o._validateLayer(n)}}}})}xr.getSourceType=function(t){return G[t]},xr.setSourceType=function(t,e){G[t]=e},xr.registerForPluginStateChange=vt.registerForPluginStateChange;var wr=vt.createLayout([{name:"a_pos",type:"Int16",components:2}]),Sr=Xr("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),Tr=Xr("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ir=Xr("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Er=Xr("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Cr=Xr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ar=Xr("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),kr=Xr("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Pr=Xr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Mr=Xr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Lr=Xr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Dr=Xr("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),zr=Xr("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Or=Xr("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Rr=Xr("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),Nr=Xr("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),Br=Xr("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),Fr=Xr("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Ur=Xr("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),jr=Xr("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),qr=Xr("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Vr=Xr("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),Gr=Xr("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),Zr=Xr("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Hr=Xr("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),Wr=Xr("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),Kr=Xr("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function Xr(t,e){var i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=e.match(/attribute ([\w]+) ([\w]+)/g),n=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=o?o.concat(n):n,s={};return{fragmentSource:t=t.replace(i,function(t,e,i,r,n){return s[n]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_"+n+"\nvarying "+i+" "+r+" "+n+";\n#else\nuniform "+i+" "+r+" u_"+n+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+n+"\n    "+i+" "+r+" "+n+" = u_"+n+";\n#endif\n"}),vertexSource:e=e.replace(i,function(t,e,i,r,n){var o="float"===r?"vec2":"vec4",a=n.match(/color/)?"color":o;return s[n]?"define"===e?"\n#ifndef HAS_UNIFORM_u_"+n+"\nuniform lowp float u_"+n+"_t;\nattribute "+i+" "+o+" a_"+n+";\nvarying "+i+" "+r+" "+n+";\n#else\nuniform "+i+" "+r+" u_"+n+";\n#endif\n":"vec4"==a?"\n#ifndef HAS_UNIFORM_u_"+n+"\n    "+n+" = a_"+n+";\n#else\n    "+i+" "+r+" "+n+" = u_"+n+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+n+"\n    "+n+" = unpack_mix_"+a+"(a_"+n+", u_"+n+"_t);\n#else\n    "+i+" "+r+" "+n+" = u_"+n+";\n#endif\n":"define"===e?"\n#ifndef HAS_UNIFORM_u_"+n+"\nuniform lowp float u_"+n+"_t;\nattribute "+i+" "+o+" a_"+n+";\n#else\nuniform "+i+" "+r+" u_"+n+";\n#endif\n":"vec4"==a?"\n#ifndef HAS_UNIFORM_u_"+n+"\n    "+i+" "+r+" "+n+" = a_"+n+";\n#else\n    "+i+" "+r+" "+n+" = u_"+n+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+n+"\n    "+i+" "+r+" "+n+" = unpack_mix_"+a+"(a_"+n+", u_"+n+"_t);\n#else\n    "+i+" "+r+" "+n+" = u_"+n+";\n#endif\n"}),staticAttributes:r,staticUniforms:a}}function Yr(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}var Jr=Object.freeze({__proto__:null,prelude:Sr,background:Tr,backgroundPattern:Ir,circle:Er,clippingMask:Cr,heatmap:Ar,heatmapTexture:kr,collisionBox:Pr,collisionCircle:Mr,debug:Lr,fill:Dr,fillOutline:zr,fillOutlinePattern:Or,fillPattern:Rr,fillExtrusion:Nr,fillExtrusionPattern:Br,hillshadePrepare:Fr,hillshade:Ur,line:jr,lineGradient:qr,linePattern:Vr,lineSDF:Gr,raster:Zr,symbolIcon:Hr,symbolSDF:Wr,symbolTextAndIcon:Kr});function Qr(t){for(var e=[],i=0;i<t.length;i++)if(null!==t[i]){var r=t[i].split(" ");e.push(r.pop())}return e}function $r(t,e,i,r,n,o){var a=t.gl;this.program=a.createProgram();for(var s=Qr(i.staticAttributes),l=r?r.getBinderAttributes():[],u=s.concat(l),c=i.staticUniforms?Qr(i.staticUniforms):[],p=r?r.getBinderUniforms():[],h=[],d=0,f=c.concat(p);d<f.length;d+=1){var m=f[d];h.indexOf(m)<0&&h.push(m)}var g=r?r.defines():[];o&&g.push("#define OVERDRAW_INSPECTOR;");var y=g.concat(Sr.fragmentSource,i.fragmentSource).join("\n"),v=g.concat(Sr.vertexSource,i.vertexSource).join("\n"),_=a.createShader(a.FRAGMENT_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(_,y),a.compileShader(_),a.attachShader(this.program,_);var x=a.createShader(a.VERTEX_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(x,v),a.compileShader(x),a.attachShader(this.program,x),this.attributes={};var b={};this.numAttributes=u.length;for(var w=0;w<this.numAttributes;w++)u[w]&&(a.bindAttribLocation(this.program,w,u[w]),this.attributes[u[w]]=w);a.linkProgram(this.program),a.deleteShader(x),a.deleteShader(_);for(var S=0;S<h.length;S++){var T=h[S];if(T&&!b[T]){var I=a.getUniformLocation(this.program,T);I&&(b[T]=I)}}this.fixedUniforms=n(t,b),this.binderUniforms=r?r.getUniforms(t,b):[]}}}function tn(t,e,i){var r=1/qi(i,1,e.transform.tileZoom),n=Math.pow(2,i.tileID.overscaledZ),o=i.tileSize*Math.pow(2,e.transform.tileZoom)/n,a=o*(i.tileID.canonical.x+i.tileID.wrap*n),s=o*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[r,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[a>>16,s>>16],u_pixel_coord_lower:[65535&a,65535&s]}}function en(t,e,i,r){var n=e.style.light,o=n.properties.get("position"),a=[o.x,o.y,o.z],s=vt.create$1();"viewport"===n.properties.get("anchor")&&vt.fromRotation(s,-e.transform.angle),vt.transformMat3(a,a,s);var l=n.properties.get("color");return{u_matrix:t,u_lightpos:a,u_lightintensity:n.properties.get("intensity"),u_lightcolor:[l.r,l.g,l.b],u_vertical_gradient:+i,u_opacity:r}}function rn(t){return{u_matrix:t}}function nn(t,e,i,r){return vt.extend(rn(t),tn(i,e,r))}function on(t,e,i,r){var n,o,a=t.transform;if("map"===r.paint.get("circle-pitch-alignment")){var s=qi(i,1,a.zoom);n=!0,o=[s,s]}else n=!1,o=a.pixelsToGLUnits;return{u_camera_to_center_distance:a.cameraToCenterDistance,u_scale_with_map:+("map"===r.paint.get("circle-pitch-scale")),u_matrix:t.translatePosMatrix(e.posMatrix,i,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_pitch_with_map:+n,u_device_pixel_ratio:vt.browser.devicePixelRatio,u_extrude_scale:o}}function an(t){return{u_matrix:t}}function sn(t,e,i){var r=t.transform;return{u_matrix:cn(t,e,i),u_ratio:1/qi(e,1,r.zoom),u_device_pixel_ratio:vt.browser.devicePixelRatio,u_units_to_pixels:[1/r.pixelsToGLUnits[0],1/r.pixelsToGLUnits[1]]}}Yr.prototype.bind=function(t,e,i,r,n,o,a,s){this.context=t;for(var l=this.boundPaintVertexBuffers.length!==r.length,u=0;!l&&u<r.length;u++)this.boundPaintVertexBuffers[u]!==r[u]&&(l=!0);t.extVertexArrayObject&&this.vao&&this.boundProgram===e&&this.boundLayoutVertexBuffer===i&&!l&&this.boundIndexBuffer===n&&this.boundVertexOffset===o&&this.boundDynamicVertexBuffer===a&&this.boundDynamicVertexBuffer2===s?(t.bindVertexArrayOES.set(this.vao),a&&a.bind(),n&&n.dynamicDraw&&n.bind(),s&&s.bind()):this.freshBind(e,i,r,n,o,a,s)},Yr.prototype.freshBind=function(t,e,i,r,n,o,a){var s,l=t.numAttributes,u=this.context,c=u.gl;if(u.extVertexArrayObject)this.vao&&this.destroy(),this.vao=u.extVertexArrayObject.createVertexArrayOES(),u.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=r,this.boundVertexOffset=n,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=a;else{s=u.currentNumAttributes||0;for(var p=l;p<s;p++)c.disableVertexAttribArray(p)}e.enableAttributes(c,t);for(var h=0,d=i;h<d.length;h+=1)d[h].enableAttributes(c,t);o&&o.enableAttributes(c,t),a&&a.enableAttributes(c,t),e.bind(),e.setVertexAttribPointers(c,t,n);for(var f=0,m=i;f<m.length;f+=1){var g=m[f];g.bind(),g.setVertexAttribPointers(c,t,n)}o&&(o.bind(),o.setVertexAttribPointers(c,t,n)),r&&r.bind(),a&&(a.bind(),a.setVertexAttribPointers(c,t,n)),u.currentNumAttributes=l},Yr.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)},$r.prototype.draw=function(t,e,i,r,n,o,a,s,l,u,c,p,h,d,f,m){var g,y=t.gl;if(!this.failedToCreate){for(var v in t.program.set(this.program),t.setDepthMode(i),t.setStencilMode(r),t.setColorMode(n),t.setCullFace(o),this.fixedUniforms)this.fixedUniforms[v].set(a[v]);d&&d.setUniforms(t,this.binderUniforms,p,{zoom:h});for(var _=((g={})[y.LINES]=2,g[y.TRIANGLES]=3,g[y.LINE_STRIP]=1,g[e]),x=0,b=c.get();x<b.length;x+=1){var w=b[x],S=w.vaos||(w.vaos={});(S[s]||(S[s]=new Yr)).bind(t,this,l,d?d.getPaintVertexBuffers():[],u,w.vertexOffset,f,m),y.drawElements(e,w.primitiveLength*_,y.UNSIGNED_SHORT,w.primitiveOffset*_*2)}}};var ln=function(t,e,i){return void 0===i&&(i=1),{u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:i}};function un(t,e){return 1/qi(t,1,e.tileZoom)}function cn(t,e,i){return t.translatePosMatrix(e.tileID.posMatrix,e,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}function pn(t,e,i,r,n){return{u_matrix:t,u_tl_parent:e,u_scale_parent:i,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*n.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:n.paint.get("raster-brightness-min"),u_brightness_high:n.paint.get("raster-brightness-max"),u_saturation_factor:0<(a=n.paint.get("raster-saturation"))?1-1/(1.001-a):-a,u_contrast_factor:0<(o=n.paint.get("raster-contrast"))?1/(1-o):1+o,u_spin_weights:function(t){t*=Math.PI/180;var e=Math.sin(t),i=Math.cos(t);return[(2*i+1)/3,(-Math.sqrt(3)*e-i+1)/3,(Math.sqrt(3)*e-i+1)/3]}(n.paint.get("raster-hue-rotate"))};var o,a}function hn(t,e,i,r,n,o,a,s,l,u){var c=n.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:c.cameraToCenterDistance,u_pitch:c.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:c.width/c.height,u_fade_change:n.options.fadeDuration?n.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:a,u_coord_matrix:s,u_is_text:+l,u_pitch_with_map:+r,u_texsize:u,u_texture:0}}function dn(t,e,i,r,n,o,a,s,l,u,c){var p=n.transform;return vt.extend(hn(t,e,i,r,n,o,a,s,l,u),{u_gamma_scale:r?Math.cos(p._pitch)*p.cameraToCenterDistance:1,u_device_pixel_ratio:vt.browser.devicePixelRatio,u_is_halo:+c})}var fn,mn={fillExtrusion:function(t,e){return{u_matrix:new vt.UniformMatrix4f(t,e.u_matrix),u_lightpos:new vt.Uniform3f(t,e.u_lightpos),u_lightintensity:new vt.Uniform1f(t,e.u_lightintensity),u_lightcolor:new vt.Uniform3f(t,e.u_lightcolor),u_vertical_gradient:new vt.Uniform1f(t,e.u_vertical_gradient),u_opacity:new vt.Uniform1f(t,e.u_opacity)}},fillExtrusionPattern:function(t,e){return{u_matrix:new vt.UniformMatrix4f(t,e.u_matrix),u_lightpos:new vt.Uniform3f(t,e.u_lightpos),u_lightintensity:new vt.Uniform1f(t,e.u_lightintensity),u_lightcolor:new vt.Uniform3f(t,e.u_lightcolor),u_vertical_gradient:new vt.Uniform1f(t,e.u_vertical_gradient),u_height_factor:new vt.Uniform1f(t,e.u_height_factor),u_image:new vt.Uniform1i(t,e.u_image),u_texsize:new vt.Uniform2f(t,e.u_texsize),u_pixel_coord_upper:new vt.Uniform2f(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new vt.Uniform2f(t,e.u_pixel_coord_lower),u_scale:new vt.Uniform3f(t,e.u_scale),u_fade:new vt.Uniform1f(t,e.u_fade),u_opacity:new vt.Uniform1f(t,e.u_opacity)}},fill:function(t,e){return{u_matrix:new vt.UniformMatrix4f(t,e.u_matrix)}},fillPattern:function(t,e){return{u_matrix:new vt.UniformMatrix4f(t,e.u_matrix),u_image:new vt.Uniform1i(t,e.u_image),u_texsize:new vt.Uniform2f(t,e.u_texsize),u_pixel_coord_upper:new vt.Uniform2f(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new vt.Uniform2f(t,e.u_pixel_coord_lower),u_scale:new vt.Uniform3f(t,e.u_scale),u_fade:new vt.Uniform1f(t,e.u_fade)}},fillOutline:function(t,e){return{u_matrix:new vt.UniformMatrix4f(t,e.u_matrix),u_world:new vt.Uniform2f(t,e.u_world)}},fillOutlinePattern:function(t,e){return{u_matrix:new vt.UniformMatrix4f(t,e.u_matrix),u_world:new vt.Uniform2f(t,e.u_world),u_image:new vt.Uniform1i(t,e.u_image),u_texsize:new vt.Uniform2f(t,e.u_texsize),u_pixel_coord_upper:new vt.Uniform2f(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new vt.Uniform2f(t,e.u_pixel_coord_lower),u_scale:new vt.Uniform3f(t,e.u_scale),u_fade:new vt.Uniform1f(t,e.u_fade)}},circle:function(t,e){return{u_camera_to_center_distance:new vt.Uniform1f(t,e.u_camera_to_center_distance),u_scale_with_map:new vt.Uniform1i(t,e.u_scale_with_map),u_pitch_with_map:new vt.Uniform1i(t,e.u_pitch_with_map),u_extrude_scale:new vt.Uniform2f(t,e.u_extrude_scale),u_device_pixel_ratio:new vt.Uniform1f(t,e.u_device_pixel_ratio),u_matrix:new vt.UniformMatrix4f(t,e.u_matrix)}},collisionBox:function(t,e){return{u_matrix:new vt.UniformMatrix4f(t,e.u_matrix),u_camera_to_center_distance:new vt.Uniform1f(t,e.u_camera_to_center_distance),u_pixels_to_tile_units:new vt.Uniform1f(t,e.u_pixels_to_tile_units),u_extrude_scale:new vt.Uniform2f(t,e.u_extrude_scale),u_overscale_factor:new vt.Uniform1f(t,e.u_overscale_factor)}},collisionCircle:function(t,e){return{u_matrix:new vt.UniformMatrix4f(t,e.u_matrix),u_inv_matrix:new vt.UniformMatrix4f(t,e.u_inv_matrix),u_camera_to_center_distance:new vt.Uniform1f(t,e.u_camera_to_center_distance),u_viewport_size:new vt.Uniform2f(t,e.u_viewport_size)}},debug:function(t,e){return{u_color:new vt.UniformColor(t,e.u_color),u_matrix:new vt.UniformMatrix4f(t,e.u_matrix),u_overlay:new vt.Uniform1i(t,e.u_overlay),u_overlay_scale:new vt.Uniform1f(t,e.u_overlay_scale)}},clippingMask:function(t,e){return{u_matrix:new vt.UniformMatrix4f(t,e.u_matrix)}},heatmap:function(t,e){return{u_extrude_scale:new vt.Uniform1f(t,e.u_extrude_scale),u_intensity:new vt.Uniform1f(t,e.u_intensity),u_matrix:new vt.UniformMatrix4f(t,e.u_matrix)}},heatmapTexture:function(t,e){return{u_matrix:new vt.UniformMatrix4f(t,e.u_matrix),u_world:new vt.Uniform2f(t,e.u_world),u_image:new vt.Uniform1i(t,e.u_image),u_color_ramp:new vt.Uniform1i(t,e.u_color_ramp),u_opacity:new vt.Uniform1f(t,e.u_opacity)}},hillshade:function(t,e){return{u_matrix:new vt.UniformMatrix4f(t,e.u_matrix),u_image:new vt.Uniform1i(t,e.u_image),u_latrange:new vt.Uniform2f(t,e.u_latrange),u_light:new vt.Uniform2f(t,e.u_light),u_shadow:new vt.UniformColor(t,e.u_shadow),u_highlight:new vt.UniformColor(t,e.u_highlight),u_accent:new vt.UniformColor(t,e.u_accent)}},hillshadePrepare:function(t,e){return{u_matrix:new vt.UniformMatrix4f(t,e.u_matrix),u_image:new vt.Uniform1i(t,e.u_image),u_dimension:new vt.Uniform2f(t,e.u_dimension),u_zoom:new vt.Uniform1f(t,e.u_zoom),u_maxzoom:new vt.Uniform1f(t,e.u_maxzoom),u_unpack:new vt.Uniform4f(t,e.u_unpack)}},line:function(t,e){return{u_matrix:new vt.UniformMatrix4f(t,e.u_matrix),u_ratio:new vt.Uniform1f(t,e.u_ratio),u_device_pixel_ratio:new vt.Uniform1f(t,e.u_device_pixel_ratio),u_units_to_pixels:new vt.Uniform2f(t,e.u_units_to_pixels)}},lineGradient:function(t,e){return{u_matrix:new vt.UniformMatrix4f(t,e.u_matrix),u_ratio:new vt.Uniform1f(t,e.u_ratio),u_device_pixel_ratio:new vt.Uniform1f(t,e.u_device_pixel_ratio),u_units_to_pixels:new vt.Uniform2f(t,e.u_units_to_pixels),u_image:new vt.Uniform1i(t,e.u_image)}},linePattern:function(t,e){return{u_matrix:new vt.UniformMatrix4f(t,e.u_matrix),u_texsize:new vt.Uniform2f(t,e.u_texsize),u_ratio:new vt.Uniform1f(t,e.u_ratio),u_device_pixel_ratio:new vt.Uniform1f(t,e.u_device_pixel_ratio),u_image:new vt.Uniform1i(t,e.u_image),u_units_to_pixels:new vt.Uniform2f(t,e.u_units_to_pixels),u_scale:new vt.Uniform3f(t,e.u_scale),u_fade:new vt.Uniform1f(t,e.u_fade)}},lineSDF:function(t,e){return{u_matrix:new vt.UniformMatrix4f(t,e.u_matrix),u_ratio:new vt.Uniform1f(t,e.u_ratio),u_device_pixel_ratio:new vt.Uniform1f(t,e.u_device_pixel_ratio),u_units_to_pixels:new vt.Uniform2f(t,e.u_units_to_pixels),u_patternscale_a:new vt.Uniform2f(t,e.u_patternscale_a),u_patternscale_b:new vt.Uniform2f(t,e.u_patternscale_b),u_sdfgamma:new vt.Uniform1f(t,e.u_sdfgamma),u_image:new vt.Uniform1i(t,e.u_image),u_tex_y_a:new vt.Uniform1f(t,e.u_tex_y_a),u_tex_y_b:new vt.Uniform1f(t,e.u_tex_y_b),u_mix:new vt.Uniform1f(t,e.u_mix)}},raster:function(t,e){return{u_matrix:new vt.UniformMatrix4f(t,e.u_matrix),u_tl_parent:new vt.Uniform2f(t,e.u_tl_parent),u_scale_parent:new vt.Uniform1f(t,e.u_scale_parent),u_buffer_scale:new vt.Uniform1f(t,e.u_buffer_scale),u_fade_t:new vt.Uniform1f(t,e.u_fade_t),u_opacity:new vt.Uniform1f(t,e.u_opacity),u_image0:new vt.Uniform1i(t,e.u_image0),u_image1:new vt.Uniform1i(t,e.u_image1),u_brightness_low:new vt.Uniform1f(t,e.u_brightness_low),u_brightness_high:new vt.Uniform1f(t,e.u_brightness_high),u_saturation_factor:new vt.Uniform1f(t,e.u_saturation_factor),u_contrast_factor:new vt.Uniform1f(t,e.u_contrast_factor),u_spin_weights:new vt.Uniform3f(t,e.u_spin_weights)}},symbolIcon:function(t,e){return{u_is_size_zoom_constant:new vt.Uniform1i(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new vt.Uniform1i(t,e.u_is_size_feature_constant),u_size_t:new vt.Uniform1f(t,e.u_size_t),u_size:new vt.Uniform1f(t,e.u_size),u_camera_to_center_distance:new vt.Uniform1f(t,e.u_camera_to_center_distance),u_pitch:new vt.Uniform1f(t,e.u_pitch),u_rotate_symbol:new vt.Uniform1i(t,e.u_rotate_symbol),u_aspect_ratio:new vt.Uniform1f(t,e.u_aspect_ratio),u_fade_change:new vt.Uniform1f(t,e.u_fade_change),u_matrix:new vt.UniformMatrix4f(t,e.u_matrix),u_label_plane_matrix:new vt.UniformMatrix4f(t,e.u_label_plane_matrix),u_coord_matrix:new vt.UniformMatrix4f(t,e.u_coord_matrix),u_is_text:new vt.Uniform1i(t,e.u_is_text),u_pitch_with_map:new vt.Uniform1i(t,e.u_pitch_with_map),u_texsize:new vt.Uniform2f(t,e.u_texsize),u_texture:new vt.Uniform1i(t,e.u_texture)}},symbolSDF:function(t,e){return{u_is_size_zoom_constant:new vt.Uniform1i(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new vt.Uniform1i(t,e.u_is_size_feature_constant),u_size_t:new vt.Uniform1f(t,e.u_size_t),u_size:new vt.Uniform1f(t,e.u_size),u_camera_to_center_distance:new vt.Uniform1f(t,e.u_camera_to_center_distance),u_pitch:new vt.Uniform1f(t,e.u_pitch),u_rotate_symbol:new vt.Uniform1i(t,e.u_rotate_symbol),u_aspect_ratio:new vt.Uniform1f(t,e.u_aspect_ratio),u_fade_change:new vt.Uniform1f(t,e.u_fade_change),u_matrix:new vt.UniformMatrix4f(t,e.u_matrix),u_label_plane_matrix:new vt.UniformMatrix4f(t,e.u_label_plane_matrix),u_coord_matrix:new vt.UniformMatrix4f(t,e.u_coord_matrix),u_is_text:new vt.Uniform1i(t,e.u_is_text),u_pitch_with_map:new vt.Uniform1i(t,e.u_pitch_with_map),u_texsize:new vt.Uniform2f(t,e.u_texsize),u_texture:new vt.Uniform1i(t,e.u_texture),u_gamma_scale:new vt.Uniform1f(t,e.u_gamma_scale),u_device_pixel_ratio:new vt.Uniform1f(t,e.u_device_pixel_ratio),u_is_halo:new vt.Uniform1i(t,e.u_is_halo)}},symbolTextAndIcon:function(t,e){return{u_is_size_zoom_constant:new vt.Uniform1i(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new vt.Uniform1i(t,e.u_is_size_feature_constant),u_size_t:new vt.Uniform1f(t,e.u_size_t),u_size:new vt.Uniform1f(t,e.u_size),u_camera_to_center_distance:new vt.Uniform1f(t,e.u_camera_to_center_distance),u_pitch:new vt.Uniform1f(t,e.u_pitch),u_rotate_symbol:new vt.Uniform1i(t,e.u_rotate_symbol),u_aspect_ratio:new vt.Uniform1f(t,e.u_aspect_ratio),u_fade_change:new vt.Uniform1f(t,e.u_fade_change),u_matrix:new vt.UniformMatrix4f(t,e.u_matrix),u_label_plane_matrix:new vt.UniformMatrix4f(t,e.u_label_plane_matrix),u_coord_matrix:new vt.UniformMatrix4f(t,e.u_coord_matrix),u_is_text:new vt.Uniform1i(t,e.u_is_text),u_pitch_with_map:new vt.Uniform1i(t,e.u_pitch_with_map),u_texsize:new vt.Uniform2f(t,e.u_texsize),u_texsize_icon:new vt.Uniform2f(t,e.u_texsize_icon),u_texture:new vt.Uniform1i(t,e.u_texture),u_texture_icon:new vt.Uniform1i(t,e.u_texture_icon),u_gamma_scale:new vt.Uniform1f(t,e.u_gamma_scale),u_device_pixel_ratio:new vt.Uniform1f(t,e.u_device_pixel_ratio),u_is_halo:new vt.Uniform1i(t,e.u_is_halo)}},background:function(t,e){return{u_matrix:new vt.UniformMatrix4f(t,e.u_matrix),u_opacity:new vt.Uniform1f(t,e.u_opacity),u_color:new vt.UniformColor(t,e.u_color)}},backgroundPattern:function(t,e){return{u_matrix:new vt.UniformMatrix4f(t,e.u_matrix),u_opacity:new vt.Uniform1f(t,e.u_opacity),u_image:new vt.Uniform1i(t,e.u_image),u_pattern_tl_a:new vt.Uniform2f(t,e.u_pattern_tl_a),u_pattern_br_a:new vt.Uniform2f(t,e.u_pattern_br_a),u_pattern_tl_b:new vt.Uniform2f(t,e.u_pattern_tl_b),u_pattern_br_b:new vt.Uniform2f(t,e.u_pattern_br_b),u_texsize:new vt.Uniform2f(t,e.u_texsize),u_mix:new vt.Uniform1f(t,e.u_mix),u_pattern_size_a:new vt.Uniform2f(t,e.u_pattern_size_a),u_pattern_size_b:new vt.Uniform2f(t,e.u_pattern_size_b),u_scale_a:new vt.Uniform1f(t,e.u_scale_a),u_scale_b:new vt.Uniform1f(t,e.u_scale_b),u_pixel_coord_upper:new vt.Uniform2f(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new vt.Uniform2f(t,e.u_pixel_coord_lower),u_tile_units_to_pixels:new vt.Uniform1f(t,e.u_tile_units_to_pixels)}}};function gn(t,e,i,r,n,o,a){for(var s=t.context,l=s.gl,u=t.useProgram("collisionBox"),c=[],p=0,h=0,d=0;d<r.length;d++){var f=r[d],m=e.getTile(f),g=m.getBucket(i);if(g){var y=f.posMatrix;0===n[0]&&0===n[1]||(y=t.translatePosMatrix(f.posMatrix,m,n,o));var v=a?g.textCollisionBox:g.iconCollisionBox,_=g.collisionCircleArray;if(0<_.length){var x=vt.create(),b=y;vt.mul(x,g.placementInvProjMatrix,t.transform.glCoordMatrix),vt.mul(x,x,g.placementViewportMatrix),c.push({circleArray:_,circleOffset:h,transform:b,invTransform:x}),h=p+=_.length/4}v&&u.draw(s,l.LINES,ei.disabled,ii.disabled,t.colorModeForRenderPass(),ni.disabled,(w=y,S=t.transform,I=qi(T=m,1,S.zoom),E=Math.pow(2,S.zoom-T.tileID.overscaledZ),C=T.tileID.overscaleFactor(),{u_matrix:w,u_camera_to_center_distance:S.cameraToCenterDistance,u_pixels_to_tile_units:I,u_extrude_scale:[S.pixelsToGLUnits[0]/(I*E),S.pixelsToGLUnits[1]/(I*E)],u_overscale_factor:C}),i.id,v.layoutVertexBuffer,v.indexBuffer,v.segments,null,t.transform.zoom,null,null,v.collisionVertexBuffer)}}var w,S,T,I,E,C,A,k,P;if(a&&c.length){var M=t.useProgram("collisionCircle"),L=new vt.StructArrayLayout2f1f2i16;L.resize(4*p),L._trim();for(var D=0,z=0,O=c;z<O.length;z+=1)for(var R=O[z],N=0;N<R.circleArray.length/4;N++){var B=4*N,F=R.circleArray[0+B],U=R.circleArray[1+B],j=R.circleArray[2+B],q=R.circleArray[3+B];L.emplace(D++,F,U,j,q,0),L.emplace(D++,F,U,j,q,1),L.emplace(D++,F,U,j,q,2),L.emplace(D++,F,U,j,q,3)}(!fn||fn.length<2*p)&&(fn=function(){var t=2*p,e=new vt.StructArrayLayout3ui6;e.resize(t),e._trim();for(var i=0;i<t;i++){var r=6*i;e.uint16[0+r]=4*i+0,e.uint16[1+r]=4*i+1,e.uint16[2+r]=4*i+2,e.uint16[3+r]=4*i+2,e.uint16[4+r]=4*i+3,e.uint16[5+r]=4*i+0}return e}());for(var V=s.createIndexBuffer(fn,!0),G=s.createVertexBuffer(L,vt.collisionCircleLayout.members,!0),Z=0,H=c;Z<H.length;Z+=1){var W=H[Z],K=(A=W.transform,k=W.invTransform,P=t.transform,{u_matrix:A,u_inv_matrix:k,u_camera_to_center_distance:P.cameraToCenterDistance,u_viewport_size:[P.width,P.height]});M.draw(s,l.TRIANGLES,ei.disabled,ii.disabled,t.colorModeForRenderPass(),ni.disabled,K,i.id,G,V,vt.SegmentVector.simpleSegment(0,2*W.circleOffset,W.circleArray.length,W.circleArray.length/2),null,t.transform.zoom,null,null,null)}G.destroy(),V.destroy()}}var yn=vt.identity(new Float32Array(16));function vn(t,e,i,r,n,o,a,s,l,u,c){var p,h,d,f,m,g,y,v,_,x,b=t.text.placedSymbolArray,w=t.text.dynamicLayoutVertexArray,S=t.icon.dynamicLayoutVertexArray,T={};w.clear();for(var I=0;I<b.length;I++){var E=b.get(I),C=E.hidden||!E.crossTileID||t.allowVerticalPlacement&&!E.placedOrientation?null:r[E.crossTileID];if(C){var A=new vt.Point(E.anchorX,E.anchorY),k=Pi(A,i?s:a),P=Mi(o.cameraToCenterDistance,k.signedDistanceFromCamera),M=n.evaluateSizeForFeature(t.textSizeData,u,E)*P/vt.ONE_EM;i&&(M*=t.tilePixelRatio/l);for(var L=(p=C.anchor,h=C.width,d=C.height,f=C.textOffset,m=C.textBoxScale,g=M,y=vt.getAnchorAlignment(p),v=-(y.horizontalAlign-.5)*h,_=-(y.verticalAlign-.5)*d,x=vt.evaluateVariableOffset(p,f),new vt.Point((v/m+x[0])*g,(_/m+x[1])*g)),D=i?Pi(A.add(L),a).point:k.point.add(e?L.rotate(-o.angle):L),z=t.allowVerticalPlacement&&E.placedOrientation===vt.WritingMode.vertical?Math.PI/2:0,O=0;O<E.numGlyphs;O++)vt.addDynamicAttributes(w,D,z);c&&0<=E.associatedIconIndex&&(T[E.associatedIconIndex]={shiftedAnchor:D,angle:z})}else Fi(E.numGlyphs,w)}if(c){S.clear();for(var R=t.icon.placedSymbolArray,N=0;N<R.length;N++){var B=R.get(N);if(B.hidden)Fi(B.numGlyphs,S);else{var F=T[N];if(F)for(var U=0;U<B.numGlyphs;U++)vt.addDynamicAttributes(S,F.shiftedAnchor,F.angle);else Fi(B.numGlyphs,S)}}t.icon.dynamicLayoutVertexBuffer.updateData(S)}t.text.dynamicLayoutVertexBuffer.updateData(w)}function _n(t,e,i,r,n,o,a,s,l,u,c,p){for(var h=t.context,d=h.gl,f=t.transform,m="map"===s,g="map"===l,y=m&&"point"!==i.layout.get("symbol-placement"),v=m&&!g&&!y,_=void 0!==i.layout.get("symbol-sort-key").constantOr(1),x=t.depthModeForSublayer(0,ei.ReadOnly),b=i.layout.get("text-variable-anchor"),w=[],S=0,T=r;S<T.length;S+=1){var I=T[S],E=e.getTile(I),C=E.getBucket(i);if(C){var A=n?C.text:C.icon;if(A&&A.segments.get().length){var k=A.programConfigurations.get(i.id),P=n||C.sdfIcons,M=n?C.textSizeData:C.iconSizeData,L=g||0!==f.pitch,D=t.useProgram((pt=P,ht=n,C.iconsInText&&ht?"symbolTextAndIcon":pt?"symbolSDF":"symbolIcon"),k),z=vt.evaluateSizeForZoom(M,f.zoom),O=void 0,R=[0,0],N=void 0,B=void 0,F=null,U=void 0;if(n)N=E.glyphAtlasTexture,B=d.LINEAR,O=E.glyphAtlasTexture.size,C.iconsInText&&(R=E.imageAtlasTexture.size,F=E.imageAtlasTexture,U=L||t.options.rotating||t.options.zooming||"composite"===M.kind||"camera"===M.kind?d.LINEAR:d.NEAREST);else{var j=1!==i.layout.get("icon-size").constantOr(0)||C.iconsNeedLinear;N=E.imageAtlasTexture,B=P||t.options.rotating||t.options.zooming||j||L?d.LINEAR:d.NEAREST,O=E.imageAtlasTexture.size}var q=qi(E,1,t.transform.zoom),V=Ai(I.posMatrix,g,m,t.transform,q),G=ki(I.posMatrix,g,m,t.transform,q),Z=b&&C.hasTextData(),H="none"!==i.layout.get("icon-text-fit")&&Z&&C.hasIconData();y&&Li(C,I.posMatrix,t,n,V,G,g,u);var W=t.translatePosMatrix(I.posMatrix,E,o,a),K=y||n&&b||H?yn:V,X=t.translatePosMatrix(G,E,o,a,!0),Y=P&&0!==i.paint.get(n?"text-halo-width":"icon-halo-width").constantOr(1),J={program:D,buffers:A,uniformValues:P?C.iconsInText?(et=M.kind,it=z,rt=v,nt=g,ot=t,at=W,st=K,lt=X,ut=O,ct=R,vt.extend(dn(et,it,rt,nt,ot,at,st,lt,!0,ut,!0),{u_texsize_icon:ct,u_texture_icon:1})):dn(M.kind,z,v,g,t,W,K,X,n,O,!0):hn(M.kind,z,v,g,t,W,K,X,n,O),atlasTexture:N,atlasTextureIcon:F,atlasInterpolation:B,atlasInterpolationIcon:U,isSDF:P,hasHalo:Y};if(_)for(var Q=0,$=A.segments.get();Q<$.length;Q+=1){var tt=$[Q];w.push({segments:new vt.SegmentVector([tt]),sortKey:tt.sortKey,state:J})}else w.push({segments:A.segments,sortKey:0,state:J})}}}var et,it,rt,nt,ot,at,st,lt,ut,ct,pt,ht;_&&w.sort(function(t,e){return t.sortKey-e.sortKey});for(var dt=0,ft=w;dt<ft.length;dt+=1){var mt=ft[dt],gt=mt.state;if(h.activeTexture.set(d.TEXTURE0),gt.atlasTexture.bind(gt.atlasInterpolation,d.CLAMP_TO_EDGE),gt.atlasTextureIcon&&(h.activeTexture.set(d.TEXTURE1),gt.atlasTextureIcon&&gt.atlasTextureIcon.bind(gt.atlasInterpolationIcon,d.CLAMP_TO_EDGE)),gt.isSDF){var yt=gt.uniformValues;gt.hasHalo&&(yt.u_is_halo=1,xn(gt.buffers,mt.segments,i,t,gt.program,x,c,p,yt)),yt.u_is_halo=0}xn(gt.buffers,mt.segments,i,t,gt.program,x,c,p,gt.uniformValues)}}function xn(t,e,i,r,n,o,a,s,l){var u=r.context;n.draw(u,u.gl.TRIANGLES,o,a,s,ni.disabled,l,i.id,t.layoutVertexBuffer,t.indexBuffer,e,i.paint,r.transform.zoom,t.programConfigurations.get(i.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function bn(t,e,i,r,n,o,a){var s,l,u,c,p,h,d,f,m,g,y=t.context.gl,v=i.paint.get("fill-pattern"),_=v&&v.constantOr(1),x=i.getCrossfadeParameters();s=a?(l=_&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",y.LINES):(l=_?"fillPattern":"fill",y.TRIANGLES);for(var b=0,w=r;b<w.length;b+=1){var S=w[b],T=e.getTile(S);if(!_||T.patternsLoaded()){var I=T.getBucket(i);if(I){var E=I.programConfigurations.get(i.id),C=t.useProgram(l,E);_&&(t.context.activeTexture.set(y.TEXTURE0),T.imageAtlasTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),E.updatePaintBuffers(x));var A=v.constantOr(null);if(A&&T.imageAtlas){var k=T.imageAtlas,P=k.patternPositions[A.to.toString()],M=k.patternPositions[A.from.toString()];P&&M&&E.setConstantPatternPositions(P,M)}var L=t.translatePosMatrix(S.posMatrix,T,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(a){c=I.indexBuffer2,p=I.segments2;var D=[y.drawingBufferWidth,y.drawingBufferHeight];u="fillOutlinePattern"===l&&_?(h=L,d=t,f=x,m=T,g=D,vt.extend(nn(h,d,f,m),{u_world:g})):{u_matrix:L,u_world:D}}else c=I.indexBuffer,p=I.segments,u=_?nn(L,t,x,T):rn(L);C.draw(t.context,s,n,t.stencilModeForClipping(S),o,ni.disabled,u,i.id,I.layoutVertexBuffer,c,p,i.paint,t.transform.zoom,E)}}}}function wn(t,e,i,r,n,o,a){for(var s=t.context,l=s.gl,u=i.paint.get("fill-extrusion-pattern"),c=u.constantOr(1),p=i.getCrossfadeParameters(),h=i.paint.get("fill-extrusion-opacity"),d=0,f=r;d<f.length;d+=1){var m=f[d],g=e.getTile(m),y=g.getBucket(i);if(y){var v=y.programConfigurations.get(i.id),_=t.useProgram(c?"fillExtrusionPattern":"fillExtrusion",v);c&&(t.context.activeTexture.set(l.TEXTURE0),g.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),v.updatePaintBuffers(p));var x=u.constantOr(null);if(x&&g.imageAtlas){var b=g.imageAtlas,w=b.patternPositions[x.to.toString()],S=b.patternPositions[x.from.toString()];w&&S&&v.setConstantPatternPositions(w,S)}var T=t.translatePosMatrix(m.posMatrix,g,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),I=i.paint.get("fill-extrusion-vertical-gradient"),E=c?(C=T,A=t,k=I,P=h,M=m,L=p,D=g,vt.extend(en(C,A,k,P),tn(L,A,D),{u_height_factor:-Math.pow(2,M.overscaledZ)/D.tileSize/8})):en(T,t,I,h);_.draw(s,s.gl.TRIANGLES,n,o,a,ni.backCCW,E,i.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,i.paint,t.transform.zoom,v)}}var C,A,k,P,M,L,D}function Sn(t,e,i,r,n,o){var a=t.context,s=a.gl,l=e.fbo;if(l){var u=t.useProgram("hillshade");a.activeTexture.set(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,l.colorAttachment.get());var c=function(t,e,i){var r=i.paint.get("hillshade-shadow-color"),n=i.paint.get("hillshade-highlight-color"),o=i.paint.get("hillshade-accent-color"),a=i.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===i.paint.get("hillshade-illumination-anchor")&&(a-=t.transform.angle);var s,l,u,c=!t.options.moving;return{u_matrix:t.transform.calculatePosMatrix(e.tileID.toUnwrapped(),c),u_image:0,u_latrange:(s=e.tileID,l=Math.pow(2,s.canonical.z),u=s.canonical.y,[new vt.MercatorCoordinate(0,u/l).toLngLat().lat,new vt.MercatorCoordinate(0,(u+1)/l).toLngLat().lat]),u_light:[i.paint.get("hillshade-exaggeration"),a],u_shadow:r,u_highlight:n,u_accent:o}}(t,e,i);u.draw(a,s.TRIANGLES,r,n,o,ni.disabled,c,i.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}}function Tn(t,e,i,r,n,o,a){var s,l,u,c,p,h=t.context,d=h.gl,f=e.dem;if(f&&f.data){var m=f.dim,g=f.stride,y=f.getPixels();if(h.activeTexture.set(d.TEXTURE1),h.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||t.getTileTexture(g),e.demTexture){var v=e.demTexture;v.update(y,{premultiply:!1}),v.bind(d.NEAREST,d.CLAMP_TO_EDGE)}else e.demTexture=new vt.Texture(h,y,d.RGBA,{premultiply:!1}),e.demTexture.bind(d.NEAREST,d.CLAMP_TO_EDGE);h.activeTexture.set(d.TEXTURE0);var _=e.fbo;if(!_){var x=new vt.Texture(h,{width:m,height:m,data:null},d.RGBA);x.bind(d.LINEAR,d.CLAMP_TO_EDGE),(_=e.fbo=h.createFramebuffer(m,m,!0)).colorAttachment.set(x.texture)}h.bindFramebuffer.set(_.framebuffer),h.viewport.set([0,0,m,m]),t.useProgram("hillshadePrepare").draw(h,d.TRIANGLES,n,o,a,ni.disabled,(s=e.tileID,u=r,c=(l=f).stride,p=vt.create(),vt.ortho(p,0,vt.EXTENT,-vt.EXTENT,0,0,1),vt.translate(p,p,[0,-vt.EXTENT,0]),{u_matrix:p,u_image:1,u_dimension:[c,c],u_zoom:s.overscaledZ,u_maxzoom:u,u_unpack:l.getUnpackVector()}),i.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments),e.needsHillshadePrepare=!1}}function In(t,e,i,r,n){var o=r.paint.get("raster-fade-duration");if(0<o){var a=vt.browser.now(),s=(a-t.timeAdded)/o,l=e?(a-e.timeAdded)/o:-1,u=i.getSource(),c=n.coveringZoomLevel({tileSize:u.tileSize,roundZoom:u.roundZoom}),p=!e||Math.abs(e.tileID.overscaledZ-c)>Math.abs(t.tileID.overscaledZ-c),h=p&&t.refreshedUponExpiration?1:vt.clamp(p?s:1-l,0,1);return t.refreshedUponExpiration&&1<=s&&(t.refreshedUponExpiration=!1),e?{opacity:1,mix:1-h}:{opacity:h,mix:0}}return{opacity:1,mix:0}}var En=new vt.Color(1,0,0,1),Cn=new vt.Color(0,1,0,1),An=new vt.Color(0,0,1,1),kn=new vt.Color(1,0,1,1),Pn=new vt.Color(0,1,1,1);function Mn(t,e,i,r){Dn(t,0,e+i/2,t.transform.width,i,r)}function Ln(t,e,i,r){Dn(t,e-i/2,0,i,t.transform.height,r)}function Dn(t,e,i,r,n,o){var a=t.context,s=a.gl;s.enable(s.SCISSOR_TEST),s.scissor(e*vt.browser.devicePixelRatio,i*vt.browser.devicePixelRatio,r*vt.browser.devicePixelRatio,n*vt.browser.devicePixelRatio),a.clear({color:o}),s.disable(s.SCISSOR_TEST)}function zn(t,e,i){var r=t.context,n=r.gl,o=i.posMatrix,a=t.useProgram("debug"),s=ei.disabled,l=ii.disabled,u=t.colorModeForRenderPass();r.activeTexture.set(n.TEXTURE0),t.emptyTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE),a.draw(r,n.LINE_STRIP,s,l,u,ni.disabled,ln(o,vt.Color.red),"$debug",t.debugBuffer,t.tileBorderIndexBuffer,t.debugSegments);var c=e.getTileByID(i.key).latestRawTileData,p=Math.floor((c&&c.byteLength||0)/1024),h=e.getTile(i).tileSize,d=512/Math.min(h,512)*(i.overscaledZ/t.transform.zoom)*.5,f=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(f+=" => "+i.overscaledZ),function(t,e){t.initDebugOverlayCanvas();var i=t.debugOverlayCanvas,r=t.context.gl,n=t.debugOverlayCanvas.getContext("2d");n.clearRect(0,0,i.width,i.height),n.shadowColor="white",n.shadowBlur=2,n.lineWidth=1.5,n.strokeStyle="white",n.textBaseline="top",n.font="bold 36px Open Sans, sans-serif",n.fillText(e,5,5),n.strokeText(e,5,5),t.debugOverlayTexture.update(i),t.debugOverlayTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}(t,f+" "+p+"kb"),a.draw(r,n.TRIANGLES,s,l,ri.alphaBlended,ni.disabled,ln(o,vt.Color.transparent,d),"$debug",t.debugBuffer,t.quadTriangleIndexBuffer,t.debugSegments)}function On(t,e){this.context=new oi(t),this.transform=e,this._tileTextures={},this.setup(),this.numSublayers=si.maxUnderzooming+si.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new fr,this.gpuTimers={}}var Rn={symbol:function(t,e,i,r,n){if("translucent"===t.renderPass){var o=ii.disabled,a=t.colorModeForRenderPass();i.layout.get("text-variable-anchor")&&function(t,e,i,r,n,o,a){for(var s=e.transform,l="map"===n,u="map"===o,c=0,p=t;c<p.length;c+=1){var h=p[c],d=r.getTile(h),f=d.getBucket(i);if(f&&f.text&&f.text.segments.get().length){var m=vt.evaluateSizeForZoom(f.textSizeData,s.zoom),g=qi(d,1,e.transform.zoom),y=Ai(h.posMatrix,u,l,e.transform,g),v="none"!==i.layout.get("icon-text-fit")&&f.hasIconData();if(m){var _=Math.pow(2,s.zoom-d.tileID.overscaledZ);vn(f,l,u,a,vt.symbolSize,s,y,h.posMatrix,_,m,v)}}}}(r,t,i,e,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),n),0!==i.paint.get("icon-opacity").constantOr(1)&&_n(t,e,i,r,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),o,a),0!==i.paint.get("text-opacity").constantOr(1)&&_n(t,e,i,r,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),o,a),e.map.showCollisionBoxes&&(gn(t,e,i,r,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),gn(t,e,i,r,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))}},circle:function(t,e,i,r){if("translucent"===t.renderPass){var n=i.paint.get("circle-opacity"),o=i.paint.get("circle-stroke-width"),a=i.paint.get("circle-stroke-opacity"),s=void 0!==i.layout.get("circle-sort-key").constantOr(1);if(0!==n.constantOr(1)||0!==o.constantOr(1)&&0!==a.constantOr(1)){for(var l=t.context,u=l.gl,c=t.depthModeForSublayer(0,ei.ReadOnly),p=ii.disabled,h=t.colorModeForRenderPass(),d=[],f=0;f<r.length;f++){var m=r[f],g=e.getTile(m),y=g.getBucket(i);if(y){var v=y.programConfigurations.get(i.id),_={programConfiguration:v,program:t.useProgram("circle",v),layoutVertexBuffer:y.layoutVertexBuffer,indexBuffer:y.indexBuffer,uniformValues:on(t,m,g,i)};if(s)for(var x=0,b=y.segments.get();x<b.length;x+=1){var w=b[x];d.push({segments:new vt.SegmentVector([w]),sortKey:w.sortKey,state:_})}else d.push({segments:y.segments,sortKey:0,state:_})}}s&&d.sort(function(t,e){return t.sortKey-e.sortKey});for(var S=0,T=d;S<T.length;S+=1){var I=T[S],E=I.state;E.program.draw(l,u.TRIANGLES,c,p,h,ni.disabled,E.uniformValues,i.id,E.layoutVertexBuffer,E.indexBuffer,I.segments,i.paint,t.transform.zoom,E.programConfiguration)}}}},heatmap:function(t,e,i,r){if(0!==i.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){var n=t.context,o=n.gl,a=ii.disabled,s=new ri([o.ONE,o.ONE],vt.Color.transparent,[!0,!0,!0,!0]);!function(t,e,i){var r=t.gl;t.activeTexture.set(r.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);var n,o,a,s=i.heatmapFbo;if(s)r.bindTexture(r.TEXTURE_2D,s.colorAttachment.get()),t.bindFramebuffer.set(s.framebuffer);else{var l=r.createTexture();r.bindTexture(r.TEXTURE_2D,l),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),s=i.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4,!1),n=l,o=s,(a=t.gl).texImage2D(a.TEXTURE_2D,0,a.RGBA,e.width/4,e.height/4,0,a.RGBA,t.extRenderToTextureHalfFloat?t.extTextureHalfFloat.HALF_FLOAT_OES:a.UNSIGNED_BYTE,null),o.colorAttachment.set(n)}}(n,t,i),n.clear({color:vt.Color.transparent});for(var l=0;l<r.length;l++){var u=r[l];if(!e.hasRenderableParent(u)){var c=e.getTile(u),p=c.getBucket(i);if(p){var h=p.programConfigurations.get(i.id);t.useProgram("heatmap",h).draw(n,o.TRIANGLES,ei.disabled,a,s,ni.disabled,(d=u.posMatrix,f=c,m=t.transform.zoom,g=i.paint.get("heatmap-intensity"),{u_matrix:d,u_extrude_scale:qi(f,1,m),u_intensity:g}),i.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,i.paint,t.transform.zoom,h)}}}n.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,e){var i=t.context,r=i.gl,n=e.heatmapFbo;if(n){i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,n.colorAttachment.get()),i.activeTexture.set(r.TEXTURE1);var o=e.colorRampTexture;(o=o||(e.colorRampTexture=new vt.Texture(i,e.colorRamp,r.RGBA))).bind(r.LINEAR,r.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(i,r.TRIANGLES,ei.disabled,ii.disabled,t.colorModeForRenderPass(),ni.disabled,function(t,e){var i=vt.create();vt.ortho(i,0,t.width,t.height,0,0,1);var r=t.context.gl;return{u_matrix:i,u_world:[r.drawingBufferWidth,r.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:e.paint.get("heatmap-opacity")}}(t,e),e.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,e.paint,t.transform.zoom)}}(t,i));var d,f,m,g},line:function(t,e,i,r){if("translucent"===t.renderPass){var n=i.paint.get("line-opacity"),o=i.paint.get("line-width");if(0!==n.constantOr(1)&&0!==o.constantOr(1)){var a=t.depthModeForSublayer(0,ei.ReadOnly),s=t.colorModeForRenderPass(),l=i.paint.get("line-dasharray"),u=i.paint.get("line-pattern"),c=u.constantOr(1),p=i.paint.get("line-gradient"),h=i.getCrossfadeParameters(),d=c?"linePattern":l?"lineSDF":p?"lineGradient":"line",f=t.context,m=f.gl,g=!0;if(p){f.activeTexture.set(m.TEXTURE0);var y=i.gradientTexture;if(!i.gradient)return;(y=y||(i.gradientTexture=new vt.Texture(f,i.gradient,m.RGBA))).bind(m.LINEAR,m.CLAMP_TO_EDGE)}for(var v=0,_=r;v<_.length;v+=1){var x=_[v],b=e.getTile(x);if(!c||b.patternsLoaded()){var w=b.getBucket(i);if(w){var S=w.programConfigurations.get(i.id),T=t.context.program.get(),I=t.useProgram(d,S),E=g||I.program!==T,C=u.constantOr(null);if(C&&b.imageAtlas){var A=b.imageAtlas,k=A.patternPositions[C.to.toString()],P=A.patternPositions[C.from.toString()];k&&P&&S.setConstantPatternPositions(k,P)}var M=c?(K=b,X=i,Y=h,J=(W=t).transform,Q=un(K,J),{u_matrix:cn(W,K,X),u_texsize:K.imageAtlasTexture.size,u_ratio:1/qi(K,1,J.zoom),u_device_pixel_ratio:vt.browser.devicePixelRatio,u_image:0,u_scale:[Q,Y.fromScale,Y.toScale],u_fade:Y.t,u_units_to_pixels:[1/J.pixelsToGLUnits[0],1/J.pixelsToGLUnits[1]]}):l?(R=b,N=i,B=l,F=h,U=void 0,U=(O=t).lineAtlas,j=un(R,O.transform),q="round"===N.layout.get("line-cap"),V=U.getDash(B.from,q),G=U.getDash(B.to,q),Z=V.width*F.fromScale,H=G.width*F.toScale,vt.extend(sn(O,R,N),{u_patternscale_a:[j/Z,-V.height/2],u_patternscale_b:[j/H,-G.height/2],u_sdfgamma:U.width/(256*Math.min(Z,H)*vt.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:V.y,u_tex_y_b:G.y,u_mix:F.t})):p?(L=t,D=b,z=i,vt.extend(sn(L,D,z),{u_image:0})):sn(t,b,i);c?(f.activeTexture.set(m.TEXTURE0),b.imageAtlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE),S.updatePaintBuffers(h)):l&&(E||t.lineAtlas.dirty)&&(f.activeTexture.set(m.TEXTURE0),t.lineAtlas.bind(f)),I.draw(f,m.TRIANGLES,a,t.stencilModeForClipping(x),s,ni.disabled,M,i.id,w.layoutVertexBuffer,w.indexBuffer,w.segments,i.paint,t.transform.zoom,S),g=!1}}}}}var L,D,z,O,R,N,B,F,U,j,q,V,G,Z,H,W,K,X,Y,J,Q},fill:function(t,e,i,r){var n=i.paint.get("fill-color"),o=i.paint.get("fill-opacity");if(0!==o.constantOr(1)){var a=t.colorModeForRenderPass(),s=i.paint.get("fill-pattern"),l=t.opaquePassEnabledForLayer()&&!s.constantOr(1)&&1===n.constantOr(vt.Color.transparent).a&&1===o.constantOr(0)?"opaque":"translucent";if(t.renderPass===l){var u=t.depthModeForSublayer(1,"opaque"===t.renderPass?ei.ReadWrite:ei.ReadOnly);bn(t,e,i,r,u,a,!1)}if("translucent"===t.renderPass&&i.paint.get("fill-antialias")){var c=t.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,ei.ReadOnly);bn(t,e,i,r,c,a,!0)}}},"fill-extrusion":function(t,e,i,r){var n=i.paint.get("fill-extrusion-opacity");if(0!==n&&"translucent"===t.renderPass){var o=new ei(t.context.gl.LEQUAL,ei.ReadWrite,t.depthRangeFor3D);if(1!==n||i.paint.get("fill-extrusion-pattern").constantOr(1))wn(t,e,i,r,o,ii.disabled,ri.disabled),wn(t,e,i,r,o,t.stencilModeFor3D(),t.colorModeForRenderPass());else{var a=t.colorModeForRenderPass();wn(t,e,i,r,o,ii.disabled,a)}}},hillshade:function(t,e,i,r){if("offscreen"===t.renderPass||"translucent"===t.renderPass){for(var n=t.context,o=e.getSource().maxzoom,a=t.depthModeForSublayer(0,ei.ReadOnly),s=t.colorModeForRenderPass(),l="translucent"===t.renderPass?t.stencilConfigForOverlap(r):[{},r],u=l[0],c=0,p=l[1];c<p.length;c+=1){var h=p[c],d=e.getTile(h);d.needsHillshadePrepare&&"offscreen"===t.renderPass?Tn(t,d,i,o,a,ii.disabled,s):"translucent"===t.renderPass&&Sn(t,d,i,a,u[h.overscaledZ],s)}n.viewport.set([0,0,t.width,t.height])}},raster:function(t,e,i,r){if("translucent"===t.renderPass&&0!==i.paint.get("raster-opacity")&&r.length)for(var n=t.context,o=n.gl,a=e.getSource(),s=t.useProgram("raster"),l=t.colorModeForRenderPass(),u=a instanceof j?[{},r]:t.stencilConfigForOverlap(r),c=u[0],p=u[1],h=p[p.length-1].overscaledZ,d=!t.options.moving,f=0,m=p;f<m.length;f+=1){var g=m[f],y=t.depthModeForSublayer(g.overscaledZ-h,1===i.paint.get("raster-opacity")?ei.ReadWrite:ei.ReadOnly,o.LESS),v=e.getTile(g),_=t.transform.calculatePosMatrix(g.toUnwrapped(),d);v.registerFadeDuration(i.paint.get("raster-fade-duration"));var x=e.findLoadedParent(g,0),b=In(v,x,e,i,t.transform),w=void 0,S=void 0,T="nearest"===i.paint.get("raster-resampling")?o.NEAREST:o.LINEAR;n.activeTexture.set(o.TEXTURE0),v.texture.bind(T,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),n.activeTexture.set(o.TEXTURE1),x?(x.texture.bind(T,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),w=Math.pow(2,x.tileID.overscaledZ-v.tileID.overscaledZ),S=[v.tileID.canonical.x*w%1,v.tileID.canonical.y*w%1]):v.texture.bind(T,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST);var I=pn(_,S||[0,0],w||1,b,i);a instanceof j?s.draw(n,o.TRIANGLES,y,ii.disabled,l,ni.disabled,I,i.id,a.boundsBuffer,t.quadTriangleIndexBuffer,a.boundsSegments):s.draw(n,o.TRIANGLES,y,c[g.overscaledZ],l,ni.disabled,I,i.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}},background:function(t,e,i){var r,n,o,a,s,l,u,c,p,h,d,f,m,g,y,v,_,x,b,w=i.paint.get("background-color"),S=i.paint.get("background-opacity");if(0!==S){var T=t.context,I=T.gl,E=t.transform,C=E.tileSize,A=i.paint.get("background-pattern");if(!t.isPatternMissing(A)){var k=!A&&1===w.a&&1===S&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass===k){var P=ii.disabled,M=t.depthModeForSublayer(0,"opaque"==k?ei.ReadWrite:ei.ReadOnly),L=t.colorModeForRenderPass(),D=t.useProgram(A?"backgroundPattern":"background"),z=E.coveringTiles({tileSize:C});A&&(T.activeTexture.set(I.TEXTURE0),t.imageManager.bind(t.context));for(var O=i.getCrossfadeParameters(),R=0,N=z;R<N.length;R+=1){var B=N[R],F=t.transform.calculatePosMatrix(B.toUnwrapped()),U=A?(r=F,n=S,o=t,a=A,s={tileID:B,tileSize:C},l=O,b=x=_=v=y=g=m=f=d=h=p=c=u=void 0,vt.extend((u=a,c=l,h=s,d=(p=o).imageManager.getPattern(u.from.toString()),f=p.imageManager.getPattern(u.to.toString()),m=p.imageManager.getPixelSize(),g=m.width,y=m.height,v=Math.pow(2,h.tileID.overscaledZ),_=h.tileSize*Math.pow(2,p.transform.tileZoom)/v,x=_*(h.tileID.canonical.x+h.tileID.wrap*v),b=_*h.tileID.canonical.y,{u_image:0,u_pattern_tl_a:d.tl,u_pattern_br_a:d.br,u_pattern_tl_b:f.tl,u_pattern_br_b:f.br,u_texsize:[g,y],u_mix:c.t,u_pattern_size_a:d.displaySize,u_pattern_size_b:f.displaySize,u_scale_a:c.fromScale,u_scale_b:c.toScale,u_tile_units_to_pixels:1/qi(h,1,p.transform.tileZoom),u_pixel_coord_upper:[x>>16,b>>16],u_pixel_coord_lower:[65535&x,65535&b]}),{u_matrix:r,u_opacity:n})):{u_matrix:F,u_opacity:S,u_color:w};D.draw(T,I.TRIANGLES,M,P,L,ni.disabled,U,i.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}}}}},debug:function(t,e,i){for(var r=0;r<i.length;r++)zn(t,e,i[r])},custom:function(t,e,i){var r=t.context,n=i.implementation;if("offscreen"===t.renderPass){var o=n.prerender;o&&(t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),o.call(n,r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState())}else if("translucent"===t.renderPass){t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),r.setStencilMode(ii.disabled);var a="3d"===n.renderingMode?new ei(t.context.gl.LEQUAL,ei.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,ei.ReadOnly);r.setDepthMode(a),n.render(r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState(),r.bindFramebuffer.set(null)}}};function Nn(t,e){this.points=t,this.planes=e}function Bn(t,e){this.min=t,this.max=e,this.center=vt.scale$2([],vt.add([],this.min,this.max),.5)}function Fn(t,e,i,r){if(void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),isNaN(t)||t<0||isNaN(e)||e<0||isNaN(i)||i<0||isNaN(r)||r<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=i,this.right=r}function Un(t,e,i,r,n){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===n||n,this._minZoom=t||0,this._maxZoom=e||22,this._minPitch=null==i?0:i,this._maxPitch=null==r?60:r,this.setMaxBounds(),this.width=0,this.height=0,this._center=new vt.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Fn,this._posMatrixCache={},this._alignedPosMatrixCache={}}On.prototype.resize=function(t,e){if(this.width=t*vt.browser.devicePixelRatio,this.height=e*vt.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var i=0,r=this.style._order;i<r.length;i+=1)this.style._layers[r[i]].resize()},On.prototype.setup=function(){var t=this.context,e=new vt.StructArrayLayout2i4;e.emplaceBack(0,0),e.emplaceBack(vt.EXTENT,0),e.emplaceBack(0,vt.EXTENT),e.emplaceBack(vt.EXTENT,vt.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(e,wr.members),this.tileExtentSegments=vt.SegmentVector.simpleSegment(0,0,4,2);var i=new vt.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(vt.EXTENT,0),i.emplaceBack(0,vt.EXTENT),i.emplaceBack(vt.EXTENT,vt.EXTENT),this.debugBuffer=t.createVertexBuffer(i,wr.members),this.debugSegments=vt.SegmentVector.simpleSegment(0,0,4,5);var r=new vt.StructArrayLayout4i8;r.emplaceBack(0,0,0,0),r.emplaceBack(vt.EXTENT,0,vt.EXTENT,0),r.emplaceBack(0,vt.EXTENT,0,vt.EXTENT),r.emplaceBack(vt.EXTENT,vt.EXTENT,vt.EXTENT,vt.EXTENT),this.rasterBoundsBuffer=t.createVertexBuffer(r,U.members),this.rasterBoundsSegments=vt.SegmentVector.simpleSegment(0,0,4,2);var n=new vt.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(1,0),n.emplaceBack(0,1),n.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(n,wr.members),this.viewportSegments=vt.SegmentVector.simpleSegment(0,0,4,2);var o=new vt.StructArrayLayout1ui2;o.emplaceBack(0),o.emplaceBack(1),o.emplaceBack(3),o.emplaceBack(2),o.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(o);var a=new vt.StructArrayLayout3ui6;a.emplaceBack(0,1,2),a.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(a),this.emptyTexture=new vt.Texture(t,{width:1,height:1,data:new Uint8Array([0,0,0,0])},t.gl.RGBA);var s=this.context.gl;this.stencilClearMode=new ii({func:s.ALWAYS,mask:0},0,255,s.ZERO,s.ZERO,s.ZERO)},On.prototype.clearStencil=function(){var t=this.context,e=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var i=vt.create();vt.ortho(i,0,this.width,this.height,0,0,1),vt.scale(i,i,[e.drawingBufferWidth,e.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,e.TRIANGLES,ei.disabled,this.stencilClearMode,ri.disabled,ni.disabled,an(i),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},On.prototype._renderTileClippingMasks=function(t,e){if(this.currentStencilSource!==t.source&&t.isTileClipped()&&e&&e.length){this.currentStencilSource=t.source;var i=this.context,r=i.gl;256<this.nextStencilID+e.length&&this.clearStencil(),i.setColorMode(ri.disabled),i.setDepthMode(ei.disabled);var n=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var o=0,a=e;o<a.length;o+=1){var s=a[o],l=this._tileClippingMaskIDs[s.key]=this.nextStencilID++;n.draw(i,r.TRIANGLES,ei.disabled,new ii({func:r.ALWAYS,mask:0},l,255,r.KEEP,r.KEEP,r.REPLACE),ri.disabled,ni.disabled,an(s.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},On.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,256<this.nextStencilID+1&&this.clearStencil();var t=this.nextStencilID++,e=this.context.gl;return new ii({func:e.NOTEQUAL,mask:255},t,255,e.KEEP,e.KEEP,e.REPLACE)},On.prototype.stencilModeForClipping=function(t){var e=this.context.gl;return new ii({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)},On.prototype.stencilConfigForOverlap=function(t){var e,i=this.context.gl,r=t.sort(function(t,e){return e.overscaledZ-t.overscaledZ}),n=r[r.length-1].overscaledZ,o=r[0].overscaledZ-n+1;if(1<o){this.currentStencilSource=void 0,256<this.nextStencilID+o&&this.clearStencil();for(var a={},s=0;s<o;s++)a[s+n]=new ii({func:i.GEQUAL,mask:255},s+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=o,[a,r]}return[((e={})[n]=ii.disabled,e),r]},On.prototype.colorModeForRenderPass=function(){var t=this.context.gl;return this._showOverdrawInspector?new ri([t.CONSTANT_COLOR,t.ONE],new vt.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?ri.unblended:ri.alphaBlended},On.prototype.depthModeForSublayer=function(t,e,i){if(!this.opaquePassEnabledForLayer())return ei.disabled;var r=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new ei(i||this.context.gl.LEQUAL,e,[r,r])},On.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},On.prototype.render=function(t,e){var i=this;this.style=t,this.options=e,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(vt.browser.now()),this.imageManager.beginFrame();var r=this.style._order,n=this.style.sourceCaches;for(var o in n){var a=n[o];a.used&&a.prepare(this.context)}var s,l,u={},c={},p={};for(var h in n){var d=n[h];u[h]=d.getVisibleCoordinates(),c[h]=u[h].slice().reverse(),p[h]=d.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var f=0;f<r.length;f++)if(this.style._layers[r[f]].is3D()){this.opaquePassCutoff=f;break}this.renderPass="offscreen";for(var m=0,g=r;m<g.length;m+=1){var y=this.style._layers[g[m]];if(y.hasOffscreenPass()&&!y.isHidden(this.transform.zoom)){var v=c[y.source];"custom"!==y.type&&!v.length||this.renderLayer(this,n[y.source],y,v)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:e.showOverdrawInspector?vt.Color.black:vt.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=e.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=r.length-1;0<=this.currentLayer;this.currentLayer--){var _=this.style._layers[r[this.currentLayer]],x=n[_.source],b=u[_.source];this._renderTileClippingMasks(_,b),this.renderLayer(this,x,_,b)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<r.length;this.currentLayer++){var w=this.style._layers[r[this.currentLayer]],S=n[w.source],T=("symbol"===w.type?p:c)[w.source];this._renderTileClippingMasks(w,u[w.source]),this.renderLayer(this,S,w,T)}this.options.showTileBoundaries&&(vt.values(this.style._layers).forEach(function(t){t.source&&!t.isHidden(i.transform.zoom)&&(t.source!==(l&&l.id)&&(l=i.style.sourceCaches[t.source]),(!s||s.getSource().maxzoom<l.getSource().maxzoom)&&(s=l))}),s&&Rn.debug(this,s,s.getVisibleCoordinates())),this.options.showPadding&&function(t){var e=t.transform.padding;Mn(t,t.transform.height-(e.top||0),3,En),Mn(t,e.bottom||0,3,Cn),Ln(t,e.left||0,3,An),Ln(t,t.transform.width-(e.right||0),3,kn);var i,r,n,o,a=t.transform.centerPoint;i=t,r=a.x,n=t.transform.height-a.y,Dn(i,r-1,n-10,2,20,o=Pn),Dn(i,r-10,n-1,20,2,o)}(this),this.context.setDefault()},On.prototype.renderLayer=function(t,e,i,r){i.isHidden(this.transform.zoom)||"background"!==i.type&&"custom"!==i.type&&!r.length||(this.id=i.id,this.gpuTimingStart(i),Rn[i.type](t,e,i,r,this.style.placement.variableOffsets),this.gpuTimingEnd())},On.prototype.gpuTimingStart=function(t){if(this.options.gpuTiming){var e=this.context.extTimerQuery,i=this.gpuTimers[t.id];(i=i||(this.gpuTimers[t.id]={calls:0,cpuTime:0,query:e.createQueryEXT()})).calls++,e.beginQueryEXT(e.TIME_ELAPSED_EXT,i.query)}},On.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}},On.prototype.collectGpuTimers=function(){var t=this.gpuTimers;return this.gpuTimers={},t},On.prototype.queryGpuTimers=function(t){var e={};for(var i in t){var r=t[i],n=this.context.extTimerQuery,o=n.getQueryObjectEXT(r.query,n.QUERY_RESULT_EXT)/1e6;n.deleteQueryEXT(r.query),e[i]=o}return e},On.prototype.translatePosMatrix=function(t,e,i,r,n){if(!i[0]&&!i[1])return t;var o=n?"map"===r?this.transform.angle:0:"viewport"===r?-this.transform.angle:0;if(o){var a=Math.sin(o),s=Math.cos(o);i=[i[0]*s-i[1]*a,i[0]*a+i[1]*s]}var l=[n?i[0]:qi(e,i[0],this.transform.zoom),n?i[1]:qi(e,i[1],this.transform.zoom),0],u=new Float32Array(16);return vt.translate(u,t,l),u},On.prototype.saveTileTexture=function(t){var e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]},On.prototype.getTileTexture=function(t){var e=this._tileTextures[t];return e&&0<e.length?e.pop():null},On.prototype.isPatternMissing=function(t){if(!t)return!1;if(!t.from||!t.to)return!0;var e=this.imageManager.getPattern(t.from.toString()),i=this.imageManager.getPattern(t.to.toString());return!e||!i},On.prototype.useProgram=function(t,e){this.cache=this.cache||{};var i=""+t+(e?e.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[i]||(this.cache[i]=new $r(this.context,0,Jr[t],e,mn[t],this._showOverdrawInspector)),this.cache[i]},On.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},On.prototype.setBaseState=function(){var t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)},On.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=vt.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new vt.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},On.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()},Nn.fromInvProjectionMatrix=function(e,i,t){var r=Math.pow(2,t),o=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(t){return vt.transformMat4([],t,e)}).map(function(t){return vt.scale$1([],t,1/t[3]/i*r)}),n=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(t){var e=vt.sub([],o[t[0]],o[t[1]]),i=vt.sub([],o[t[2]],o[t[1]]),r=vt.normalize([],vt.cross([],e,i)),n=-vt.dot(r,o[t[1]]);return r.concat(n)});return new Nn(o,n)},Bn.prototype.quadrant=function(t){for(var e=[t%2==0,t<2],i=vt.clone$2(this.min),r=vt.clone$2(this.max),n=0;n<e.length;n++)i[n]=e[n]?this.min[n]:this.center[n],r[n]=e[n]?this.center[n]:this.max[n];return r[2]=this.max[2],new Bn(i,r)},Bn.prototype.distanceX=function(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]},Bn.prototype.distanceY=function(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]},Bn.prototype.intersects=function(t){for(var e=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],i=!0,r=0;r<t.planes.length;r++){for(var n=t.planes[r],o=0,a=0;a<e.length;a++)o+=0<=vt.dot$1(n,e[a]);if(0===o)return 0;o!==e.length&&(i=!1)}if(i)return 2;for(var s=0;s<3;s++){for(var l=Number.MAX_VALUE,u=-Number.MAX_VALUE,c=0;c<t.points.length;c++){var p=t.points[c][s]-this.min[s];l=Math.min(l,p),u=Math.max(u,p)}if(u<0||l>this.max[s]-this.min[s])return 0}return 1},Fn.prototype.interpolate=function(t,e,i){return null!=e.top&&null!=t.top&&(this.top=vt.number(t.top,e.top,i)),null!=e.bottom&&null!=t.bottom&&(this.bottom=vt.number(t.bottom,e.bottom,i)),null!=e.left&&null!=t.left&&(this.left=vt.number(t.left,e.left,i)),null!=e.right&&null!=t.right&&(this.right=vt.number(t.right,e.right,i)),this},Fn.prototype.getCenter=function(t,e){var i=vt.clamp((this.left+t-this.right)/2,0,t),r=vt.clamp((this.top+e-this.bottom)/2,0,e);return new vt.Point(i,r)},Fn.prototype.equals=function(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right},Fn.prototype.clone=function(){return new Fn(this.top,this.bottom,this.left,this.right)},Fn.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var jn={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};function qn(t){var e,i,r,n;this._hashName=t&&encodeURIComponent(t),vt.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(e=this._updateHashUnthrottled.bind(this),i=!1,r=null,n=function(){r=null,i&&(e(),r=setTimeout(n,300),i=!1)},function(){return i=!0,r||n(),r})}function Vn(t){this._map=t,this.clear()}Un.prototype.clone=function(){var t=new Un(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._calcMatrices(),t},jn.minZoom.get=function(){return this._minZoom},jn.minZoom.set=function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))},jn.maxZoom.get=function(){return this._maxZoom},jn.maxZoom.set=function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))},jn.minPitch.get=function(){return this._minPitch},jn.minPitch.set=function(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))},jn.maxPitch.get=function(){return this._maxPitch},jn.maxPitch.set=function(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))},jn.renderWorldCopies.get=function(){return this._renderWorldCopies},jn.renderWorldCopies.set=function(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t},jn.worldSize.get=function(){return this.tileSize*this.scale},jn.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},jn.size.get=function(){return new vt.Point(this.width,this.height)},jn.bearing.get=function(){return-this.angle/Math.PI*180},jn.bearing.set=function(t){var e=-vt.wrap(t,-180,180)*Math.PI/180;this.angle!==e&&(this._unmodified=!1,this.angle=e,this._calcMatrices(),this.rotationMatrix=vt.create$2(),vt.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},jn.pitch.get=function(){return this._pitch/Math.PI*180},jn.pitch.set=function(t){var e=vt.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==e&&(this._unmodified=!1,this._pitch=e,this._calcMatrices())},jn.fov.get=function(){return this._fov/Math.PI*180},jn.fov.set=function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())},jn.zoom.get=function(){return this._zoom},jn.zoom.set=function(t){var e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom,this._constrain(),this._calcMatrices())},jn.center.get=function(){return this._center},jn.center.set=function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())},jn.padding.get=function(){return this._edgeInsets.toJSON()},jn.padding.set=function(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())},jn.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Un.prototype.isPaddingEqual=function(t){return this._edgeInsets.equals(t)},Un.prototype.interpolatePadding=function(t,e,i){this._unmodified=!1,this._edgeInsets.interpolate(t,e,i),this._constrain(),this._calcMatrices()},Un.prototype.coveringZoomLevel=function(t){var e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)},Un.prototype.getVisibleUnwrappedCoordinates=function(t){var e=[new vt.UnwrappedTileID(0,t)];if(this._renderWorldCopies)for(var i=this.pointCoordinate(new vt.Point(0,0)),r=this.pointCoordinate(new vt.Point(this.width,0)),n=this.pointCoordinate(new vt.Point(this.width,this.height)),o=this.pointCoordinate(new vt.Point(0,this.height)),a=Math.floor(Math.min(i.x,r.x,n.x,o.x)),s=Math.floor(Math.max(i.x,r.x,n.x,o.x)),l=a-1;l<=s+1;l++)0!==l&&e.push(new vt.UnwrappedTileID(l,t));return e},Un.prototype.coveringTiles=function(t){var e=this.coveringZoomLevel(t),i=e;if(void 0!==t.minzoom&&e<t.minzoom)return[];void 0!==t.maxzoom&&e>t.maxzoom&&(e=t.maxzoom);var r=vt.MercatorCoordinate.fromLngLat(this.center),n=Math.pow(2,e),o=[n*r.x,n*r.y,0],a=Nn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,e),s=t.minzoom||0;function l(t){return{aabb:new Bn([t*n,0,0],[(t+1)*n,n,0]),zoom:0,x:0,y:0,wrap:t,fullyVisible:!1}}this.pitch<=60&&this._edgeInsets.top<.1&&(s=e);var u=[],c=[],p=e,h=t.reparseOverscaled?i:e;if(this._renderWorldCopies)for(var d=1;d<=3;d++)u.push(l(-d)),u.push(l(d));for(u.push(l(0));0<u.length;){var f=u.pop(),m=f.x,g=f.y,y=f.fullyVisible;if(!y){var v=f.aabb.intersects(a);if(0===v)continue;y=2===v}var _=f.aabb.distanceX(o),x=f.aabb.distanceY(o),b=Math.max(Math.abs(_),Math.abs(x));if(f.zoom===p||b>3+(1<<p-f.zoom)-2&&f.zoom>=s)c.push({tileID:new vt.OverscaledTileID(f.zoom===p?h:f.zoom,f.wrap,f.zoom,m,g),distanceSq:vt.sqrLen([o[0]-.5-m,o[1]-.5-g])});else for(var w=0;w<4;w++){var S=(m<<1)+w%2,T=(g<<1)+(w>>1);u.push({aabb:f.aabb.quadrant(w),zoom:f.zoom+1,x:S,y:T,wrap:f.wrap,fullyVisible:y})}}return c.sort(function(t,e){return t.distanceSq-e.distanceSq}).map(function(t){return t.tileID})},Un.prototype.resize=function(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()},jn.unmodified.get=function(){return this._unmodified},Un.prototype.zoomScale=function(t){return Math.pow(2,t)},Un.prototype.scaleZoom=function(t){return Math.log(t)/Math.LN2},Un.prototype.project=function(t){var e=vt.clamp(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new vt.Point(vt.mercatorXfromLng(t.lng)*this.worldSize,vt.mercatorYfromLat(e)*this.worldSize)},Un.prototype.unproject=function(t){return new vt.MercatorCoordinate(t.x/this.worldSize,t.y/this.worldSize).toLngLat()},jn.point.get=function(){return this.project(this.center)},Un.prototype.setLocationAtPoint=function(t,e){var i=this.pointCoordinate(e),r=this.pointCoordinate(this.centerPoint),n=this.locationCoordinate(t),o=new vt.MercatorCoordinate(n.x-(i.x-r.x),n.y-(i.y-r.y));this.center=this.coordinateLocation(o),this._renderWorldCopies&&(this.center=this.center.wrap())},Un.prototype.locationPoint=function(t){return this.coordinatePoint(this.locationCoordinate(t))},Un.prototype.pointLocation=function(t){return this.coordinateLocation(this.pointCoordinate(t))},Un.prototype.locationCoordinate=function(t){return vt.MercatorCoordinate.fromLngLat(t)},Un.prototype.coordinateLocation=function(t){return t.toLngLat()},Un.prototype.pointCoordinate=function(t){var e=[t.x,t.y,0,1],i=[t.x,t.y,1,1];vt.transformMat4(e,e,this.pixelMatrixInverse),vt.transformMat4(i,i,this.pixelMatrixInverse);var r=e[3],n=i[3],o=e[1]/r,a=i[1]/n,s=e[2]/r,l=i[2]/n,u=s==l?0:(0-s)/(l-s);return new vt.MercatorCoordinate(vt.number(e[0]/r,i[0]/n,u)/this.worldSize,vt.number(o,a,u)/this.worldSize)},Un.prototype.coordinatePoint=function(t){var e=[t.x*this.worldSize,t.y*this.worldSize,0,1];return vt.transformMat4(e,e,this.pixelMatrix),new vt.Point(e[0]/e[3],e[1]/e[3])},Un.prototype.getBounds=function(){return(new vt.LngLatBounds).extend(this.pointLocation(new vt.Point(0,0))).extend(this.pointLocation(new vt.Point(this.width,0))).extend(this.pointLocation(new vt.Point(this.width,this.height))).extend(this.pointLocation(new vt.Point(0,this.height)))},Un.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new vt.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Un.prototype.setMaxBounds=function(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Un.prototype.calculatePosMatrix=function(t,e){void 0===e&&(e=!1);var i=t.key,r=e?this._alignedPosMatrixCache:this._posMatrixCache;if(r[i])return r[i];var n=t.canonical,o=this.worldSize/this.zoomScale(n.z),a=n.x+Math.pow(2,n.z)*t.wrap,s=vt.identity(new Float64Array(16));return vt.translate(s,s,[a*o,n.y*o,0]),vt.scale(s,s,[o/vt.EXTENT,o/vt.EXTENT,1]),vt.multiply(s,e?this.alignedProjMatrix:this.projMatrix,s),r[i]=new Float32Array(s),r[i]},Un.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Un.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var t,e,i,r,n=-90,o=90,a=-180,s=180,l=this.size,u=this._unmodified;if(this.latRange){var c=this.latRange;n=vt.mercatorYfromLat(c[1])*this.worldSize,t=(o=vt.mercatorYfromLat(c[0])*this.worldSize)-n<l.y?l.y/(o-n):0}if(this.lngRange){var p=this.lngRange;a=vt.mercatorXfromLng(p[0])*this.worldSize,e=(s=vt.mercatorXfromLng(p[1])*this.worldSize)-a<l.x?l.x/(s-a):0}var h=this.point,d=Math.max(e||0,t||0);if(d)return this.center=this.unproject(new vt.Point(e?(s+a)/2:h.x,t?(o+n)/2:h.y)),this.zoom+=this.scaleZoom(d),this._unmodified=u,void(this._constraining=!1);if(this.latRange){var f=h.y,m=l.y/2;f-m<n&&(r=n+m),o<f+m&&(r=o-m)}if(this.lngRange){var g=h.x,y=l.x/2;g-y<a&&(i=a+y),s<g+y&&(i=s-y)}void 0===i&&void 0===r||(this.center=this.unproject(new vt.Point(void 0!==i?i:h.x,void 0!==r?r:h.y))),this._unmodified=u,this._constraining=!1}},Un.prototype._calcMatrices=function(){if(this.height){var t=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var e=Math.PI/2+this._pitch,i=this._fov*(.5+t.y/this.height),r=Math.sin(i)*this.cameraToCenterDistance/Math.sin(vt.clamp(Math.PI-e-i,.01,Math.PI-.01)),n=this.point,o=n.x,a=n.y,s=1.01*(Math.cos(Math.PI/2-this._pitch)*r+this.cameraToCenterDistance),l=this.height/50,u=new Float64Array(16);vt.perspective(u,this._fov,this.width/this.height,l,s),u[8]=2*-t.x/this.width,u[9]=2*t.y/this.height,vt.scale(u,u,[1,-1,1]),vt.translate(u,u,[0,0,-this.cameraToCenterDistance]),vt.rotateX(u,u,this._pitch),vt.rotateZ(u,u,this.angle),vt.translate(u,u,[-o,-a,0]),this.mercatorMatrix=vt.scale([],u,[this.worldSize,this.worldSize,this.worldSize]),vt.scale(u,u,[1,1,vt.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=u,this.invProjMatrix=vt.invert([],this.projMatrix);var c=this.width%2/2,p=this.height%2/2,h=Math.cos(this.angle),d=Math.sin(this.angle),f=o-Math.round(o)+h*c+d*p,m=a-Math.round(a)+h*p+d*c,g=new Float64Array(u);if(vt.translate(g,g,[.5<f?f-1:f,.5<m?m-1:m,0]),this.alignedProjMatrix=g,u=vt.create(),vt.scale(u,u,[this.width/2,-this.height/2,1]),vt.translate(u,u,[1,-1,0]),this.labelPlaneMatrix=u,u=vt.create(),vt.scale(u,u,[1,-1,1]),vt.translate(u,u,[-1,-1,0]),vt.scale(u,u,[2/this.width,2/this.height,1]),this.glCoordMatrix=u,this.pixelMatrix=vt.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(u=vt.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=u,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Un.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var t=this.pointCoordinate(new vt.Point(0,0)),e=[t.x*this.worldSize,t.y*this.worldSize,0,1];return vt.transformMat4(e,e,this.pixelMatrix)[3]/this.cameraToCenterDistance},Un.prototype.getCameraPoint=function(){var t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new vt.Point(0,t))},Un.prototype.getCameraQueryGeometry=function(t){var e=this.getCameraPoint();if(1===t.length)return[t[0],e];for(var i=e.x,r=e.y,n=e.x,o=e.y,a=0,s=t;a<s.length;a+=1){var l=s[a];i=Math.min(i,l.x),r=Math.min(r,l.y),n=Math.max(n,l.x),o=Math.max(o,l.y)}return[new vt.Point(i,r),new vt.Point(n,r),new vt.Point(n,o),new vt.Point(i,o),new vt.Point(i,r)]},Object.defineProperties(Un.prototype,jn),qn.prototype.addTo=function(t){return this._map=t,vt.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},qn.prototype.remove=function(){return vt.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},qn.prototype.getHashString=function(t){var e=this._map.getCenter(),i=Math.round(100*this._map.getZoom())/100,r=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),n=Math.pow(10,r),o=Math.round(e.lng*n)/n,a=Math.round(e.lat*n)/n,s=this._map.getBearing(),l=this._map.getPitch(),u="";if(u+=t?"/"+o+"/"+a+"/"+i:i+"/"+a+"/"+o,(s||l)&&(u+="/"+Math.round(10*s)/10),l&&(u+="/"+Math.round(l)),this._hashName){var c=this._hashName,p=!1,h=vt.window.location.hash.slice(1).split("&").map(function(t){var e=t.split("=")[0];return e===c?(p=!0,e+"="+u):t}).filter(function(t){return t});return p||h.push(c+"="+u),"#"+h.join("&")}return"#"+u},qn.prototype._getCurrentHash=function(){var e,i=this,t=vt.window.location.hash.replace("#","");return this._hashName?(t.split("&").map(function(t){return t.split("=")}).forEach(function(t){t[0]===i._hashName&&(e=t)}),(e&&e[1]||"").split("/")):t.split("/")},qn.prototype._onHashChange=function(){var t=this._getCurrentHash();if(3<=t.length&&!t.some(function(t){return isNaN(t)})){var e=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:e,pitch:+(t[4]||0)}),!0}return!1},qn.prototype._updateHashUnthrottled=function(){var t=this.getHashString();try{vt.window.history.replaceState(vt.window.history.state,"",t)}catch(t){}};var Gn={linearity:.3,easing:vt.bezier(0,0,.3,1)},Zn=vt.extend({deceleration:2500,maxSpeed:1400},Gn),Hn=vt.extend({deceleration:20,maxSpeed:1400},Gn),Wn=vt.extend({deceleration:1e3,maxSpeed:360},Gn),Kn=vt.extend({deceleration:1e3,maxSpeed:90},Gn);function Xn(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function Yn(t,e,i){var r=i.maxSpeed,n=i.linearity,o=i.deceleration,a=vt.clamp(t*n/(e/1e3),-r,r),s=Math.abs(a)/(o*n);return{easing:i.easing,duration:1e3*s,amount:a*(s/2)}}function Jn(t,e){this._map=t,this._clickTolerance=e.clickTolerance}Vn.prototype.clear=function(){this._inertiaBuffer=[]},Vn.prototype.record=function(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:vt.browser.now(),settings:t})},Vn.prototype._drainInertiaBuffer=function(){for(var t=this._inertiaBuffer,e=vt.browser.now();0<t.length&&160<e-t[0].time;)t.shift()},Vn.prototype._onMoveEnd=function(t){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var e={zoom:0,bearing:0,pitch:0,pan:new vt.Point(0,0),pinchAround:void 0,around:void 0},i=0,r=this._inertiaBuffer;i<r.length;i+=1){var n=r[i].settings;e.zoom+=n.zoomDelta||0,e.bearing+=n.bearingDelta||0,e.pitch+=n.pitchDelta||0,n.panDelta&&e.pan._add(n.panDelta),n.around&&(e.around=n.around),n.pinchAround&&(e.pinchAround=n.pinchAround)}var o=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,a={};if(e.pan.mag()){var s=Yn(e.pan.mag(),o,vt.extend({},Zn,t||{}));a.offset=e.pan.mult(s.amount/e.pan.mag()),a.center=this._map.transform.center,Xn(a,s)}if(e.zoom){var l=Yn(e.zoom,o,Hn);a.zoom=this._map.transform.zoom+l.amount,Xn(a,l)}if(e.bearing){var u=Yn(e.bearing,o,Wn);a.bearing=this._map.transform.bearing+vt.clamp(u.amount,-179,179),Xn(a,u)}if(e.pitch){var c=Yn(e.pitch,o,Kn);a.pitch=this._map.transform.pitch+c.amount,Xn(a,c)}if(a.zoom||a.bearing){var p=void 0===e.pinchAround?e.around:e.pinchAround;a.around=p?this._map.unproject(p):this._map.getCenter()}return this.clear(),vt.extend(a,{noMoveStart:!0})}};var Qn=function(a){function t(t,e,i,r){void 0===r&&(r={});var n=_.mousePos(e.getCanvasContainer(),i),o=e.unproject(n);a.call(this,t,vt.extend({point:n,lngLat:o,originalEvent:i},r)),this._defaultPrevented=!1,this.target=e}a&&(t.__proto__=a);var e={defaultPrevented:{configurable:!0}};return((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.preventDefault=function(){this._defaultPrevented=!0},e.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(t.prototype,e),t}(vt.Event),$n=function(l){function t(t,e,i){var r="touchend"===t?i.changedTouches:i.touches,n=_.touchPos(e.getCanvasContainer(),r),o=n.map(function(t){return e.unproject(t)}),a=n.reduce(function(t,e,i,r){return t.add(e.div(r.length))},new vt.Point(0,0)),s=e.unproject(a);l.call(this,t,{points:n,point:a,lngLats:o,lngLat:s,originalEvent:i}),this._defaultPrevented=!1}l&&(t.__proto__=l);var e={defaultPrevented:{configurable:!0}};return((t.prototype=Object.create(l&&l.prototype)).constructor=t).prototype.preventDefault=function(){this._defaultPrevented=!0},e.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(t.prototype,e),t}(vt.Event),to=function(r){function t(t,e,i){r.call(this,t,{originalEvent:i}),this._defaultPrevented=!1}r&&(t.__proto__=r);var e={defaultPrevented:{configurable:!0}};return((t.prototype=Object.create(r&&r.prototype)).constructor=t).prototype.preventDefault=function(){this._defaultPrevented=!0},e.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(t.prototype,e),t}(vt.Event);function eo(t){this._map=t}function io(t,e){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1}function ro(t,e){for(var i={},r=0;r<t.length;r++)i[t[r].identifier]=e[r];return i}function no(t){this.reset(),this.numTouches=t.numTouches}function oo(t){this.singleTap=new no(t),this.numTaps=t.numTaps,this.reset()}function ao(){this._zoomIn=new oo({numTouches:1,numTaps:2}),this._zoomOut=new oo({numTouches:2,numTaps:1}),this.reset()}function so(t){this.reset(),this._clickTolerance=t.clickTolerance||1}Jn.prototype.reset=function(){delete this._mousedownPos},Jn.prototype.wheel=function(t){return this._firePreventable(new to(t.type,this._map,t))},Jn.prototype.mousedown=function(t,e){return this._mousedownPos=e,this._firePreventable(new Qn(t.type,this._map,t))},Jn.prototype.mouseup=function(t){this._map.fire(new Qn(t.type,this._map,t))},Jn.prototype.click=function(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||this._map.fire(new Qn(t.type,this._map,t))},Jn.prototype.dblclick=function(t){return this._firePreventable(new Qn(t.type,this._map,t))},Jn.prototype.mouseover=function(t){this._map.fire(new Qn(t.type,this._map,t))},Jn.prototype.mouseout=function(t){this._map.fire(new Qn(t.type,this._map,t))},Jn.prototype.touchstart=function(t){return this._firePreventable(new $n(t.type,this._map,t))},Jn.prototype.touchmove=function(t){this._map.fire(new $n(t.type,this._map,t))},Jn.prototype.touchend=function(t){this._map.fire(new $n(t.type,this._map,t))},Jn.prototype.touchcancel=function(t){this._map.fire(new $n(t.type,this._map,t))},Jn.prototype._firePreventable=function(t){if(this._map.fire(t),t.defaultPrevented)return{}},Jn.prototype.isEnabled=function(){return!0},Jn.prototype.isActive=function(){return!1},Jn.prototype.enable=function(){},Jn.prototype.disable=function(){},eo.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},eo.prototype.mousemove=function(t){this._map.fire(new Qn(t.type,this._map,t))},eo.prototype.mousedown=function(){this._delayContextMenu=!0},eo.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Qn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},eo.prototype.contextmenu=function(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new Qn(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()},eo.prototype.isEnabled=function(){return!0},eo.prototype.isActive=function(){return!1},eo.prototype.enable=function(){},eo.prototype.disable=function(){},io.prototype.isEnabled=function(){return!!this._enabled},io.prototype.isActive=function(){return!!this._active},io.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},io.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},io.prototype.mousedown=function(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(_.disableDrag(),this._startPos=this._lastPos=e,this._active=!0)},io.prototype.mousemoveWindow=function(t,e){if(this._active){var i=e;if(!(this._lastPos.equals(i)||!this._box&&i.dist(this._startPos)<this._clickTolerance)){var r=this._startPos;this._lastPos=i,this._box||(this._box=_.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));var n=Math.min(r.x,i.x),o=Math.max(r.x,i.x),a=Math.min(r.y,i.y),s=Math.max(r.y,i.y);_.setTransform(this._box,"translate("+n+"px,"+a+"px)"),this._box.style.width=o-n+"px",this._box.style.height=s-a+"px"}}},io.prototype.mouseupWindow=function(t,e){var i=this;if(this._active&&0===t.button){var r=this._startPos,n=e;if(this.reset(),_.suppressClick(),r.x!==n.x||r.y!==n.y)return this._map.fire(new vt.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:function(t){return t.fitScreenCoordinates(r,n,i._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",t)}},io.prototype.keydown=function(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))},io.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(_.remove(this._box),this._box=null),_.enableDrag(),delete this._startPos,delete this._lastPos},io.prototype._fireEvent=function(t,e){return this._map.fire(new vt.Event(t,{originalEvent:e}))},no.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},no.prototype.touchstart=function(t,e,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=t.timeStamp),i.length===this.numTouches&&(this.centroid=function(t){for(var e=new vt.Point(0,0),i=0,r=t;i<r.length;i+=1)e._add(r[i]);return e.div(t.length)}(e),this.touches=ro(i,e)))},no.prototype.touchmove=function(t,e,i){if(!this.aborted&&this.centroid){var r=ro(i,e);for(var n in this.touches){var o=r[n];(!o||30<o.dist(this.touches[n]))&&(this.aborted=!0)}}},no.prototype.touchend=function(t,e,i){if((!this.centroid||500<t.timeStamp-this.startTime)&&(this.aborted=!0),0===i.length){var r=!this.aborted&&this.centroid;if(this.reset(),r)return r}},oo.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},oo.prototype.touchstart=function(t,e,i){this.singleTap.touchstart(t,e,i)},oo.prototype.touchmove=function(t,e,i){this.singleTap.touchmove(t,e,i)},oo.prototype.touchend=function(t,e,i){var r=this.singleTap.touchend(t,e,i);if(r){var n=t.timeStamp-this.lastTime<500,o=!this.lastTap||this.lastTap.dist(r)<30;if(n&&o||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=r,this.count===this.numTaps)return this.reset(),r}},ao.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},ao.prototype.touchstart=function(t,e,i){this._zoomIn.touchstart(t,e,i),this._zoomOut.touchstart(t,e,i)},ao.prototype.touchmove=function(t,e,i){this._zoomIn.touchmove(t,e,i),this._zoomOut.touchmove(t,e,i)},ao.prototype.touchend=function(e,t,i){var r=this,n=this._zoomIn.touchend(e,t,i),o=this._zoomOut.touchend(e,t,i);return n?(this._active=!0,e.preventDefault(),setTimeout(function(){return r.reset()},0),{cameraAnimation:function(t){return t.easeTo({duration:300,zoom:t.getZoom()+1,around:t.unproject(n)},{originalEvent:e})}}):o?(this._active=!0,e.preventDefault(),setTimeout(function(){return r.reset()},0),{cameraAnimation:function(t){return t.easeTo({duration:300,zoom:t.getZoom()-1,around:t.unproject(o)},{originalEvent:e})}}):void 0},ao.prototype.touchcancel=function(){this.reset()},ao.prototype.enable=function(){this._enabled=!0},ao.prototype.disable=function(){this._enabled=!1,this.reset()},ao.prototype.isEnabled=function(){return this._enabled},ao.prototype.isActive=function(){return this._active};var lo={0:1,2:2};function uo(t){this._minTouches=1,this._clickTolerance=t.clickTolerance||1,this.reset()}so.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},so.prototype._correctButton=function(t,e){return!1},so.prototype._move=function(t,e){return{}},so.prototype.mousedown=function(t,e){if(!this._lastPoint){var i=_.mouseButton(t);this._correctButton(t,i)&&(this._lastPoint=e,this._eventButton=i)}},so.prototype.mousemoveWindow=function(t,e){var i,r,n=this._lastPoint;if(n)if(t.preventDefault(),i=this._eventButton,r=lo[i],void 0===t.buttons||(t.buttons&r)!==r)this.reset();else if(this._moved||!(e.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=e,this._move(n,e)},so.prototype.mouseupWindow=function(t){this._lastPoint&&_.mouseButton(t)===this._eventButton&&(this._moved&&_.suppressClick(),this.reset())},so.prototype.enable=function(){this._enabled=!0},so.prototype.disable=function(){this._enabled=!1,this.reset()},so.prototype.isEnabled=function(){return this._enabled},so.prototype.isActive=function(){return this._active};var co,po,ho,fo=(_o.__proto__=ho=so,((_o.prototype=Object.create(ho&&ho.prototype)).constructor=_o).prototype.mousedown=function(t,e){ho.prototype.mousedown.call(this,t,e),this._lastPoint&&(this._active=!0)},_o.prototype._correctButton=function(t,e){return 0===e&&!t.ctrlKey},_o.prototype._move=function(t,e){return{around:e,panDelta:e.sub(t)}},_o),mo=(vo.__proto__=po=so,((vo.prototype=Object.create(po&&po.prototype)).constructor=vo).prototype._correctButton=function(t,e){return 0===e&&t.ctrlKey||2===e},vo.prototype._move=function(t,e){var i=.8*(e.x-t.x);if(i)return this._active=!0,{bearingDelta:i}},vo.prototype.contextmenu=function(t){t.preventDefault()},vo),go=(yo.__proto__=co=so,((yo.prototype=Object.create(co&&co.prototype)).constructor=yo).prototype._correctButton=function(t,e){return 0===e&&t.ctrlKey||2===e},yo.prototype._move=function(t,e){var i=-.5*(e.y-t.y);if(i)return this._active=!0,{pitchDelta:i}},yo.prototype.contextmenu=function(t){t.preventDefault()},yo);function yo(){co.apply(this,arguments)}function vo(){po.apply(this,arguments)}function _o(){ho.apply(this,arguments)}function xo(){this.reset()}function bo(t,e,i){for(var r=0;r<t.length;r++)if(t[r].identifier===i)return e[r]}function wo(t,e){return Math.log(t/e)/Math.LN2}uo.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new vt.Point(0,0)},uo.prototype.touchstart=function(t,e,i){return this._calculateTransform(t,e,i)},uo.prototype.touchmove=function(t,e,i){if(this._active)return t.preventDefault(),this._calculateTransform(t,e,i)},uo.prototype.touchend=function(t,e,i){this._calculateTransform(t,e,i),this._active&&i.length<this._minTouches&&this.reset()},uo.prototype.touchcancel=function(){this.reset()},uo.prototype._calculateTransform=function(t,e,i){0<i.length&&(this._active=!0);var r=ro(i,e),n=new vt.Point(0,0),o=new vt.Point(0,0),a=0;for(var s in r){var l=r[s],u=this._touches[s];u&&(n._add(l),o._add(l.sub(u)),a++,r[s]=l)}if(this._touches=r,!(a<this._minTouches)&&o.mag()){var c=o.div(a);if(this._sum._add(c),!(this._sum.mag()<this._clickTolerance))return{around:n.div(a),panDelta:c}}},uo.prototype.enable=function(){this._enabled=!0},uo.prototype.disable=function(){this._enabled=!1,this.reset()},uo.prototype.isEnabled=function(){return this._enabled},uo.prototype.isActive=function(){return this._active},xo.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},xo.prototype._start=function(t){},xo.prototype._move=function(t,e,i){return{}},xo.prototype.touchstart=function(t,e,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([e[0],e[1]]))},xo.prototype.touchmove=function(t,e,i){if(this._firstTwoTouches){t.preventDefault();var r=this._firstTwoTouches,n=r[1],o=bo(i,e,r[0]),a=bo(i,e,n);if(o&&a){var s=this._aroundCenter?null:o.add(a).div(2);return this._move([o,a],s,t)}}},xo.prototype.touchend=function(t,e,i){if(this._firstTwoTouches){var r=this._firstTwoTouches,n=r[1],o=bo(i,e,r[0]),a=bo(i,e,n);o&&a||(this._active&&_.suppressClick(),this.reset())}},xo.prototype.touchcancel=function(){this.reset()},xo.prototype.enable=function(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around},xo.prototype.disable=function(){this._enabled=!1,this.reset()},xo.prototype.isEnabled=function(){return this._enabled},xo.prototype.isActive=function(){return this._active};var So,To=(Io.__proto__=So=xo,((Io.prototype=Object.create(So&&So.prototype)).constructor=Io).prototype.reset=function(){So.prototype.reset.call(this),delete this._distance,delete this._startDistance},Io.prototype._start=function(t){this._startDistance=this._distance=t[0].dist(t[1])},Io.prototype._move=function(t,e){var i=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(wo(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:wo(this._distance,i),pinchAround:e}},Io);function Io(){So.apply(this,arguments)}function Eo(t,e){return 180*t.angleWith(e)/Math.PI}var Co,Ao=(ko.__proto__=Co=xo,((ko.prototype=Object.create(Co&&Co.prototype)).constructor=ko).prototype.reset=function(){Co.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},ko.prototype._start=function(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])},ko.prototype._move=function(t,e){var i=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Eo(this._vector,i),pinchAround:e}},ko.prototype._isBelowThreshold=function(t){this._minDiameter=Math.min(this._minDiameter,t.mag());var e=25/(Math.PI*this._minDiameter)*360,i=Eo(t,this._startVector);return Math.abs(i)<e},ko);function ko(){Co.apply(this,arguments)}function Po(t){return Math.abs(t.y)>Math.abs(t.x)}function Mo(){var t=zo;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep}var Lo,Do=(Oo.__proto__=Lo=xo,((Oo.prototype=Object.create(Lo&&Lo.prototype)).constructor=Oo).prototype.reset=function(){Lo.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},Oo.prototype._start=function(t){Po((this._lastPoints=t)[0].sub(t[1]))&&(this._valid=!1)},Oo.prototype._move=function(t,e,i){var r=t[0].sub(this._lastPoints[0]),n=t[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(r,n,i.timeStamp),this._valid)return this._lastPoints=t,this._active=!0,{pitchDelta:(r.y+n.y)/2*-.5}},Oo.prototype.gestureBeginsVertically=function(t,e,i){if(void 0!==this._valid)return this._valid;var r=2<=t.mag(),n=2<=e.mag();if(r||n){if(!r||!n)return void 0===this._firstMove&&(this._firstMove=i),i-this._firstMove<100&&void 0;var o=0<t.y==0<e.y;return Po(t)&&Po(e)&&o}},Oo),zo={panStep:100,bearingStep:15,pitchStep:10};function Oo(){Lo.apply(this,arguments)}function Ro(t){return t*(2-t)}function No(t,e){this._map=t,this._el=t.getCanvasContainer(),this._handler=e,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,vt.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)}function Bo(t,e){this._clickZoom=t,this._tapZoom=e}function Fo(){this.reset()}function Uo(){this._tap=new oo({numTouches:1,numTaps:1}),this.reset()}function jo(t,e,i){this._el=t,this._mousePan=e,this._touchPan=i}function qo(t,e,i){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=i}function Vo(t,e,i,r){this._el=t,this._touchZoom=e,this._touchRotate=i,this._tapDragZoom=r,this._rotationDisabled=!1,this._enabled=!0}function Go(t){return t.zoom||t.drag||t.pitch||t.rotate}Mo.prototype.reset=function(){this._active=!1},Mo.prototype.keydown=function(i){var r=this;if(!(i.altKey||i.ctrlKey||i.metaKey)){var n=0,o=0,a=0,s=0,l=0;switch(i.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:i.shiftKey?o=-1:(i.preventDefault(),s=-1);break;case 39:i.shiftKey?o=1:(i.preventDefault(),s=1);break;case 38:i.shiftKey?a=1:(i.preventDefault(),l=-1);break;case 40:i.shiftKey?a=-1:(i.preventDefault(),l=1);break;default:return}return{cameraAnimation:function(t){var e=t.getZoom();t.easeTo({duration:300,easeId:"keyboardHandler",easing:Ro,zoom:n?Math.round(e)+n*(i.shiftKey?2:1):e,bearing:t.getBearing()+o*r._bearingStep,pitch:t.getPitch()+a*r._pitchStep,offset:[-s*r._panStep,-l*r._panStep],center:t.getCenter()},{originalEvent:i})}}}},Mo.prototype.enable=function(){this._enabled=!0},Mo.prototype.disable=function(){this._enabled=!1,this.reset()},Mo.prototype.isEnabled=function(){return this._enabled},Mo.prototype.isActive=function(){return this._active},No.prototype.setZoomRate=function(t){this._defaultZoomRate=t},No.prototype.setWheelZoomRate=function(t){this._wheelZoomRate=t},No.prototype.isEnabled=function(){return!!this._enabled},No.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},No.prototype.isZooming=function(){return!!this._zooming},No.prototype.enable=function(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},No.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},No.prototype.wheel=function(t){if(this.isEnabled()){var e=t.deltaMode===vt.window.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY,i=vt.browser.now(),r=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,0!==e&&e%4.000244140625==0?this._type="wheel":0!==e&&Math.abs(e)<4?this._type="trackpad":400<r?(this._type=null,this._lastValue=e,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(r*e)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,e+=this._lastValue)),t.shiftKey&&e&&(e/=4),this._type&&(this._lastWheelEvent=t,this._delta-=e,this._active||this._start(t)),t.preventDefault()}},No.prototype._onTimeout=function(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)},No.prototype._start=function(t){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var e=_.mousePos(this._el,t);this._around=vt.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(e)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},No.prototype.renderFrame=function(){return this._onScrollFrame()},No.prototype._onScrollFrame=function(){var t=this;if(this._frameId&&(this._frameId=null,this.isActive())){var e=this._map.transform;if(0!==this._delta){var i="wheel"===this._type&&4.000244140625<Math.abs(this._delta)?this._wheelZoomRate:this._defaultZoomRate,r=2/(1+Math.exp(-Math.abs(this._delta*i)));this._delta<0&&0!==r&&(r=1/r);var n="number"==typeof this._targetZoom?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(n*r))),"wheel"===this._type&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var o,a="number"==typeof this._targetZoom?this._targetZoom:e.zoom,s=this._startZoom,l=this._easing,u=!1;if("wheel"===this._type&&s&&l){var c=Math.min((vt.browser.now()-this._lastWheelEventTime)/200,1),p=l(c);o=vt.number(s,a,p),c<1?this._frameId||(this._frameId=!0):u=!0}else o=a,u=!0;return this._active=!0,u&&(this._active=!1,this._finishTimeout=setTimeout(function(){t._zooming=!1,t._handler._triggerRenderFrame(),delete t._targetZoom,delete t._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!u,zoomDelta:o-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},No.prototype._smoothOutEasing=function(t){var e=vt.ease;if(this._prevEase){var i=this._prevEase,r=(vt.browser.now()-i.start)/i.duration,n=i.easing(.01+r)-i.easing(r),o=.27/Math.sqrt(n*n+1e-4)*.01,a=Math.sqrt(.0729-o*o);e=vt.bezier(o,a,.25,1)}return this._prevEase={start:vt.browser.now(),duration:t,easing:e},e},No.prototype.reset=function(){this._active=!1},Bo.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Bo.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Bo.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Bo.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()},Fo.prototype.reset=function(){this._active=!1},Fo.prototype.dblclick=function(e,i){return e.preventDefault(),{cameraAnimation:function(t){t.easeTo({duration:300,zoom:t.getZoom()+(e.shiftKey?-1:1),around:t.unproject(i)},{originalEvent:e})}}},Fo.prototype.enable=function(){this._enabled=!0},Fo.prototype.disable=function(){this._enabled=!1,this.reset()},Fo.prototype.isEnabled=function(){return this._enabled},Fo.prototype.isActive=function(){return this._active},Uo.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Uo.prototype.touchstart=function(t,e,i){this._swipePoint||(this._tapTime&&500<t.timeStamp-this._tapTime&&this.reset(),this._tapTime?0<i.length&&(this._swipePoint=e[0],this._swipeTouch=i[0].identifier):this._tap.touchstart(t,e,i))},Uo.prototype.touchmove=function(t,e,i){if(this._tapTime){if(this._swipePoint){if(i[0].identifier!==this._swipeTouch)return;var r=e[0],n=r.y-this._swipePoint.y;return this._swipePoint=r,t.preventDefault(),this._active=!0,{zoomDelta:n/128}}}else this._tap.touchmove(t,e,i)},Uo.prototype.touchend=function(t,e,i){this._tapTime?this._swipePoint&&0===i.length&&this.reset():this._tap.touchend(t,e,i)&&(this._tapTime=t.timeStamp)},Uo.prototype.touchcancel=function(){this.reset()},Uo.prototype.enable=function(){this._enabled=!0},Uo.prototype.disable=function(){this._enabled=!1,this.reset()},Uo.prototype.isEnabled=function(){return this._enabled},Uo.prototype.isActive=function(){return this._active},jo.prototype.enable=function(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},jo.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},jo.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},jo.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()},qo.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},qo.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},qo.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},qo.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()},Vo.prototype.enable=function(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Vo.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Vo.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Vo.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Vo.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Vo.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Zo,Ho=((Zo=vt.Event)&&(Wo.__proto__=Zo),(Wo.prototype=Object.create(Zo&&Zo.prototype)).constructor=Wo);function Wo(){Zo.apply(this,arguments)}function Ko(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}function Xo(t,e){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Vn(t),this._bearingSnap=e.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(e),vt.bindAll(["handleEvent","handleWindowEvent"],this);var i=this._el;this._listeners=[[i,"touchstart",{passive:!0}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[vt.window.document,"mousemove",{capture:!0}],[vt.window.document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[vt.window,"blur",void 0]];for(var r=0,n=this._listeners;r<n.length;r+=1){var o=n[r],a=o[0];_.addEventListener(a,o[1],a===vt.window.document?this.handleWindowEvent:this.handleEvent,o[2])}}function Yo(t){void 0===t&&(t={}),this.options=t,vt.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)}Xo.prototype.destroy=function(){for(var t=0,e=this._listeners;t<e.length;t+=1){var i=e[t],r=i[0];_.removeEventListener(r,i[1],r===vt.window.document?this.handleWindowEvent:this.handleEvent,i[2])}},Xo.prototype._addDefaultHandlers=function(t){var e=this._map,i=e.getCanvasContainer();this._add("mapEvent",new Jn(e,t));var r=e.boxZoom=new io(e,t);this._add("boxZoom",r);var n=new ao,o=new Fo;e.doubleClickZoom=new Bo(o,n),this._add("tapZoom",n),this._add("clickZoom",o);var a=new Uo;this._add("tapDragZoom",a);var s=e.touchPitch=new Do;this._add("touchPitch",s);var l=new mo(t),u=new go(t);e.dragRotate=new qo(t,l,u),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",u,["mouseRotate"]);var c=new fo(t),p=new uo(t);e.dragPan=new jo(i,c,p),this._add("mousePan",c),this._add("touchPan",p,["touchZoom","touchRotate"]);var h=new Ao,d=new To;e.touchZoomRotate=new Vo(i,d,h,a),this._add("touchRotate",h,["touchPan","touchZoom"]),this._add("touchZoom",d,["touchPan","touchRotate"]);var f=e.scrollZoom=new No(e,this);this._add("scrollZoom",f,["mousePan"]);var m=e.keyboard=new Mo;this._add("keyboard",m),this._add("blockableMapEvent",new eo(e));for(var g=0,y=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];g<y.length;g+=1){var v=y[g];t.interactive&&t[v]&&e[v].enable(t[v])}},Xo.prototype._add=function(t,e,i){this._handlers.push({handlerName:t,handler:e,allowed:i}),this._handlersById[t]=e},Xo.prototype.stop=function(){if(!this._updatingCamera){for(var t=0,e=this._handlers;t<e.length;t+=1)e[t].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},Xo.prototype.isActive=function(){for(var t=0,e=this._handlers;t<e.length;t+=1)if(e[t].handler.isActive())return!0;return!1},Xo.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Xo.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Xo.prototype.isMoving=function(){return Boolean(Go(this._eventsInProgress))||this.isZooming()},Xo.prototype._blockedByActive=function(t,e,i){for(var r in t)if(r!==i&&(!e||e.indexOf(r)<0))return!0;return!1},Xo.prototype.handleWindowEvent=function(t){this.handleEvent(t,t.type+"Window")},Xo.prototype._getMapTouches=function(t){for(var e=[],i=0,r=t;i<r.length;i+=1){var n=r[i];this._el.contains(n.target)&&e.push(n)}return e},Xo.prototype.handleEvent=function(t,e){if("blur"!==t.type){this._updatingCamera=!0;for(var i="renderFrame"===t.type?void 0:t,r={needsRenderFrame:!1},n={},o={},a=t.touches?this._getMapTouches(t.touches):void 0,s=a?_.touchPos(this._el,a):_.mousePos(this._el,t),l=0,u=this._handlers;l<u.length;l+=1){var c=u[l],p=c.handlerName,h=c.handler,d=c.allowed;if(h.isEnabled()){var f=void 0;this._blockedByActive(o,d,p)?h.reset():h[e||t.type]&&(f=h[e||t.type](t,s,a),this.mergeHandlerResult(r,n,f,p,i),f&&f.needsRenderFrame&&this._triggerRenderFrame()),(f||h.isActive())&&(o[p]=h)}}var m={};for(var g in this._previousActiveHandlers)o[g]||(m[g]=i);this._previousActiveHandlers=o,(Object.keys(m).length||Ko(r))&&(this._changes.push([r,n,m]),this._triggerRenderFrame()),(Object.keys(o).length||Ko(r))&&this._map._stop(!0),this._updatingCamera=!1;var y=r.cameraAnimation;y&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],y(this._map))}else this.stop()},Xo.prototype.mergeHandlerResult=function(t,e,i,r,n){if(i){vt.extend(t,i);var o={handlerName:r,originalEvent:i.originalEvent||n};void 0!==i.zoomDelta&&(e.zoom=o),void 0!==i.panDelta&&(e.drag=o),void 0!==i.pitchDelta&&(e.pitch=o),void 0!==i.bearingDelta&&(e.rotate=o)}},Xo.prototype._applyChanges=function(){for(var t={},e={},i={},r=0,n=this._changes;r<n.length;r+=1){var o=n[r],a=o[0],s=o[1],l=o[2];a.panDelta&&(t.panDelta=(t.panDelta||new vt.Point(0,0))._add(a.panDelta)),a.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+a.zoomDelta),a.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+a.bearingDelta),a.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+a.pitchDelta),void 0!==a.around&&(t.around=a.around),void 0!==a.pinchAround&&(t.pinchAround=a.pinchAround),a.noInertia&&(t.noInertia=a.noInertia),vt.extend(e,s),vt.extend(i,l)}this._updateMapTransform(t,e,i),this._changes=[]},Xo.prototype._updateMapTransform=function(t,e,i){var r=this._map,n=r.transform;if(!Ko(t))return this._fireEvents(e,i);var o=t.panDelta,a=t.zoomDelta,s=t.bearingDelta,l=t.pitchDelta,u=t.around,c=t.pinchAround;void 0!==c&&(u=c),r._stop(!0),u=u||r.transform.centerPoint;var p=n.pointLocation(o?u.sub(o):u);s&&(n.bearing+=s),l&&(n.pitch+=l),a&&(n.zoom+=a),n.setLocationAtPoint(p,u),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(e,i)},Xo.prototype._fireEvents=function(t,e){var i=this,r=Go(this._eventsInProgress),n=Go(t),o={};for(var a in t)this._eventsInProgress[a]||(o[a+"start"]=t[a].originalEvent),this._eventsInProgress[a]=t[a];for(var s in!r&&n&&this._fireEvent("movestart",n.originalEvent),o)this._fireEvent(s,o[s]);for(var l in t.rotate&&(this._bearingChanged=!0),n&&this._fireEvent("move",n.originalEvent),t)this._fireEvent(l,t[l].originalEvent);var u,c={};for(var p in this._eventsInProgress){var h=this._eventsInProgress[p],d=h.handlerName,f=h.originalEvent;this._handlersById[d].isActive()||(delete this._eventsInProgress[p],c[p+"end"]=u=e[d]||f)}for(var m in c)this._fireEvent(m,c[m]);var g=Go(this._eventsInProgress);if((r||n)&&!g){this._updatingCamera=!0;var y=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),v=function(t){return 0!==t&&-i._bearingSnap<t&&t<i._bearingSnap};y?(v(y.bearing||this._map.getBearing())&&(y.bearing=0),this._map.easeTo(y,{originalEvent:u})):(this._map.fire(new vt.Event("moveend",{originalEvent:u})),v(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},Xo.prototype._fireEvent=function(t,e){this._map.fire(new vt.Event(t,e?{originalEvent:e}:{}))},Xo.prototype._requestFrame=function(){var e=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(t){delete e._frameId,e.handleEvent(new Ho("renderFrame",{timeStamp:t})),e._applyChanges()})},Xo.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var Jo,Qo=((Jo=vt.Evented)&&($o.__proto__=Jo),(($o.prototype=Object.create(Jo&&Jo.prototype)).constructor=$o).prototype.getCenter=function(){return new vt.LngLat(this.transform.center.lng,this.transform.center.lat)},$o.prototype.setCenter=function(t,e){return this.jumpTo({center:t},e)},$o.prototype.panBy=function(t,e,i){return t=vt.Point.convert(t).mult(-1),this.panTo(this.transform.center,vt.extend({offset:t},e),i)},$o.prototype.panTo=function(t,e,i){return this.easeTo(vt.extend({center:t},e),i)},$o.prototype.getZoom=function(){return this.transform.zoom},$o.prototype.setZoom=function(t,e){return this.jumpTo({zoom:t},e),this},$o.prototype.zoomTo=function(t,e,i){return this.easeTo(vt.extend({zoom:t},e),i)},$o.prototype.zoomIn=function(t,e){return this.zoomTo(this.getZoom()+1,t,e),this},$o.prototype.zoomOut=function(t,e){return this.zoomTo(this.getZoom()-1,t,e),this},$o.prototype.getBearing=function(){return this.transform.bearing},$o.prototype.setBearing=function(t,e){return this.jumpTo({bearing:t},e),this},$o.prototype.getPadding=function(){return this.transform.padding},$o.prototype.setPadding=function(t,e){return this.jumpTo({padding:t},e),this},$o.prototype.rotateTo=function(t,e,i){return this.easeTo(vt.extend({bearing:t},e),i)},$o.prototype.resetNorth=function(t,e){return this.rotateTo(0,vt.extend({duration:1e3},t),e),this},$o.prototype.resetNorthPitch=function(t,e){return this.easeTo(vt.extend({bearing:0,pitch:0,duration:1e3},t),e),this},$o.prototype.snapToNorth=function(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this},$o.prototype.getPitch=function(){return this.transform.pitch},$o.prototype.setPitch=function(t,e){return this.jumpTo({pitch:t},e),this},$o.prototype.cameraForBounds=function(t,e){return t=vt.LngLatBounds.convert(t),this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),0,e)},$o.prototype._cameraForBoxAndBearing=function(t,e,i,r){var n={top:0,bottom:0,right:0,left:0};if("number"==typeof(r=vt.extend({padding:n,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding){var o=r.padding;r.padding={top:o,bottom:o,right:o,left:o}}r.padding=vt.extend(n,r.padding);var a=this.transform,s=a.padding,l=a.project(vt.LngLat.convert(t)),u=a.project(vt.LngLat.convert(e)),c=l.rotate(-i*Math.PI/180),p=u.rotate(-i*Math.PI/180),h=new vt.Point(Math.max(c.x,p.x),Math.max(c.y,p.y)),d=new vt.Point(Math.min(c.x,p.x),Math.min(c.y,p.y)),f=h.sub(d),m=(a.width-(s.left+s.right+r.padding.left+r.padding.right))/f.x,g=(a.height-(s.top+s.bottom+r.padding.top+r.padding.bottom))/f.y;if(!(g<0||m<0)){var y=Math.min(a.scaleZoom(a.scale*Math.min(m,g)),r.maxZoom),v=vt.Point.convert(r.offset),_=new vt.Point(v.x+(r.padding.left-r.padding.right)/2,v.y+(r.padding.top-r.padding.bottom)/2).mult(a.scale/a.zoomScale(y));return{center:a.unproject(l.add(u).div(2).sub(_)),zoom:y,bearing:i}}vt.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},$o.prototype.fitBounds=function(t,e,i){return this._fitInternal(this.cameraForBounds(t,e),e,i)},$o.prototype.fitScreenCoordinates=function(t,e,i,r,n){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(vt.Point.convert(t)),this.transform.pointLocation(vt.Point.convert(e)),i,r),r,n)},$o.prototype._fitInternal=function(t,e,i){return t?(delete(e=vt.extend(t,e)).padding,e.linear?this.easeTo(e,i):this.flyTo(e,i)):this},$o.prototype.jumpTo=function(t,e){this.stop();var i=this.transform,r=!1,n=!1,o=!1;return"zoom"in t&&i.zoom!==+t.zoom&&(r=!0,i.zoom=+t.zoom),void 0!==t.center&&(i.center=vt.LngLat.convert(t.center)),"bearing"in t&&i.bearing!==+t.bearing&&(n=!0,i.bearing=+t.bearing),"pitch"in t&&i.pitch!==+t.pitch&&(o=!0,i.pitch=+t.pitch),null==t.padding||i.isPaddingEqual(t.padding)||(i.padding=t.padding),this.fire(new vt.Event("movestart",e)).fire(new vt.Event("move",e)),r&&this.fire(new vt.Event("zoomstart",e)).fire(new vt.Event("zoom",e)).fire(new vt.Event("zoomend",e)),n&&this.fire(new vt.Event("rotatestart",e)).fire(new vt.Event("rotate",e)).fire(new vt.Event("rotateend",e)),o&&this.fire(new vt.Event("pitchstart",e)).fire(new vt.Event("pitch",e)).fire(new vt.Event("pitchend",e)),this.fire(new vt.Event("moveend",e))},$o.prototype.easeTo=function(t,o){var a=this;this._stop(!1,t.easeId),(!1===(t=vt.extend({offset:[0,0],duration:500,easing:vt.ease},t)).animate||!t.essential&&vt.browser.prefersReducedMotion)&&(t.duration=0);var s=this.transform,l=this.getZoom(),u=this.getBearing(),c=this.getPitch(),p=this.getPadding(),h="zoom"in t?+t.zoom:l,d="bearing"in t?this._normalizeBearing(t.bearing,u):u,f="pitch"in t?+t.pitch:c,m="padding"in t?t.padding:s.padding,g=vt.Point.convert(t.offset),y=s.centerPoint.add(g),e=s.pointLocation(y),i=vt.LngLat.convert(t.center||e);this._normalizeCenter(i);var v,_,x=s.project(e),b=s.project(i).sub(x),w=s.zoomScale(h-l);t.around&&(v=vt.LngLat.convert(t.around),_=s.locationPoint(v));var r={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||h!==l,this._rotating=this._rotating||u!==d,this._pitching=this._pitching||f!==c,this._padding=!s.isPaddingEqual(m),this._easeId=t.easeId,this._prepareEase(o,t.noMoveStart,r),clearTimeout(this._easeEndTimeoutID),this._ease(function(t){if(a._zooming&&(s.zoom=vt.number(l,h,t)),a._rotating&&(s.bearing=vt.number(u,d,t)),a._pitching&&(s.pitch=vt.number(c,f,t)),a._padding&&(s.interpolatePadding(p,m,t),y=s.centerPoint.add(g)),v)s.setLocationAtPoint(v,_);else{var e=s.zoomScale(s.zoom-l),i=l<h?Math.min(2,w):Math.max(.5,w),r=Math.pow(i,1-t),n=s.unproject(x.add(b.mult(t*r)).mult(e));s.setLocationAtPoint(s.renderWorldCopies?n.wrap():n,y)}a._fireMoveEvents(o)},function(t){a._afterEase(o,t)},t),this},$o.prototype._prepareEase=function(t,e,i){void 0===i&&(i={}),this._moving=!0,e||i.moving||this.fire(new vt.Event("movestart",t)),this._zooming&&!i.zooming&&this.fire(new vt.Event("zoomstart",t)),this._rotating&&!i.rotating&&this.fire(new vt.Event("rotatestart",t)),this._pitching&&!i.pitching&&this.fire(new vt.Event("pitchstart",t))},$o.prototype._fireMoveEvents=function(t){this.fire(new vt.Event("move",t)),this._zooming&&this.fire(new vt.Event("zoom",t)),this._rotating&&this.fire(new vt.Event("rotate",t)),this._pitching&&this.fire(new vt.Event("pitch",t))},$o.prototype._afterEase=function(t,e){if(!this._easeId||!e||this._easeId!==e){delete this._easeId;var i=this._zooming,r=this._rotating,n=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,i&&this.fire(new vt.Event("zoomend",t)),r&&this.fire(new vt.Event("rotateend",t)),n&&this.fire(new vt.Event("pitchend",t)),this.fire(new vt.Event("moveend",t))}},$o.prototype.flyTo=function(t,n){var o=this;if(!t.essential&&vt.browser.prefersReducedMotion){var e=vt.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(e,n)}this.stop(),t=vt.extend({offset:[0,0],speed:1.2,curve:1.42,easing:vt.ease},t);var a=this.transform,s=this.getZoom(),l=this.getBearing(),u=this.getPitch(),c=this.getPadding(),p="zoom"in t?vt.clamp(+t.zoom,a.minZoom,a.maxZoom):s,h="bearing"in t?this._normalizeBearing(t.bearing,l):l,d="pitch"in t?+t.pitch:u,f="padding"in t?t.padding:a.padding,i=a.zoomScale(p-s),m=vt.Point.convert(t.offset),g=a.centerPoint.add(m),r=a.pointLocation(g),y=vt.LngLat.convert(t.center||r);this._normalizeCenter(y);var v=a.project(r),_=a.project(y).sub(v),x=t.curve,b=Math.max(a.width,a.height),w=b/i,S=_.mag();if("minZoom"in t){var T=vt.clamp(Math.min(t.minZoom,s,p),a.minZoom,a.maxZoom),I=b/a.zoomScale(T-s);x=Math.sqrt(I/S*2)}var E=x*x;function C(t){var e=(w*w-b*b+(t?-1:1)*E*E*S*S)/(2*(t?w:b)*E*S);return Math.log(Math.sqrt(e*e+1)-e)}function A(t){return(Math.exp(t)-Math.exp(-t))/2}function k(t){return(Math.exp(t)+Math.exp(-t))/2}var P=C(0),M=function(t){return k(P)/k(P+x*t)},L=function(t){return b*((k(P)*(A(e=P+x*t)/k(e))-A(P))/E)/S;var e},D=(C(1)-P)/x;if(Math.abs(S)<1e-6||!isFinite(D)){if(Math.abs(b-w)<1e-6)return this.easeTo(t,n);var z=w<b?-1:1;D=Math.abs(Math.log(w/b))/x,L=function(){return 0},M=function(t){return Math.exp(z*x*t)}}return t.duration="duration"in t?+t.duration:1e3*D/("screenSpeed"in t?t.screenSpeed/x:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=l!==h,this._pitching=d!==u,this._padding=!a.isPaddingEqual(f),this._prepareEase(n,!1),this._ease(function(t){var e=t*D,i=1/M(e);a.zoom=1===t?p:s+a.scaleZoom(i),o._rotating&&(a.bearing=vt.number(l,h,t)),o._pitching&&(a.pitch=vt.number(u,d,t)),o._padding&&(a.interpolatePadding(c,f,t),g=a.centerPoint.add(m));var r=1===t?y:a.unproject(v.add(_.mult(L(e))).mult(i));a.setLocationAtPoint(a.renderWorldCopies?r.wrap():r,g),o._fireMoveEvents(n)},function(){return o._afterEase(n)},t),this},$o.prototype.isEasing=function(){return!!this._easeFrameId},$o.prototype.stop=function(){return this._stop()},$o.prototype._stop=function(t,e){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var i=this._onEaseEnd;delete this._onEaseEnd,i.call(this,e)}if(!t){var r=this.handlers;r&&r.stop()}return this},$o.prototype._ease=function(t,e,i){!1===i.animate||0===i.duration?(t(1),e()):(this._easeStart=vt.browser.now(),this._easeOptions=i,this._onEaseFrame=t,this._onEaseEnd=e,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},$o.prototype._renderFrameCallback=function(){var t=Math.min((vt.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},$o.prototype._normalizeBearing=function(t,e){t=vt.wrap(t,-180,180);var i=Math.abs(t-e);return Math.abs(t-360-e)<i&&(t-=360),Math.abs(t+360-e)<i&&(t+=360),t},$o.prototype._normalizeCenter=function(t){var e=this.transform;if(e.renderWorldCopies&&!e.lngRange){var i=t.lng-e.center.lng;t.lng+=180<i?-360:i<-180?360:0}},$o);function $o(t,e){Jo.call(this),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=e.bearingSnap,vt.bindAll(["_renderFrameCallback"],this)}function ta(){vt.bindAll(["_updateLogo"],this),vt.bindAll(["_updateCompact"],this)}function ea(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}Yo.prototype.getDefaultPosition=function(){return"bottom-right"},Yo.prototype.onAdd=function(t){var e=this.options&&this.options.compact;return this._map=t,this._container=_.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=_.create("div","mapboxgl-ctrl-attrib-inner",this._container),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Yo.prototype.onRemove=function(){_.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Yo.prototype._updateEditLink=function(){var t=this._editLink;t=t||(this._editLink=this._container.querySelector(".mapbox-improve-map"));var r=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||vt.config.ACCESS_TOKEN}];if(t){var e=r.reduce(function(t,e,i){return e.value&&(t+=e.key+"="+e.value+(i<r.length-1?"&":"")),t},"?");t.href=vt.config.FEEDBACK_URL+"/"+e+(this._map._hash?this._map._hash.getHashString(!0):""),t.rel="noopener nofollow"}},Yo.prototype._updateData=function(t){!t||"metadata"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())},Yo.prototype._updateAttributions=function(){if(this._map.style){var r=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=r.concat(this.options.customAttribution.map(function(t){return"string"!=typeof t?"":t})):"string"==typeof this.options.customAttribution&&r.push(this.options.customAttribution)),this._map.style.stylesheet){var t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}var e=this._map.style.sourceCaches;for(var i in e){var n=e[i];if(n.used){var o=n.getSource();o.attribution&&r.indexOf(o.attribution)<0&&r.push(o.attribution)}}r.sort(function(t,e){return t.length-e.length});var a=(r=r.filter(function(t,e){for(var i=e+1;i<r.length;i++)if(0<=r[i].indexOf(t))return!1;return!0})).join(" | ");a!==this._attribHTML&&(this._attribHTML=a,r.length?(this._innerContainer.innerHTML=a,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Yo.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")},ta.prototype.onAdd=function(t){this._map=t,this._container=_.create("div","mapboxgl-ctrl");var e=_.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://www.mapbox.com/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ta.prototype.onRemove=function(){_.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ta.prototype.getDefaultPosition=function(){return"bottom-left"},ta.prototype._updateLogo=function(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},ta.prototype._logoRequired=function(){if(this._map.style){var t=this._map.style.sourceCaches;for(var e in t)if(t[e].getSource().mapbox_logo)return!0;return!1}},ta.prototype._updateCompact=function(){var t=this._container.children;if(t.length){var e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}},ea.prototype.add=function(t){var e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e},ea.prototype.remove=function(t){for(var e=this._currentlyRunning,i=0,r=e?this._queue.concat(e):this._queue;i<r.length;i+=1){var n=r[i];if(n.id===t)return void(n.cancelled=!0)}},ea.prototype.run=function(t){void 0===t&&(t=0);var e=this._currentlyRunning=this._queue;this._queue=[];for(var i=0,r=e;i<r.length;i+=1){var n=r[i];if(!n.cancelled&&(n.callback(t),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},ea.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ia={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},ra=vt.window.HTMLImageElement,na=vt.window.HTMLElement,oa=vt.window.ImageBitmap,aa={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},sa=function(u){function t(t){var e=this;if(null!=(t=vt.extend({},aa,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=t.minPitch&&null!=t.maxPitch&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=t.minPitch&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=t.maxPitch&&60<t.maxPitch)throw new Error("maxPitch must be less than or equal to 60");var i=new Un(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies);if(u.call(this,i,t),this._interactive=t.interactive,this._maxTileCacheSize=t.maxTileCacheSize,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._antialias=t.antialias,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._crossSourceCollisions=t.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=t.collectResourceTiming,this._renderTaskQueue=new ea,this._controls=[],this._mapId=vt.uniqueId(),this._locale=vt.extend({},ia,t.locale),this._requestManager=new vt.RequestManager(t.transformRequest,t.accessToken),"string"==typeof t.container){if(this._container=vt.window.document.getElementById(t.container),!this._container)throw new Error("Container '"+t.container+"' not found.")}else{if(!(t.container instanceof na))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(t.maxBounds&&this.setMaxBounds(t.maxBounds),vt.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return e._update(!1)}),this.on("moveend",function(){return e._update(!1)}),this.on("zoom",function(){return e._update(!0)}),void 0!==vt.window&&(vt.window.addEventListener("online",this._onWindowOnline,!1),vt.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new Xo(this,t),this._hash=t.hash&&new qn("string"==typeof t.hash&&t.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,vt.extend({},t.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=t.localIdeographFontFamily,t.style&&this.setStyle(t.style,{localIdeographFontFamily:t.localIdeographFontFamily}),t.attributionControl&&this.addControl(new Yo({customAttribution:t.customAttribution})),this.addControl(new ta,t.logoPosition),this.on("style.load",function(){e.transform.unmodified&&e.jumpTo(e.style.stylesheet)}),this.on("data",function(t){e._update("style"===t.dataType),e.fire(new vt.Event(t.dataType+"data",t))}),this.on("dataloading",function(t){e.fire(new vt.Event(t.dataType+"dataloading",t))})}u&&(t.__proto__=u);var e={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return((t.prototype=Object.create(u&&u.prototype)).constructor=t).prototype._getMapId=function(){return this._mapId},t.prototype.addControl=function(t,e){if(void 0===e&&t.getDefaultPosition&&(e=t.getDefaultPosition()),void 0===e&&(e="top-right"),!t||!t.onAdd)return this.fire(new vt.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var i=t.onAdd(this);this._controls.push(t);var r=this._controlPositions[e];return-1!==e.indexOf("bottom")?r.insertBefore(i,r.firstChild):r.appendChild(i),this},t.prototype.removeControl=function(t){if(!t||!t.onRemove)return this.fire(new vt.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var e=this._controls.indexOf(t);return-1<e&&this._controls.splice(e,1),t.onRemove(this),this},t.prototype.resize=function(t){var e=this._containerDimensions(),i=e[0],r=e[1];this._resizeCanvas(i,r),this.transform.resize(i,r),this.painter.resize(i,r);var n=!this._moving;return n&&(this.stop(),this.fire(new vt.Event("movestart",t)).fire(new vt.Event("move",t))),this.fire(new vt.Event("resize",t)),n&&this.fire(new vt.Event("moveend",t)),this},t.prototype.getBounds=function(){return this.transform.getBounds()},t.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},t.prototype.setMaxBounds=function(t){return this.transform.setMaxBounds(vt.LngLatBounds.convert(t)),this._update()},t.prototype.setMinZoom=function(t){if(-2<=(t=null==t?-2:t)&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},t.prototype.getMinZoom=function(){return this.transform.minZoom},t.prototype.setMaxZoom=function(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")},t.prototype.getMaxZoom=function(){return this.transform.maxZoom},t.prototype.setMinPitch=function(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(0<=t&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t&&this.setPitch(t),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},t.prototype.getMinPitch=function(){return this.transform.minPitch},t.prototype.setMaxPitch=function(t){if(60<(t=null==t?60:t))throw new Error("maxPitch must be less than or equal to 60");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")},t.prototype.getMaxPitch=function(){return this.transform.maxPitch},t.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},t.prototype.setRenderWorldCopies=function(t){return this.transform.renderWorldCopies=t,this._update()},t.prototype.project=function(t){return this.transform.locationPoint(vt.LngLat.convert(t))},t.prototype.unproject=function(t){return this.transform.pointLocation(vt.Point.convert(t))},t.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},t.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},t.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},t.prototype._createDelegatedListener=function(i,r,n){var t,o=this;if("mouseenter"===i||"mouseover"===i){var a=!1;return{layer:r,listener:n,delegates:{mousemove:function(t){var e=o.getLayer(r)?o.queryRenderedFeatures(t.point,{layers:[r]}):[];e.length?a||(a=!0,n.call(o,new Qn(i,o,t.originalEvent,{features:e}))):a=!1},mouseout:function(){a=!1}}}}if("mouseleave"!==i&&"mouseout"!==i)return{layer:r,listener:n,delegates:((t={})[i]=function(t){var e=o.getLayer(r)?o.queryRenderedFeatures(t.point,{layers:[r]}):[];e.length&&(t.features=e,n.call(o,t),delete t.features)},t)};var e=!1;return{layer:r,listener:n,delegates:{mousemove:function(t){(o.getLayer(r)?o.queryRenderedFeatures(t.point,{layers:[r]}):[]).length?e=!0:e&&(e=!1,n.call(o,new Qn(i,o,t.originalEvent)))},mouseout:function(t){e&&(e=!1,n.call(o,new Qn(i,o,t.originalEvent)))}}}},t.prototype.on=function(t,e,i){if(void 0===i)return u.prototype.on.call(this,t,e);var r=this._createDelegatedListener(t,e,i);for(var n in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(r),r.delegates)this.on(n,r.delegates[n]);return this},t.prototype.once=function(t,e,i){if(void 0===i)return u.prototype.once.call(this,t,e);var r=this._createDelegatedListener(t,e,i);for(var n in r.delegates)this.once(n,r.delegates[n]);return this},t.prototype.off=function(o,a,s){var l=this;return void 0===s?u.prototype.off.call(this,o,a):(this._delegatedListeners&&this._delegatedListeners[o]&&function(t){for(var e=t[o],i=0;i<e.length;i++){var r=e[i];if(r.layer===a&&r.listener===s){for(var n in r.delegates)l.off(n,r.delegates[n]);return e.splice(i,1)}}}(this._delegatedListeners),this)},t.prototype.queryRenderedFeatures=function(t,e){if(!this.style)return[];var i;if(void 0!==e||void 0===t||t instanceof vt.Point||Array.isArray(t)||(e=t,t=void 0),e=e||{},(t=t||[[0,0],[this.transform.width,this.transform.height]])instanceof vt.Point||"number"==typeof t[0])i=[vt.Point.convert(t)];else{var r=vt.Point.convert(t[0]),n=vt.Point.convert(t[1]);i=[r,new vt.Point(n.x,r.y),n,new vt.Point(r.x,n.y),r]}return this.style.queryRenderedFeatures(i,e,this.transform)},t.prototype.querySourceFeatures=function(t,e){return this.style.querySourceFeatures(t,e)},t.prototype.setStyle=function(t,e){return!1!==(e=vt.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},e)).diff&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&t?(this._diffStyle(t,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(t,e))},t.prototype._getUIString=function(t){var e=this._locale[t];if(null==e)throw new Error("Missing UI string '"+t+"'");return e},t.prototype._updateStyle=function(t,e){return this.style&&(this.style.setEventedParent(null),this.style._remove()),t?(this.style=new xr(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t):this.style.loadJSON(t)):delete this.style,this},t.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new xr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},t.prototype._diffStyle=function(t,i){var r=this;if("string"==typeof t){var e=this._requestManager.normalizeStyleURL(t),n=this._requestManager.transformRequest(e,vt.ResourceType.Style);vt.getJSON(n,function(t,e){t?r.fire(new vt.ErrorEvent(t)):e&&r._updateDiff(e,i)})}else"object"==typeof t&&this._updateDiff(t,i)},t.prototype._updateDiff=function(e,i){try{this.style.setState(e)&&this._update(!0)}catch(t){vt.warnOnce("Unable to perform style diff: "+(t.message||t.error||t)+".  Rebuilding the style from scratch."),this._updateStyle(e,i)}},t.prototype.getStyle=function(){if(this.style)return this.style.serialize()},t.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():vt.warnOnce("There is no style added to the map.")},t.prototype.addSource=function(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)},t.prototype.isSourceLoaded=function(t){var e=this.style&&this.style.sourceCaches[t];if(void 0!==e)return e.loaded();this.fire(new vt.ErrorEvent(new Error("There is no source with ID '"+t+"'")))},t.prototype.areTilesLoaded=function(){var t=this.style&&this.style.sourceCaches;for(var e in t){var i=t[e]._tiles;for(var r in i){var n=i[r];if("loaded"!==n.state&&"errored"!==n.state)return!1}}return!0},t.prototype.addSourceType=function(t,e,i){return this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,i)},t.prototype.removeSource=function(t){return this.style.removeSource(t),this._update(!0)},t.prototype.getSource=function(t){return this.style.getSource(t)},t.prototype.addImage=function(t,e,i){void 0===i&&(i={});var r=i.pixelRatio;void 0===r&&(r=1);var n=i.sdf;void 0===n&&(n=!1);var o=i.stretchX,a=i.stretchY,s=i.content;if(this._lazyInitEmptyStyle(),e instanceof ra||oa&&e instanceof oa){var l=vt.browser.getImageData(e);this.style.addImage(t,{data:new vt.RGBAImage({width:l.width,height:l.height},l.data),pixelRatio:r,stretchX:o,stretchY:a,content:s,sdf:n,version:0})}else{if(void 0===e.width||void 0===e.height)return this.fire(new vt.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var u=e;this.style.addImage(t,{data:new vt.RGBAImage({width:e.width,height:e.height},new Uint8Array(e.data)),pixelRatio:r,stretchX:o,stretchY:a,content:s,sdf:n,version:0,userImage:u}),u.onAdd&&u.onAdd(this,t)}},t.prototype.updateImage=function(t,e){var i=this.style.getImage(t);if(!i)return this.fire(new vt.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var r=e instanceof ra||oa&&e instanceof oa?vt.browser.getImageData(e):e,n=r.width,o=r.height,a=r.data;return void 0===n||void 0===o?this.fire(new vt.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):n!==i.data.width||o!==i.data.height?this.fire(new vt.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(i.data.replace(a,!(e instanceof ra||oa&&e instanceof oa)),void this.style.updateImage(t,i))},t.prototype.hasImage=function(t){return t?!!this.style.getImage(t):(this.fire(new vt.ErrorEvent(new Error("Missing required image id"))),!1)},t.prototype.removeImage=function(t){this.style.removeImage(t)},t.prototype.loadImage=function(t,e){vt.getImage(this._requestManager.transformRequest(t,vt.ResourceType.Image),e)},t.prototype.listImages=function(){return this.style.listImages()},t.prototype.addLayer=function(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)},t.prototype.moveLayer=function(t,e){return this.style.moveLayer(t,e),this._update(!0)},t.prototype.removeLayer=function(t){return this.style.removeLayer(t),this._update(!0)},t.prototype.getLayer=function(t){return this.style.getLayer(t)},t.prototype.setLayerZoomRange=function(t,e,i){return this.style.setLayerZoomRange(t,e,i),this._update(!0)},t.prototype.setFilter=function(t,e,i){return void 0===i&&(i={}),this.style.setFilter(t,e,i),this._update(!0)},t.prototype.getFilter=function(t){return this.style.getFilter(t)},t.prototype.setPaintProperty=function(t,e,i,r){return void 0===r&&(r={}),this.style.setPaintProperty(t,e,i,r),this._update(!0)},t.prototype.getPaintProperty=function(t,e){return this.style.getPaintProperty(t,e)},t.prototype.setLayoutProperty=function(t,e,i,r){return void 0===r&&(r={}),this.style.setLayoutProperty(t,e,i,r),this._update(!0)},t.prototype.getLayoutProperty=function(t,e){return this.style.getLayoutProperty(t,e)},t.prototype.setLight=function(t,e){return void 0===e&&(e={}),this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)},t.prototype.getLight=function(){return this.style.getLight()},t.prototype.setFeatureState=function(t,e){return this.style.setFeatureState(t,e),this._update()},t.prototype.removeFeatureState=function(t,e){return this.style.removeFeatureState(t,e),this._update()},t.prototype.getFeatureState=function(t){return this.style.getFeatureState(t)},t.prototype.getContainer=function(){return this._container},t.prototype.getCanvasContainer=function(){return this._canvasContainer},t.prototype.getCanvas=function(){return this._canvas},t.prototype._containerDimensions=function(){var t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]},t.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==vt.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&vt.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},t.prototype._setupContainer=function(){var t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=_.create("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();var e=this._canvasContainer=_.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=_.create("canvas","mapboxgl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var i=this._containerDimensions();this._resizeCanvas(i[0],i[1]);var r=this._controlContainer=_.create("div","mapboxgl-control-container",t),n=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(t){n[t]=_.create("div","mapboxgl-ctrl-"+t,r)})},t.prototype._resizeCanvas=function(t,e){var i=vt.browser.devicePixelRatio||1;this._canvas.width=i*t,this._canvas.height=i*e,this._canvas.style.width=t+"px",this._canvas.style.height=e+"px"},t.prototype._setupPainter=function(){var t=vt.extend({},i.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),e=this._canvas.getContext("webgl",t)||this._canvas.getContext("experimental-webgl",t);e?(this.painter=new On(e,this.transform),vt.webpSupported.testSupport(e)):this.fire(new vt.ErrorEvent(new Error("Failed to initialize WebGL")))},t.prototype._contextLost=function(t){t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new vt.Event("webglcontextlost",{originalEvent:t}))},t.prototype._contextRestored=function(t){this._setupPainter(),this.resize(),this._update(),this.fire(new vt.Event("webglcontextrestored",{originalEvent:t}))},t.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},t.prototype._update=function(t){return this.style&&(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint()),this},t.prototype._requestRenderFrame=function(t){return this._update(),this._renderTaskQueue.add(t)},t.prototype._cancelRenderFrame=function(t){this._renderTaskQueue.remove(t)},t.prototype._render=function(t){var e,i=this,r=0,n=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(e=n.createQueryEXT(),n.beginQueryEXT(n.TIME_ELAPSED_EXT,e),r=vt.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(t),!this._removed){var o=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var a=this.transform.zoom,s=vt.browser.now();this.style.zoomHistory.update(a,s);var l=new vt.EvaluationParameters(a,{now:s,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),u=l.crossFadingFactor();1===u&&u===this._crossFadingFactor||(o=!0,this._crossFadingFactor=u),this.style.update(l)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new vt.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new vt.Event("load"))),this.style&&(this.style.hasTransitions()||o)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var c=vt.browser.now()-r;n.endQueryEXT(n.TIME_ELAPSED_EXT,e),setTimeout(function(){var t=n.getQueryObjectEXT(e,n.QUERY_RESULT_EXT)/1e6;n.deleteQueryEXT(e),i.fire(new vt.Event("gpu-timing-frame",{cpuTime:c,gpuTime:t}))},50)}if(this.listens("gpu-timing-layer")){var p=this.painter.collectGpuTimers();setTimeout(function(){var t=i.painter.queryGpuTimers(p);i.fire(new vt.Event("gpu-timing-layer",{layerTimes:t}))},50)}var h=this._sourcesDirty||this._styleDirty||this._placementDirty;return h||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new vt.Event("idle")),!this._loaded||this._fullyLoaded||h||(this._fullyLoaded=!0),this}},t.prototype.remove=function(){this._hash&&this._hash.remove();for(var t=0,e=this._controls;t<e.length;t+=1)e[t].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==vt.window&&(vt.window.removeEventListener("resize",this._onWindowResize,!1),vt.window.removeEventListener("online",this._onWindowOnline,!1));var i=this.painter.context.gl.getExtension("WEBGL_lose_context");i&&i.loseContext(),la(this._canvasContainer),la(this._controlContainer),la(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new vt.Event("remove"))},t.prototype.triggerRepaint=function(){var e=this;this.style&&!this._frame&&(this._frame=vt.browser.frame(function(t){e._frame=null,e._render(t)}))},t.prototype._onWindowOnline=function(){this._update()},t.prototype._onWindowResize=function(t){this._trackResize&&this.resize({originalEvent:t})._update()},e.showTileBoundaries.get=function(){return!!this._showTileBoundaries},e.showTileBoundaries.set=function(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())},e.showPadding.get=function(){return!!this._showPadding},e.showPadding.set=function(t){this._showPadding!==t&&(this._showPadding=t,this._update())},e.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},e.showCollisionBoxes.set=function(t){this._showCollisionBoxes!==t&&((this._showCollisionBoxes=t)?this.style._generateCollisionBoxes():this._update())},e.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},e.showOverdrawInspector.set=function(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())},e.repaint.get=function(){return!!this._repaint},e.repaint.set=function(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())},e.vertices.get=function(){return!!this._vertices},e.vertices.set=function(t){this._vertices=t,this._update()},t.prototype._setCacheLimits=function(t,e){vt.setCacheLimits(t,e)},e.version.get=function(){return vt.version},Object.defineProperties(t.prototype,e),t}(Qo);function la(t){t.parentNode&&t.parentNode.removeChild(t)}function ua(t){var e=this;this.options=vt.extend({},ca,t),this._container=_.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(t){return t.preventDefault()}),this.options.showZoom&&(vt.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(t){return e._map.zoomIn({},{originalEvent:t})}),_.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(t){return e._map.zoomOut({},{originalEvent:t})}),_.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(vt.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(t){e.options.visualizePitch?e._map.resetNorthPitch({},{originalEvent:t}):e._map.resetNorth({},{originalEvent:t})}),this._compassIcon=_.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))}var ca={showCompass:!0,showZoom:!0,visualizePitch:!1};ua.prototype._updateZoomButtons=function(){var t=this._map.getZoom();this._zoomInButton.disabled=t===this._map.getMaxZoom(),this._zoomOutButton.disabled=t===this._map.getMinZoom()},ua.prototype._rotateCompassArrow=function(){var t=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=t},ua.prototype.onAdd=function(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new pa(this._map,this._compass,this.options.visualizePitch)),this._container},ua.prototype.onRemove=function(){_.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ua.prototype._createButton=function(t,e){var i=_.create("button",t,this._container);return i.type="button",i.addEventListener("click",e),i},ua.prototype._setButtonTitle=function(t,e){var i=this._map._getUIString("NavigationControl."+e);t.title=i,t.setAttribute("aria-label",i)};var pa=function(t,e,i){void 0===i&&(i=!1),this._clickTolerance=10,this.element=e,this.mouseRotate=new mo({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,i&&(this.mousePitch=new go({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),vt.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),_.addEventListener(e,"mousedown",this.mousedown),_.addEventListener(e,"touchstart",this.touchstart,{passive:!1}),_.addEventListener(e,"touchmove",this.touchmove),_.addEventListener(e,"touchend",this.touchend),_.addEventListener(e,"touchcancel",this.reset)};function ha(t,e,i){if(t=new vt.LngLat(t.lng,t.lat),e){var r=new vt.LngLat(t.lng-360,t.lat),n=new vt.LngLat(t.lng+360,t.lat),o=i.locationPoint(t).distSqr(e);i.locationPoint(r).distSqr(e)<o?t=r:i.locationPoint(n).distSqr(e)<o&&(t=n)}for(;180<Math.abs(t.lng-i.center.lng);){var a=i.locationPoint(t);if(0<=a.x&&0<=a.y&&a.x<=i.width&&a.y<=i.height)break;t.lng>i.center.lng?t.lng-=360:t.lng+=360}return t}pa.prototype.down=function(t,e){this.mouseRotate.mousedown(t,e),this.mousePitch&&this.mousePitch.mousedown(t,e),_.disableDrag()},pa.prototype.move=function(t,e){var i=this.map,r=this.mouseRotate.mousemoveWindow(t,e);if(r&&r.bearingDelta&&i.setBearing(i.getBearing()+r.bearingDelta),this.mousePitch){var n=this.mousePitch.mousemoveWindow(t,e);n&&n.pitchDelta&&i.setPitch(i.getPitch()+n.pitchDelta)}},pa.prototype.off=function(){var t=this.element;_.removeEventListener(t,"mousedown",this.mousedown),_.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),_.removeEventListener(t,"touchmove",this.touchmove),_.removeEventListener(t,"touchend",this.touchend),_.removeEventListener(t,"touchcancel",this.reset),this.offTemp()},pa.prototype.offTemp=function(){_.enableDrag(),_.removeEventListener(vt.window,"mousemove",this.mousemove),_.removeEventListener(vt.window,"mouseup",this.mouseup)},pa.prototype.mousedown=function(t){this.down(vt.extend({},t,{ctrlKey:!0,preventDefault:function(){return t.preventDefault()}}),_.mousePos(this.element,t)),_.addEventListener(vt.window,"mousemove",this.mousemove),_.addEventListener(vt.window,"mouseup",this.mouseup)},pa.prototype.mousemove=function(t){this.move(t,_.mousePos(this.element,t))},pa.prototype.mouseup=function(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()},pa.prototype.touchstart=function(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=_.touchPos(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return t.preventDefault()}},this._startPos))},pa.prototype.touchmove=function(t){1!==t.targetTouches.length?this.reset():(this._lastPos=_.touchPos(this.element,t.targetTouches)[0],this.move({preventDefault:function(){return t.preventDefault()}},this._lastPos))},pa.prototype.touchend=function(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},pa.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var da={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function fa(t,e,i){var r=t.classList;for(var n in da)r.remove("mapboxgl-"+i+"-anchor-"+n);r.add("mapboxgl-"+i+"-anchor-"+e)}function ma(t){this.options=vt.extend({},Ta,t),vt.bindAll(["_onMove","setUnit"],this)}var ga,ya,va,_a=((va=vt.Evented)&&(Ea.__proto__=va),((Ea.prototype=Object.create(va&&va.prototype)).constructor=Ea).prototype.addTo=function(t){return this.remove(),(this._map=t).getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},Ea.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),_.remove(this._element),this._popup&&this._popup.remove(),this},Ea.prototype.getLngLat=function(){return this._lngLat},Ea.prototype.setLngLat=function(t){return this._lngLat=vt.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},Ea.prototype.getElement=function(){return this._element},Ea.prototype.setPopup=function(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){var e=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[e,-1*(24.6+e)],"bottom-right":[-e,-1*(24.6+e)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},Ea.prototype._onKeyPress=function(t){var e=t.code,i=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==i&&13!==i||this.togglePopup()},Ea.prototype._onMapClick=function(t){var e=t.originalEvent.target,i=this._element;this._popup&&(e===i||i.contains(e))&&this.togglePopup()},Ea.prototype.getPopup=function(){return this._popup},Ea.prototype.togglePopup=function(){var t=this._popup;return t&&(t.isOpen()?t.remove():t.addTo(this._map)),this},Ea.prototype._update=function(t){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=ha(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var e="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?e="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(e="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var i="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?i="rotateX(0deg)":"map"===this._pitchAlignment&&(i="rotateX("+this._map.getPitch()+"deg)"),t&&"moveend"!==t.type||(this._pos=this._pos.round()),_.setTransform(this._element,da[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+i+" "+e)}},Ea.prototype.getOffset=function(){return this._offset},Ea.prototype.setOffset=function(t){return this._offset=vt.Point.convert(t),this._update(),this},Ea.prototype._onMove=function(t){this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new vt.Event("dragstart"))),this.fire(new vt.Event("drag"))},Ea.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new vt.Event("dragend")),this._state="inactive"},Ea.prototype._addDragHandler=function(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},Ea.prototype.setDraggable=function(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},Ea.prototype.isDraggable=function(){return this._draggable},Ea.prototype.setRotation=function(t){return this._rotation=t||0,this._update(),this},Ea.prototype.getRotation=function(){return this._rotation},Ea.prototype.setRotationAlignment=function(t){return this._rotationAlignment=t||"auto",this._update(),this},Ea.prototype.getRotationAlignment=function(){return this._rotationAlignment},Ea.prototype.setPitchAlignment=function(t){return this._pitchAlignment=t&&"auto"!==t?t:this._rotationAlignment,this._update(),this},Ea.prototype.getPitchAlignment=function(){return this._pitchAlignment},Ea),xa={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},ba=0,wa=!1,Sa=((ya=vt.Evented)&&(Ia.__proto__=ya),((Ia.prototype=Object.create(ya&&ya.prototype)).constructor=Ia).prototype.onAdd=function(t){var e;return this._map=t,this._container=_.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),e=this._setupUI,void 0!==ga?e(ga):void 0!==vt.window.navigator.permissions?vt.window.navigator.permissions.query({name:"geolocation"}).then(function(t){e(ga="denied"!==t.state)}):e(ga=!!vt.window.navigator.geolocation),this._container},Ia.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(vt.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),_.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ba=0,wa=!1},Ia.prototype._isOutOfMapMaxBounds=function(t){var e=this._map.getMaxBounds(),i=t.coords;return e&&(i.longitude<e.getWest()||i.longitude>e.getEast()||i.latitude<e.getSouth()||i.latitude>e.getNorth())},Ia.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},Ia.prototype._onSuccess=function(t){if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new vt.Event("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new vt.Event("geolocate",t)),this._finish()}},Ia.prototype._updateCamera=function(t){var e=new vt.LngLat(t.coords.longitude,t.coords.latitude),i=t.coords.accuracy,r=this._map.getBearing(),n=vt.extend({bearing:r},this.options.fitBoundsOptions);this._map.fitBounds(e.toBounds(i),n,{geolocateSource:!0})},Ia.prototype._updateMarker=function(t){if(t){var e=new vt.LngLat(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(e).addTo(this._map),this._userLocationDotMarker.setLngLat(e).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},Ia.prototype._updateCircleRadius=function(){var t=this._map._container.clientHeight/2,e=this._map.unproject([0,t]),i=this._map.unproject([1,t]),r=e.distanceTo(i),n=Math.ceil(2*this._accuracy/r);this._circleElement.style.width=n+"px",this._circleElement.style.height=n+"px"},Ia.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},Ia.prototype._onError=function(t){if(this._map){if(this.options.trackUserLocation)if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&wa)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new vt.Event("error",t)),this._finish()}},Ia.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},Ia.prototype._setupUI=function(t){var e=this;if(this._container.addEventListener("contextmenu",function(t){return t.preventDefault()}),this._geolocateButton=_.create("button","mapboxgl-ctrl-geolocate",this._container),_.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),!(this._geolocateButton.type="button")===t){vt.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}else{var r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=_.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new _a(this._dotElement),this._circleElement=_.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new _a({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(t){t.geolocateSource||"ACTIVE_LOCK"!==e._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(e._watchState="BACKGROUND",e._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),e._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),e.fire(new vt.Event("trackuserlocationend")))})},Ia.prototype.trigger=function(){if(!this._setup)return vt.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new vt.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ba--,wa=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new vt.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new vt.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var t;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),wa=1<++ba?(t={maximumAge:6e5,timeout:0},!0):(t=this.options.positionOptions,!1),this._geolocationWatchID=vt.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,t)}}else vt.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},Ia.prototype._clearWatch=function(){vt.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},Ia),Ta={maxWidth:100,unit:"metric"};function Ia(t){ya.call(this),this.options=vt.extend({},xa,t),vt.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}function Ea(t,e){var i=this;if(va.call(this),(t instanceof vt.window.HTMLElement||e)&&(t=vt.extend({element:t},e)),vt.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&"auto"!==t.pitchAlignment?t.pitchAlignment:this._rotationAlignment,t&&t.element)this._element=t.element,this._offset=vt.Point.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=_.create("div"),this._element.setAttribute("aria-label","Map marker");var r=_.createNS("http://www.w3.org/2000/svg","svg");r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height","41px"),r.setAttributeNS(null,"width","27px"),r.setAttributeNS(null,"viewBox","0 0 27 41");var n=_.createNS("http://www.w3.org/2000/svg","g");n.setAttributeNS(null,"stroke","none"),n.setAttributeNS(null,"stroke-width","1"),n.setAttributeNS(null,"fill","none"),n.setAttributeNS(null,"fill-rule","evenodd");var o=_.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"fill-rule","nonzero");var a=_.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"transform","translate(3.0, 29.0)"),a.setAttributeNS(null,"fill","#000000");for(var s=0,l=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];s<l.length;s+=1){var u=l[s],c=_.createNS("http://www.w3.org/2000/svg","ellipse");c.setAttributeNS(null,"opacity","0.04"),c.setAttributeNS(null,"cx","10.5"),c.setAttributeNS(null,"cy","5.80029008"),c.setAttributeNS(null,"rx",u.rx),c.setAttributeNS(null,"ry",u.ry),a.appendChild(c)}var p=_.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"fill",this._color);var h=_.createNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),p.appendChild(h);var d=_.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"opacity","0.25"),d.setAttributeNS(null,"fill","#000000");var f=_.createNS("http://www.w3.org/2000/svg","path");f.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),d.appendChild(f);var m=_.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(6.0, 7.0)"),m.setAttributeNS(null,"fill","#FFFFFF");var g=_.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"transform","translate(8.0, 8.0)");var y=_.createNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"fill","#000000"),y.setAttributeNS(null,"opacity","0.25"),y.setAttributeNS(null,"cx","5.5"),y.setAttributeNS(null,"cy","5.5"),y.setAttributeNS(null,"r","5.4999962");var v=_.createNS("http://www.w3.org/2000/svg","circle");v.setAttributeNS(null,"fill","#FFFFFF"),v.setAttributeNS(null,"cx","5.5"),v.setAttributeNS(null,"cy","5.5"),v.setAttributeNS(null,"r","5.4999962"),g.appendChild(y),g.appendChild(v),o.appendChild(a),o.appendChild(p),o.appendChild(d),o.appendChild(m),o.appendChild(g),r.appendChild(o),r.setAttributeNS(null,"height",41*this._scale+"px"),r.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(r),this._offset=vt.Point.convert(t&&t.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(t){t.preventDefault()}),this._element.addEventListener("mousedown",function(t){t.preventDefault()}),this._element.addEventListener("focus",function(){var t=i._map.getContainer();t.scrollTop=0,t.scrollLeft=0}),fa(this._element,this._anchor,"marker"),this._popup=null}function Ca(t,e,i){var r=i&&i.maxWidth||100,n=t._container.clientHeight/2,o=t.unproject([0,n]),a=t.unproject([r,n]),s=o.distanceTo(a);if(i&&"imperial"===i.unit){var l=3.2808*s;5280<l?Aa(e,r,l/5280,t._getUIString("ScaleControl.Miles")):Aa(e,r,l,t._getUIString("ScaleControl.Feet"))}else i&&"nautical"===i.unit?Aa(e,r,s/1852,t._getUIString("ScaleControl.NauticalMiles")):1e3<=s?Aa(e,r,s/1e3,t._getUIString("ScaleControl.Kilometers")):Aa(e,r,s,t._getUIString("ScaleControl.Meters"))}function Aa(t,e,i,r){var n,o,a,s,l,u=(n=i,(o=Math.pow(10,(""+Math.floor(n)).length-1))*(a=10<=(a=n/o)?10:5<=a?5:3<=a?3:2<=a?2:1<=a?1:(s=a,l=Math.pow(10,Math.ceil(-Math.log(s)/Math.LN10)),Math.round(s*l)/l)));t.style.width=e*(u/i)+"px",t.innerHTML=u+"&nbsp;"+r}function ka(t){this._fullscreen=!1,t&&t.container&&(t.container instanceof vt.window.HTMLElement?this._container=t.container:vt.warnOnce("Full screen control 'container' must be a DOM element.")),vt.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in vt.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in vt.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in vt.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in vt.window.document&&(this._fullscreenchange="MSFullscreenChange")}ma.prototype.getDefaultPosition=function(){return"bottom-left"},ma.prototype._onMove=function(){Ca(this._map,this._container,this.options)},ma.prototype.onAdd=function(t){return this._map=t,this._container=_.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},ma.prototype.onRemove=function(){_.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},ma.prototype.setUnit=function(t){this.options.unit=t,Ca(this._map,this._container,this.options)},ka.prototype.onAdd=function(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=_.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",vt.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},ka.prototype.onRemove=function(){_.remove(this._controlContainer),this._map=null,vt.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},ka.prototype._checkFullscreenSupport=function(){return!!(vt.window.document.fullscreenEnabled||vt.window.document.mozFullScreenEnabled||vt.window.document.msFullscreenEnabled||vt.window.document.webkitFullscreenEnabled)},ka.prototype._setupUI=function(){var t=this._fullscreenButton=_.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);_.create("span","mapboxgl-ctrl-icon",t).setAttribute("aria-hidden",!0),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),vt.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},ka.prototype._updateTitle=function(){var t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.title=t},ka.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},ka.prototype._isFullscreen=function(){return this._fullscreen},ka.prototype._changeIcon=function(){(vt.window.document.fullscreenElement||vt.window.document.mozFullScreenElement||vt.window.document.webkitFullscreenElement||vt.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},ka.prototype._onClickFullscreen=function(){this._isFullscreen()?vt.window.document.exitFullscreen?vt.window.document.exitFullscreen():vt.window.document.mozCancelFullScreen?vt.window.document.mozCancelFullScreen():vt.window.document.msExitFullscreen?vt.window.document.msExitFullscreen():vt.window.document.webkitCancelFullScreen&&vt.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Pa,Ma={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},La=((Pa=vt.Evented)&&(za.__proto__=Pa),((za.prototype=Object.create(Pa&&Pa.prototype)).constructor=za).prototype.addTo=function(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new vt.Event("open")),this},za.prototype.isOpen=function(){return!!this._map},za.prototype.remove=function(){return this._content&&_.remove(this._content),this._container&&(_.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new vt.Event("close")),this},za.prototype.getLngLat=function(){return this._lngLat},za.prototype.setLngLat=function(t){return this._lngLat=vt.LngLat.convert(t),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},za.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},za.prototype.getElement=function(){return this._container},za.prototype.setText=function(t){return this.setDOMContent(vt.window.document.createTextNode(t))},za.prototype.setHTML=function(t){var e,i=vt.window.document.createDocumentFragment(),r=vt.window.document.createElement("body");for(r.innerHTML=t;e=r.firstChild;)i.appendChild(e);return this.setDOMContent(i)},za.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},za.prototype.setMaxWidth=function(t){return this.options.maxWidth=t,this._update(),this},za.prototype.setDOMContent=function(t){return this._createContent(),this._content.appendChild(t),this._update(),this},za.prototype.addClassName=function(t){this._container&&this._container.classList.add(t)},za.prototype.removeClassName=function(t){this._container&&this._container.classList.remove(t)},za.prototype.toggleClassName=function(t){if(this._container)return this._container.classList.toggle(t)},za.prototype._createContent=function(){this._content&&_.remove(this._content),this._content=_.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=_.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},za.prototype._onMouseUp=function(t){this._update(t.point)},za.prototype._onMouseMove=function(t){this._update(t.point)},za.prototype._onDrag=function(t){this._update(t.point)},za.prototype._update=function(t){var e=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=_.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=_.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(t){return e._container.classList.add(t)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ha(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||t)){var i=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat),r=this.options.anchor,n=function t(e){if(e){if("number"==typeof e){var i=Math.round(Math.sqrt(.5*Math.pow(e,2)));return{center:new vt.Point(0,0),top:new vt.Point(0,e),"top-left":new vt.Point(i,i),"top-right":new vt.Point(-i,i),bottom:new vt.Point(0,-e),"bottom-left":new vt.Point(i,-i),"bottom-right":new vt.Point(-i,-i),left:new vt.Point(e,0),right:new vt.Point(-e,0)}}if(e instanceof vt.Point||Array.isArray(e)){var r=vt.Point.convert(e);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:vt.Point.convert(e.center||[0,0]),top:vt.Point.convert(e.top||[0,0]),"top-left":vt.Point.convert(e["top-left"]||[0,0]),"top-right":vt.Point.convert(e["top-right"]||[0,0]),bottom:vt.Point.convert(e.bottom||[0,0]),"bottom-left":vt.Point.convert(e["bottom-left"]||[0,0]),"bottom-right":vt.Point.convert(e["bottom-right"]||[0,0]),left:vt.Point.convert(e.left||[0,0]),right:vt.Point.convert(e.right||[0,0])}}return t(new vt.Point(0,0))}(this.options.offset);if(!r){var o,a=this._container.offsetWidth,s=this._container.offsetHeight;o=i.y+n.bottom.y<s?["top"]:i.y>this._map.transform.height-s?["bottom"]:[],i.x<a/2?o.push("left"):i.x>this._map.transform.width-a/2&&o.push("right"),r=0===o.length?"bottom":o.join("-")}var l=i.add(n[r]).round();_.setTransform(this._container,da[r]+" translate("+l.x+"px,"+l.y+"px)"),fa(this._container,r,"popup")}},za.prototype._onClose=function(){this.remove()},za),Da={version:vt.version,supported:i,setRTLTextPlugin:vt.setRTLTextPlugin,getRTLTextPluginStatus:vt.getRTLTextPluginStatus,Map:sa,NavigationControl:ua,GeolocateControl:Sa,AttributionControl:Yo,ScaleControl:ma,FullscreenControl:ka,Popup:La,Marker:_a,Style:xr,LngLat:vt.LngLat,LngLatBounds:vt.LngLatBounds,Point:vt.Point,MercatorCoordinate:vt.MercatorCoordinate,Evented:vt.Evented,config:vt.config,prewarm:function(){gi().acquire(hi)},clearPrewarmedResources:function(){var t=fi;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(hi),fi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return vt.config.ACCESS_TOKEN},set accessToken(t){vt.config.ACCESS_TOKEN=t},get baseApiUrl(){return vt.config.API_URL},set baseApiUrl(t){vt.config.API_URL=t},get workerCount(){return di.workerCount},set workerCount(t){di.workerCount=t},get maxParallelImageRequests(){return vt.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){vt.config.MAX_PARALLEL_IMAGE_REQUESTS=t},clearStorage:function(t){vt.clearTileCache(t)},workerUrl:""};function za(t){Pa.call(this),this.options=vt.extend(Object.create(Ma),t),vt.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return Da}),a)}),i=(h.Map,h.setRTLTextPlugin),r=(h.supported,h.Marker),n="atlas.microsoft.com",o="atlas.microsoft.com",a="styles/definitions/2019-10-16.json",s="e96cb745-c6f5-409c-a775-c4313e468c1d",l="https://login.microsoftonline.com/",u="Authorization",c="Bearer ",d="{azMapsDomain}",f="Map-Agent",m="x-ms-client-id",g="Ms-Am-Request-Origin",y="MapControl",v="https://atlas.microsoft.com/",_="Session-Id",x=function(t,e){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function b(t,e){function i(){this.constructor=t}x(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var w=function(){return(w=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function S(o,a,s,l){return new(s=s||Promise)(function(t,e){function i(t){try{n(l.next(t))}catch(t){e(t)}}function r(t){try{n(l.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(i,r)}n((l=l.apply(o,a||[])).next())})}function T(i,r){var n,o,a,t,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(a=2&e[0]?o.return:e[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,e[1])).done)return a;switch(o=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,o=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){s.label=e[1];break}if(6===e[0]&&s.label<a[1]){s.label=a[1],a=e;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(e);break}a[2]&&s.ops.pop(),s.trys.pop();continue}e=r.call(i,s)}catch(t){e=[6,t],o=0}finally{n=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}var I=(E.prototype.merge=function(){for(var t,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];for(var r=0,n=e;r<n.length;r++){var o=n[r];if(o)for(var a in o)o.hasOwnProperty(a)&&this.hasOwnProperty(a)&&(void 0!==o[a]&&null!=o[a]?this[a]instanceof E?this[a].merge(o[a]):this[a]=o[a]:(t=t||new(Object.getPrototypeOf(this).constructor),this[a]=t[a]))}return this},E);function E(){}var C,A=(b(k,C=I),k);function k(){var t=null!==C&&C.apply(this,arguments)||this;return t.domain=void 0,t.headers={},t.path="",t.protocol="https",t.queryParams={},t.subdomain="",t}var P=(M.prototype.get=function(){return fetch(this.toString(),{method:"GET",mode:"cors",headers:new Headers(this.options.headers)}).then(function(t){if(t.ok)return t.json();throw new Error("HTTP "+t.status+": "+t.statusText)})},M.prototype.toString=function(){var t=Object.entries(this.options.queryParams).map(function(t){return t[0]+"="+t[1]}).join("&"),e=[];return M.protoRegEx.test(this.options.domain)||(e.push(this.options.protocol+"://"),e.push(this.options.subdomain?this.options.subdomain+".":"")),e.push(this.options.domain),e.push(this.options.path?"/"+this.options.path:""),e.push(t?"?"+t:""),e.join("")},M.protoRegEx=new RegExp(/^\w+:\/\//),M);function M(t){this.options=(new A).merge(t)}var L,D="2.0.28",z=(O.getFullVersion=function(){return D},O.getEndpointVersion=function(){var t=D.indexOf(".");return-1===(t=D.indexOf(".",t+1))?D:D.substring(0,t)},O);function O(){}(L=p.ControlPosition||(p.ControlPosition={})).TopLeft="top-left",L.TopRight="top-right",L.BottomLeft="bottom-left",L.BottomRight="bottom-right",L.NonFixed="non-fixed";var R,N=(b(B,R=I),B);function B(){var t=null!==R&&R.apply(this,arguments)||this;return t.position=p.ControlPosition.NonFixed,t}var F={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},U=e(function(t){var a=Array.prototype.concat,s=Array.prototype.slice,e=t.exports=function(t){for(var e,i=[],r=0,n=t.length;r<n;r++){var o=t[r];(e=o)&&"string"!=typeof e&&(e instanceof Array||Array.isArray(e)||0<=e.length&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))?i=a.call(i,s.call(o)):i.push(o)}return i};e.wrap=function(t){return function(){return t(e(arguments))}}}),j=e(function(t){var e={};for(var i in F)F.hasOwnProperty(i)&&(e[F[i]]=i);var r=t.exports={to:{},get:{}};function a(t,e,i){return Math.min(Math.max(e,t),i)}function n(t){var e=t.toString(16).toUpperCase();return e.length<2?"0"+e:e}r.get=function(t){var e,i;switch(t.substring(0,3).toLowerCase()){case"hsl":e=r.get.hsl(t),i="hsl";break;case"hwb":e=r.get.hwb(t),i="hwb";break;default:e=r.get.rgb(t),i="rgb"}return e?{model:i,value:e}:null},r.get.rgb=function(t){if(!t)return null;var e,i,r,n=[0,0,0,1];if(e=t.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(r=e[2],e=e[1],i=0;i<3;i++){var o=2*i;n[i]=parseInt(e.slice(o,2+o),16)}r&&(n[3]=Math.round(parseInt(r,16)/255*100)/100)}else if(e=t.match(/^#([a-f0-9]{3,4})$/i)){for(r=(e=e[1])[3],i=0;i<3;i++)n[i]=parseInt(e[i]+e[i],16);r&&(n[3]=Math.round(parseInt(r+r,16)/255*100)/100)}else if(e=t.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){for(i=0;i<3;i++)n[i]=parseInt(e[i+1],0);e[4]&&(n[3]=parseFloat(e[4]))}else{if(!(e=t.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)))return(e=t.match(/(\D+)/))?"transparent"===e[1]?[0,0,0,0]:(n=F[e[1]])?(n[3]=1,n):null:null;for(i=0;i<3;i++)n[i]=Math.round(2.55*parseFloat(e[i+1]));e[4]&&(n[3]=parseFloat(e[4]))}for(i=0;i<3;i++)n[i]=a(n[i],0,255);return n[3]=a(n[3],0,1),n},r.get.hsl=function(t){if(!t)return null;var e=t.match(/^hsla?\(\s*([+-]?(?:\d*\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(e){var i=parseFloat(e[4]);return[(parseFloat(e[1])+360)%360,a(parseFloat(e[2]),0,100),a(parseFloat(e[3]),0,100),a(isNaN(i)?1:i,0,1)]}return null},r.get.hwb=function(t){if(!t)return null;var e=t.match(/^hwb\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(e){var i=parseFloat(e[4]);return[(parseFloat(e[1])%360+360)%360,a(parseFloat(e[2]),0,100),a(parseFloat(e[3]),0,100),a(isNaN(i)?1:i,0,1)]}return null},r.to.hex=function(){var t=U(arguments);return"#"+n(t[0])+n(t[1])+n(t[2])+(t[3]<1?n(Math.round(255*t[3])):"")},r.to.rgb=function(){var t=U(arguments);return t.length<4||1===t[3]?"rgb("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+")":"rgba("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+", "+t[3]+")"},r.to.rgb.percent=function(){var t=U(arguments),e=Math.round(t[0]/255*100),i=Math.round(t[1]/255*100),r=Math.round(t[2]/255*100);return t.length<4||1===t[3]?"rgb("+e+"%, "+i+"%, "+r+"%)":"rgba("+e+"%, "+i+"%, "+r+"%, "+t[3]+")"},r.to.hsl=function(){var t=U(arguments);return t.length<4||1===t[3]?"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)":"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+t[3]+")"},r.to.hwb=function(){var t=U(arguments),e="";return 4<=t.length&&1!==t[3]&&(e=", "+t[3]),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+e+")"},r.to.keyword=function(t){return e[t.slice(0,3)]}}),q=(j.to,j.get,e(function(t){var u={};for(var e in F)F.hasOwnProperty(e)&&(u[F[e]]=e);var a=t.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var i in a)if(a.hasOwnProperty(i)){if(!("channels"in a[i]))throw new Error("missing channels property: "+i);if(!("labels"in a[i]))throw new Error("missing channel labels property: "+i);if(a[i].labels.length!==a[i].channels)throw new Error("channel and label counts mismatch: "+i);var r=a[i].channels,n=a[i].labels;delete a[i].channels,delete a[i].labels,Object.defineProperty(a[i],"channels",{value:r}),Object.defineProperty(a[i],"labels",{value:n})}a.rgb.hsl=function(t){var e,i,r=t[0]/255,n=t[1]/255,o=t[2]/255,a=Math.min(r,n,o),s=Math.max(r,n,o),l=s-a;return s===a?e=0:r===s?e=(n-o)/l:n===s?e=2+(o-r)/l:o===s&&(e=4+(r-n)/l),(e=Math.min(60*e,360))<0&&(e+=360),i=(a+s)/2,[e,100*(s===a?0:i<=.5?l/(s+a):l/(2-s-a)),100*i]},a.rgb.hsv=function(t){function e(t){return(c-t)/6/p+.5}var i,r,n,o,a,s=t[0]/255,l=t[1]/255,u=t[2]/255,c=Math.max(s,l,u),p=c-Math.min(s,l,u);return 0==p?o=a=0:(a=p/c,i=e(s),r=e(l),n=e(u),s===c?o=n-r:l===c?o=1/3+i-n:u===c&&(o=2/3+r-i),o<0?o+=1:1<o&&--o),[360*o,100*a,100*c]},a.rgb.hwb=function(t){var e=t[0],i=t[1],r=t[2];return[a.rgb.hsl(t)[0],100*(1/255*Math.min(e,Math.min(i,r))),100*(r=1-1/255*Math.max(e,Math.max(i,r)))]},a.rgb.cmyk=function(t){var e,i=t[0]/255,r=t[1]/255,n=t[2]/255;return[100*((1-i-(e=Math.min(1-i,1-r,1-n)))/(1-e)||0),100*((1-r-e)/(1-e)||0),100*((1-n-e)/(1-e)||0),100*e]},a.rgb.keyword=function(t){var e=u[t];if(e)return e;var i,r,n,o=1/0;for(var a in F)if(F.hasOwnProperty(a)){var s=F[a],l=(r=t,n=s,Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2)+Math.pow(r[2]-n[2],2));l<o&&(o=l,i=a)}return i},a.keyword.rgb=function(t){return F[t]},a.rgb.xyz=function(t){var e=t[0]/255,i=t[1]/255,r=t[2]/255;return[100*(.4124*(e=.04045<e?Math.pow((e+.055)/1.055,2.4):e/12.92)+.3576*(i=.04045<i?Math.pow((i+.055)/1.055,2.4):i/12.92)+.1805*(r=.04045<r?Math.pow((r+.055)/1.055,2.4):r/12.92)),100*(.2126*e+.7152*i+.0722*r),100*(.0193*e+.1192*i+.9505*r)]},a.rgb.lab=function(t){var e=a.rgb.xyz(t),i=e[0],r=e[1],n=e[2];return r/=100,n/=108.883,i=.008856<(i/=95.047)?Math.pow(i,1/3):7.787*i+16/116,[116*(r=.008856<r?Math.pow(r,1/3):7.787*r+16/116)-16,500*(i-r),200*(r-(n=.008856<n?Math.pow(n,1/3):7.787*n+16/116))]},a.hsl.rgb=function(t){var e,i,r,n,o,a=t[0]/360,s=t[1]/100,l=t[2]/100;if(0==s)return[o=255*l,o,o];e=2*l-(i=l<.5?l*(1+s):l+s-l*s),n=[0,0,0];for(var u=0;u<3;u++)(r=a+1/3*-(u-1))<0&&r++,1<r&&r--,o=6*r<1?e+6*(i-e)*r:2*r<1?i:3*r<2?e+(i-e)*(2/3-r)*6:e,n[u]=255*o;return n},a.hsl.hsv=function(t){var e=t[0],i=t[1]/100,r=t[2]/100,n=i,o=Math.max(r,.01);return i*=(r*=2)<=1?r:2-r,n*=o<=1?o:2-o,[e,100*(0===r?2*n/(o+n):2*i/(r+i)),100*((r+i)/2)]},a.hsv.rgb=function(t){var e=t[0]/60,i=t[1]/100,r=t[2]/100,n=Math.floor(e)%6,o=e-Math.floor(e),a=255*r*(1-i),s=255*r*(1-i*o),l=255*r*(1-i*(1-o));switch(r*=255,n){case 0:return[r,l,a];case 1:return[s,r,a];case 2:return[a,r,l];case 3:return[a,s,r];case 4:return[l,a,r];case 5:return[r,a,s]}},a.hsv.hsl=function(t){var e,i,r,n=t[0],o=t[1]/100,a=t[2]/100,s=Math.max(a,.01);return r=(2-o)*a,i=o*s,[n,100*(i=(i/=(e=(2-o)*s)<=1?e:2-e)||0),100*(r/=2)]},a.hwb.rgb=function(t){var e,i,r,n,o,a,s,l=t[0]/360,u=t[1]/100,c=t[2]/100,p=u+c;switch(1<p&&(u/=p,c/=p),r=6*l-(e=Math.floor(6*l)),0!=(1&e)&&(r=1-r),n=u+r*((i=1-c)-u),e){default:case 6:case 0:o=i,a=n,s=u;break;case 1:o=n,a=i,s=u;break;case 2:o=u,a=i,s=n;break;case 3:o=u,a=n,s=i;break;case 4:o=n,a=u,s=i;break;case 5:o=i,a=u,s=n}return[255*o,255*a,255*s]},a.cmyk.rgb=function(t){var e=t[0]/100,i=t[1]/100,r=t[2]/100,n=t[3]/100;return[255*(1-Math.min(1,e*(1-n)+n)),255*(1-Math.min(1,i*(1-n)+n)),255*(1-Math.min(1,r*(1-n)+n))]},a.xyz.rgb=function(t){var e,i,r,n=t[0]/100,o=t[1]/100,a=t[2]/100;return i=-.9689*n+1.8758*o+.0415*a,r=.0557*n+-.204*o+1.057*a,e=.0031308<(e=3.2406*n+-1.5372*o+-.4986*a)?1.055*Math.pow(e,1/2.4)-.055:12.92*e,i=.0031308<i?1.055*Math.pow(i,1/2.4)-.055:12.92*i,r=.0031308<r?1.055*Math.pow(r,1/2.4)-.055:12.92*r,[255*(e=Math.min(Math.max(0,e),1)),255*(i=Math.min(Math.max(0,i),1)),255*(r=Math.min(Math.max(0,r),1))]},a.xyz.lab=function(t){var e=t[0],i=t[1],r=t[2];return i/=100,r/=108.883,e=.008856<(e/=95.047)?Math.pow(e,1/3):7.787*e+16/116,[116*(i=.008856<i?Math.pow(i,1/3):7.787*i+16/116)-16,500*(e-i),200*(i-(r=.008856<r?Math.pow(r,1/3):7.787*r+16/116))]},a.lab.xyz=function(t){var e,i,r,n=t[0];e=t[1]/500+(i=(n+16)/116),r=i-t[2]/200;var o=Math.pow(i,3),a=Math.pow(e,3),s=Math.pow(r,3);return i=.008856<o?o:(i-16/116)/7.787,e=.008856<a?a:(e-16/116)/7.787,r=.008856<s?s:(r-16/116)/7.787,[e*=95.047,i*=100,r*=108.883]},a.lab.lch=function(t){var e,i=t[0],r=t[1],n=t[2];return(e=360*Math.atan2(n,r)/2/Math.PI)<0&&(e+=360),[i,Math.sqrt(r*r+n*n),e]},a.lch.lab=function(t){var e,i=t[0],r=t[1];return e=t[2]/360*2*Math.PI,[i,r*Math.cos(e),r*Math.sin(e)]},a.rgb.ansi16=function(t){var e=t[0],i=t[1],r=t[2],n=1 in arguments?arguments[1]:a.rgb.hsv(t)[2];if(0===(n=Math.round(n/50)))return 30;var o=30+(Math.round(r/255)<<2|Math.round(i/255)<<1|Math.round(e/255));return 2===n&&(o+=60),o},a.hsv.ansi16=function(t){return a.rgb.ansi16(a.hsv.rgb(t),t[2])},a.rgb.ansi256=function(t){var e=t[0],i=t[1],r=t[2];return e===i&&i===r?e<8?16:248<e?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(i/255*5)+Math.round(r/255*5)},a.ansi16.rgb=function(t){var e=t%10;if(0===e||7===e)return 50<t&&(e+=3.5),[e=e/10.5*255,e,e];var i=.5*(1+~~(50<t));return[(1&e)*i*255,(e>>1&1)*i*255,(e>>2&1)*i*255]},a.ansi256.rgb=function(t){if(232<=t){var e=10*(t-232)+8;return[e,e,e]}var i;return t-=16,[Math.floor(t/36)/5*255,Math.floor((i=t%36)/6)/5*255,i%6/5*255]},a.rgb.hex=function(t){var e=(((255&Math.round(t[0]))<<16)+((255&Math.round(t[1]))<<8)+(255&Math.round(t[2]))).toString(16).toUpperCase();return"000000".substring(e.length)+e},a.hex.rgb=function(t){var e=t.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];var i=e[0];3===e[0].length&&(i=i.split("").map(function(t){return t+t}).join(""));var r=parseInt(i,16);return[r>>16&255,r>>8&255,255&r]},a.rgb.hcg=function(t){var e,i=t[0]/255,r=t[1]/255,n=t[2]/255,o=Math.max(Math.max(i,r),n),a=Math.min(Math.min(i,r),n),s=o-a;return e=s<=0?0:o===i?(r-n)/s%6:o===r?2+(n-i)/s:4+(i-r)/s+4,e/=6,[360*(e%=1),100*s,100*(s<1?a/(1-s):0)]},a.hsl.hcg=function(t){var e=t[1]/100,i=t[2]/100,r=1,n=0;return(r=i<.5?2*e*i:2*e*(1-i))<1&&(n=(i-.5*r)/(1-r)),[t[0],100*r,100*n]},a.hsv.hcg=function(t){var e=t[1]/100,i=t[2]/100,r=e*i,n=0;return r<1&&(n=(i-r)/(1-r)),[t[0],100*r,100*n]},a.hcg.rgb=function(t){var e=t[0]/360,i=t[1]/100,r=t[2]/100;if(0==i)return[255*r,255*r,255*r];var n,o=[0,0,0],a=e%1*6,s=a%1,l=1-s;switch(Math.floor(a)){case 0:o[0]=1,o[1]=s,o[2]=0;break;case 1:o[0]=l,o[1]=1,o[2]=0;break;case 2:o[0]=0,o[1]=1,o[2]=s;break;case 3:o[0]=0,o[1]=l,o[2]=1;break;case 4:o[0]=s,o[1]=0,o[2]=1;break;default:o[0]=1,o[1]=0,o[2]=l}return n=(1-i)*r,[255*(i*o[0]+n),255*(i*o[1]+n),255*(i*o[2]+n)]},a.hcg.hsv=function(t){var e=t[1]/100,i=e+t[2]/100*(1-e),r=0;return 0<i&&(r=e/i),[t[0],100*r,100*i]},a.hcg.hsl=function(t){var e=t[1]/100,i=t[2]/100*(1-e)+.5*e,r=0;return 0<i&&i<.5?r=e/(2*i):.5<=i&&i<1&&(r=e/(2*(1-i))),[t[0],100*r,100*i]},a.hcg.hwb=function(t){var e=t[1]/100,i=e+t[2]/100*(1-e);return[t[0],100*(i-e),100*(1-i)]},a.hwb.hcg=function(t){var e=t[1]/100,i=1-t[2]/100,r=i-e,n=0;return r<1&&(n=(i-r)/(1-r)),[t[0],100*r,100*n]},a.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]},a.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]},a.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]},a.gray.hsl=a.gray.hsv=function(t){return[0,0,t[0]]},a.gray.hwb=function(t){return[0,100,t[0]]},a.gray.cmyk=function(t){return[0,0,0,t[0]]},a.gray.lab=function(t){return[t[0],0,0]},a.gray.hex=function(t){var e=255&Math.round(t[0]/100*255),i=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".substring(i.length)+i},a.rgb.gray=function(t){return[(t[0]+t[1]+t[2])/3/255*100]}}));q.rgb,q.hsl,q.hsv,q.hwb,q.cmyk,q.xyz,q.lab,q.lch,q.hex,q.keyword,q.ansi16,q.ansi256,q.hcg,q.apple,q.gray;function V(t){var e=function(){for(var t={},e=Object.keys(q),i=e.length,r=0;r<i;r++)t[e[r]]={distance:-1,parent:null};return t}(),i=[t];for(e[t].distance=0;i.length;)for(var r=i.pop(),n=Object.keys(q[r]),o=n.length,a=0;a<o;a++){var s=n[a],l=e[s];-1===l.distance&&(l.distance=e[r].distance+1,l.parent=r,i.unshift(s))}return e}function G(e,i){return function(t){return i(e(t))}}function Z(t,e){for(var i=[e[t].parent,t],r=q[e[t].parent][t],n=e[t].parent;e[n].parent;)i.unshift(e[n].parent),r=G(q[e[n].parent][n],r),n=e[n].parent;return r.conversion=i,r}var H={};function W(e){function t(t){return null==t?t:(1<arguments.length&&(t=Array.prototype.slice.call(arguments)),e(t))}return"conversion"in e&&(t.conversion=e.conversion),t}function K(n){function t(t){if(null==t)return t;1<arguments.length&&(t=Array.prototype.slice.call(arguments));var e=n(t);if("object"==typeof e)for(var i=e.length,r=0;r<i;r++)e[r]=Math.round(e[r]);return e}return"conversion"in n&&(t.conversion=n.conversion),t}Object.keys(q).forEach(function(i){H[i]={},Object.defineProperty(H[i],"channels",{value:q[i].channels}),Object.defineProperty(H[i],"labels",{value:q[i].labels});var r=function(t){for(var e=V(t),i={},r=Object.keys(e),n=r.length,o=0;o<n;o++){var a=r[o];null!==e[a].parent&&(i[a]=Z(a,e))}return i}(i);Object.keys(r).forEach(function(t){var e=r[t];H[i][t]=K(e),H[i][t].raw=W(e)})});var X=H,Y=[].slice,J=["keyword","gray","hex"],Q={};Object.keys(X).forEach(function(t){Q[Y.call(X[t].labels).sort().join("")]=t});var $={};function tt(t,e){if(!(this instanceof tt))return new tt(t,e);if(e&&e in J&&(e=null),e&&!(e in X))throw new Error("Unknown model: "+e);var i,r;if(null==t)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(t instanceof tt)this.model=t.model,this.color=t.color.slice(),this.valpha=t.valpha;else if("string"==typeof t){var n=j.get(t);if(null===n)throw new Error("Unable to parse color from string: "+t);this.model=n.model,r=X[this.model].channels,this.color=n.value.slice(0,r),this.valpha="number"==typeof n.value[r]?n.value[r]:1}else if(t.length){this.model=e||"rgb",r=X[this.model].channels;var o=Y.call(t,0,r);this.color=rt(o,r),this.valpha="number"==typeof t[r]?t[r]:1}else if("number"==typeof t)t&=16777215,this.model="rgb",this.color=[t>>16&255,t>>8&255,255&t],this.valpha=1;else{this.valpha=1;var a=Object.keys(t);"alpha"in t&&(a.splice(a.indexOf("alpha"),1),this.valpha="number"==typeof t.alpha?t.alpha:0);var s=a.sort().join("");if(!(s in Q))throw new Error("Unable to parse color from object: "+JSON.stringify(t));this.model=Q[s];var l=X[this.model].labels,u=[];for(i=0;i<l.length;i++)u.push(t[l[i]]);this.color=rt(u)}if($[this.model])for(r=X[this.model].channels,i=0;i<r;i++){var c=$[this.model][i];c&&(this.color[i]=c(this.color[i]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function et(i,r,n){return(i=Array.isArray(i)?i:[i]).forEach(function(t){($[t]||($[t]=[]))[r]=n}),i=i[0],function(t){var e;return arguments.length?(n&&(t=n(t)),(e=this[i]()).color[r]=t):(e=this[i]().color[r],n&&(e=n(e))),e}}function it(e){return function(t){return Math.max(0,Math.min(e,t))}}function rt(t,e){for(var i=0;i<e;i++)"number"!=typeof t[i]&&(t[i]=0);return t}tt.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(t){var e=this.model in j.to?this:this.rgb(),i=1===(e=e.round("number"==typeof t?t:1)).valpha?e.color:e.color.concat(this.valpha);return j.to[e.model](i)},percentString:function(t){var e=this.rgb().round("number"==typeof t?t:1),i=1===e.valpha?e.color:e.color.concat(this.valpha);return j.to.rgb.percent(i)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var t={},e=X[this.model].channels,i=X[this.model].labels,r=0;r<e;r++)t[i[r]]=this.color[r];return 1!==this.valpha&&(t.alpha=this.valpha),t},unitArray:function(){var t=this.rgb().color;return t[0]/=255,t[1]/=255,t[2]/=255,1!==this.valpha&&t.push(this.valpha),t},unitObject:function(){var t=this.rgb().object();return t.r/=255,t.g/=255,t.b/=255,1!==this.valpha&&(t.alpha=this.valpha),t},round:function(t){return t=Math.max(t||0,0),new tt(this.color.map((i=t,function(t){return e=i,Number(t.toFixed(e));var e})).concat(this.valpha),this.model);var i},alpha:function(t){return arguments.length?new tt(this.color.concat(Math.max(0,Math.min(1,t))),this.model):this.valpha},red:et("rgb",0,it(255)),green:et("rgb",1,it(255)),blue:et("rgb",2,it(255)),hue:et(["hsl","hsv","hsl","hwb","hcg"],0,function(t){return(t%360+360)%360}),saturationl:et("hsl",1,it(100)),lightness:et("hsl",2,it(100)),saturationv:et("hsv",1,it(100)),value:et("hsv",2,it(100)),chroma:et("hcg",1,it(100)),gray:et("hcg",2,it(100)),white:et("hwb",1,it(100)),wblack:et("hwb",2,it(100)),cyan:et("cmyk",0,it(100)),magenta:et("cmyk",1,it(100)),yellow:et("cmyk",2,it(100)),black:et("cmyk",3,it(100)),x:et("xyz",0,it(100)),y:et("xyz",1,it(100)),z:et("xyz",2,it(100)),l:et("lab",0,it(100)),a:et("lab",1),b:et("lab",2),keyword:function(t){return arguments.length?new tt(t):X[this.model].keyword(this.color)},hex:function(t){return arguments.length?new tt(t):j.to.hex(this.rgb().round().color)},rgbNumber:function(){var t=this.rgb().color;return(255&t[0])<<16|(255&t[1])<<8|255&t[2]},luminosity:function(){for(var t=this.rgb().color,e=[],i=0;i<t.length;i++){var r=t[i]/255;e[i]=r<=.03928?r/12.92:Math.pow((.055+r)/1.055,2.4)}return.2126*e[0]+.7152*e[1]+.0722*e[2]},contrast:function(t){var e=this.luminosity(),i=t.luminosity();return i<e?(e+.05)/(i+.05):(i+.05)/(e+.05)},level:function(t){var e=this.contrast(t);return 7.1<=e?"AAA":4.5<=e?"AA":""},isDark:function(){var t=this.rgb().color;return(299*t[0]+587*t[1]+114*t[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var t=this.rgb(),e=0;e<3;e++)t.color[e]=255-t.color[e];return t},lighten:function(t){var e=this.hsl();return e.color[2]+=e.color[2]*t,e},darken:function(t){var e=this.hsl();return e.color[2]-=e.color[2]*t,e},saturate:function(t){var e=this.hsl();return e.color[1]+=e.color[1]*t,e},desaturate:function(t){var e=this.hsl();return e.color[1]-=e.color[1]*t,e},whiten:function(t){var e=this.hwb();return e.color[1]+=e.color[1]*t,e},blacken:function(t){var e=this.hwb();return e.color[2]+=e.color[2]*t,e},grayscale:function(){var t=this.rgb().color,e=.3*t[0]+.59*t[1]+.11*t[2];return tt.rgb(e,e,e)},fade:function(t){return this.alpha(this.valpha-this.valpha*t)},opaquer:function(t){return this.alpha(this.valpha+this.valpha*t)},rotate:function(t){var e=this.hsl(),i=e.color[0];return i=(i=(i+t)%360)<0?360+i:i,e.color[0]=i,e},mix:function(t,e){if(!t||!t.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof t);var i=t.rgb(),r=this.rgb(),n=void 0===e?.5:e,o=2*n-1,a=i.alpha()-r.alpha(),s=(1+(o*a==-1?o:(o+a)/(1+o*a)))/2,l=1-s;return tt.rgb(s*i.red()+l*r.red(),s*i.green()+l*r.green(),s*i.blue()+l*r.blue(),i.alpha()*n+r.alpha()*(1-n))}},Object.keys(X).forEach(function(i){if(-1===J.indexOf(i)){var r=X[i].channels;tt.prototype[i]=function(){if(this.model===i)return new tt(this);if(arguments.length)return new tt(arguments,i);var t,e="number"==typeof arguments[r]?r:this.valpha;return new tt((t=X[this.model][i].raw(this.color),(Array.isArray(t)?t:[t]).concat(e)),i)},tt[i]=function(t){return"number"==typeof t&&(t=rt(Y.call(arguments),r)),new tt(t,i)}}});var nt,ot=tt;(nt=p.ControlStyle||(p.ControlStyle={})).light="light",nt.dark="dark",nt.auto="auto";var at=(st.prototype.onRemove=function(){this._container&&(this._container.remove(),delete this._container),this._map&&(this._map.events.remove("styledata",this._onStyleChange),delete this._map),this._observer&&(this._observer.disconnect(),delete this._observer),delete this._theme},st.prototype.buildContainer=function(t,e,i,r){var n=this;return this._map=t,this._container=document.createElement(r||"div"),this._container.classList.add("azure-maps-control-container"),"string"==typeof i&&this._container.setAttribute("aria-label",i),e.toLowerCase()===p.ControlStyle.auto?this._map.styles.initialize().then(function(){n._onStyleChange(),n._map.events.add("styledata",n._onStyleChange)}):this._container.classList.add(e),this._container},st.prototype._setTheme=function(t){this._theme!==t&&(this._container.classList.remove(this._theme),this._container.classList.add(t),this._theme=t)},st.activateClickDelay=100,st);function st(){var e=this;this._onStyleChange=function(){if(e._map.getStyle().style.toLowerCase().startsWith("blank"))e._observer||(e._onBackgroundChange(),e._observer=new MutationObserver(e._onBackgroundChange),e._observer.observe(e._map.getMapContainer(),{attributes:!0,attributeFilter:["style"]}));else{e._observer&&(e._observer.disconnect(),delete e._observer);var t=e._map.styles.getTheme(e._map.getStyle());e._setTheme(t)}},this._onBackgroundChange=function(){try{var t=.5<ot(e._map.getMapContainer().style.backgroundColor).luminosity()?p.ControlStyle.light:p.ControlStyle.dark;e._setTheme(t)}catch(t){e._setTheme(p.ControlStyle.light)}}}var lt,ut=(b(ct,lt=I),ct);function ct(){var t=null!==lt&&lt.apply(this,arguments)||this;return t.rotationDegreesDelta=15,t.style=p.ControlStyle.light,t}var pt,ht=(b(dt,pt=at),dt.prototype.onAdd=function(t,e){var i=this,r=this.buildContainer(t,this.options.style,"Rotation Control"),n=this.constructRotationButton(t),o=this.constructRotationGrid(t,e);return r.addEventListener("mouseover",function(t){i.lastActiveTime=i.lastActiveTime||t.timeStamp,i.hasMouse=!0,r.classList.add("in-use"),o.classList.remove("hidden-accessible-element")}),r.addEventListener("focusin",function(t){i.lastActiveTime=i.lastActiveTime||t.timeStamp,i.hasFocus=!0,r.classList.add("in-use"),o.classList.remove("hidden-accessible-element")}),r.addEventListener("mouseleave",function(){i.hasMouse=!1,i.hasFocus||(delete i.lastActiveTime,r.classList.remove("in-use"),o.classList.add("hidden-accessible-element"))}),r.addEventListener("focusout",function(t){t.relatedTarget instanceof Node&&r.contains(t.relatedTarget)||(i.hasFocus=!1,i.hasMouse||(delete i.lastActiveTime,r.classList.remove("in-use"),o.classList.add("hidden-accessible-element")))}),e&&dt.InvertOrderPositions.includes(e.position)?(r.appendChild(o),r.appendChild(n)):(r.appendChild(n),r.appendChild(o)),r},dt.prototype.constructRotationGrid=function(t,e){var i=document.createElement("div");i.classList.add("sub-container"),i.classList.add("hidden-accessible-element");var r=this.constructRightRotationButton(t),n=this.constructLeftRotationButton(t);return e&&dt.InvertOrderPositions.includes(e.position)?(i.appendChild(r),i.appendChild(n)):(i.appendChild(n),i.appendChild(r)),i},dt.prototype.constructRotationButton=function(e){var i=this,t=document.createElement("button");t.classList.add("azure-maps-control-button"),t.classList.add("rotation"),t.setAttribute("title","Reset to Default Rotation"),t.setAttribute("alt","Reset to Default Rotation"),t.setAttribute("type","button");var r=document.createElement("div");return t.appendChild(r),t.addEventListener("click",function(t){t.timeStamp-i.lastActiveTime>at.activateClickDelay&&e.setCamera({bearing:dt.DefaultRotation},!0)}),e.events.add("rotate",function(t){r.style.transform="rotate("+-t.map.getCamera().bearing+"deg)"}),t},dt.prototype.constructRightRotationButton=function(t){var e=this,i=document.createElement("button");return i.classList.add("azure-maps-control-button"),i.classList.add("rotation-right"),i.setAttribute("title","Rotate Right"),i.setAttribute("alt","Rotate Right"),i.setAttribute("type","button"),i.addEventListener("click",function(){t.setCamera({bearing:t.getCamera().bearing+e.options.rotationDegreesDelta,duration:dt.RotationDuration,type:"ease"},!0)}),i},dt.prototype.constructLeftRotationButton=function(t){var e=this,i=document.createElement("button");return i.classList.add("azure-maps-control-button"),i.classList.add("rotation-left"),i.setAttribute("title","Rotate Left"),i.setAttribute("alt","Rotate Left"),i.setAttribute("type","button"),i.addEventListener("click",function(){t.setCamera({bearing:t.getCamera().bearing-e.options.rotationDegreesDelta,duration:dt.RotationDuration,type:"ease"},!0)}),i},dt.DefaultRotation=0,dt.RotationDuration=100,dt.InvertOrderPositions=[p.ControlPosition.BottomRight,p.ControlPosition.TopRight],dt);function dt(t){var e=pt.call(this)||this;return e.hasMouse=!1,e.hasFocus=!1,e.options=(new ut).merge(t),e}var ft,mt=(b(gt,ft=I),gt);function gt(){var t=null!==ft&&ft.apply(this,arguments)||this;return t.pitchDegreesDelta=10,t.style=p.ControlStyle.light,t}var yt,vt=(b(_t,yt=at),_t.prototype.onAdd=function(t,e){var i=this,r=this.buildContainer(t,this.options.style,"Pitch Control"),n=this.constructPitchButton(t),o=this.constructPitchGrid(t,e);return r.addEventListener("mouseover",function(t){i.lastActiveTime=i.lastActiveTime||t.timeStamp,i.hasMouse=!0,r.classList.add("in-use"),o.classList.remove("hidden-accessible-element")}),r.addEventListener("focusin",function(t){i.lastActiveTime=i.lastActiveTime||t.timeStamp,i.hasFocus=!0,r.classList.add("in-use"),o.classList.remove("hidden-accessible-element")}),r.addEventListener("mouseleave",function(){i.hasMouse=!1,i.hasFocus||(delete i.lastActiveTime,r.classList.remove("in-use"),o.classList.add("hidden-accessible-element"))}),r.addEventListener("focusout",function(t){t.relatedTarget instanceof Node&&r.contains(t.relatedTarget)||(i.hasFocus=!1,i.hasMouse||(delete i.lastActiveTime,r.classList.remove("in-use"),o.classList.add("hidden-accessible-element")))}),e&&_t.INVERT_ORDER_POSITIONS.includes(e.position)?(r.appendChild(o),r.appendChild(n)):(r.appendChild(n),r.appendChild(o)),r},_t.prototype.constructPitchGrid=function(t,e){var i=document.createElement("div");i.classList.add("sub-container"),i.classList.add("hidden-accessible-element");var r=this.constructPitchIncrementButton(t),n=this.constructPitchDecrementButton(t);return e&&_t.INVERT_ORDER_POSITIONS.includes(e.position)?(i.appendChild(n),i.appendChild(r)):(i.appendChild(r),i.appendChild(n)),i},_t.prototype.constructPitchButton=function(t){var e=this,i=document.createElement("button");return i.classList.add("azure-maps-control-button"),i.classList.add("pitch"),i.setAttribute("title","Reset to Default Pitch"),i.setAttribute("alt","Reset to Default Pitch"),i.setAttribute("type","button"),i.addEventListener("click",function(){event.timeStamp-e.lastActiveTime>at.activateClickDelay&&t.setCamera({pitch:_t.DEFAULT_PITCH},!0)}),i},_t.prototype.constructPitchDecrementButton=function(t){var e=this,i=document.createElement("button");return i.classList.add("azure-maps-control-button"),i.classList.add("pitch-down"),i.setAttribute("title","Decrease Pitch"),i.setAttribute("alt","Decrease Pitch"),i.setAttribute("type","button"),i.addEventListener("click",function(){t.setCamera({pitch:t.getCamera().pitch-e.options.pitchDegreesDelta,duration:_t.PITCH_DURATION_MS,type:"ease"},!0)}),i},_t.prototype.constructPitchIncrementButton=function(t){var e=this,i=document.createElement("button");return i.classList.add("azure-maps-control-button"),i.classList.add("pitch-up"),i.setAttribute("title","Increase Pitch"),i.setAttribute("alt","Increase Pitch"),i.setAttribute("type","button"),i.addEventListener("click",function(){t.setCamera({pitch:t.getCamera().pitch+e.options.pitchDegreesDelta,duration:_t.PITCH_DURATION_MS,type:"ease"},!0)}),i},_t.PITCH_DURATION_MS=100,_t.DEFAULT_PITCH=0,_t.INVERT_ORDER_POSITIONS=[p.ControlPosition.BottomRight,p.ControlPosition.TopRight],_t);function _t(t){var e=yt.call(this)||this;return e.hasMouse=!1,e.hasFocus=!1,e.options=(new mt).merge(t),e}function xt(){this.__data__=[],this.size=0}var bt=function(t,e){return t===e||t!=t&&e!=e};var wt=function(t,e){for(var i=t.length;i--;)if(bt(t[i][0],e))return i;return-1},St=Array.prototype.splice;function Tt(t){var e=this.__data__,i=wt(e,t);return!(i<0)&&(i==e.length-1?e.pop():St.call(e,i,1),--this.size,!0)}function It(t){var e=this.__data__,i=wt(e,t);return i<0?void 0:e[i][1]}function Et(t){return-1<wt(this.__data__,t)}function Ct(t,e){var i=this.__data__,r=wt(i,t);return r<0?(++this.size,i.push([t,e])):i[r][1]=e,this}function At(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}At.prototype.clear=xt,At.prototype.delete=Tt,At.prototype.get=It,At.prototype.has=Et,At.prototype.set=Ct;var kt=At;function Pt(){this.__data__=new kt,this.size=0}function Mt(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i}function Lt(t){return this.__data__.get(t)}function Dt(t){return this.__data__.has(t)}var zt="object"==typeof t&&t&&t.Object===Object&&t,Ot="object"==typeof self&&self&&self.Object===Object&&self,Rt=zt||Ot||Function("return this")(),Nt=Rt.Symbol,Bt=Object.prototype,Ft=Bt.hasOwnProperty,Ut=Bt.toString,jt=Nt?Nt.toStringTag:void 0;var qt=function(t){var e=Ft.call(t,jt),i=t[jt];try{var r=!(t[jt]=void 0)}catch(t){}var n=Ut.call(t);return r&&(e?t[jt]=i:delete t[jt]),n},Vt=Object.prototype.toString;var Gt=function(t){return Vt.call(t)},Zt=Nt?Nt.toStringTag:void 0;var Ht=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":(Zt&&Zt in Object(t)?qt:Gt)(t)};var Wt=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};var Kt,Xt=function(t){if(!Wt(t))return!1;var e=Ht(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},Yt=Rt["__core-js_shared__"],Jt=(Kt=/[^.]+$/.exec(Yt&&Yt.keys&&Yt.keys.IE_PROTO||""))?"Symbol(src)_1."+Kt:"";var Qt=function(t){return!!Jt&&Jt in t},$t=Function.prototype.toString;var te=function(t){if(null!=t){try{return $t.call(t)}catch(t){}try{return t+""}catch(t){}}return""},ee=/^\[object .+?Constructor\]$/,ie=Function.prototype,re=Object.prototype,ne=ie.toString,oe=re.hasOwnProperty,ae=RegExp("^"+ne.call(oe).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var se=function(t){return!(!Wt(t)||Qt(t))&&(Xt(t)?ae:ee).test(te(t))};var le=function(t,e){return null==t?void 0:t[e]};var ue=function(t,e){var i=le(t,e);return se(i)?i:void 0},ce=ue(Rt,"Map"),pe=ue(Object,"create");function he(){this.__data__=pe?pe(null):{},this.size=0}function de(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var fe=Object.prototype.hasOwnProperty;function me(t){var e=this.__data__;if(pe){var i=e[t];return"__lodash_hash_undefined__"===i?void 0:i}return fe.call(e,t)?e[t]:void 0}var ge=Object.prototype.hasOwnProperty;function ye(t){var e=this.__data__;return pe?void 0!==e[t]:ge.call(e,t)}function ve(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=pe&&void 0===e?"__lodash_hash_undefined__":e,this}function _e(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}_e.prototype.clear=he,_e.prototype.delete=de,_e.prototype.get=me,_e.prototype.has=ye,_e.prototype.set=ve;var xe=_e;var be=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var we=function(t,e){var i=t.__data__;return be(e)?i["string"==typeof e?"string":"hash"]:i.map};function Se(t){var e=we(this,t).delete(t);return this.size-=e?1:0,e}function Te(t){return we(this,t).get(t)}function Ie(t){return we(this,t).has(t)}function Ee(t,e){var i=we(this,t),r=i.size;return i.set(t,e),this.size+=i.size==r?0:1,this}function Ce(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}Ce.prototype.clear=function(){this.size=0,this.__data__={hash:new xe,map:new(ce||kt),string:new xe}},Ce.prototype.delete=Se,Ce.prototype.get=Te,Ce.prototype.has=Ie,Ce.prototype.set=Ee;var Ae=Ce;function ke(t,e){var i=this.__data__;if(i instanceof kt){var r=i.__data__;if(!ce||r.length<199)return r.push([t,e]),this.size=++i.size,this;i=this.__data__=new Ae(r)}return i.set(t,e),this.size=i.size,this}function Pe(t){var e=this.__data__=new kt(t);this.size=e.size}Pe.prototype.clear=Pt,Pe.prototype.delete=Mt,Pe.prototype.get=Lt,Pe.prototype.has=Dt,Pe.prototype.set=ke;var Me=Pe;var Le=function(t,e){for(var i=-1,r=null==t?0:t.length;++i<r&&!1!==e(t[i],i,t););return t},De=function(){try{var t=ue(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var ze=function(t,e,i){"__proto__"==e&&De?De(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i},Oe=Object.prototype.hasOwnProperty;var Re=function(t,e,i){var r=t[e];Oe.call(t,e)&&bt(r,i)&&(void 0!==i||e in t)||ze(t,e,i)};var Ne=function(t,e,i,r){var n=!i;i=i||{};for(var o=-1,a=e.length;++o<a;){var s=e[o],l=r?r(i[s],t[s],s,i,t):void 0;void 0===l&&(l=t[s]),(n?ze:Re)(i,s,l)}return i};var Be=function(t,e){for(var i=-1,r=Array(t);++i<t;)r[i]=e(i);return r};var Fe=function(t){return null!=t&&"object"==typeof t};var Ue=function(t){return Fe(t)&&"[object Arguments]"==Ht(t)},je=Object.prototype,qe=je.hasOwnProperty,Ve=je.propertyIsEnumerable,Ge=Ue(function(){return arguments}())?Ue:function(t){return Fe(t)&&qe.call(t,"callee")&&!Ve.call(t,"callee")},Ze=Array.isArray;function He(){return!1}var We=e(function(t,e){var i=e&&!e.nodeType&&e,r=i&&t&&!t.nodeType&&t,n=r&&r.exports===i?Rt.Buffer:void 0,o=(n?n.isBuffer:void 0)||He;t.exports=o}),Ke=/^(?:0|[1-9]\d*)$/;var Xe=function(t,e){var i=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==i||"symbol"!=i&&Ke.test(t))&&-1<t&&t%1==0&&t<e};var Ye=function(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=9007199254740991},Je={};Je["[object Float32Array]"]=Je["[object Float64Array]"]=Je["[object Int8Array]"]=Je["[object Int16Array]"]=Je["[object Int32Array]"]=Je["[object Uint8Array]"]=Je["[object Uint8ClampedArray]"]=Je["[object Uint16Array]"]=Je["[object Uint32Array]"]=!0,Je["[object Arguments]"]=Je["[object Array]"]=Je["[object ArrayBuffer]"]=Je["[object Boolean]"]=Je["[object DataView]"]=Je["[object Date]"]=Je["[object Error]"]=Je["[object Function]"]=Je["[object Map]"]=Je["[object Number]"]=Je["[object Object]"]=Je["[object RegExp]"]=Je["[object Set]"]=Je["[object String]"]=Je["[object WeakMap]"]=!1;function Qe(t){return Fe(t)&&Ye(t.length)&&!!Je[Ht(t)]}var $e=function(e){return function(t){return e(t)}},ti=e(function(t,e){var i=e&&!e.nodeType&&e,r=i&&t&&!t.nodeType&&t,n=r&&r.exports===i&&zt.process,o=function(){try{var t=r&&r.require&&r.require("util").types;return t?t:n&&n.binding&&n.binding("util")}catch(t){}}();t.exports=o}),ei=ti&&ti.isTypedArray,ii=ei?$e(ei):Qe,ri=Object.prototype.hasOwnProperty;var ni=function(t,e){var i=Ze(t),r=!i&&Ge(t),n=!i&&!r&&We(t),o=!i&&!r&&!n&&ii(t),a=i||r||n||o,s=a?Be(t.length,String):[],l=s.length;for(var u in t)!e&&!ri.call(t,u)||a&&("length"==u||n&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Xe(u,l))||s.push(u);return s},oi=Object.prototype;var ai=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||oi)};var si=function(e,i){return function(t){return e(i(t))}},li=si(Object.keys,Object),ui=Object.prototype.hasOwnProperty;var ci=function(t){if(!ai(t))return li(t);var e=[];for(var i in Object(t))ui.call(t,i)&&"constructor"!=i&&e.push(i);return e};var pi=function(t){return null!=t&&Ye(t.length)&&!Xt(t)};var hi=function(t){return(pi(t)?ni:ci)(t)};var di=function(t,e){return t&&Ne(e,hi(e),t)};var fi=function(t){var e=[];if(null!=t)for(var i in Object(t))e.push(i);return e},mi=Object.prototype.hasOwnProperty;var gi=function(t){if(!Wt(t))return fi(t);var e=ai(t),i=[];for(var r in t)("constructor"!=r||!e&&mi.call(t,r))&&i.push(r);return i};var yi=function(t){return pi(t)?ni(t,!0):gi(t)};var vi=function(t,e){return t&&Ne(e,yi(e),t)},_i=e(function(t,e){var i=e&&!e.nodeType&&e,r=i&&t&&!t.nodeType&&t,n=r&&r.exports===i?Rt.Buffer:void 0,o=n?n.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var i=t.length,r=o?o(i):new t.constructor(i);return t.copy(r),r}});var xi=function(t,e){var i=-1,r=t.length;for(e=e||Array(r);++i<r;)e[i]=t[i];return e};var bi=function(t,e){for(var i=-1,r=null==t?0:t.length,n=0,o=[];++i<r;){var a=t[i];e(a,i,t)&&(o[n++]=a)}return o};function wi(){return[]}var Si=Object.prototype.propertyIsEnumerable,Ti=Object.getOwnPropertySymbols,Ii=Ti?function(e){return null==e?[]:(e=Object(e),bi(Ti(e),function(t){return Si.call(e,t)}))}:wi;var Ei=function(t,e){return Ne(t,Ii(t),e)};var Ci=function(t,e){for(var i=-1,r=e.length,n=t.length;++i<r;)t[n+i]=e[i];return t},Ai=si(Object.getPrototypeOf,Object),ki=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Ci(e,Ii(t)),t=Ai(t);return e}:wi;var Pi=function(t,e){return Ne(t,ki(t),e)};var Mi=function(t,e,i){var r=e(t);return Ze(t)?r:Ci(r,i(t))};var Li=function(t){return Mi(t,hi,Ii)};var Di=function(t){return Mi(t,yi,ki)},zi=ue(Rt,"DataView"),Oi=ue(Rt,"Promise"),Ri=ue(Rt,"Set"),Ni=ue(Rt,"WeakMap"),Bi="[object Map]",Fi="[object Promise]",Ui="[object Set]",ji="[object WeakMap]",qi="[object DataView]",Vi=te(zi),Gi=te(ce),Zi=te(Oi),Hi=te(Ri),Wi=te(Ni),Ki=Ht;(zi&&Ki(new zi(new ArrayBuffer(1)))!=qi||ce&&Ki(new ce)!=Bi||Oi&&Ki(Oi.resolve())!=Fi||Ri&&Ki(new Ri)!=Ui||Ni&&Ki(new Ni)!=ji)&&(Ki=function(t){var e=Ht(t),i="[object Object]"==e?t.constructor:void 0,r=i?te(i):"";if(r)switch(r){case Vi:return qi;case Gi:return Bi;case Zi:return Fi;case Hi:return Ui;case Wi:return ji}return e});var Xi=Ki,Yi=Object.prototype.hasOwnProperty;var Ji=function(t){var e=t.length,i=new t.constructor(e);return e&&"string"==typeof t[0]&&Yi.call(t,"index")&&(i.index=t.index,i.input=t.input),i},Qi=Rt.Uint8Array;var $i=function(t){var e=new t.constructor(t.byteLength);return new Qi(e).set(new Qi(t)),e};var tr=function(t,e){var i=e?$i(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)},er=/\w*$/;var ir=function(t){var e=new t.constructor(t.source,er.exec(t));return e.lastIndex=t.lastIndex,e},rr=Nt?Nt.prototype:void 0,nr=rr?rr.valueOf:void 0;var or=function(t){return nr?Object(nr.call(t)):{}};var ar=function(t,e){var i=e?$i(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)};var sr=function(t,e,i){var r=t.constructor;switch(e){case"[object ArrayBuffer]":return $i(t);case"[object Boolean]":case"[object Date]":return new r(+t);case"[object DataView]":return tr(t,i);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return ar(t,i);case"[object Map]":return new r;case"[object Number]":case"[object String]":return new r(t);case"[object RegExp]":return ir(t);case"[object Set]":return new r;case"[object Symbol]":return or(t)}},lr=Object.create;function ur(){}var cr=function(t){if(!Wt(t))return{};if(lr)return lr(t);ur.prototype=t;var e=new ur;return ur.prototype=void 0,e};var pr=function(t){return"function"!=typeof t.constructor||ai(t)?{}:cr(Ai(t))};function hr(t){return Fe(t)&&"[object Map]"==Xi(t)}var dr=ti&&ti.isMap,fr=dr?$e(dr):hr;function mr(t){return Fe(t)&&"[object Set]"==Xi(t)}var gr=ti&&ti.isSet,yr=gr?$e(gr):mr,vr=1,_r=2,xr=4,br="[object Arguments]",wr="[object Function]",Sr="[object GeneratorFunction]",Tr="[object Object]",Ir={};Ir[br]=Ir["[object Array]"]=Ir["[object ArrayBuffer]"]=Ir["[object DataView]"]=Ir["[object Boolean]"]=Ir["[object Date]"]=Ir["[object Float32Array]"]=Ir["[object Float64Array]"]=Ir["[object Int8Array]"]=Ir["[object Int16Array]"]=Ir["[object Int32Array]"]=Ir["[object Map]"]=Ir["[object Number]"]=Ir[Tr]=Ir["[object RegExp]"]=Ir["[object Set]"]=Ir["[object String]"]=Ir["[object Symbol]"]=Ir["[object Uint8Array]"]=Ir["[object Uint8ClampedArray]"]=Ir["[object Uint16Array]"]=Ir["[object Uint32Array]"]=!0,Ir["[object Error]"]=Ir[wr]=Ir["[object WeakMap]"]=!1;var Er=function i(r,n,o,t,e,a){var s,l=n&vr,u=n&_r,c=n&xr;if(o&&(s=e?o(r,t,e,a):o(r)),void 0!==s)return s;if(!Wt(r))return r;var p=Ze(r);if(p){if(s=Ji(r),!l)return xi(r,s)}else{var h=Xi(r),d=h==wr||h==Sr;if(We(r))return _i(r,l);if(h==Tr||h==br||d&&!e){if(s=u||d?{}:pr(r),!l)return u?Pi(r,vi(s,r)):Ei(r,di(s,r))}else{if(!Ir[h])return e?r:{};s=sr(r,h,l)}}var f=(a=a||new Me).get(r);if(f)return f;a.set(r,s),yr(r)?r.forEach(function(t){s.add(i(t,n,o,t,r,a))}):fr(r)&&r.forEach(function(t,e){s.set(e,i(t,n,o,e,r,a))});var m=c?u?Di:Li:u?keysIn:hi,g=p?void 0:m(r);return Le(g||r,function(t,e){g&&(t=r[e=t]),Re(s,e,i(t,n,o,e,r,a))}),s};var Cr,Ar=function(t){return Er(t,5)},kr=Map,Pr=(b(Mr,Cr=I),Mr);function Mr(){var t=null!==Cr&&Cr.apply(this,arguments)||this;return t.layout="icons",t.mapStyles=["road","grayscale_light","grayscale_dark","night","road_shaded_relief"],t.style=p.ControlStyle.light,t}var Lr,Dr=(b(zr,Lr=at),zr.prototype.onAdd=function(t,e){var i=this;this.map=t;var r=this.buildContainer(t,this.options.style,"Map Style Control"),n=this.buildStyleOpsGrid(r),o=this.buildCurrStyleBtn(r,n);return r.addEventListener("mouseover",function(){i.hasMouse=!0,r.classList.add(zr.Css.inUse),n.classList.remove("hidden-accessible-element")}),r.addEventListener("focusin",function(){i.hasFocus=!0,r.classList.add(zr.Css.inUse),n.classList.remove("hidden-accessible-element")}),r.addEventListener("mouseleave",function(){i.hasMouse=!1,i.hasFocus||(r.classList.remove(zr.Css.inUse),n.classList.add("hidden-accessible-element"))}),r.addEventListener("focusout",function(t){t.relatedTarget instanceof Node&&r.contains(t.relatedTarget)||(i.hasFocus=!1,i.hasMouse||(r.classList.remove(zr.Css.inUse),n.classList.add("hidden-accessible-element")))}),e&&zr.InvertOrderPositions.includes(e.position)?(r.appendChild(n),r.appendChild(o)):(r.appendChild(o),r.appendChild(n)),r},zr.prototype.onRemove=function(){Lr.prototype.onRemove.call(this),this.map.events.remove("styledata",this.onStyleChange)},zr.prototype.buildSelectStyleBtn=function(t,e){var i=this,r=document.createElement("button"),n=this.mapToFriendlyStyleName(t);r.setAttribute("title",n),r.setAttribute("alt",n),r.setAttribute("type","button");var o=new Image;return o.src=e,o.alt=n,r.appendChild(o),"icons"===this.options.layout?r.classList.add(zr.Css.button):r.appendChild(document.createTextNode(n)),r.addEventListener("click",function(){i.map.setStyle({style:t})}),r},zr.prototype.buildCurrStyleBtn=function(t,e){var i=document.createElement("button");i.classList.add(zr.Css.button),i.classList.add(zr.Css.currentStyle),i.setAttribute("title","Select Style"),i.setAttribute("alt","Select Style"),i.setAttribute("type","button"),this.currStyleImage=new Image,i.appendChild(this.currStyleImage);var r=document.createElement("div");return r.classList.add("icon"),i.appendChild(r),i},zr.prototype.buildStyleOpsGrid=function(t){var a=this,s=document.createElement("div");return s.classList.add(zr.Css.styleOptions),s.classList.add(this.options.layout),s.setAttribute("aria-label","Style Options"),s.classList.add("hidden-accessible-element"),this.map.styles.initialize().then(function(){for(var t=a.map.styles.getDef(),e=a.map.getStyle().style,i=0,r=t.styles;i<r.length;i++){var n=r[i],o=new P({domain:t.domain,path:n.iconPath}).toString();a.styleIcons.set(n.name,o),n.name===e&&(a.currStyleImage.src=o,a.currStyleImage.alt=a.mapToFriendlyStyleName(n.name))}"all"===a.options.mapStyles?a.styleIcons.forEach(function(t,e){var i=a.buildSelectStyleBtn(e,t);s.appendChild(i)}):a.options.mapStyles.filter(function(t){return a.styleIcons.has(t)}).forEach(function(t){var e=a.styleIcons.get(t),i=a.buildSelectStyleBtn(t,e);s.appendChild(i)}),a.map.events.add("styledata",a.onStyleChange)}),s},zr.prototype.mapToFriendlyStyleName=function(t){return zr.StyleNamesMap[t]?zr.StyleNamesMap[t]:t},zr.InvertOrderPositions=[p.ControlPosition.TopRight,p.ControlPosition.BottomRight],zr.Css={button:"azure-maps-control-button",currentStyle:"curr-style",inUse:"in-use",styleOptions:"style-options"},zr.StyleNamesMap={road:"Road",satellite:"Satellite",satellite_road_labels:"Hybrid",grayscale_dark:"Grayscale (Dark)",grayscale_light:"Grayscale (Light)",night:"Night",road_shaded_relief:"Terra",blank:"Blank",blank_accessible:"Blank (Accessible)",high_contrast_dark:"High contrast"},zr);function zr(t){var e=Lr.call(this)||this;return e.hasMouse=!1,e.hasFocus=!1,e.styleIcons=new kr,e.onStyleChange=function(){var t=e.map.getStyle().style;e.styleIcons.has(t)&&(e.currStyleImage.src=e.styleIcons.get(t),e.currStyleImage.alt=e.mapToFriendlyStyleName(t))},e.options=(new Pr).merge(Ar(t)),e}var Or,Rr=(b(Nr,Or=I),Nr);function Nr(){var t=null!==Or&&Or.apply(this,arguments)||this;return t.zoomDelta=1,t.style=p.ControlStyle.light,t}var Br,Fr=(b(Ur,Br=at),Ur.prototype.onAdd=function(t){var e=this.buildContainer(t,this.options.style,"Zoom Control");e.style.flexDirection="column";var i=this.constructZoomInButton(t),r=this.constructZoomOutButton(t);return e.appendChild(i),e.appendChild(r),e},Ur.prototype.constructZoomInButton=function(t){var e=this,i=document.createElement("button");return i.classList.add("azure-maps-control-button"),i.classList.add("zoom-in"),i.setAttribute("title","Zoom In"),i.setAttribute("alt","Zoom In"),i.setAttribute("type","button"),i.addEventListener("click",function(){t.setCamera({zoom:t.getCamera().zoom+e.options.zoomDelta,duration:Ur.ZOOM_DURATION_MS,type:"ease"},!0)}),i},Ur.prototype.constructZoomOutButton=function(t){var e=this,i=document.createElement("button");return i.classList.add("azure-maps-control-button"),i.classList.add("zoom-out"),i.setAttribute("title","Zoom Out"),i.setAttribute("alt","Zoom Out"),i.setAttribute("type","button"),i.addEventListener("click",function(){t.setCamera({zoom:t.getCamera().zoom-e.options.zoomDelta,duration:Ur.ZOOM_DURATION_MS,type:"ease"},!0)}),i},Ur.ZOOM_DURATION_MS=200,Ur);function Ur(t){var e=Br.call(this)||this;return e.options=(new Rr).merge(t),e}var jr=Object.freeze({__proto__:null,PitchControl:vt,CompassControl:ht,ZoomControl:Fr,StyleControl:Dr});function qr(t){return this.__data__.has(t)}function Vr(t){var e=-1,i=null==t?0:t.length;for(this.__data__=new Ae;++e<i;)this.add(t[e])}Vr.prototype.add=Vr.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Vr.prototype.has=qr;var Gr=Vr;var Zr=function(t,e){for(var i=-1,r=null==t?0:t.length;++i<r;)if(e(t[i],i,t))return!0;return!1};var Hr=function(t,e){return t.has(e)};var Wr=function(t,e,i,r,n,o){var a=1&i,s=t.length,l=e.length;if(s!=l&&!(a&&s<l))return!1;var u=o.get(t);if(u&&o.get(e))return u==e;var c=-1,p=!0,h=2&i?new Gr:void 0;for(o.set(t,e),o.set(e,t);++c<s;){var d=t[c],f=e[c];if(r)var m=a?r(f,d,c,e,t,o):r(d,f,c,t,e,o);if(void 0!==m){if(m)continue;p=!1;break}if(h){if(!Zr(e,function(t,e){if(!Hr(h,e)&&(d===t||n(d,t,i,r,o)))return h.push(e)})){p=!1;break}}else if(d!==f&&!n(d,f,i,r,o)){p=!1;break}}return o.delete(t),o.delete(e),p};function Kr(t){var i=-1,r=Array(t.size);return t.forEach(function(t,e){r[++i]=[e,t]}),r}function Xr(t){var e=-1,i=Array(t.size);return t.forEach(function(t){i[++e]=t}),i}var Yr=Nt?Nt.prototype:void 0,Jr=Yr?Yr.valueOf:void 0;var Qr=function(t,e,i,r,n,o,a){switch(i){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return t.byteLength==e.byteLength&&o(new Qi(t),new Qi(e))?!0:!1;case"[object Boolean]":case"[object Date]":case"[object Number]":return bt(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var s=Kr;case"[object Set]":var l=1&r;if(s=s||Xr,t.size!=e.size&&!l)return!1;var u=a.get(t);if(u)return u==e;r|=2,a.set(t,e);var c=Wr(s(t),s(e),r,n,o,a);return a.delete(t),c;case"[object Symbol]":if(Jr)return Jr.call(t)==Jr.call(e)}return!1},$r=Object.prototype.hasOwnProperty;var tn=function(t,e,i,r,n,o){var a=1&i,s=Li(t),l=s.length;if(l!=Li(e).length&&!a)return!1;for(var u=l;u--;){var c=s[u];if(!(a?c in e:$r.call(e,c)))return!1}var p=o.get(t);if(p&&o.get(e))return p==e;var h=!0;o.set(t,e),o.set(e,t);for(var d=a;++u<l;){var f=t[c=s[u]],m=e[c];if(r)var g=a?r(m,f,c,e,t,o):r(f,m,c,t,e,o);if(!(void 0===g?f===m||n(f,m,i,r,o):g)){h=!1;break}d=d||"constructor"==c}if(h&&!d){var y=t.constructor,v=e.constructor;y!=v&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof v&&v instanceof v)&&(h=!1)}return o.delete(t),o.delete(e),h},en="[object Arguments]",rn="[object Array]",nn="[object Object]",on=Object.prototype.hasOwnProperty;var an=function(t,e,i,r,n,o){var a=Ze(t),s=Ze(e),l=a?rn:Xi(t),u=s?rn:Xi(e),c=(l=l==en?nn:l)==nn,p=(u=u==en?nn:u)==nn,h=l==u;if(h&&We(t)){if(!We(e))return!1;c=!(a=!0)}if(h&&!c)return o=o||new Me,a||ii(t)?Wr(t,e,i,r,n,o):Qr(t,e,l,i,r,n,o);if(!(1&i)){var d=c&&on.call(t,"__wrapped__"),f=p&&on.call(e,"__wrapped__");if(d||f)return n(d?t.value():t,f?e.value():e,i,r,o=o||new Me)}return h&&(o=o||new Me,tn(t,e,i,r,n,o))};var sn=function t(e,i,r,n,o){return e===i||(null==e||null==i||!Fe(e)&&!Fe(i)?e!=e&&i!=i:an(e,i,r,n,t,o))};var ln,un=function(t,e){return sn(t,e)},cn=(ln=Object.freeze({__proto__:null,default:{}}))&&ln.default||ln,pn=e(function(t){!function(){var n,o,a,s=0,e=[];for(l.BUFFER_SIZE=512,l.bin=i,l.test=function(t){if("string"==typeof t)return/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/.test(t)},o=0;o<256;o++)e[o]=(o+256).toString(16).substr(1);function i(){var t=function(t){var e,i,r;if(void 0!==a){if(void 0===n||l.BUFFER_SIZE<s+t)if(s=0,a.getRandomValues)n=new Uint8Array(l.BUFFER_SIZE),a.getRandomValues(n);else{if(!a.randomBytes)throw new Error("Non-standard crypto library");n=a.randomBytes(l.BUFFER_SIZE)}return n.slice(s,s+=t)}for(e=[],o=0;o<t;o++)e.push((i=0,r=255,Math.floor(Math.random()*(r-i))+i));return e}(16);return t[6]=15&t[6]|64,t[8]=63&t[8]|128,t}function l(){var t=i();return e[t[0]]+e[t[1]]+e[t[2]]+e[t[3]]+"-"+e[t[4]]+e[t[5]]+"-"+e[t[6]]+e[t[7]]+"-"+e[t[8]]+e[t[9]]+"-"+e[t[10]]+e[t[11]]+e[t[12]]+e[t[13]]+e[t[14]]+e[t[15]]}"undefined"!=typeof crypto?a=crypto:"undefined"!=typeof window&&void 0!==window.msCrypto&&(a=window.msCrypto),a=a||cn,t.exports=l}()}),hn=(dn.TYPE="Feature",dn);function dn(t,e,i,r){this.type="Feature",this.type=dn.TYPE,this.properties=e||{},this.id=i,this.geometry=t,this.bbox=r}var fn,mn=(b(gn,fn=Array),gn.fromData=function(i){var r=NaN,n=NaN,o=new Set(["y"]),a=new Set(["x"]);return Object.keys(i).forEach(function(t){var e=t.toLowerCase();isNaN(r)&&o.has(e)&&"number"==typeof i[t]?r=i[t]:isNaN(n)&&a.has(e)&&"number"==typeof i[t]&&(n=i[t])}),isNaN(r)||isNaN(n)?null:new gn(r,n)},gn.getX=function(t){return 0<t.length?t[0]:NaN},gn.getY=function(t){return 1<t.length?t[1]:NaN},gn.getDestination=function(t,e,i){return new gn(gn.getX(t)+i*Math.cos((e+270)*Math.PI/180),gn.getY(t)+i*Math.sin((e+270)*Math.PI/180))},gn.getDistance=function(t,e){var i=gn.getX(t)-gn.getX(e),r=gn.getY(t)-gn.getY(e);return Math.sqrt(i*i+r*r)},gn.getHeading=function(t,e){var i=gn.getX(e)-gn.getX(t),r=gn.getY(t)-gn.getY(e);return 180*(2.5*Math.PI-Math.atan2(r,i))/Math.PI%360},gn);function gn(t,e){return fn.call(this,t,e)||this}var yn=(vn.TYPE="Point",vn);function vn(t){this.type="Point",this.type=vn.TYPE,this.coordinates=t}var _n,xn,bn,wn,Sn,Tn,In,En,Cn,An,kn=6378137,Pn=Math.PI/180,Mn=180/Math.PI,Ln=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function Dn(t){return t*Pn}function zn(t){return t*Mn}function On(t,e,i){return Math.min(Math.max(t,e),i)}function Rn(t,e){var i=Dn(e[1]-t[1]),r=Dn(e[0]-t[0]),n=Math.pow(Math.sin(i/2),2)+Math.cos(Dn(t[1]))*Math.cos(Dn(e[1]))*Math.pow(Math.sin(r/2),2),o=2*Math.atan2(Math.sqrt(n),Math.sqrt(1-n));return Math.round(kn*o*100)/100}function Nn(t){if(t)switch(t.toLowerCase()){case"feet":case"foot":case"ft":return bn.feet;case"kilometers":case"kilometer":case"kilometres":case"kilometre":case"km":case"kms":return bn.kilometers;case"miles":case"mile":case"mi":return bn.miles;case"nauticalmiles":case"nauticalmile":case"nms":case"nm":return bn.nauticalMiles;case"yards":case"yard":case"yds":case"yrd":case"yrds":return bn.yards;case"meters":case"metres":case"m":default:return bn.meters}return bn.meters}function Bn(t){if(t)switch(t.toLowerCase()){case"milespersecondsquared":case"milepersecondsquared":case"mi/s^2":case"mi/s2":return Cn.milesPerSecondSquared;case"kilometerspersecondsquared":case"kilometrespersecondsquared":case"kilometerpersecondsquared":case"kilometrepersecondsquared":case"km/s^2":case"km/s2":return Cn.kilometersPerSecondSquared;case"knotspersecond":case"knotpersecond":case"knts/s":case"kn/s":case"kt/s":return Cn.knotsPerSecond;case"standardgravity":case"g":return Cn.standardGravity;case"feetpersecondsquared":case"footpersecondsquared":case"ft/s^2":case"ft/s2":return Cn.feetPerSecondSquared;case"yardspersecondsquared":case"yardpersecondsquared":case"yds/s^2":case"yds/s2":case"yd/s^2":case"yd/s2":return Cn.yardsPerSecondSquared;case"milesperhoursecond":case"mileperhoursecond":case"milesperhourseconds":case"mileperhourseconds":case"mi/h/s":return Cn.milesPerHourSecond;case"kilometersperhoursecond":case"kilometrespersoursecond":case"kilometerperhoursecond":case"kilometrepersoursecond":case"kilometersperhourssecond":case"kilometrespersourssecond":case"kilometerperhourssecond":case"kilometrepersourssecond":case"kmhs":case"km/h/s":return Cn.kilometersPerHourSecond;case"meterspersecondsquared":case"metrespersecondsquared":case"meterpersecondsquared":case"metrepersecondsquared":case"m/s^2":case"m/s2":default:return Cn.metersPerSecondSquared}return Cn.metersPerSecondSquared}function Fn(t){if(t)switch(t){case"acres":case"ac":return _n.acres;case"hectares":case"ha":return _n.hectares;case"squareFeet":case"ft^2":case"ft2":return _n.squareFeet;case"squareYards":case"squareYard":case"yds^2":case"yds2":case"yd^2":case"yd2":return _n.squareYards;case"squareKilometers":case"squareKilometres":case"squareKilometer":case"squareKilometre":case"km^2":case"km2":return _n.squareKilometers;case"squareMiles":case"squareMile":case"mi^2":case"mi2":return _n.squareMiles;case"squareMeters":case"squareMetres":case"squareMeter":case"squareMetre":case"m^2":case"m2":default:return _n.squareMeters}return _n.squareMeters}function Un(t){if(t)switch(t.toLowerCase()){case"feetpersecond":case"footsecond":case"ftps":case"ft/s":return In.feetPerSecond;case"milesperhour":case"mileperhour":case"mph":case"mi/hr":case"mi/h":return In.milesPerHour;case"knots":case"knot":case"knts":case"knt":case"kn":case"kt":return In.knots;case"mach":case"m":return In.mach;case"kilometersperhour":case"kilometresperhour":case"kmperhour":case"kmph":case"km/hr":case"km/h":return In.kilometersPerHour;case"meterspersecond":case"metrespersecond":case"mps":case"ms":case"m/s":default:return In.metersPerSecond}return In.metersPerSecond}function jn(t){if(t)switch(t.toLowerCase()){case"milliseconds":case"ms":return Sn.ms;case"minutes":case"minute":case"mins":case"min":return Sn.minutes;case"hours":case"hour":case"hr":case"h":return Sn.hours;case"days":case"day":case"d":return Sn.days;case"seconds":case"second":case"secs":case"sec":case"s":default:return Sn.seconds}return Sn.seconds}function qn(t){var e=0;if(t&&0<t.length){e=Math.abs(Vn(t[0]));for(var i=1,r=t.length;i<r;i++)e-=Math.abs(Vn(t[i]))}return e}function Vn(t){var e=0;if(3<=t.length){for(var i=void 0,r=void 0,n=0,o=t.length;n<o;n++)e+=(Dn(t[n===o-2?(i=o-2,r=o-1,0):n===o-1?(i=o-1,r=0,1):(r=(i=n)+1,n+2)][0])-Dn(t[i][0]))*Math.sin(Dn(t[r][1]));e=e*kn*kn/2}return e}function Gn(t,e,i){return(t[0]-i[0])*(e[1]-i[1])-(t[1]-i[1])*(e[0]-i[0])}function Zn(t,e,i){if(2<=i.length){for(var r=1/0,n=void 0,o=null,a=ao(i,22),s=void 0,l=0,u=a.length-1;l<u;l++)s=Hn(e,a[l],a[l+1]),(n=mn.getDistance(e,s))<r&&(r=n,o=s);if(o){var c=oo([o],22)[0];return new hn(new yn(c),{distance:Yn(t,c)})}}else if(1===i.length)return new hn(new yn(i[0]),{distance:Yn(t,i[0])});return null}function Hn(t,e,i){if(e[0]===i[0]&&e[1]===i[1])return e;var r=t[0]-e[0],n=t[1]-e[1],o=i[0]-e[0],a=i[1]-e[1],s=(o*r+a*n)/(o*o+a*a);return s<0?e:1<s?i:[e[0]+o*s,e[1]+a*s]}function Wn(t,e){if(!isNaN(t)&&"number"==typeof e&&0<=e){var i=void 0;i=e<Ln.length?Ln[e]:Math.pow(10,e),t=Math.round(t*i)/i}return t}function Kn(t,e,i,r){switch(Nn(e)){case bn.meters:t/=1e3;break;case bn.feet:t/=3280.8399;break;case bn.miles:t/=.62137119;break;case bn.yards:t/=1093.6133;break;case bn.nauticalMiles:t/=.5399568;break;case bn.kilometers:}switch(Nn(i)){case bn.meters:t*=1e3;break;case bn.feet:t*=3280.8399;break;case bn.miles:t*=.62137119;break;case bn.yards:t*=1093.6133;break;case bn.nauticalMiles:t*=.5399568;break;case bn.kilometers:}if("number"==typeof r&&0<=r){var n=Math.pow(10,r);t=Math.round(t*n)/n}return t}function Xn(t,e,i,r){r=r||"meters",t=yo(t);var n=Jn(r),o=Dn(t[1]),a=Dn(t[0]),s=Dn(e),l=i/n,u=Math.asin(Math.sin(o)*Math.cos(l)+Math.cos(o)*Math.sin(l)*Math.cos(s)),c=a+Math.atan2(Math.sin(s)*Math.sin(l)*Math.cos(o),Math.cos(l)-Math.sin(o)*Math.sin(u)),p=On(io(zn(u)),-85,85);return[ro(zn(c)),p]}function Yn(t,e,i){var r=Rn(t=yo(t),e=yo(e));return"meters"===i?r:Kn(r,"meters",i||"meters")}function Jn(t){var e=Nn(t);return Kn(kn,bn.meters,e)}function Qn(t,e){if(t=yo(t),e=yo(e),t&&2<=t.length&&e&&2<=e.length){var i=Dn(t[1]),r=Dn(e[1]),n=Dn(e[0]-t[0]),o=Math.sin(n)*Math.cos(r),a=Math.cos(i)*Math.sin(r)-Math.sin(i)*Math.cos(r)*Math.cos(n);return(zn(Math.atan2(o,a))+360)%360}return NaN}function $n(t,e){var i,r=0;Array.isArray(t)?i=t:t.type&&"LineString"===t.type&&(i=t.coordinates);for(var n=0,o=i.length-1;n<o;n++)r+=Rn(i[n],i[n+1]);return Kn(r,"meters",e||"meters")}function to(t,e,i){i=i||"meters";var r,n,o=0;if(Array.isArray(t)?n=t:t.type&&"LineString"===t.type&&(n=t.coordinates),2<=n.length){for(var a=n.length,s=1;s<a;s++){if(e<=o+(r=Yn(n[s-1],n[s],i))){var l=Qn(n[s-1],n[s]);return Xn(n[s-1],l,e-o,i)}o+=r}return o<=e?n[a-1]:n[0]}return null}function eo(t,e,i,r,n){r=r||"meters",n=n||0,t=yo(t);for(var o=[],a=360/i,s=0;s<=i;s++)o.push(Xn(t,(s*a+n)%360,e,r));return o}function io(t){return 90<t?180<(t=(t+90)%360)?90-(t-180):t-90:t<-90?(t=(t-90)%360)<-180?-90-(t+180):t+90:t}function ro(t){return 180<t?(t+180)%360-180:t<-180?(t-180)%360+180:t}function no(t,e,i){if(0===i)return Object.assign({},t);e=yo(e);for(var r,n,o=[],a=0,s=t.length;a<s;a++)r=Yn(e,t[a]),n=Qn(e,t[a]),o.push(Xn(e,n+i,r));return o}function oo(t,e){for(var i,r,n=512*Math.pow(2,e),o=[],a=0,s=t.length;a<s;a++)i=t[a][0]/n-.5,r=.5-t[a][1]/n,o.push([360*i,90-360*Math.atan(Math.exp(2*-r*Math.PI))/Math.PI]);return o}function ao(t,e){for(var i,r,n,o=512*Math.pow(2,e),a=[],s=0,l=t.length;s<l;s++)n=Math.sin(t[s][1]*Math.PI/180),i=(t[s][0]+180)/360,r=.5-Math.log((1+n)/(1-n))/(4*Math.PI),a.push([Math.round(i*o),Math.round(r*o)]);return a}function so(t,e,i,r){switch(Bn(e)){case Cn.kilometersPerHourSecond:t/=3.6;break;case Cn.milesPerHourSecond:t/=2.236936292054;break;case Cn.knotsPerSecond:t/=1.943844492441;break;case Cn.standardGravity:t/=.1019716212978;break;case Cn.kilometersPerSecondSquared:t/=.001;break;case Cn.milesPerSecondSquared:t/=.000621371192;break;case Cn.feetPerSecondSquared:t/=3.280839895012;break;case Cn.yardsPerSecondSquared:t/=1.093613298338;break;case Cn.metersPerSecondSquared:}switch(Bn(i)){case Cn.kilometersPerHourSecond:t*=3.6;break;case Cn.milesPerHourSecond:t*=2.236936292054;break;case Cn.knotsPerSecond:t*=1.943844492441;break;case Cn.standardGravity:t*=.1019716212978;break;case Cn.kilometersPerSecondSquared:t*=.001;break;case Cn.milesPerSecondSquared:t*=.000621371192;break;case Cn.feetPerSecondSquared:t*=3.280839895012;break;case Cn.yardsPerSecondSquared:t*=1.093613298338;break;case Cn.metersPerSecondSquared:}return Wn(t,r)}function lo(t,e,i,r){switch(Fn(e)){case _n.acres:t*=4046.8564224;break;case _n.hectares:t*=1e4;break;case _n.squareFeet:t*=.09290304;break;case _n.squareKilometers:t*=1e6;break;case _n.squareMiles:t*=259e4;break;case _n.squareYards:t*=.83612736;break;case _n.squareMeters:}switch(Fn(i)){case _n.acres:t/=4046.8564224;break;case _n.hectares:t/=1e4;break;case _n.squareFeet:t/=.09290304;break;case _n.squareKilometers:t/=1e6;break;case _n.squareMiles:t/=259e4;break;case _n.squareYards:t/=.83612736;break;case _n.squareMeters:}return Wn(t,r)}function uo(t,e,i,r){switch(Un(e)){case In.feetPerSecond:t*=1.09728;break;case In.milesPerHour:t*=1.6093;break;case In.knots:t*=1.852;break;case In.metersPerSecond:t*=3.6;break;case In.mach:t*=1234.8;break;case In.kilometersPerHour:}switch(Un(i)){case In.feetPerSecond:t/=1.09728;break;case In.milesPerHour:t/=1.6093;break;case In.knots:t/=1.852;break;case In.metersPerSecond:t/=3.6;break;case In.mach:t/=1234.8;break;case In.kilometersPerHour:}return Wn(t,r)}function co(t,e,i,r){switch(jn(e)){case Sn.ms:t/=1e3;break;case Sn.hours:t*=3600;break;case Sn.minutes:t*=60;break;case Sn.days:t*=86400;break;case Sn.seconds:}switch(jn(i)){case Sn.ms:t*=1e3;break;case Sn.hours:t/=3600;break;case Sn.minutes:t/=60;break;case Sn.days:t/=86400;break;case Sn.seconds:}return Wn(t,r)}function po(t,e,i,r,n,o,a,s){var l=Kn(e,n,bn.meters),u=co(i,o,Sn.seconds);return so(2*(l-uo(t,r,In.metersPerSecond)*u)/(u*u),Cn.metersPerSecondSquared,a,s)}function ho(t,e,i,r,n,o,a){var s=uo(t,r,In.metersPerSecond);return so((uo(e,r,In.metersPerSecond)-s)/co(i,n,Sn.seconds),Cn.metersPerSecondSquared,o,a)}function fo(t,e,i,r){var n=mo(t),o=mo(e);return null!=n&&null!=o?co(o.getTime()-n.getTime(),Sn.ms,i,r):NaN}function mo(t){if("[object Date]"===Object.prototype.toString.call(t))return t;if("string"==typeof t){var e=Date.parse(t);if(!isNaN(e))return new Date(e);if(0<=t.indexOf("Date(")){var i=0;return i=0<(t=t.replace("/Date(","").replace(")/","")).indexOf("+")?parseInt(t.substr(0,t.indexOf("+")),10):0<t.indexOf("-")?parseInt(t.substr(0,t.indexOf("-")),10):parseInt(t,10),new Date(i)}}else if("number"==typeof t)return new Date(t);return null}function go(t){var e=[],i=null,r=null;if(Array.isArray(t)&&0<t.length)if(Array.isArray(t[0])&&"number"==typeof t[0][0])e=t;else for(var n=t.length,o=0;o<n;o++)e=e.concat(go(t[o]));else if(t.type)switch(t.type){case"Point":e=[t.coordinates];break;case"LineString":e=t.coordinates;break;case"Polygon":i=t.coordinates;break;case"MultiPoint":e=t.coordinates;break;case"MultiLineString":i=t.coordinates;break;case"MultiPolygon":r=t.coordinates;break;case"Feature":var a=t;e=Lo._isCircle(a)?Lo._getCirclePositions(a):go(a.geometry);break;case"FeatureCollection":e=go(t.features);break;case"GeometryCollection":e=go(t.geometries)}else if(t instanceof Lo)return go(t.toJson());if(i)for(n=i.length,o=0;o<n;o++)e=e.concat(i[o]);else if(r){var s=r.length;for(o=0;o<s;o++)for(var l=r[o].length,u=0;u<l;u++)e=e.concat(r[o][u])}return e}function yo(t){if(Array.isArray(t)&&"number"==typeof t[0])return t;if(t.type){if("Point"===t.type)return t.coordinates;if("Feature"===t.type&&"Point"===t.geometry.type)return t.geometry.coordinates}else if(t instanceof Lo&&"Point"===t.getType())return t.getCoordinates();return null}function vo(t,e,i){i=i||"meters";var r,n,o=0;if(Array.isArray(t)?n=t:t.type&&"LineString"===t.type&&(n=t.coordinates),2<=n.length){for(var a=n.length,s=1;s<a;s++){if(e<=o+(r=Yn(n[s-1],n[s],i))){var l=Qn(n[s-1],n[s]),u=Xn(n[s-1],l,e-o,i);return new hn(new yn(u),{heading:l})}o+=r}return o<=e?new hn(new yn(n[a-1]),{heading:Qn(n[a-2],n[a-1])}):new hn(new yn(n[0]),{heading:Qn(n[0],n[1])})}return null}function _o(t,e,i,r){var n,o=yo(t),a=ao([o],22)[0],s=null,l=1/0;switch((e=e instanceof Lo?e.toJson():e).type){case"Feature":return _o(t,e.geometry,i);case"Point":n=[[e.coordinates]];break;case"MultiPoint":for(var u=void 0,c=e.coordinates,p=0,h=c.length;p<h;p++)(u=Yn(o,c[p]))<l&&(l=u,s=new hn(new yn(c[p]),{distance:u}));break;case"LineString":n=[e.coordinates];break;case"Polygon":case"MultiLineString":n=e.coordinates;break;case"MultiPolygon":var d=e.coordinates;if(0<d.length){n=d[0];for(p=1,h=d.length;p<h;p++)n=n.concat(d[p])}}if(n){var f=void 0;for(p=0,h=n.length;p<h;p++)(f=Zn(o,a,n[p]))&&f.properties.distance<l&&(l=f.properties.distance,s=f)}return s&&(s.properties.distance=Kn(s.properties.distance,"meters",i,r)),s}(xn=_n=_n||{}).squareMeters="squareMeters",xn.acres="acres",xn.hectares="hectares",xn.squareFeet="squareFeet",xn.squareKilometers="squareKilometers",xn.squareMiles="squareMiles",xn.squareYards="squareYards",(wn=bn=bn||{}).meters="meters",wn.kilometers="kilometers",wn.feet="feet",wn.miles="miles",wn.nauticalMiles="nauticalMiles",wn.yards="yards",(Tn=Sn=Sn||{}).seconds="seconds",Tn.hours="hours",Tn.ms="ms",Tn.minutes="minutes",Tn.days="days",(En=In=In||{}).metersPerSecond="metersPerSecond",En.kilometersPerHour="kilometersPerHour",En.feetPerSecond="feetPerSecond",En.milesPerHour="milesPerHour",En.knots="knots",En.mach="mach",(An=Cn=Cn||{}).milesPerSecondSquared="milesPerSecondSquared",An.kilometersPerSecondSquared="kilometersPerSecondSquared",An.knotsPerSecond="knotsPerSecond",An.standardGravity="standardGravity",An.feetPerSecondSquared="feetPerSecondSquared",An.yardsPerSecondSquared="yardsPerSecondSquared",An.milesPerHourSecond="milesPerHourSecond",An.kilometersPerHourSecond="kilometersPerHourSecond",An.metersPerSecondSquared="metersPerSecondSquared";var xo,bo=(b(wo,xo=Array),wo.fromPosition=function(t){return 2===t.length?new wo(t[0],t[1]):2<t.length?new wo(t[0],t[1],t[2]):null},wo.areEqual=function(t,e,i){if(void 0===i&&(i=6),t&&2<=t.length&&e&&2<=e.length){var r=Math.pow(10,i),n=io(t[1]),o=io(e[1]),a=ro(t[0]),s=ro(e[0]);if(0!=Math.round((n-o)*r)/r)return!1;var l=Math.round((a-s)*r)/r;return 0==l||360==l}return!1},wo.fromLatLng=function(n,t,e){var i=[];if("number"==typeof n)i.push(n),"number"==typeof t&&i.push(t),"number"==typeof e&&i.push(e);else if(Array.isArray(n))2<=n.length&&"number"==typeof n[0]&&"number"==typeof n[1]&&(3<=n.length&&"number"==typeof n[2]?i.push(n[0],n[1],n[2]):i.push(n[0],n[1]));else if("object"==typeof n){var o=["lat","latitude","y"],a=["lng","longitude","lon","x"],s=["elv","elevation","alt","altitude","z"],l=NaN,u=NaN,c=NaN;Object.keys(n).forEach(function(t,e,i){var r=t.toLowerCase();isNaN(l)&&0<=o.indexOf(r)&&"number"==typeof n[t]?l=n[t]:isNaN(u)&&0<=a.indexOf(r)&&"number"==typeof n[t]?u=n[t]:isNaN(c)&&0<=s.indexOf(r)&&"number"==typeof n[t]&&(c=n[t])}),isNaN(l)||isNaN(u)||(i.push(u,l),isNaN(c)||i.push(c))}return 2<=i.length?i:null},wo.fromLatLngs=function(t){var e=[];if(Array.isArray(t))for(var i=0,r=t.length;i<r;i++){var n=wo.fromLatLng(t[i]);n&&e.push(n)}return e},wo._getDimensions=function(t){for(var e=0;Array.isArray(t);)t=t[0],e++;return"number"==typeof t&&e--,e},wo);function wo(t,e,i){return i?xo.call(this,t,e,i)||this:xo.call(this,t,e)||this}var So=(To.TYPE="Polygon",To);function To(t,e){this.type="Polygon",this.type=To.TYPE,1===bo._getDimensions(t)?this.coordinates=[t]:this.coordinates=t,this.bbox=e}var Io=(Eo.prototype._addEventListener=function(t,e,i){this.listeners.has(t)||this.listeners.set(t,new kr),this.listeners.get(t).set(e,i)},Eo.prototype._removeEventListener=function(t,e){this.listeners.has(t)&&this.listeners.get(t).delete(e)},Eo.prototype._invokeEvent=function(i,r){var n=this;this.listeners.has(i)&&this.listeners.get(i).forEach(function(t,e){t&&n._removeEventListener(i,e);try{e(r)}catch(t){console.error(t)}})},Eo);function Eo(){this.listeners=new kr}var Co=Object.freeze({__proto__:null,EventEmitter:Io}),Ao=(ko.prototype.toTarget=function(t,e){return this.transformArray(t,this.M,e)},ko.prototype.toSource=function(t,e){return this.transformArray(t,this.inverseM,e)},ko.prototype.transformArray=function(t,e,i){if(t&&Array.isArray(t)&&Array.isArray(t[0])){for(var r=[],n=0,o=t;n<o.length;n++){var a=o[n];r.push(this.transform(a,e,i))}return r}return null},ko.prototype.transform=function(t,e,i){var r=t[0]*e[0][3]+t[1]*e[1][3]+e[2][3],n=t[0]*e[0][4]+t[1]*e[1][4]+e[2][4];return"number"==typeof i&&0<=i?[Wn(r,i),Wn(n,i)]:[Wn(r,6),Wn(n,6)]},ko._calculateAffineTransform=function(t,e){if(t.length!==e.length||t.length<1)throw new Error("Error: source and target arrays must have the same length.");var i=Math.min(t[0].length,e[0].length),r=i+1;if(t.length<i)throw new Error("Erorr: At least "+i+" reference points required.");for(var n=[],o=[],a=0;a<r;a++){o[a]=[];for(var s=0;s<r;s++){s<i&&(n[s]=0);for(var l=o[a][s]=0;l<t.length;l++)s<i&&(n[s]+=a<i?t[l][a]*e[l][s]:e[l][s]),o[a][s]+=i<=a&&i<=s?1:i<=a?t[l][s]:i<=s?t[l][a]:t[l][a]*t[l][s]}o[a]=o[a].concat(n)}if(!this._gaussJordanElimination(o))throw new Error("Error: Singular matrix. Points are likely coplanar.");return o},ko._gaussJordanElimination=function(t){for(var e,i,r=t.length,n=2*r-1,o=0;o<r;o++){for(var a=o,s=o+1;s<r;s++)Math.abs(t[s][o])>Math.abs(t[a][o])&&(a=s);if(i=t[a],t[a]=t[o],t[o]=i,Math.abs(t[o][o])<=1e-10)return!1;for(var l=o+1;l<r;l++){e=t[l][o]/t[o][o];for(var u=o;u<n;u++)t[l][u]-=t[o][u]*e}}for(o=r-1;-1<o;o--){for(e=t[o][o],s=0;s<o;s++)for(var c=n-1;o-1<c;c--)t[s][c]-=t[o][c]*t[s][o]/e;t[o][o]/=e;for(var p=r;p<n;p++)t[o][p]/=e}return!0},ko);function ko(t,e){this.M=ko._calculateAffineTransform(t,e),this.inverseM=ko._calculateAffineTransform(e,t)}var Po,Mo=Object.freeze({__proto__:null,AffineTransform:Ao,_precision:Wn,get AreaUnits(){return _n},get DistanceUnits(){return bn},get TimeUnits(){return Sn},get SpeedUnits(){return In},get AccelerationUnits(){return Cn},boundingBoxToPolygon:function(t){var e=ro(Oo.getWest(t)),i=ro(Oo.getEast(t)),r=io(Oo.getNorth(t)),n=io(Oo.getSouth(t)),o=Oo.getCenter(t),a=[[e,r],[e,n],[o[0],n],[i,n],[i,r],[o[0],r],[e,r]];return new So([a])},convertDistance:Kn,getCardinalSpline:function(t,e,i,r){var n;if(!t||t.length<=2)return n;"number"!=typeof e&&(e=.5),("number"!=typeof i||i<=0)&&(i=15);var o=t.length;n=t.slice(0),r?(bo.areEqual(n[0],n[o-1])&&(n.pop(),o--),n.unshift(t[o-1]),n.push(t[0]),n.push(t[1]),o++):(n.unshift(t[0]),n.push(t[o-1]));var a,s,l,u=[];u.push([1,0,0,0]);for(var c=1;c<i-1;c++)l=(a=c/i)*(s=a*a),u.push([2*l-3*s+1,-2*l+3*s,l-2*s+a,l-s]);u.push([0,1,0,0]);var p,h,d,f,m,g,y,v=[];for(c=1;c<o;c++)for(h=e*(n[c+1][0]-n[c-1][0]),d=e*(n[c+1][1]-n[c-1][1]),f=e*(n[c+2][0]-n[c][0]),m=e*(n[c+2][1]-n[c][1]),a=0;a<i;a++)y=(p=u[a])[0]*n[c][0]+p[1]*n[c+1][0]+p[2]*h+p[3]*f,g=On(g=p[0]*n[c][1]+p[1]*n[c+1][1]+p[2]*d+p[3]*m,-85,85),v.push([y,g]);return v},getDestination:Xn,getDistanceTo:Yn,getEarthRadius:Jn,getGeodesicPath:function(t,e){var i;(!e||e<=0)&&(e=15),Array.isArray(t)?i=t:t.type&&"LineString"===t.type&&(i=t.coordinates);for(var r=i.length-1,n=[],o=0;o<r;o++)for(var a=Dn(i[o][1]),s=Dn(i[o][0]),l=Dn(i[o+1][1]),u=Dn(i[o+1][0]),c=2*Math.asin(Math.sqrt(Math.pow(Math.sin((a-l)/2),2)+Math.cos(a)*Math.cos(l)*Math.pow(Math.sin((s-u)/2),2))),p=0;p<=e;p++){var h=p/e,d=Math.sin((1-h)*c)/Math.sin(c),f=Math.sin(h*c)/Math.sin(c),m=d*Math.cos(a)*Math.cos(s)+f*Math.cos(l)*Math.cos(u),g=d*Math.cos(a)*Math.sin(s)+f*Math.cos(l)*Math.sin(u),y=d*Math.sin(a)+f*Math.sin(l),v=Math.atan2(y,Math.sqrt(Math.pow(m,2)+Math.pow(g,2))),_=Math.atan2(g,m);v=On(zn(v),-85,85),_=zn(_),n.push([_,v])}return n},getHeading:Qn,getLengthOfPath:$n,getPositionAlongPath:to,getRegularPolygonPath:eo,interpolate:function(t,e,i){i=void 0===i?.5:i;var r=Yn(t=yo(t),e=yo(e),"kilometers");return Xn(t,Qn(t,e),r*i,"kilometers")},normalizeLatitude:io,normalizeLongitude:ro,rotatePositions:no,getPixelHeading:function(t,e){var i=ao([t=yo(t),e=yo(e)],21),r=i[0],n=i[1],o=n[0]-r[0],a=r[1]-n[1];return(2.5*Math.PI-Math.atan2(a,o))*Mn%360},mercatorPixelsToPositions:oo,mercatorPositionsToPixels:ao,convertAcceleration:so,convertArea:lo,convertSpeed:uo,convertTimespan:co,getAcceleration:po,getAccelerationFromSpeeds:ho,getAccelerationFromFeatures:function(t,e,i,r,n,o,a){if("string"==typeof i&&"Feature"===t.type&&"Point"===t.geometry.type&&"Feature"===e.type&&"Point"===e.geometry.type){var s=fo(t.properties[i],e.properties[i],Sn.seconds);if(!isNaN(s)){var l=0;if(r&&"string"==typeof r){var u=t.properties[r],c=e.properties[r];if("number"==typeof u&&(l=u,"number"==typeof c))return ho(u,c,s,n,Sn.seconds,o,a)}return po(l,Yn(t.geometry.coordinates,e.geometry.coordinates,bn.meters),s,n,bn.meters,Sn.seconds,o,a)}}return NaN},getArea:function t(e,i,r){if(e){var n=0;switch((e=e instanceof Lo?e.toJson():e).type){case"Feature":if(e.geometry)return t(e.geometry,i,r);break;case"Polygon":e.coordinates&&(n=qn(e.coordinates));break;case"MultiPolygon":var o=e;if(o.coordinates)for(var a=0,s=o.coordinates.length;a<s;a++)n+=qn(o.coordinates[a])}return lo(n,_n.squareMeters,i,r)}return 0},getSpeed:function(t,e,i,r,n,o){var a=yo(t),s=yo(e);if(a&&s){var l=co(i,r,Sn.seconds);return uo(Yn(a,s,bn.meters)/l,In.metersPerSecond,n,o)}return 0},getSpeedFromFeatures:function(t,e,i,r,n){if("string"==typeof i&&"Feature"===t.type&&"Point"===t.geometry.type&&"Feature"===e.type&&"Point"===e.geometry.type){var o=this.getTimespan(t.properties[i],e.properties[i],Sn.seconds);if(!isNaN(o)){var a=this.getDistanceTo(t.geometry.coordinates,e.geometry.coordinates,bn.meters);return this.convertSpeed(a/o,In.metersPerSecond,r,n)}}return NaN},getTimespan:fo,getTravelDistance:function(t,e,i,r,n,o,a,s){e=this.convertTimespan(e,n,Sn.seconds);var l=(i=this.convertSpeed(i,o,In.metersPerSecond))*e;return"number"==typeof r&&(l+=.5*this.convertAcceleration(r,a,Cn.metersPerSecondSquared)*e*e),this.convertDistance(l,bn.meters,t,s)},parseTimestamp:mo,getConvexHull:function(t){var e=go(t).map(function(t){return[ro(t[0]),io(t[1])]});e.sort(function(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]});for(var i=[],r=0,n=e;r<n.length;r++){for(var o=n[r];2<=i.length&&Gn(i[i.length-2],i[i.length-1],o)<=0;)i.pop();i.push(o)}for(var a=[],s=e.length-1;0<=s;s--){for(;2<=a.length&&Gn(a[a.length-2],a[a.length-1],e[s])<=0;)a.pop();a.push(e[s])}return new So([i.concat(a)])},getPositions:go,getPosition:yo,getPositionsAlongPath:function(t,e){if(e<2)return[];for(var i=[],r=$n(t,bn.meters)/(e-1),n=0;n<e;n++){var o=to(t,r*n,bn.meters);null!=o&&i.push(o)}return i},getPointWithHeadingAlongPath:vo,getPointsWithHeadingsAlongPath:function(t,e){if(e<=0)return[];for(var i=[],r=$n(t,bn.meters)/(e-1),n=0;n<e;n++){var o=vo(t,r*n,bn.meters);null!=o&&i.push(o)}return i},getClosestPointOnGeometry:_o}),Lo=(b(Do,Po=Io),Do.prototype.addProperty=function(t,e){un(this.data.properties[t],e)||(this.data.properties[t]=Ar(e),"subType"!==t&&"radius"!==t||this._handleCircle(),this.dataSource&&this.dataSource._updateSource(),this._invokeEvent("shapechanged",this))},Do.prototype.getBounds=function(){var t,e=this.getCoordinates(),i=this.getType();if("Point"===i)if(this.circlePolygon){var r=this.circlePolygon.geometry.coordinates;t=Oo.fromPositions(r[0])}else t=new Oo(r=e,r);else if("MultiPoint"===i||"LineString"===i)r=e,t=Oo.fromPositions(r);else if("Polygon"===i)r=e,t=Oo.fromPositions(r[0]);else if("MultiLineString"===i)for(var n=0,o=r=e;n<o.length;n++){var a=o[n];t=Oo.merge(t,Oo.fromPositions(a))}else if("MultiPolygon"===i)for(var s=0,l=r=e;s<l.length;s++){var u=l[s];t=Oo.merge(t,Oo.fromPositions(u[0]))}return t},Do.prototype.getCoordinates=function(){return Ar(this.data.geometry.coordinates)},Do.prototype.getCircleCoordinates=function(){return this.circlePolygon?Ar(this.circlePolygon.geometry.coordinates[0]):null},Do.prototype.getId=function(){return this.data.id},Do.prototype.getProperties=function(){return Ar(this.data.properties)},Do.prototype.getType=function(){return this.data.geometry.type},Do.prototype.isCircle=function(){return Do._isCircle(this.data)},Do.prototype.isRectangle=function(){return Do._isRectangle(this.data)},Do.prototype.setCoordinates=function(t){var e;e="Polygon"===this.getType()&&1===bo._getDimensions(t)?[t]:t,un(this.data.geometry.coordinates,e)||(this.data.geometry.coordinates=Ar(e),this._handleCircle(),this.dataSource&&this.dataSource._updateSource(),this._invokeEvent("shapechanged",this))},Do.prototype.setProperties=function(t){t[Do._shapeIdPropName]=this.data.id,un(this.data.properties,t)||(this.data.properties=Ar(t),this._handleCircle(),this.dataSource&&this.dataSource._updateSource(),this._invokeEvent("shapechanged",this))},Do.prototype.toJson=function(){return JSON.parse(JSON.stringify(this.data))},Do.prototype._toJson=function(){return this.circlePolygon||this.data},Do.prototype._setDataSource=function(t){void 0===t||null==t?delete this.dataSource:this.dataSource=t},Do.prototype._handleCircle=function(){if(this.isCircle()){var t=Do._getCirclePositions(this.data);this.circlePolygon=new hn(new So([t]),this.data.properties,this.data.id),this.data.properties.subType="Circle"}else delete this.circlePolygon},Do._isCircle=function(t){return t&&t.geometry&&"Point"===t.geometry.type&&t.geometry.coordinates&&t.properties&&"string"==typeof t.properties.subType&&"circle"===t.properties.subType.toLowerCase()&&"number"==typeof t.properties.radius},Do._isRectangle=function(t){if("Polygon"===t.geometry.type&&t.geometry.coordinates&&"string"==typeof t.properties.subType&&"rectangle"===t.properties.subType.toLowerCase()){var e=t.geometry.coordinates;if(1===e.length){var i=e[0];if(5===i.length)return i[0][0]===i[4][0]&&i[0][1]===i[4][1];if(4===i.length)return!0}}return!1},Do._getCirclePositions=function(t){return eo(t.geometry.coordinates,t.properties.radius,72,"meters")},Do._shapeIdPropName="_azureMapsShapeId",Do);function Do(t,e,i){var r,n=Po.call(this)||this;if("Feature"===t.type){var o=t;r=Ar(o.geometry),i=o.properties?Ar(o.properties):{},e=null==o.id||""===o.id?pn():o.id}else r=Ar(t),e=null==e||""===e?pn():e,i=i?Ar(i):{};return i[Do._shapeIdPropName]=e,n.data=new hn(r,i,e),n._handleCircle(),n}var zo,Oo=(b(Ro,zo=Array),Ro.fromBoundingBox=function(t){var e=Ro.getWest(t),i=Ro.getSouth(t),r=Ro.getEast(t),n=Ro.getNorth(t);return new Ro([e,i,r,n])},Ro.fromDimensions=function(t,e,i){var r=t[0],n=t[1],o=Math.min(Math.max(n+i/2,-85.5),85.5),a=Math.min(Math.max(n-i/2,-85.5),85.5),s=ro(r+e/2);return new Ro([ro(r-e/2),a,s,o])},Ro.fromEdges=function(t,e,i,r){return new Ro([t,e,i,r])},Ro.containsPosition=function(t,e){var i=Ro.getCenter(t),r=Math.abs(i[1]-e[1]),n=Math.abs(i[0]-e[0]);180<n&&(n=360-n);var o=Ro.getHeight(t),a=Ro.getWidth(t);return r<=o/2+1e-8&&n<=a/2+1e-8},Ro.crossesAntimeridian=function(t){return ro(Ro.getEast(t))-ro(Ro.getWest(t))<0},Ro.getCenter=function(t){var e=ro(Ro.getEast(t)),i=ro(Ro.getWest(t));e<i&&(e+=360);var r=ro((i+e)/2),n=io(Ro.getSouth(t)),o=io(Ro.getNorth(t));return[r,io((n+o)/2)]},Ro.getHeight=function(t){var e=io(Ro.getNorth(t))-io(Ro.getSouth(t));return isNaN(e)?0:e},Ro.getWidth=function(t){var e=ro(Ro.getEast(t))-ro(Ro.getWest(t));return isNaN(e)?0:e<0?e+=360:e},Ro.getSouthWest=function(t){var e=this.getSouth(t),i=this.getWest(t);return isNaN(e)||isNaN(i)?null:[i,e]},Ro.getNorthEast=function(t){var e=this.getNorth(t),i=this.getEast(t);return isNaN(e)||isNaN(i)?null:[i,e]},Ro.getNorthWest=function(t){var e=this.getNorth(t),i=this.getWest(t);return isNaN(e)||isNaN(i)?null:[i,e]},Ro.getSouthEast=function(t){var e=this.getSouth(t),i=this.getEast(t);return isNaN(e)||isNaN(i)?null:[i,e]},Ro.getSouth=function(t){return t&&4<=t.length?Number(t[1]):NaN},Ro.getWest=function(t){return t&&4<=t.length?Number(t[0]):NaN},Ro.getNorth=function(t){if(t){if(4===t.length)return Number(t[3]);if(6===t.length)return Number(t[4])}return NaN},Ro.getEast=function(t){if(t){if(4===t.length)return Number(t[2]);if(6===t.length)return Number(t[3])}return NaN},Ro.intersect=function(t,e){var i=Ro.getCenter(t),r=Ro.getCenter(e),n=Math.abs(i[1]-r[1]),o=Math.abs(i[0]-r[0]);180<o&&(o=360-o);var a=Ro.getHeight(t),s=Ro.getWidth(t),l=Ro.getHeight(e),u=Ro.getWidth(e);return n<=a/2+l/2&&o<=s/2+u/2},Ro.merge=function(t,e){var i=t&&4===t.length,r=e&&4===e.length;if(i&&!r)return t;if(r&&!i)return e;if(!i&&!r)return null;var n=Math.max(io(Ro.getNorth(t)),io(Ro.getNorth(e))),o=Math.min(io(Ro.getSouth(t)),io(Ro.getSouth(e))),a=[t,e],s=[],l=0;for(l=0;l<a.length;l++){var u=a[l],c=ro(Ro.getWest(u)),p=ro(Ro.getEast(u));Ro.crossesAntimeridian(u)?(s.push([c,180]),s.push([-180,p])):s.push([c,p])}s.sort(function(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]});var h=[],d=s[0];for(l=1;l<s.length;){var f=s[l];d[1]>=f[0]?d[1]=Math.max(d[1],f[1]):(h.push(d),d=f),l++}h.push(d);var m=h.length,g=h[0][0]+360-h[m-1][1],y=[h[m-1][1],h[0][0]];for(l=1;l<m;l++){var v=h[l][0]-h[l-1][1];g<v&&(g=v,y=[h[l-1][1],h[l][0]])}return new Ro([y[1],o],[y[0],n])},Ro.fromPositions=function(t){for(var e,i=NaN,r=NaN,n=NaN,o=NaN,a=t.length,s=new Array(a),l=0;a--;)if((e=t[a])&&2<=e.length){var u=io(e[1]);i=isNaN(i)?u:Math.max(i,u),r=isNaN(r)?u:Math.min(r,u),s[l++]=ro(e[0])}if(l){s.length=l,s.sort(function(t,e){return t-e});var c=s[0]+360-s[l-1],p=0;for(a=1;a<l;a++){var h=s[a]-s[a-1];c<h&&(c=h,p=a)}n=s[p],o=s[(p||l)-1]}return isNaN(n)||isNaN(r)||isNaN(o)||isNaN(i)?null:new Ro([n,r,o,i])},Ro.fromLatLngs=function(t){return Ro.fromPositions(bo.fromLatLngs(t))},Ro.fromData=function(t){var e,i=null;if(Array.isArray(t)&&0<t.length){for(var r=0,n=t;r<n.length;r++){var o=n[r];null!=(e=Ro.fromData(o))&&(i=null===i?e:Ro.merge(i,e))}return i}if(t instanceof Lo)return t.getBounds();if(t&&t.type){var a=t;if(a.bbox&&4===a.bbox.length)return a.bbox;switch(a.type){case"FeatureCollection":return Ro.fromData(a.features);case"Feature":return Lo._isCircle(a)?Ro.fromPositions(Lo._getCirclePositions(a)):Ro.fromData(a.geometry);case"GeometryCollection":return Ro.fromData(a.geometries);case"Point":var s=a.coordinates;if(s&&2<=s.length)return[s[0],s[1],s[0],s[1]];break;case"LineString":case"MultiPoint":return Ro.fromPositions(a.coordinates);case"Polygon":case"MultiLineString":var l=a.coordinates;if(l&&0<l.length){for(var u=0,c=l.length;u<c;u++)null!=(e=Ro.fromPositions(l[u]))&&(i=null===i?e:Ro.merge(i,e));if(null!=i)return i}break;case"MultiPolygon":var p=a.coordinates;if(p&&0<p.length){for(u=0,c=p.length;u<c;u++)for(var h=0,d=p[u].length;h<d;h++)null!=(e=Ro.fromPositions(p[u][h]))&&(i=null===i?e:Ro.merge(i,e));return i}}}return null},Ro.splitOnAntimeridian=function(t){var e=[];if(Ro.crossesAntimeridian(t)){var i=void 0,r=void 0,n=ro(Ro.getWest(t)),o=ro(Ro.getEast(t)),a=io(Ro.getNorth(t)),s=io(Ro.getSouth(t));r=6<=t.length?(i=new Ro([n,s,t[2],180,a,t[5]]),new Ro([-180,s,t[2],o,a,t[5]])):(i=new Ro([n,s,180,a]),new Ro([-180,s,o,a])),e.push(i,r)}else e.push(new Ro(t));return e},Ro);function Ro(t,e){var i=this;if(t&&e){var r=t;i=r[2]&&e[2]?zo.call(this,r[0],r[1],r[2]||0,e[0],e[1],e[2]||0)||this:zo.call(this,r[0],r[1],e[0],e[1])||this}else if(t){var n=t;n&&(4===n.length?i=zo.call(this,n[0],n[1],n[2],n[3])||this:6<=n.length&&(i=zo.call(this,n[0],n[1],n[2],n[3],n[4],n[5])||this))}return i}var No=(Bo.TYPE="FeatureCollection",Bo);function Bo(t,e){this.type="FeatureCollection",this.type=Bo.TYPE,this.features=t,this.bbox=e}var Fo=(Uo.TYPE="GeometryCollection",Uo);function Uo(t){this.type="GeometryCollection",this.type=Uo.TYPE,this.geometries=t}var jo=(qo.TYPE="LineString",qo);function qo(t,e){this.type="LineString",this.type=qo.TYPE,this.coordinates=t,this.bbox=e}var Vo=(Go.TYPE="MultiLineString",Go);function Go(t,e){this.type="MultiLineString",this.type=Go.TYPE,this.coordinates=t,this.bbox=e}var Zo=(Ho.TYPE="MultiPoint",Ho);function Ho(t,e){this.type="MultiPoint",this.type=Ho.TYPE,this.coordinates=t,this.bbox=e}var Wo=(Ko.TYPE="MultiPolygon",Ko);function Ko(t,e){this.type="MultiPolygon",this.type=Ko.TYPE,this.coordinates=t,this.bbox=e}var Xo=Object.freeze({__proto__:null,Feature:hn,FeatureCollection:No,LineString:jo,Point:yn,Polygon:So,Position:bo,BoundingBox:Oo,MultiLineString:Vo,MultiPoint:Zo,MultiPolygon:Wo,GeometryCollection:Fo});var Yo,Jo=function(t,e){return Er(t,5,e="function"==typeof e?e:void 0)},Qo=(b($o,Yo=I),$o);function $o(){var t=null!==Yo&&Yo.apply(this,arguments)||this;return t.maxZoom=18,t.cluster=!1,t.clusterRadius=50,t.clusterMaxZoom=void 0,t.clusterProperties=void 0,t.lineMetrics=!1,t.tolerance=.375,t}var ta,ea=(b(ia,ta=Io),ia.prototype.getId=function(){return this.id},ia.prototype._setMap=function(t){if(null==t||void 0===t){var e=this.map;delete this.map,this._invokeEvent("sourceremoved",this),e&&e.events.invoke("sourceremoved",this)}else this.map=t,this._invokeEvent("sourceadded",this),this.map.events.invoke("sourceadded",this)},ia);function ia(t){var e=ta.call(this)||this;return e.id=t||pn(),e}var ra,na=(b(oa,ra=ea),oa.prototype.add=function(t,e){this._addNoUpdate(t,e),this._updateSource()},oa.prototype.clear=function(){this._clearNoUpdate(),this._updateSource()},oa.prototype.dispose=function(){this.options=null,this.shapes=null,this.shapesMap=null,this.map=null},oa.prototype.getClusterExpansionZoom=function(e){var n=this;return new Promise(function(i,r){if(n.map){var t=n.map._getMap().getSource(n.getId());t&&"geojson"===t.type&&t.getClusterExpansionZoom(e,function(t,e){t?r(t):"number"!=typeof e||i(e)})}else r("The DataSource hasn't been added to a map.")})},oa.prototype.getClusterChildren=function(e){var n=this;return new Promise(function(i,r){if(n.map){var t=n.map._getMap().getSource(n.getId());t&&"geojson"===t.type&&t.getClusterChildren(e,function(t,e){t?r(t):e&&i(n.map.sources._mapFeaturesToShapes(e,!1,n))})}else r("The DataSource hasn't been added to a map.")})},oa.prototype.getClusterLeaves=function(e,n,o){var a=this;return new Promise(function(i,r){if(a.map){var t=a.map._getMap().getSource(a.getId());t&&"geojson"===t.type&&t.getClusterLeaves(e,n,o,function(t,e){t?r(t):e&&i(a.map.sources._mapFeaturesToShapes(e,!1,a))})}else r("The DataSource hasn't been added to a map.")})},oa.prototype.getOptions=function(){return Ar(this.options)},oa.prototype.getShapes=function(){return Array.from(this.shapes)},oa.prototype.importDataFromUrl=function(t){var e=this;return fetch(t,{method:"GET",mode:"cors"}).then(function(t){if(t.ok)return t.json();throw new Error("HTTP "+t.status+": "+t.statusText)}).then(function(t){e.add(t)})},oa.prototype.getShapeById=function(t){return this.shapes[this.shapesMap.get(t)]||null},oa.prototype.remove=function(t){for(var e=0,i=Array.isArray(t)?t:[t];e<i.length;e++){var r=i[e];"number"==typeof r?this._removeByIndex(r):this._removeById(r)}this._updateSource()},oa.prototype.removeById=function(t){for(var e=0,i=Array.isArray(t)?t:[t];e<i.length;e++){var r=i[e];this._removeById(r)}this._updateSource()},oa.prototype.setOptions=function(t){var e=(new Qo).merge(this.options,Ar(t));un(this.options,e)||(this._invokeEvent("datasourceupdated",this),this.options=e,this.map&&this.map._rebuildStyle())},oa.prototype.setShapes=function(t){this._clearNoUpdate(),this.add(t)},oa.prototype.toJson=function(){return new No(this.shapes.map(function(t){return t.toJson()}))},oa.prototype._toJson=function(){return new No(this.shapes.map(function(t){return t._toJson()}))},oa.prototype._buildSource=function(){var t={type:"geojson",data:this._toJson(),maxzoom:this.options.maxZoom,cluster:this.options.cluster,clusterRadius:this.options.clusterRadius,tolerance:this.options.tolerance,lineMetrics:this.options.lineMetrics,clusterProperties:this.options.clusterProperties};return"number"==typeof this.options.clusterMaxZoom&&(t.clusterMaxZoom=this.options.clusterMaxZoom),t},oa.prototype._addNoUpdate=function(t,e){var i;if(t instanceof Lo)this._addToSources(t,e),i=[t];else if(Array.isArray(t))i=t.map(function(t){return t instanceof Lo?t:new Lo(t)}),this._addToSources(i,e);else if("FeatureCollection"===t.type)i=t.features.map(function(t){return new Lo(t)}),this._addToSources(i,e);else if("GeometryCollection"===t.type)i=t.geometries.map(function(t){return new Lo(t)}),this._addToSources(i,e);else{var r=new Lo(t);this._addToSources(r,e),i=[r]}this._invokeEvent("dataadded",i)},oa.prototype._clearNoUpdate=function(){var t=this.shapes;this.shapes=[],this.shapesMap=new kr,t&&0<t.length&&this._invokeEvent("dataremoved",t)},oa.prototype._updateSource=function(){var t=this;void 0===this.requestId&&(this.requestId=requestAnimationFrame(function(){t._updateMboxSource(),t.requestId=void 0}))},oa.prototype._addToSources=function(t,e){if(t=Array.isArray(t)?t:[t],"number"!=typeof e)for(var i=0,r=t;i<r.length;i++){var n=r[i];this.shapes.push(n),this.shapesMap.set(n.getId(),this.shapes.length-1)}else for(var o=t.length-1;0<=o;o--)this.shapes.splice(e,0,t[o]),this._updateShapesMap(e);for(var a=0,s=t;a<s.length;a++)(n=s[a])._setDataSource(this)},oa.prototype._removeById=function(t){var e,i=t instanceof Lo?t.getId():"string"==typeof t||"number"==typeof t?t:t.id;(e=this.shapes[this.shapesMap.get(i)])._setDataSource(null),this.shapes.splice(this.shapesMap.get(i),1),this._updateShapesMap(this.shapesMap.get(i)),this.shapesMap.delete(i),this._invokeEvent("dataremoved",[e])},oa.prototype._removeByIndex=function(t){var e;if(t>=this.shapes.length)throw new Error("The specified remove index '"+t+"' is greater than the maximum possible index '"+(this.shapes.length-1)+"'");e=this.shapes[t],this.shapesMap.delete(e.getId()),e._setDataSource(null),this.shapes.splice(t,1),this._updateShapesMap(t),this._invokeEvent("dataremoved",[e])},oa.prototype._updateShapesMap=function(t){for(var e=t;e<this.shapes.length;e++)this.shapesMap.set(this.shapes[e].getId(),e)},oa.prototype._updateMboxSource=function(){if(this.map&&this.map._getMap()){var t=this.map._getMap().getSource(this.getId());t&&"geojson"===t.type&&t.setData(this._toJson())}},oa);function oa(t,e){var i=ra.call(this,t)||this;return i.requestId=void 0,i.options=(new Qo).merge(Ar(e)),i.shapes=[],i.shapesMap=new kr,i}var aa,sa=(b(la,aa=I),la);function la(){var t=null!==aa&&aa.apply(this,arguments)||this;return t.bounds=void 0,t.minZoom=0,t.maxZoom=22,t.isTMS=!1,t.tiles=void 0,t.tileSize=512,t.url=void 0,t}var ua,ca=(b(pa,ua=ea),pa.prototype.getOptions=function(){return Ar(this.options)},pa.prototype.getShape=function(t,e){return this.map._getMap().querySourceFeatures(this.getId(),{sourceLayer:t,filter:e})},pa.prototype._buildSource=function(){var t={type:"vector"};return this.options.bounds&&(t.bounds=this.options.bounds),this.options.tiles?(t.tiles=this.options.tiles,t.minzoom=this.options.minZoom,t.maxzoom=this.options.maxZoom):this.options.url&&(t.url=this.options.url),this.options.isTMS&&(t.scheme="tms"),this.options.tileSize&&(t.tileSize=this.options.tileSize),t},pa);function pa(t,e){var i=ua.call(this,t)||this;return i.options=(new sa).merge(Ar(e)),i}var ha,da=Object.freeze({__proto__:null,Source:ea,DataSource:na,VectorTileSource:ca}),fa=(b(ma,ha=Io),ma.prototype.getId=function(){return this.id},ma.prototype.getMap=function(){return this.map||null},ma.prototype.onAdd=function(t){this.map=t,this._invokeEvent("layeradded",this),this.map.events.invoke("layeradded",this)},ma.prototype.onRemove=function(){var t=this.map;delete this.map,this._invokeEvent("layerremoved",this),t&&t.events.invoke("layerremoved",this)},ma._isMBoxEvent=function(t){return!this.LayerEvents.hasOwnProperty(t)},ma.prototype._updateBaseProperties=function(t,e){this._updateFilter(t.filter,e.filter),this._updateZoomRange(t.minZoom,e.minZoom,t.maxZoom,e.maxZoom),this._updateLayoutProperty("visibility",t.visible,e.visible,t.visible?"visible":"none")},ma.prototype._updateFilter=function(t,e){un(t,e)||this.map._getMap().setFilter(this.id,t)},ma.prototype._updatePaintProperty=function(t,e,i,r){un(e,i)||this.map._getMap().setPaintProperty(this.id,t,r||e)},ma.prototype._updateLayoutProperty=function(t,e,i,r){un(e,i)||this.map._getMap().setLayoutProperty(this.id,t,r||e)},ma.prototype._updateZoomRange=function(t,e,i,r){t===e&&r===i||this.map._getMap().setLayerZoomRange(this.id,t,i)},ma.LayerEvents={layeradded:void 0,layerremoved:void 0},ma);function ma(t){var e=ha.call(this)||this;return e.id=t||pn(),e}var ga,ya=(b(va,ga=I),va._cloneCustomizer=function(t){if(t instanceof ea)return t},va);function va(){var t=null!==ga&&ga.apply(this,arguments)||this;return t.filter=void 0,t.minZoom=0,t.maxZoom=24,t.visible=!0,t}var _a,xa=(b(ba,_a=ya),ba);function ba(){var t=null!==_a&&_a.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.color="#1A73AA",t.blur=0,t.opacity=1,t.strokeColor="#FFFFFF",t.strokeOpacity=1,t.strokeWidth=2,t.pitchAlignment="viewport",t.radius=8,t}var wa,Sa=(b(Ta,wa=fa),Ta.prototype.getOptions=function(){return Jo(this.options,xa._cloneCustomizer)},Ta.prototype.getSource=function(){return this.options.source},Ta.prototype.setOptions=function(t){var e=(new xa).merge(this.options,Jo(t,xa._cloneCustomizer));if(this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("circle-blur",e.blur,this.options.blur),this._updatePaintProperty("circle-color",e.color,this.options.color),this._updatePaintProperty("circle-opacity",e.opacity,this.options.opacity),this._updatePaintProperty("circle-radius",e.radius,this.options.radius),this._updatePaintProperty("circle-stroke-color",e.strokeColor,this.options.strokeColor),this._updatePaintProperty("circle-stroke-opacity",e.strokeOpacity,this.options.strokeOpacity),this._updatePaintProperty("circle-stroke-width",e.strokeWidth,this.options.strokeWidth),this._updatePaintProperty("circle-pitch-alignment",e.pitchAlignment,this.options.pitchAlignment)}this.options=e},Ta.prototype._buildLayers=function(){var t={id:this.id,type:"circle",source:this.options.source instanceof ea?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:{"circle-color":this.options.color,"circle-blur":this.options.blur,"circle-opacity":this.options.opacity,"circle-stroke-color":this.options.strokeColor,"circle-stroke-opacity":this.options.strokeOpacity,"circle-stroke-width":this.options.strokeWidth,"circle-pitch-alignment":this.options.pitchAlignment,"circle-radius":this.options.radius},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(t.filter=this.options.filter),this.options.sourceLayer&&(t["source-layer"]=this.options.sourceLayer),[t]},Ta.prototype._getLayerIds=function(){return[this.id]},Ta.prototype._getSourceIds=function(){var t=new Set;return this.options.source instanceof ea?t.add(this.options.source.getId()):t.add(this.options.source),t},Ta);function Ta(t,e,i){var r=wa.call(this,e)||this;return r.options=(new xa).merge(Jo(i,xa._cloneCustomizer)),r.options.source=t||r.options.source,r}var Ia,Ea=(b(Ca,Ia=ya),Ca._cloneCustomizer=function(t){if(t instanceof ea)return t},Ca);function Ca(){var t=null!==Ia&&Ia.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.color=["interpolate",["linear"],["heatmap-density"],0,"rgba(0,0, 255,0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],t.intensity=1,t.opacity=1,t.radius=30,t.weight=1,t}var Aa,ka=(b(Pa,Aa=fa),Pa.prototype.getOptions=function(){return Jo(this.options,Ea._cloneCustomizer)},Pa.prototype.getSource=function(){return this.options.source},Pa.prototype.setOptions=function(t){var e=(new Ea).merge(this.options,Jo(t,Ea._cloneCustomizer));if(this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("heatmap-color",e.color,this.options.color),this._updatePaintProperty("heatmap-intensity",e.intensity,this.options.intensity),this._updatePaintProperty("heatmap-opacity",e.opacity,this.options.opacity),this._updatePaintProperty("heatmap-radius",e.radius,this.options.radius),this._updatePaintProperty("heatmap-weight",e.weight,this.options.weight)}this.options=e},Pa.prototype._buildLayers=function(){var t={id:this.id,type:"heatmap",source:this.options.source instanceof ea?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:{"heatmap-color":this.options.color,"heatmap-intensity":this.options.intensity,"heatmap-opacity":this.options.opacity,"heatmap-radius":this.options.radius,"heatmap-weight":this.options.weight},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(t.filter=this.options.filter),this.options.sourceLayer&&(t["source-layer"]=this.options.sourceLayer),[t]},Pa.prototype._getLayerIds=function(){return[this.id]},Pa.prototype._getSourceIds=function(){var t=new Set;return this.options.source instanceof ea?t.add(this.options.source.getId()):t.add(this.options.source),t},Pa);function Pa(t,e,i){var r=Aa.call(this,e)||this;return r.options=(new Ea).merge(Jo(i,Ea._cloneCustomizer)),r.options.source=t||r.options.source,r}var Ma,La=(b(Da,Ma=ya),Da);function Da(){var t=null!==Ma&&Ma.apply(this,arguments)||this;return t.contrast=0,t.fadeDuration=300,t.hueRotation=0,t.maxBrightness=1,t.minBrightness=0,t.opacity=1,t.saturation=0,t}var za,Oa=(b(Ra,za=La),Ra._cloneCustomizer=function(t){if(t instanceof ea)return t},Ra);function Ra(){var t=null!==za&&za.apply(this,arguments)||this;return t.url=void 0,t.coordinates=void 0,t}var Na,Ba=(b(Fa,Na=fa),Fa.prototype._getSourceIds=function(){var t=new Set;return t.add(this._getSourceId()),t},Fa);function Fa(){return null!==Na&&Na.apply(this,arguments)||this}var Ua,ja=(b(qa,Ua=Ba),qa.prototype.getOptions=function(){return Jo(this.options,Oa._cloneCustomizer)},qa.prototype.setOptions=function(t){var e=(new Oa).merge(this.options,Jo(t,Oa._cloneCustomizer)),i="string"==typeof t.url&&t.url!==this.getOptions().url,r=void 0!==t.coordinates&&t.coordinates!==this.getOptions().coordinates;if(this.map){this._updateBaseProperties(e,this.options),this._updatePaintProperty("raster-contrast",e.contrast,this.options.contrast),this._updatePaintProperty("raster-fade-duration",e.fadeDuration,this.options.fadeDuration),this._updatePaintProperty("raster-hue-rotate",e.hueRotation,this.options.hueRotation),this._updatePaintProperty("raster-brightness-max",e.maxBrightness,this.options.maxBrightness),this._updatePaintProperty("raster-opacity",e.opacity,this.options.opacity),this._updatePaintProperty("raster-saturation",e.saturation,this.options.saturation);var n=this.map._getMap().getSource(this._getSourceId());n&&n.updateImage(e)}this.options=e,i?this.reloadImage():r&&this.updateTransform()},qa.prototype.getPositions=function(e){return this.transform.then(function(t){return t.toTarget(e)})},qa.prototype.getPixels=function(e){return this.transform.then(function(t){return t.toSource(e)})},qa.getCoordinatesFromRefPoints=function(t,e,i,r){return new Ao(i,r).toTarget([[0,0],[t,0],[t,e],[0,e]])},qa.getCoordinatesFromEdges=function(t,e,i,r,n){"number"!=typeof n&&(n=0);var o=[Math.min(r,i),e,Math.max(r,i),t],a=Oo.getCenter(o);return no([Oo.getNorthWest(o),Oo.getNorthEast(o),Oo.getSouthEast(o),Oo.getSouthWest(o)],a,n)},qa.prototype._buildLayers=function(){var t={id:this.id,type:"raster",source:this._getSourceId(),layout:{visibility:this.options.visible?"visible":"none"},paint:{"raster-opacity":this.options.opacity,"raster-hue-rotate":this.options.hueRotation,"raster-brightness-min":this.options.minBrightness,"raster-brightness-max":this.options.maxBrightness,"raster-saturation":this.options.saturation,"raster-contrast":this.options.contrast,"raster-fade-duration":this.options.fadeDuration},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(t.filter=this.options.filter),[t]},qa.prototype._getLayerIds=function(){return[this.id]},qa.prototype._buildSource=function(){return{type:"image",url:this.options.url,coordinates:this.options.coordinates}},qa.prototype._getSourceId=function(){return this.getId()+"-ImageSource"},qa.prototype.reloadImage=function(){var i=this;this.options.url&&(this.transform=new Promise(function(e,t){i.img.onload=function(){var t=[[0,0],[i.img.width,0],[i.img.width,i.img.height],[0,i.img.height]];e(new Ao(t,i.options.coordinates)),i.isLoading=!1},i.img.onerror=i.img.onabort=function(){t("Failed to load image")},i.isLoading=!0,i.img.src=i.options.url}))},qa.prototype.updateTransform=function(){if(!this.isLoading){var t=[[0,0],[this.img.width,0],[this.img.width,this.img.height],[0,this.img.height]];this.transform=Promise.resolve(new Ao(t,this.options.coordinates))}},qa);function qa(t,e){var i=Ua.call(this,e)||this;return i.isLoading=!1,i.options=(new Oa).merge(Jo(t,Oa._cloneCustomizer)),i.img=new Image,i.reloadImage(),i}var Va,Ga=(b(Za,Va=ya),Za);function Za(){var t=null!==Va&&Va.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.lineCap="round",t.lineJoin="round",t.blur=0,t.strokeColor="#1E90FF",t.strokeDashArray=void 0,t.strokeGradient=void 0,t.offset=0,t.strokeOpacity=1,t.translate=new mn(0,0),t.translateAnchor="map",t.strokeWidth=2,t}var Ha,Wa=(b(Ka,Ha=fa),Ka.prototype.getOptions=function(){return Jo(this.options,Ga._cloneCustomizer)},Ka.prototype.getSource=function(){return this.options.source},Ka.prototype.setOptions=function(t){var e=(new Ga).merge(this.options,Jo(t,Ga._cloneCustomizer));if(this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("line-blur",e.blur,this.options.blur),this._updateLayoutProperty("line-cap",e.lineCap,this.options.lineCap),this._updateLayoutProperty("line-join",e.lineJoin,this.options.lineJoin),this._updatePaintProperty("line-offset",e.offset,this.options.offset),this._updatePaintProperty("line-color",e.strokeColor,this.options.strokeColor),this._updatePaintProperty("line-dasharray",e.strokeDashArray,this.options.strokeDashArray),this._updatePaintProperty("line-gradient",e.strokeGradient,this.options.strokeGradient),this._updatePaintProperty("line-opacity",e.strokeOpacity,this.options.strokeOpacity),this._updatePaintProperty("line-width",e.strokeWidth,this.options.strokeWidth),this._updatePaintProperty("line-translate",e.translate,this.options.translate),this._updatePaintProperty("line-translate-anchor",e.translateAnchor,this.options.translateAnchor)}this.options=e},Ka.prototype._buildLayers=function(){return[w(w(w(w({id:this.id,type:"line"},this.options.sourceLayer&&{"source-layer":this.options.sourceLayer}),{source:this.options.source instanceof ea?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none","line-cap":this.options.lineCap,"line-join":this.options.lineJoin},paint:w(w(w({"line-blur":this.options.blur,"line-color":this.options.strokeColor},this.options.strokeDashArray&&{"line-dasharray":this.options.strokeDashArray}),this.options.strokeGradient&&{"line-gradient":this.options.strokeGradient}),{"line-offset":this.options.offset,"line-opacity":this.options.strokeOpacity,"line-translate":this.options.translate,"line-translate-anchor":this.options.translateAnchor,"line-width":this.options.strokeWidth})}),this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},Ka.prototype._getLayerIds=function(){return[this.id]},Ka.prototype._getSourceIds=function(){var t=new Set;return this.options.source instanceof ea?t.add(this.options.source.getId()):t.add(this.options.source),t},Ka);function Ka(t,e,i){var r=Ha.call(this,e)||this;return r.options=(new Ga).merge(Jo(i,Ga._cloneCustomizer)),r.options.source=t||r.options.source,r}var Xa,Ya=(b(Ja,Xa=ya),Ja);function Ja(){var t=null!==Xa&&Xa.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.base=0,t.fillColor="#1E90FF",t.height=0,t.fillOpacity=1,t.fillPattern=void 0,t.translate=new mn(0,0),t.translateAnchor="map",t.verticalGradient=!0,t}var Qa,$a=(b(ts,Qa=fa),ts.prototype.getOptions=function(){return Jo(this.options,Ya._cloneCustomizer)},ts.prototype.getSource=function(){return this.options.source},ts.prototype.setOptions=function(t){var e=(new Ya).merge(this.options,Jo(t,Ya._cloneCustomizer));if(this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("fill-extrusion-base",e.base,this.options.base),this._updatePaintProperty("fill-extrusion-color",e.fillColor,this.options.fillColor),this._updatePaintProperty("fill-extrusion-height",e.height,this.options.height),this._updatePaintProperty("fill-extrusion-opacity",e.fillOpacity,this.options.fillOpacity),this._updatePaintProperty("fill-extrusion-pattern",e.fillPattern,this.options.fillPattern),this._updatePaintProperty("fill-extrusion-translate",e.translate,this.options.translate),this._updatePaintProperty("fill-extrusion-translate-anchor",e.translateAnchor,this.options.translateAnchor),this._updatePaintProperty("fill-extrusion-vertical-gradient",e.verticalGradient,this.options.verticalGradient)}this.options=e},ts.prototype._buildLayers=function(){return[w(w(w(w({id:this.id,type:"fill-extrusion"},this.options.sourceLayer&&{"source-layer":this.options.sourceLayer}),{source:this.options.source instanceof ea?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:w(w({"fill-extrusion-base":this.options.base,"fill-extrusion-height":this.options.height,"fill-extrusion-opacity":this.options.fillOpacity},this.options.fillPattern?{"fill-extrusion-pattern":this.options.fillPattern}:{"fill-extrusion-color":this.options.fillColor}),{"fill-extrusion-translate":this.options.translate,"fill-extrusion-translate-anchor":this.options.translateAnchor,"fill-extrusion-vertical-gradient":this.options.verticalGradient})}),this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},ts.prototype._getLayerIds=function(){return[this.id]},ts.prototype._getSourceIds=function(){var t=new Set;return this.options.source instanceof ea?t.add(this.options.source.getId()):t.add(this.options.source),t},ts);function ts(t,e,i){var r=Qa.call(this,e)||this;return r.options=(new Ya).merge(Jo(i,Ya._cloneCustomizer)),r.options.source=t||r.options.source,r}var es,is=(b(rs,es=ya),rs.prototype.merge=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=!1,r=!1,n=0,o=t;n<o.length;n++){var a=o[n];a&&(a.hasOwnProperty("fillColor")?r=!(i=!0):a.hasOwnProperty("fillPattern")&&(i=!(r=!0)))}var s=es.prototype.merge.apply(this,t);return i?s.fillPattern=void 0:r&&(s.fillColor=void 0),s},rs);function rs(){var t=null!==es&&es.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.fillColor="#1E90FF",t.fillOpacity=.5,t.fillPattern=void 0,t}var ns,os=(b(as,ns=fa),as.prototype.getOptions=function(){return Jo(this.options,is._cloneCustomizer)},as.prototype.getSource=function(){return this.options.source},as.prototype.setOptions=function(t){var e=(new is).merge(this.options,Jo(t,is._cloneCustomizer));if(this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("fill-color",e.fillColor,this.options.fillColor),this._updatePaintProperty("fill-opacity",e.fillOpacity,this.options.fillOpacity),this._updatePaintProperty("fill-pattern",e.fillPattern,this.options.fillPattern)}this.options=e},as.prototype._buildLayers=function(){var t={id:this.id,type:"fill",source:this.options.source instanceof ea?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:{"fill-opacity":this.options.fillOpacity},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(t.filter=this.options.filter),this.options.sourceLayer&&(t["source-layer"]=this.options.sourceLayer),this.options.fillPattern?t.paint["fill-pattern"]=this.options.fillPattern:t.paint["fill-color"]=this.options.fillColor,[t]},as.prototype._getLayerIds=function(){return[this.id]},as.prototype._getSourceIds=function(){var t=new Set;return this.options.source instanceof ea?t.add(this.options.source.getId()):t.add(this.options.source),t},as);function as(t,e,i){var r=ns.call(this,e)||this;return r.options=(new is).merge(Jo(i,is._cloneCustomizer)),r.options.source=t||r.options.source,r}var ss,ls=(b(us,ss=I),us);function us(){var t=null!==ss&&ss.apply(this,arguments)||this;return t.allowOverlap=!1,t.anchor="bottom",t.ignorePlacement=!1,t.image="marker-blue",t.offset=new mn(0,0),t.optional=!1,t.pitchAlignment="auto",t.rotation=0,t.rotationAlignment="auto",t.size=1,t.opacity=1,t}var cs,ps=(b(hs,cs=I),hs);function hs(){var t=null!==cs&&cs.apply(this,arguments)||this;return t.allowOverlap=!1,t.anchor="center",t.textField=void 0,t.font=["StandardFont-Regular"],t.ignorePlacement=!1,t.offset=new mn(0,0),t.optional=!1,t.pitchAlignment="auto",t.rotation=0,t.rotationAlignment="auto",t.size=16,t.color="#000000",t.haloBlur=0,t.haloColor="rgba(0,0,0,0)",t.haloWidth=0,t.opacity=1,t}var ds,fs=(b(ms,ds=ya),ms);function ms(){var t=null!==ds&&ds.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.iconOptions=new ls,t.textOptions=new ps,t.placement="point",t.lineSpacing=250,t}var gs,ys=(b(vs,gs=fa),vs.prototype.getOptions=function(){return Jo(this.options,fs._cloneCustomizer)},vs.prototype.getSource=function(){return this.options.source},vs.prototype.setOptions=function(t){var e=(new fs).merge(this.options,Jo(t,fs._cloneCustomizer));if(this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updateLayoutProperty("symbol-spacing",e.lineSpacing,this.options.lineSpacing),this._updateLayoutProperty("symbol-placement",e.placement,this.options.placement),this._updateLayoutProperty("icon-allow-overlap",e.iconOptions.allowOverlap,this.options.iconOptions.allowOverlap),this._updateLayoutProperty("icon-anchor",e.iconOptions.anchor,this.options.iconOptions.anchor),this._updateLayoutProperty("icon-ignore-placement",e.iconOptions.ignorePlacement,this.options.iconOptions.ignorePlacement),this._updateLayoutProperty("icon-image",e.iconOptions.image,this.options.iconOptions.image),this._updateLayoutProperty("icon-offset",e.iconOptions.offset,this.options.iconOptions.offset),this._updatePaintProperty("icon-opacity",e.iconOptions.opacity,this.options.iconOptions.opacity),this._updateLayoutProperty("icon-optional",e.iconOptions.optional,this.options.iconOptions.optional),this._updateLayoutProperty("icon-pitch-alignment",e.iconOptions.pitchAlignment,this.options.iconOptions.pitchAlignment),this._updateLayoutProperty("icon-rotate",e.iconOptions.rotation,this.options.iconOptions.rotation),this._updateLayoutProperty("icon-rotation-alignment",e.iconOptions.rotationAlignment,this.options.iconOptions.rotationAlignment),this._updateLayoutProperty("icon-size",e.iconOptions.size,this.options.iconOptions.size),this._updateLayoutProperty("text-allow-overlap",e.textOptions.allowOverlap,this.options.textOptions.allowOverlap),this._updateLayoutProperty("text-anchor",e.textOptions.anchor,this.options.textOptions.anchor),this._updatePaintProperty("text-color",e.textOptions.color,this.options.textOptions.color),this._updateLayoutProperty("text-font",e.textOptions.font,this.options.textOptions.font),this._updateLayoutProperty("text-ignore-placement",e.textOptions.ignorePlacement,this.options.textOptions.ignorePlacement),this._updatePaintProperty("text-halo-blur",e.textOptions.haloBlur,this.options.textOptions.haloBlur),this._updatePaintProperty("text-halo-color",e.textOptions.haloColor,this.options.textOptions.haloColor),this._updatePaintProperty("text-halo-width",e.textOptions.haloWidth,this.options.textOptions.haloWidth),this._updateLayoutProperty("text-offset",e.textOptions.offset,this.options.textOptions.offset),this._updatePaintProperty("text-opacity",e.textOptions.opacity,this.options.textOptions.opacity),this._updateLayoutProperty("text-optional",e.textOptions.optional,this.options.textOptions.optional),this._updateLayoutProperty("text-pitch-alignment",e.textOptions.pitchAlignment,this.options.textOptions.pitchAlignment),this._updateLayoutProperty("text-rotate",e.textOptions.rotation,this.options.textOptions.rotation),this._updateLayoutProperty("text-rotation-alignment",e.textOptions.rotationAlignment,this.options.textOptions.rotationAlignment),this._updateLayoutProperty("text-size",e.textOptions.size,this.options.textOptions.size),this._updateLayoutProperty("text-field",e.textOptions.textField,this.options.textOptions.textField)}this.options=e},vs.prototype._buildLayers=function(){return[w(w(w(w({id:this.id,type:"symbol"},this.options.sourceLayer&&{"source-layer":this.options.sourceLayer}),{source:this.options.source instanceof ea?this.options.source.getId():this.options.source,layout:w(w({visibility:this.options.visible?"visible":"none","symbol-placement":this.options.placement,"symbol-spacing":this.options.lineSpacing,"text-allow-overlap":this.options.textOptions.allowOverlap,"text-anchor":this.options.textOptions.anchor},this.options.textOptions.textField&&{"text-field":this.options.textOptions.textField}),{"text-font":this.options.textOptions.font,"text-ignore-placement":this.options.textOptions.ignorePlacement,"text-offset":this.options.textOptions.offset,"text-optional":this.options.textOptions.optional,"text-pitch-alignment":this.options.textOptions.pitchAlignment,"text-rotate":this.options.textOptions.rotation,"text-rotation-alignment":this.options.textOptions.rotationAlignment,"text-size":this.options.textOptions.size,"icon-allow-overlap":this.options.iconOptions.allowOverlap,"icon-anchor":this.options.iconOptions.anchor,"icon-ignore-placement":this.options.iconOptions.ignorePlacement,"icon-image":this.options.iconOptions.image,"icon-offset":this.options.iconOptions.offset,"icon-optional":this.options.iconOptions.optional,"icon-pitch-alignment":this.options.iconOptions.pitchAlignment,"icon-rotate":this.options.iconOptions.rotation,"icon-rotation-alignment":this.options.iconOptions.rotationAlignment,"icon-size":this.options.iconOptions.size}),paint:{"text-color":this.options.textOptions.color,"text-halo-blur":this.options.textOptions.haloBlur,"text-halo-color":this.options.textOptions.haloColor,"text-halo-width":this.options.textOptions.haloWidth,"text-opacity":this.options.textOptions.opacity,"icon-opacity":this.options.iconOptions.opacity}}),this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},vs.prototype._getLayerIds=function(){return[this.id]},vs.prototype._getSourceIds=function(){var t=new Set;return this.options.source instanceof ea?t.add(this.options.source.getId()):t.add(this.options.source),t},vs);function vs(t,e,i){var r=gs.call(this,e)||this;return r.options=(new fs).merge(Jo(i,fs._cloneCustomizer)),r.options.source=t||r.options.source,r}var _s,xs=(b(bs,_s=La),bs);function bs(){var t=null!==_s&&_s.apply(this,arguments)||this;return t.bounds=[-180,-85.0511,180,85.0511],t.minSourceZoom=0,t.maxSourceZoom=22,t.tileSize=512,t.isTMS=!1,t.subdomains=void 0,t.tileUrl=void 0,t}var ws,Ss=(b(Ts,ws=Ba),Ts.prototype.getOptions=function(){return Jo(this.options,xs._cloneCustomizer)},Ts.prototype.setOptions=function(t){var e=(new xs).merge(this.options,Jo(t,xs._cloneCustomizer));if(this.map){if(!un(e.bounds,this.options.bounds)||e.isTMS!==this.options.isTMS||e.maxSourceZoom!==this.options.maxSourceZoom||e.minSourceZoom!==this.options.minSourceZoom||!un(e.subdomains,this.options.subdomains)||e.tileSize!==this.options.tileSize||e.tileUrl!==this.options.tileUrl)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("raster-contrast",e.contrast,this.options.contrast),this._updatePaintProperty("raster-fade-duration",e.fadeDuration,this.options.fadeDuration),this._updatePaintProperty("raster-hue-rotate",e.hueRotation,this.options.hueRotation),this._updatePaintProperty("raster-brightness-max",e.maxBrightness,this.options.maxBrightness),this._updatePaintProperty("raster-opacity",e.opacity,this.options.opacity),this._updatePaintProperty("raster-saturation",e.saturation,this.options.saturation)}this.options=e},Ts.prototype._setOptionsNoUpdate=function(t){this.options=(new xs).merge(this.options,Jo(t,xs._cloneCustomizer))},Ts.prototype._buildLayers=function(){return[w(w({id:this.id,type:"raster",source:this._getSourceId(),layout:{visibility:this.options.visible?"visible":"none"},paint:{"raster-contrast":this.options.contrast,"raster-fade-duration":this.options.fadeDuration,"raster-hue-rotate":this.options.hueRotation,"raster-brightness-max":this.options.maxBrightness,"raster-brightness-min":this.options.minBrightness,"raster-opacity":this.options.opacity,"raster-saturation":this.options.saturation}},this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},Ts.prototype._getLayerIds=function(){return[this.id]},Ts.prototype._buildSource=function(){var t;if(this.options.tileUrl){if(-1===this.options.tileUrl.indexOf("{"))return{type:"raster",url:this.options.tileUrl};if(-1!==this.options.tileUrl.indexOf("{subdomain}")){if(!(this.options.subdomains&&0<this.options.subdomains.length))throw new Error("The {subdomain} placeholder was included in the tileUrl but no subdomains were specified");for(var e=[],i=0,r=this.options.subdomains;i<r.length;i++){var n=r[i];e.push(this.options.tileUrl.replace(/{subdomain}/g,n))}t=e}else t=[this.options.tileUrl]}return w({type:"raster",bounds:this.options.bounds,maxzoom:this.options.maxSourceZoom,minzoom:this.options.minSourceZoom,scheme:this.options.isTMS?"tms":"xyz",tileSize:this.options.tileSize},t&&{tiles:t})},Ts.prototype._getSourceId=function(){return this.getId()+"-RasterSource"},Ts);function Ts(t,e){var i=ws.call(this,e)||this;return t&&i.setOptions(t),i}var Is=Object.freeze({__proto__:null,BubbleLayer:Sa,Layer:fa,LineLayer:Wa,PolygonExtrusionLayer:$a,PolygonLayer:os,SymbolLayer:ys,TileLayer:Ss,HeatMapLayer:ka,ImageLayer:ja}),Es=(Cs.convertHtmlString=function(t){if("string"!=typeof t)return t;var e=document.createElement("div");return e.innerHTML=t,e},Cs);function Cs(){}var As=Function.prototype,ks=Object.prototype,Ps=As.toString,Ms=ks.hasOwnProperty,Ls=Ps.call(Object);var Ds=function(t){if(!Fe(t)||"[object Object]"!=Ht(t))return!1;var e=Ai(t);if(null===e)return!0;var i=Ms.call(e,"constructor")&&e.constructor;return"function"==typeof i&&i instanceof i&&Ps.call(i)==Ls};var zs,Os=function(t){return Fe(t)&&1===t.nodeType&&!Ds(t)},Rs=(b(Ns,zs=I),Ns._cloneCustomizer=function(t){if(Os(t))return t},Ns);function Ns(){var t=null!==zs&&zs.apply(this,arguments)||this;return t.anchor="none",t.draggable=!1,t.closeButton=!0,t.content=document.createElement("span"),t.fillColor="#FFFFFF",t.pixelOffset=new mn(0,0),t.position=new bo(0,0),t.showPointer=!0,t}var Bs,Fs=(b(Us,Bs=Io),Us.prototype.setPopupOptions=function(t){this.setOptions(t)},Us.prototype.setOptions=function(t){var e=(new Rs).merge(this.options,Jo(t,Rs._cloneCustomizer));e.content!==this.options.content?(this.htmlContent.remove(),this.htmlContent=this._createHtmlContent(e),this.contentDiv.prepend(this.htmlContent)):e.draggable!==this.options.draggable&&this._setDraggable(this.htmlContent,e.draggable),e.closeButton&&!this.closeBtn?(this.closeBtn=this._createCloseButton(),this.contentDiv.appendChild(this.closeBtn)):!e.closeButton&&this.closeBtn&&(this.contentDiv.removeChild(this.closeBtn),delete this.closeBtn),e.showPointer&&!this.arrowDiv?(this.arrowDiv=this._createArrowDiv(),this.containerDiv.appendChild(this.arrowDiv)):!e.showPointer&&this.arrowDiv&&(this.containerDiv.removeChild(this.arrowDiv),delete this.arrowDiv),e.fillColor!==this.options.fillColor&&(this.containerDiv.style.borderColor=e.fillColor,this.contentDiv.style.backgroundColor=e.fillColor),this.marker&&(e.anchor!==this.options.anchor?"none"===this.options.anchor?(this.autoAnchor!==e.anchor&&this._replaceMarker(this.map,e),this.map.events.remove("move",this._onMove),delete this.autoAnchor):(this._replaceMarker(this.map,e),"none"===e.anchor&&this.map.events.add("move",this._onMove)):(un(e.position,this.options.position)||this.marker.setLngLat(e.position),un(e.pixelOffset,this.options.pixelOffset)||this.marker.setOffset(e.pixelOffset))),this.options=e},Us.prototype.getPopupOptions=function(){return this.getOptions()},Us.prototype.getOptions=function(){return Jo(this.options,Rs._cloneCustomizer)},Us.prototype._dragToPixel=function(t){this.dragging||(this.dragging=!0,this.contentDiv.style.pointerEvents="none",this._invokeEvent("dragstart",{type:"dragstart",target:this}));var e=[t[0]+this.dragOffset[0],t[1]+this.dragOffset[1]],i=this.map.pixelsToPositions([e])[0];this.options.position=i,this.marker.setLngLat(this.options.position),this._invokeEvent("drag",{type:"drag",target:this})},Us.prototype._onUp=function(){this.dragging&&(this.contentDiv.style.pointerEvents="",this._invokeEvent("dragend",{type:"dragend",target:this}),"none"===this.options.anchor&&this._onMove()),delete this.dragOffset,delete this.dragging},Us.prototype._createContainerDiv=function(t){var e=this,i=document.createElement("div");i.classList.add(Us.Css.container),i.classList.add(Us.Css.hidden),i.style.borderColor=t.fillColor,i.setAttribute("role","dialog"),i.setAttribute("aria-label","Map Information Window");var r=!1;return i.addEventListener("keydown",function(t){"Tab"!==t.key&&"Escape"!==t.key&&"Esc"!==t.key||(r=!0)}),i.addEventListener("keyup",function(t){"Tab"!==t.key&&"Escape"!==t.key&&"Esc"!==t.key||(r=!1)}),i.addEventListener("focusin",function(t){e.map&&!e.isOpen()&&(e.open(e.map),t.target instanceof HTMLElement&&t.target.focus())}),i.addEventListener("focusout",function(t){r&&t.relatedTarget instanceof Node&&!i.contains(t.relatedTarget)&&(r=!1,e.isOpen()&&e.close())}),i},Us.prototype._createContentDiv=function(t){var e=document.createElement("div");return e.classList.add(Us.Css.content),e.style.backgroundColor=t.fillColor,e.setAttribute("tabindex","0"),this.htmlContent=this._createHtmlContent(t),e.appendChild(this.htmlContent),e},Us.prototype._createArrowDiv=function(){var t=document.createElement("div");return t.classList.add(Us.Css.arrow),t},Us.prototype._createCloseButton=function(){var t=document.createElement("button");return t.addEventListener("click",this.close),t.classList.add(Us.Css.close),t.setAttribute("aria-label","close"),t.setAttribute("title","close"),t.setAttribute("tabindex","0"),t.innerHTML="&times;",t},Us.prototype._createHtmlContent=function(t){var e=Es.convertHtmlString(t.content);return t.draggable&&this._setDraggable(e,t.draggable),e},Us.prototype._createMarker=function(t,e){var i=this.marker?this.marker.getLngLat():t.position;return"none"===t.anchor?(this.autoAnchor=e||"bottom",this.containerDiv.classList.add(this.autoAnchor),new r({anchor:this.autoAnchor,element:this.containerDiv,offset:t.pixelOffset}).setLngLat(i)):(this.containerDiv.classList.add(t.anchor),new r({anchor:t.anchor,element:this.containerDiv,offset:t.pixelOffset}).setLngLat(i))},Us.prototype._getAutoAnchor=function(t,e){var i,r,n=this.containerDiv.offsetWidth,o=this.containerDiv.offsetHeight;if(this.marker){var a=t._getMap().project(this.marker.getLngLat());i=a.x,r=a.y}else{var s=t.positionsToPixels([e.position])[0];i=s[0],r=s[1]}var l=[];return r<o?l.push("top"):r>t.getCanvas().offsetHeight-o&&l.push("bottom"),i<n/2?l.push("left"):i>t.getCanvas().offsetWidth-n/2&&l.push("right"),0<l.length?l.join("-"):"bottom"},Us.prototype._replaceMarker=function(t,e,i){var r=this.containerDiv.nextElementSibling;this.marker.remove(),this.containerDiv.classList.remove(this.autoAnchor||this.options.anchor),this.marker=this._createMarker(e,i),this.marker.addTo(t._getMap()),t.popups._getCollectionDiv().insertBefore(this.containerDiv,r||null)},Us.prototype._setDraggable=function(t,e){e?(t.addEventListener("mousedown",this._onDown),t.addEventListener("touchstart",this._onDown),t.addEventListener("dragstart",this._onDragStart)):(t.removeEventListener("mousedown",this._onDown),t.removeEventListener("touchstart",this._onDown),t.removeEventListener("dragstart",this._onDragStart))},Us.Css={arrow:"popup-arrow",close:"popup-close",container:"popup-container",content:"popup-content-container",hidden:"hidden-accessible-element"},Us);function Us(t){var i=Bs.call(this)||this;return i.attach=function(t){i.map!==t&&(i.map&&i.remove(),i.map=t,i.marker=i._createMarker(i.options),i.marker.addTo(i.map._getMap()),i.map.popups._getCollectionDiv().appendChild(i.containerDiv),i.map.popups.add(i))},i.open=function(t){if(!t&&!i.map)throw new Error("Must specify a map to open on or attach to a map in advance");i.attach(t||i.map),i.containerDiv.classList.remove(Us.Css.hidden),i.map.events.add("move",i._onMove),i._onMove(),i._invokeEvent("open",{target:i,type:"open"})},i.close=function(){i.map&&i.map.events.remove("move",i._onMove),i.containerDiv.classList.add(Us.Css.hidden),i._invokeEvent("close",{target:i,type:"close"})},i.remove=function(){i.map&&(i.marker.remove(),i.containerDiv.classList.remove(i.autoAnchor||i.options.anchor),i.map.events.remove("move",i._onMove),i.map.popups.remove(i),delete i.map,delete i.marker,delete i.autoAnchor)},i.isOpen=function(){return i.map&&!i.containerDiv.classList.contains(Us.Css.hidden)},i._onMove=function(){var t=i._getAutoAnchor(i.map,i.options);t!==i.autoAnchor&&(i._replaceMarker(i.map,i.options,t),i.map.events.add("move",i._onMove))},i._onDown=function(t){i.map.popups._addDraggedPopup(i);var e=i.map.positionsToPixels([i.options.position])[0];"mousedown"===t.type?(t=t,i.dragOffset=[e[0]-t.clientX,e[1]-t.clientY]):"touchstart"===t.type&&(t=t,i.dragOffset=[e[0]-t.touches[0].clientX,e[1]-t.touches[0].clientY])},i._onDragStart=function(t){t.preventDefault()},i.options=(new Rs).merge(Jo(t,Rs._cloneCustomizer)),i.containerDiv=i._createContainerDiv(i.options),i.contentDiv=i._createContentDiv(i.options),i.containerDiv.appendChild(i.contentDiv),i.options.showPointer&&(i.arrowDiv=i._createArrowDiv(),i.containerDiv.appendChild(i.arrowDiv)),i.options.closeButton&&(i.closeBtn=i._createCloseButton(),i.contentDiv.appendChild(i.closeBtn)),i}var js,qs=(b(Vs,js=I),Vs._cloneCustomizer=function(t){if(t instanceof Fs||Os(t))return t},Vs);function Vs(){var t=null!==js&&js.apply(this,arguments)||this;return t.anchor="bottom",t.color="#1A73AA",t.draggable=!1,t.htmlContent='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24.5 36.5" id="marker_'+pn()+'" width="24.5" height="36.5" display="block"><path d="M12.25.25a12.2543,12.2543,0,0,0-12,12.4937c0,6.4436,6.4879,12.1093,11.059,22.5641.5493,1.2563,1.3327,1.2563,1.882,0C17.7621,24.8529,24.25,19.1857,24.25,12.7437A12.2543,12.2543,0,0,0,12.25.25Z"   fill="{color}" stroke="{secondaryColor}" stroke-width="0.5"/><text style="font-family: Arial, Helvetica, sans-serif; font-size: 14px; fill: white;" text-anchor="middle" x="12" y="18">{text}</text></svg>',t.pixelOffset=new mn(0,0),t.position=new bo(0,0),t.popup=void 0,t.secondaryColor="white",t.text=void 0,t.visible=!0,t}var Gs,Zs=(b(Hs,Gs=Io),Hs.prototype.getOptions=function(){return Jo(this.options,qs._cloneCustomizer)},Hs.prototype.setOptions=function(t){var e=(new qs).merge(this.options,Jo(t,qs._cloneCustomizer));un(e.htmlContent,this.options.htmlContent)&&e.anchor===this.options.anchor?("string"!=typeof e.htmlContent||e.color===this.options.color&&e.text===this.options.text&&e.secondaryColor===this.options.secondaryColor||(this.element.innerHTML=this._getSubbedHtmlString(e)),e.draggable!==this.options.draggable&&(this._setDraggable(e.draggable),this.marker.setDraggable(e.draggable)),un(e.pixelOffset,this.options.pixelOffset)||this.marker.setOffset(e.pixelOffset),un(e.position,this.options.position)||this.marker.setLngLat(e.position),e.visible!==this.options.visible&&(e.visible?this.element.classList.remove(Hs.hiddenClass):this.element.classList.add(Hs.hiddenClass))):(this.marker.remove(),this._buildMarker(e),this.map&&(this.marker.addTo(this.map._getMap()),this._getCollectionContainer().appendChild(this.element))),this.options=e},Hs.prototype.togglePopup=function(){if(this.options.popup)if(this.options.popup.isOpen())this.options.popup.close();else{if(!this.map)throw new Error("The marker must be added to a map before calling togglePopup().");this.options.popup.setOptions({position:this.options.position}),this.options.popup.open(this.map)}},Hs.prototype._addToMap=function(t,e){this.map&&this.map!==t&&this._removeFromMap(),e&&(this.options.position=Ar(e),this.marker.setLngLat(this.options.position)),this.map!==t&&(this.map=t,this.marker.addTo(t._getMap()),this._getCollectionContainer().appendChild(this.element))},Hs.prototype._removeFromMap=function(){this.map&&(this.marker.remove(),delete this.map)},Hs.prototype._getId=function(){if(this.element)return"string"==typeof this.options.htmlContent?this.element.firstChild.id:this.element.id},Hs.prototype._buildMarker=function(t){if("string"==typeof t.htmlContent){var e=this._getSubbedHtmlString(t);this.element=Es.convertHtmlString(e)}else this.element=t.htmlContent;this.element.classList.add(Hs.containerClass),t.draggable&&this._setDraggable(!0),t.visible||this.element.classList.add(Hs.hiddenClass),this.marker=new r({element:this.element,offset:t.pixelOffset,draggable:t.draggable,anchor:t.anchor}).setLngLat(t.position),this.marker.on("drag",this._onDrag),this.marker.on("dragstart",this._onDragStart),this.marker.on("dragend",this._onDragEnd),this.element.addEventListener("click",this._bubbleElementEvent),this.element.addEventListener("dblclick",this._bubbleElementEvent),this.element.addEventListener("contextmenu",this._bubbleElementEvent),this.element.addEventListener("keydown",this._bubbleElementEvent),this.element.addEventListener("keypress",this._bubbleElementEvent),this.element.addEventListener("keyup",this._bubbleElementEvent),this.element.addEventListener("mousedown",this._bubbleElementEvent),this.element.addEventListener("mouseenter",this._bubbleElementEvent),this.element.addEventListener("mouseleave",this._bubbleElementEvent),this.element.addEventListener("mousemove",this._bubbleElementEvent),this.element.addEventListener("mouseout",this._bubbleElementEvent),this.element.addEventListener("mouseover",this._bubbleElementEvent),this.element.addEventListener("mouseup",this._bubbleElementEvent)},Hs.prototype._getSubbedHtmlString=function(t){if("string"==typeof t.htmlContent)return t.htmlContent.replace(/{color}/gi,t.color||"").replace(/{secondaryColor}/gi,t.secondaryColor||"").replace(/{text}/gi,t.text||"")},Hs.prototype._getCollectionContainer=function(){var t=this.map.getCanvasContainer().querySelector("."+Hs.collectionContainerClass);return t||((t=document.createElement("div")).classList.add(Hs.collectionContainerClass),this.map.getCanvasContainer().appendChild(t)),t},Hs.prototype._setDraggable=function(t){t?this.element.addEventListener("dragstart",this._onEleDragStart):this.element.removeEventListener("dragstart",this._onEleDragStart)},Hs.collectionContainerClass="marker-collection-container",Hs.hiddenClass="hidden-accessible-element",Hs.containerClass="marker-container",Hs);function Hs(t){var e=Gs.call(this)||this;return e._onDrag=function(){var t=e.marker.getLngLat().wrap();e.options.position=new bo(t.lng,t.lat),e._invokeEvent("drag",{type:"drag",target:e})},e._onDragStart=function(){e._invokeEvent("dragstart",{type:"dragstart",target:e})},e._onDragEnd=function(){e._invokeEvent("dragend",{type:"dragend",target:e})},e._bubbleElementEvent=function(t){e._invokeEvent(t.type,{type:t.type,target:e})},e._onEleDragStart=function(t){t.preventDefault()},e.options=(new qs).merge(Jo(t,qs._cloneCustomizer)),e._buildMarker(e.options),e}var Ws=function(t,e,i){(void 0===i||bt(t[e],i))&&(void 0!==i||e in t)||ze(t,e,i)};var Ks=function(l){return function(t,e,i){for(var r=-1,n=Object(t),o=i(t),a=o.length;a--;){var s=o[l?a:++r];if(!1===e(n[s],s,n))break}return t}}();var Xs=function(t){return Fe(t)&&pi(t)};var Ys=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]};var Js=function(t){return Ne(t,yi(t))};var Qs=function(t,e,i,r,n,o,a){var s=Ys(t,i),l=Ys(e,i),u=a.get(l);if(u)Ws(t,i,u);else{var c=o?o(s,l,i+"",t,e,a):void 0,p=void 0===c;if(p){var h=Ze(l),d=!h&&We(l),f=!h&&!d&&ii(l);c=l,h||d||f?c=Ze(s)?s:Xs(s)?xi(s):d?_i(l,!(p=!1)):f?ar(l,!(p=!1)):[]:Ds(l)||Ge(l)?Ge(c=s)?c=Js(s):Wt(s)&&!Xt(s)||(c=pr(l)):p=!1}p&&(a.set(l,c),n(c,l,r,o,a),a.delete(l)),Ws(t,i,c)}};var $s=function r(n,o,a,s,l){n!==o&&Ks(o,function(t,e){if(l=l||new Me,Wt(t))Qs(n,o,e,a,r,s,l);else{var i=s?s(Ys(n,e),t,e+"",n,o,l):void 0;void 0===i&&(i=t),Ws(n,e,i)}},yi)};function tl(t){return t}var el=function(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)},il=Math.max;var rl=function(o,a,s){return a=il(void 0===a?o.length-1:a,0),function(){for(var t=arguments,e=-1,i=il(t.length-a,0),r=Array(i);++e<i;)r[e]=t[a+e];e=-1;for(var n=Array(a+1);++e<a;)n[e]=t[e];return n[a]=s(r),el(o,this,n)}};var nl=function(t){return function(){return t}},ol=De?function(t,e){return De(t,"toString",{configurable:!0,enumerable:!1,value:nl(e),writable:!0})}:tl,al=Date.now;var sl=function(i){var r=0,n=0;return function(){var t=al(),e=16-(t-n);if(n=t,0<e){if(800<=++r)return arguments[0]}else r=0;return i.apply(void 0,arguments)}}(ol);var ll=function(t,e){return sl(rl(t,e,tl),t+"")};var ul=function(t,e,i){if(!Wt(i))return!1;var r=typeof e;return!!("number"==r?pi(i)&&Xe(e,i.length):"string"==r&&e in i)&&bt(i[e],t)};var cl=function(s){return ll(function(t,e){var i=-1,r=e.length,n=1<r?e[r-1]:void 0,o=2<r?e[2]:void 0;for(n=3<s.length&&"function"==typeof n?(r--,n):void 0,o&&ul(e[0],e[1],o)&&(n=r<3?void 0:n,r=1),t=Object(t);++i<r;){var a=e[i];a&&s(t,a,i,n)}return t})}(function(t,e,i){$s(t,e,i)}),pl=(hl.parse=function(t){var e=(t=t.toLowerCase()).lastIndexOf("-");return-1!==e?{code:t,language:t.substring(0,e),region:t.substring(e+1)}:{code:t,language:t}},hl);function hl(){}var dl={localizationsPath:"locs/mapcontrol/2019-3-12",sensitiveUserRegions:["il","kr","pk","in","cn","ar","bh","eg","jo","sa","kw","om","qa","ma","ae"],locales:{defaultLanguage:{defaultRegion:{code:"NGT",strings:"en/resource.json"}},ar:{defaultRegion:{code:"ar",strings:"ar-sa/resource.json"}},bg:{defaultRegion:{code:"bg-BG",strings:"bg-bg/resource.json"}},cs:{defaultRegion:{code:"cs-CZ",strings:"cs-cz/resource.json"}},da:{defaultRegion:{code:"da-DK",strings:"da-dk/resource.json"}},de:{defaultRegion:{code:"de-DE",strings:"de-de/resource.json"}},el:{defaultRegion:{code:"el-GR",strings:"el-gr/resource.json"}},en:{defaultRegion:{code:"en",strings:"en/resource.json"},us:{code:"en-US",strings:"en/resource.json"}},es:{defaultRegion:{code:"es-ES",strings:"es-es/resource.json"},mx:{code:"es-MX",strings:"es-mx/resource.json"}},fi:{defaultRegion:{code:"fi-FI",strings:"fi-fi/resource.json"}},fr:{defaultRegion:{code:"fr-FR",strings:"fr-fr/resource.json"}},hu:{defaultRegion:{code:"hu-HU",strings:"hu-hu/resource.json"}},id:{defaultRegion:{code:"id-ID",strings:"id-id/resource.json"}},it:{defaultRegion:{code:"it-IT",strings:"it-it/resource.json"}},ko:{defaultRegion:{code:"ko-KR",strings:"ko-kr/resource.json"}},lt:{defaultRegion:{code:"lt-LT",strings:"lt-lt/resource.json"}},ms:{defaultRegion:{code:"ms-MY",strings:"ms-my/resource.json"}},nb:{defaultRegion:{code:"nb-NO",strings:"nb-no/resource.json"}},nl:{defaultRegion:{code:"nl-NL",strings:"nl-nl/resource.json"}},pl:{defaultRegion:{code:"pl-PL",strings:"pl-pl/resource.json"}},pt:{defaultRegion:{code:"pt-PT",strings:"pt-pt/resource.json"},br:{code:"pt-BR",strings:"pt-br/resource.json"}},ru:{defaultRegion:{code:"ru-RU",strings:"ru-ru/resource.json"}},sk:{defaultRegion:{code:"sk-SK",strings:"sk-sk/resource.json"}},sl:{defaultRegion:{code:"sl-SL",strings:"sl-sl/resource.json"}},sv:{defaultRegion:{code:"sv-SE",strings:"sv-se/resource.json"}},th:{defaultRegion:{code:"th-TH",strings:"th-th/resource.json"}},tr:{defaultRegion:{code:"tr-TR",strings:"tr-tr/resource.json"}},zh:{defaultRegion:{code:"zh-Hant",strings:"zh-tw/resource.json"}},"zh-hant":{defaultRegion:{code:"zh-Hant",strings:"zh-tw/resource.json"}}}},fl=function(){this.Unknown="Unknown",this.Accident="Accident",this.Fog="Fog",this.Danger="Danger",this.Rain="Rain",this.Ice="Ice",this.Jam="Jam",this.LaneClosed="Lane Closed",this.RoadClosed="Road Closed",this.RoadWorks="Road Works",this.Wind="Wind",this.Flood="Flood",this.Detour="Detour"},ml=(gl.getCode=function(t){var e=pl.parse(t);return-1===dl.sensitiveUserRegions.indexOf(e.region)?this.getLocaleData(e).code:t},gl.getStrings=function(t){var e=this.getLocaleData(t);return new P({domain:o,path:dl.localizationsPath+"/"+e.strings}).get().then(function(t){return t},function(){return new fl})},gl.getLocaleData=function(t){if("string"==typeof t&&(t=pl.parse(t)),dl.locales[t.code])return dl.locales[t.code].defaultRegion;var e;if(dl.locales[t.language])e=dl.locales[t.language];else{if(-1!==t.language.indexOf("-"))return this.getLocaleData(t.language);e=dl.locales.defaultLanguage}return t.region&&e[t.region]?e[t.region]:e.defaultRegion},gl);function gl(){}var yl,vl=(_l.getEdgeOrIEVersion=function(){var t=window.navigator.userAgent,e=t.indexOf("MSIE ");if(0<e)return parseInt(t.substring(e+5,t.indexOf(".",e)),10);if(0<t.indexOf("Trident/")){var i=t.indexOf("rv:");return parseInt(t.substring(i+3,t.indexOf(".",i)),10)}var r=t.indexOf("Edge/");return 0<r?parseInt(t.substring(r+5,t.indexOf(".",r)),10):-1},_l.isEdgeOrIE=function(){return-1!==this.getEdgeOrIEVersion()},_l.isIE=function(){var t=this.getEdgeOrIEVersion();return-1!==t&&t<=11},_l);function _l(){}(yl=p.AuthenticationType||(p.AuthenticationType={})).subscriptionKey="subscriptionKey",yl.aad="aad",yl.anonymous="anonymous";var xl,bl,wl=(b(Sl,xl=I),Sl.prototype.setSubscriptionKey=function(t){this.authType=p.AuthenticationType.subscriptionKey,this.subscriptionKey=t},Sl.prototype.setAadProperties=function(t,e,i,r,n){this.authType=p.AuthenticationType.aad,this.authContext=n||this.authContext,this.aadInstance=r||this.aadInstance,this.clientId=t,this.aadAppId=e,this.aadTenant=i},Sl.prototype.setTokenCallbackFunction=function(t){this.authType=p.AuthenticationType.anonymous,this.getToken=t},Sl.prototype.merge=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=xl.prototype.merge.apply(this,t);return i.authType===p.AuthenticationType.subscriptionKey?i.authContext=i.aadAppId=i.getToken=void 0:i.authType===p.AuthenticationType.aad?i.subscriptionKey=i.getToken=void 0:i.authType===p.AuthenticationType.anonymous&&(i.subscriptionKey=i.authContext=i.aadAppId=void 0),i},Sl);function Sl(){var t=null!==xl&&xl.apply(this,arguments)||this;return t.authType=void 0,t.subscriptionKey=void 0,t.clientId=void 0,t.aadAppId=void 0,t.aadTenant=void 0,t.aadInstance=void 0,t.getToken=void 0,t.authContext=void 0,t}var Tl="NGT",Il=pn(),El=n,Cl=new wl,Al=!1,kl=!1,Pl=!1,Ml=!1,Ll=!1;function Dl(){return Object.assign({},Cl)}function zl(){return El}function Ol(){return Tl}function Rl(){return Il}function Nl(){return Cl.authType===p.AuthenticationType.subscriptionKey?Cl.subscriptionKey:void 0}function Bl(){return bl}function Fl(t){return!vl.isIE()&&h.supported({failIfMajorPerformanceCaveat:t})}function Ul(t){Cl=(new wl).merge(Cl,t),Ll=!0}function jl(t){El=t,kl=!0}function ql(t){Tl=ml.getCode(t),Pl=!0}function Vl(t){Il=t,Ml=!0}function Gl(t){Cl.setSubscriptionKey(t),Ll=!0}function Zl(t){bl=t,Al=!0}function Hl(t,e){if(e=Math.abs(e||1),"string"==typeof t&&nu[t.toLowerCase()]){for(var i=nu[t.toLowerCase()],r=/calc\(([0-9.]+)[px]*\s*\*\s*\{scale\}\)/gi,n=i,o=r.exec(i);o;)n=n.replace(o[0],parseFloat(o[1])*e+""),o=r.exec(i);return n=n.replace("{scale}",e+"")}throw new Error("Invalid templateName.")}function Wl(){return Ll}function Kl(){return kl}function Xl(){return Pl}function Yl(){return Ml}function Jl(){return Al}var Ql,$l,tu,eu,iu,ru,nu={marker:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(27 * {scale})" height="calc(39 * {scale})" viewBox="-1 -1 26 38"><path d="M12.25.25a12.254 12.254 0 0 0-12 12.494c0 6.444 6.488 12.109 11.059 22.564.549 1.256 1.333 1.256 1.882 0C17.762 24.853 24.25 19.186 24.25 12.744A12.254 12.254 0 0 0 12.25.25Z" style="fill:{color};stroke:{secondaryColor};stroke-width:1"/><text x="12.5" y="17.5" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(39 * {scale})" viewBox="-1 -1 27 38"><path d="M12.25.25a12.254 12.254 0 0 0-12 12.494c0 6.444 6.488 12.109 11.059 22.564.549 1.256 1.333 1.256 1.882 0C17.762 24.853 24.25 19.186 24.25 12.744A12.254 12.254 0 0 0 12.25.25Z" style="fill:{color};stroke:{secondaryColor};stroke-width:2"/><text x="12.5" y="18.5" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-circle":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(39 * {scale})" viewBox="-1 -1 27 38"><path d="M12.25.25a12.254 12.254 0 0 0-12 12.494c0 6.444 6.488 12.109 11.059 22.564.549 1.256 1.333 1.256 1.882 0C17.762 24.853 24.25 19.186 24.25 12.744A12.254 12.254 0 0 0 12.25.25Z" style="fill:{color};stroke:{secondaryColor};stroke-width:1"/><circle cx="12.5" cy="12.5" r="9" fill="{secondaryColor}"/><text x="12" y="17.5" style="font-size:14px;fill:#000;text-anchor:middle">{text}</text></svg>',pin:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(24 * {scale})" height="calc(28 * {scale})" viewBox="0 0 24 28"><path d="m11.988 16.615a5.15 5.15 0 0 1-2.268-.525 4.909 4.909 0 0 1-2.805-4.442 5.019 5.019 0 0 1 5.072-4.936h.012a5.03 5.03 0 0 1 5.085 4.961 4.907 4.907 0 0 1-.549 2.224 5.114 5.114 0 0 1-4.548 2.718zm0-8.06a3.173 3.173 0 0 0-3.226 3.099 3.081 3.081 0 0 0 1.77 2.782 3.299 3.299 0 0 0 4.365-1.386 3.049 3.049 0 0 0 .342-1.381 3.184 3.184 0 0 0-3.239-3.114h-.012z" fill="{secondaryColor}"/><path d="m11.999.922a10.908 10.908 0 0 0-11.076 10.732 10.639 10.639 0 0 0 4.418 8.598l6.658 6.464 6.658-6.463a10.537 10.537 0 0 0 2.198-15.041 11.182 11.182 0 0 0-8.856-4.289zm1.873 14.341a4.221 4.221 0 0 1-5.589-1.789 3.945 3.945 0 0 1-.445-1.8 4.164 4.164 0 0 1 8.323-.037 4.028 4.028 0 0 1-2.289 3.626Z" fill="{color}"/><path d="m11.999 28-7.256-7.044a11.611 11.611 0 0 1-4.743-9.303 11.844 11.844 0 0 1 11.988-11.652.102 .102 0 0 1 .02 0 12.164 12.164 0 0 1 9.577 4.647 11.357 11.357 0 0 1 2.299 8.614 11.521 11.521 0 0 1-4.63 7.695zm-.01-26.157a9.997 9.997 0 0 0-10.143 9.812 9.769 9.769 0 0 0 4.04 7.853l.099.083 6.014 5.838 6.113-5.922a9.7 9.7 0 0 0 3.945-6.505 9.533 9.533 0 0 0-1.933-7.229 10.305 10.305 0 0 0-8.116-3.931h-.021zm.021 14.772a5.11 5.11 0 0 1-4.547-2.718 4.868 4.868 0 0 1 .932-5.743 5.118 5.118 0 0 1 3.58-1.46h.024a5.031 5.031 0 0 1 5.084 4.938 4.92 4.92 0 0 1-2.805 4.457h0a5.152 5.152 0 0 1-2.269.525zm-.011-8.079h-.015a3.277 3.277 0 0 0-2.295.933 3.029 3.029 0 0 0-.587 3.58 3.297 3.297 0 0 0 4.364 1.386h0a3.092 3.092 0 0 0 1.772-2.795 3.185 3.185 0 0 0-3.239-3.105z" fill="{secondaryColor}"/><text x="12" y="17" style="font-size:14px;fill:#000;text-anchor:middle">{text}</text></svg>',"pin-round":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(25 * {scale})" height="calc(25 * {scale})" viewBox="0 0 25 25"><g transform="translate(0 1)"><circle cx="12.25" cy="11.5833" r="11" fill="{color}"/><path d="m12.25 23.583a12 12 0 1 1 12-12 12 12 0 0 1-12 12zm0-22a10 10 0 1 0 10 10 10 10 0 0 0-10-10z" fill="{secondaryColor}"/><circle cx="12.25" cy="11.5833" r="4.2386" fill="{secondaryColor}"/></g><text x="12.5" y="17" style="font-size:14px;fill:#000;text-anchor:middle">{text}</text></svg>',"marker-flat":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(27 * {scale})" height="calc(42.8 * {scale})"  viewBox="0 0 1600 2570"><g fill="{color}"><path d="M691 2419c-409-575-641-1086-683-1504-10-106-10-136 5-224 31-188 105-330 241-458 129-124 270-190 453-214 69-9 113-10 182-1 373 46 655 326 703 698 40 308-120 801-424 1309-134 224-348 535-369 535-4 0-53-63-108-141z"/></g><g fill="rgba(0,0,0,0.15)" style="transform:scale(-1,1);transform-origin:center"><path d="M691 2419c-407-571-639-1083-682-1498-14-139-3-249 37-371 69-208 254-402 459-481 68-27 217-59 271-59h24v160 180 940 635c0 349-2 635-5 635-2 0-49-63-104-141z"/></g><circle cx="800" cy="800" r="600" fill="{secondaryColor}"/><text x="800" y="1100" style="font-size:800px;fill:#000;text-anchor:middle">{text}</text></svg>',"marker-arrow":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(25.47 * {scale})" height="calc(35.18 * {scale})" viewBox="0 0 4330 5980"><g fill="{color}"><path d="m2080 5969c-49-20-93-63-115-113-25-55-1928-5486-1953-5573-40-138 67-282 210-283 36 0 246 73 987 345 518 190 947 345 955 345 8 0 438-155 955-345 615-226 954-345 979-345 87 0 165 47 204 123 46 91 107-95-957 2942-537 1535-986 2805-997 2823-11 18-43 46-72 62-41 24-62 30-111 29-33 0-71-5-85-10z"/></g><g fill="{secondaryColor}"><path d="m2200 1600c-36 10-83 2-484-84-243-53-451-94-461-91-11 4-22 18-25 31-5 19 114 371 436 1292 244 697 448 1273 454 1281 19 24 50 30 71 12z"/><path d="m2200 1600c-36 10-83 2-484-84-243-53-451-94-461-91-11 4-22 18-25 31-5 19 114 371 436 1292 244 697 448 1273 454 1281 19 24 50 30 71 12z" style="transform:scale(-1,1);transform-origin:center"/></g><g fill="rgba(0,0,0,0.2)" ><path d="m2165 685c8 0 438-155 955-345 615-226 954-345 979-345 87 0 165 47 204 123 46 91 107-95-957 2942-537 1535-986 2805-997 2823-11 18-43 46-72 62-41 24-62 30-111 29z"/></g><text x="2165" y="3300" style="font-size:2500px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-ball-pin":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(15.67 * {scale})" height="calc(33.33 * {scale})" viewBox="0 0 235 452"><g transform="translate(-135 10)"><path fill="{secondaryColor}" d="m256 442 0 0c-13 0-18-11-18-24l-6-323c0-13 11-24 24-24h0c13 0 24 11 24 24l-6 323c0 13-5 24-18 24z"/><circle style="fill:{color};stroke-width:10;stroke:{secondaryColor}" cx="256" cy="112" r="111"/><ellipse transform="matrix(0.834 0.5518 -0.5518 0.834 65.7916 -97.18)" fill="rgba(255,255,255,0.3)" cx="194.399" cy="60.749" rx="19.076" ry="32.428"/></g><text x="117.5" y="160" style="font-size:160px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(26.67 * {scale})" height="calc(32.27 * {scale})" viewBox="0 0 2000 2420"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="M845 2152c-22-37-58-95-80-129-22-35-62-99-90-143l-50-80-312 0-313 0 0-900 0-900 900 0 900 0 0 900 0 900-313 0-313 0-34 58c-19 31-38 59-42 60-5 2-8 8-8 12 0 9-69 123-88 145-5 6-11 15-13 21-16 39-77 123-89 124-8 0-33-31-55-68z"/></g><text x="1000" y="1300" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square-cluster":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(33.33 * {scale})" height="calc(38.8 * {scale})" viewBox="0 0 2500 2910"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="m866 2652c-17-31-37-68-46-82-9-14-32-54-51-90-19-36-50-92-70-125l-36-60-332-3-331-2 0-905 0-905 660 0 660 0 0-38c0-71 50-196 102-258 71-85 189-164 244-164 12 0 26-4 29-10 8-13 222-13 230 0 3 6 17 10 30 10 25 0 117 45 154 76 130 107 191 232 191 392 0 155-63 284-190 386-36 29-129 76-150 76-11 0-22 5-25 10-3 6-31 10-61 10l-54 0 0 660 0 660-332 2-332 3-29 50c-17 28-48 84-70 125-22 41-47 86-56 100-9 14-30 51-46 83-17 32-36 57-45 57-8 0-28-25-44-58z"/></g><text x="1650" y="900" style="font-size:1000px;fill:#fff">+</text><text x="1000" y="1800" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square-rounded":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(26.8 * {scale})" height="calc(32.27 * {scale})" viewBox="0 0 2010 2410"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="M856 2155c-20-30-36-59-36-65 0-5-4-10-10-10-5 0-10-5-10-11 0-5-18-37-40-69-22-32-40-64-40-69 0-6-4-11-10-11-5 0-10-5-10-10 0-6-15-33-32-60l-33-50-127 0c-74 0-129-4-133-10-3-5-17-10-30-10-25 0-116-45-155-76-87-69-142-151-178-265-15-46-17-1075-2-1084 5-3 10-17 10-30 0-13 5-27 10-30 6-3 10-13 10-22 0-22 83-135 122-168 57-46 62-50 112-75l50-25 585 0 586 0 63 34c84 46 169 133 212 218l35 68 0 565 0 565-28 59c-32 69-100 157-139 180-15 9-33 22-40 29-23 22-99 57-123 57-13 0-27 5-30 10-4 6-60 10-135 10l-128 0-128 205c-84 136-133 205-144 205-10 0-33-24-54-55z"/></g><text x="1000" y="1300" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square-rounded-cluster":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(33.33 * {scale})" height="calc(32.13 * {scale})" viewBox="0 0 2500 2900"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="m874 2669c-9-18-26-49-37-68-11-20-30-55-43-78-13-24-36-64-51-90-14-27-38-69-52-95l-26-48-142 0c-84 0-144-4-148-10-3-5-17-10-30-10-25 0-118-46-154-76-91-76-136-142-175-254-13-38-16-119-16-554 0-358 3-520 12-545 40-125 106-219 195-278 127-84 116-83 646-83l467 0 0-42c0-46 11-87 45-163 54-121 169-220 306-264 46-14 232-14 278 0 165 53 284 175 340 350 19 61 14 204-10 273-32 91-94 178-169 240-38 31-130 76-155 76-13 0-27 5-30 10-3 6-28 10-56 10l-49 0 0 462c0 446-1 464-21 522-32 91-94 178-169 240-38 31-130 76-155 76-13 0-27 5-30 10-4 6-65 10-149 10-138 0-143 1-154 23-12 23-62 114-112 202-16 28-44 79-63 115-42 77-67 88-93 39z"/></g><text x="1650" y="900" style="font-size:1000px;fill:#fff">+</text><text x="1000" y="1800" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',flag:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(23.5 * {scale})" height="calc(40 * {scale})" viewBox="34 28 198 308"><path style="stroke:{secondaryColor};stroke-width:15;stroke-linecap:round;" d="M42 327l0 -291"/><path style="fill:{color};stroke:{secondaryColor};stroke-width:10;stroke-linejoin:round;" d="M49 50c70 30 104 28 178 2-21 42-21 74 0 116-72 25-101 25-178 0l0-118z"/><text x="130" y="165" style="font-size:100px;fill:#fff;text-anchor:middle">{text}</text></svg>',"flag-triangle":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(27 * {scale})" height="calc(35.33 * {scale})" viewBox="0 0 40.5 53"><g transform="translate(-31 -20)"><path fill="{secondaryColor}" d="M34.7,73.3V48.4l34.6-10.1c0.7-0.2,1.2-0.8,1.2-1.5s-0.4-1.4-1-1.7L33.7,20.5c-0.5-0.2-1.1-0.2-1.6,0.2 c-0.5,0.3-0.7,0.8-0.7,1.4v51.2H34.7z"/><polygon points="34.7,24.5 66,36.5 34.7,45 34.7,10" fill="{color}"/></g><text x="11" y="21" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"rounded-square":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(34 * {scale})" height="calc(34 * {scale})" viewBox="0 0 34 34"><g transform="translate(2 2)"><rect x="0" y="0" rx="8" ry="8" width="30" height="30" style="stroke:{secondaryColor};stroke-width:2;fill:{color}"/></g><text x="17" y="22" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"rounded-square-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(38 * {scale})" height="calc(38 * {scale})" viewBox="0 0 38 38"><g transform="translate(4 4)"><rect x="0" y="0" rx="8" ry="8" width="30" height="30" style="stroke:{secondaryColor};stroke-width:4;fill:{color}"/></g><text x="19" y="24" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',triangle:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(36 * {scale})" height="calc(36 * {scale})" viewBox="0 0 36 36"><g transform="translate(2 2)"><polygon points="16,0 32,32 0,32 16,0" style="stroke:{secondaryColor};stroke-width:2;fill:{color}"/></g><text x="17.5" y="30" style="font-size:12px;fill:#fff;text-anchor:middle">{text}</text></svg>',"triangle-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 40 40"><g transform="translate(4 4)"><polygon points="16,0 32,32 0,32 16,0" style="stroke:{secondaryColor};stroke-width:4;fill:{color}"/></g><text x="19.5" y="32" style="font-size:12px;fill:#fff;text-anchor:middle">{text}</text></svg>',hexagon:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(35 * {scale})" height="calc(40 * {scale})" viewBox="0 0 35 40"><g transform="translate(2 2)"><path d="M31 9 15.5 0 0 9 0 27 15.5 36 31 27 31 9Z" style="stroke:{secondaryColor};stroke-width:2;fill:{color}"/></g><text x="17.5" y="25" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"hexagon-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(39 * {scale})" height="calc(44 * {scale})" viewBox="0 0 39 44"><g transform="translate(4 4)"><path d="M31 9 15.5 0 0 9 0 27 15.5 36 31 27 31 9Z" style="stroke:{secondaryColor};stroke-width:4;fill:{color}"/></g><text x="19.5" y="27" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"hexagon-rounded":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 1100 1100"><g transform="translate(50 50)"><path style="stroke:{secondaryColor};stroke-width:50;fill:{color}" d="M881 210 561 25c-33-19-88-19-121 0L119 210c-33 19-61 67-61 105v370c0 39 27 86 61 105l321 185c33 19 88 19 122 0l321-185c33-19 61-67 61-105V315C942 276 915 229 881 210z"/></g><text x="550" y="700" style="font-size:400px;fill:#fff;text-anchor:middle">{text}</text></svg>',"hexagon-rounded-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 1200 1200"><g transform="translate(100 100)"><path style="stroke:{secondaryColor};stroke-width:100;fill:{color}" d="M881 210 561 25c-33-19-88-19-121 0L119 210c-33 19-61 67-61 105v370c0 39 27 86 61 105l321 185c33 19 88 19 122 0l321-185c33-19 61-67 61-105V315C942 276 915 229 881 210z"/></g><text x="600" y="750" style="font-size:400px;fill:#fff;text-anchor:middle">{text}</text></svg>',"triangle-arrow-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(28 * {scale})" viewBox="0 0 28 28"><g transform="translate(2 2)"><polygon points="12,0 0,24 12,17 24,24" stroke-width="2" stroke="{secondaryColor}" fill="{color}"/></g><text x="14" y="17" style="font-size:8px;fill:#fff;text-anchor:middle">{text}</text></svg>',"triangle-arrow-left":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(28 * {scale})" viewBox="0 0 28 28"><g transform="translate(2 2)"><polygon points="24,12 0,0 7,12 0,24" stroke-width="2" stroke="{secondaryColor}" fill="{color}"/></g><text x="14" y="16.5" style="font-size:8px;fill:#fff;text-anchor:middle">{text}</text></svg>',"arrow-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(12.16 * {scale})" height="calc(30.1 * {scale})" viewBox="0 0 902 364"><g fill="{color}" transform="matrix(0,2.4,-2.4,0,897,-930)"><polygon points="902,222 233,222 233,364 0,182 233,0 233,141 902,141 902,222"/></g><text x="450" y="700" style="font-size:900px;fill:#000;text-anchor:middle">{text}</text></svg>',"arrow-up-thin":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(16 * {scale})" height="calc(33.33 * {scale})" viewBox="0 0 12 25"><g transform="translate(-136.91823 -751.91998)"><path fill="{color}" d="m148.271 760.71c-1.641-.547-3.186-1.47-4.633-2.769l0 18.07-1.675 0 0-18.07c-1.447 1.299-2.986 2.222-4.616 2.769l0-1.231c2.325-1.596 4.006-3.812 5.043-6.65l.838 0c1.037 2.838 2.718 5.055 5.043 6.65l0 1.231z"/></g><text x="6" y="20" style="font-size:10px;fill:#000;text-anchor:middle">{text}</text></svg>',car:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(21.93 * {scale})" height="calc(40.9 * {scale})" viewBox="0 0 6580 12270"><g transform="translate(0 12270) rotate(-90)"><path fill="{secondaryColor}" d="M7045 6566c-42-13-105-44-105-51 0-2 23-105 50-228 28-123 50-230 50-236 0-8-241-11-907-11-855 0-1145 6-1513 30-85 6-189 13-230 15-41 3-133 10-205 15-286 21-430 32-705 50-953 63-1459 18-2335-205-304-77-746-209-799-238-131-72-221-408-285-1062-34-345-42-532-48-1130-16-1557 108-2532 336-2649 32-17 469-149 676-205 409-110 819-191 1205-238 116-14 224-18 540-18 395 1 494 5 1140 50 1124 79 1224 82 2496 78l641-3-53-237c-29-131-52-238-51-239 1-1 31-14 66-29 56-23 76-26 142-23 67 3 83 7 120 33 23 17 50 41 61 55 10 14 51 117 91 230l73 205 674 3 675 2 90-39c98-43 198-72 315-93 122-21 829-18 990 5 321 45 626 143 849 270 293 168 516 378 704 662 266 402 416 893 467 1527 15 174 8 882-9 998-6 41-18 127-27 190-69 502-253 969-523 1325-79 105-262 284-381 374-189 142-355 229-574 300-336 110-526 139-952 148-457 9-685-23-887-124l-47-24-678-6-678-6-64 179c-79 224-92 253-121 284-67 70-177 97-274 66zm-2752-5073c-23-2-64-2-90 0-26 2-7 3 42 3 50 0 71-1 48-3zm395 0c-21-2-55-2-75 0-21 2-4 4 37 4 41 0 58-2 38-4z"/><path fill="{color}" d="M7043 6498c-13-6-23-19-23-28 0-9 23-117 50-240 28-123 50-230 50-237 0-22-2126-13-2465 10-132 10-400 28-595 42-661 47-824 55-1160 62-435 7-656-8-1040-73-415-70-865-183-1447-365-168-53-272-556-325-1569-16-319-16-1311 0-1630 45-872 129-1366 257-1518 22-26 51-39 172-77 557-177 1122-310 1563-369 271-36 351-40 690-40 361 1 463 6 1165 54 1122 78 1288 83 2337 79 460-2 840-7 843-11 4-4-17-117-47-252l-55-245 39-16c76-30 180-8 224 47 10 13 54 124 98 246l79 222 709 0 709 0 47-24c74-37 219-83 322-101 122-22 606-32 802-16 374 29 658 102 933 238 124 62 271 155 361 230l61 51 6 100c19 278 103 497 247 643 88 89 173 136 278 152l70 11 41 131c116 369 159 673 168 1170 10 584-38 984-167 1397l-40 126-70 12c-193 33-348 175-441 405-56 139-89 302-89 445 0 43-3 47-58 91-290 235-644 384-1068 450-191 29-796 39-974 16-135-18-263-54-368-102l-75-35-701 0-701 0-79 223c-82 232-102 267-163 293-38 16-138 17-170 2zm-2023-820c332-15 1155-12 1835 6 308 8 563 12 566 8 4-4 10-21 13-38 7-30 6-31-92-77-518-244-1197-396-2112-474-295-25-1282-25-1579 0-231 20-473 46-479 51-6 7 49 110 93 171 160 226 416 335 855 365 142 10 539 5 900-12zm3304-263c525-111 899-887 934-1935 19-557-37-1023-172-1435-186-563-521-900-896-899-81 0-158 14-525 92-426 91-431 92-540 146-195 96-287 207-306 368-12 104-11 2985 1 3078 22 170 135 291 365 389 49 21 191 55 480 115 226 47 419 87 430 89 45 10 164 6 229-8zm-5570-485c112-43 197-156 216-291 12-83 13-2623 1-2706-23-158-125-273-270-304-44-9-100-1-542 75-272 47-514 91-539 98-266 68-487 424-594 958-56 280-70 548-40 800 56 484 207 878 414 1081 115 114 122 116 702 218 277 49 524 90 550 90 26 1 72-8 102-19zm2111-3440c1023-44 1884-213 2462-486l113-53-7-33c-3-18-8-35-10-37-2-3-236 1-521 7-993 24-1271 26-1708 11-541-18-1128-18-1249-1-377 56-588 181-734 437-32 55-41 79-32 84 12 8 246 32 491 51 356 28 815 36 1195 20z"/></g><text x="3250" y="8250" style="font-size:3000px;fill:#fff;text-anchor:middle">{text}</text></svg>',checker:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(16 * {scale})" height="calc(16 * {scale})" viewBox="0 0 16 16"><pattern id="p" x="0" y="0" width="16" height="16" patternUnits="userSpaceOnUse"><rect fill="{color}" x="0" width="8" height="8" y="0"/><rect fill="{color}" x="8" width="8" height="8" y="8"/></pattern><rect x="0" y="0" width="16" height="16" fill="{secondaryColor}"/><rect x="0" y="0" width="16" height="16" fill="url(#p)"/></svg>',"checker-rotated":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(16 * {scale})" height="calc(16 * {scale})" viewBox="0 0 60 60"><rect width="60" height="60" fill="{secondaryColor}"/><rect width="42.42" height="42.42" transform="translate(30 0) rotate(45)" fill="{color}"/></svg>',"zig-zag":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(15 * {scale})" height="calc(15 * {scale})" viewBox="0 0 120 120"><rect x="0" y="0" width="120" height="120" fill="{secondaryColor}"/><polygon fill="{color}" points="120 120 60 120 90 90 120 60 120 0 120 0 60 60 0 0 0 60 30 90 60 120 120 120"/></svg>',"zig-zag-vertical":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(15 * {scale})" height="calc(15 * {scale})" viewBox="0 0 120 120"><rect x="0" y="0" width="120" height="120" fill="{secondaryColor}"/><polygon fill="{color}" points="120 0 120 60 90 30 60 0 0 0 0 0 60 60 0 120 60 120 90 90 120 60 120 0"/></svg>',"circles-spaced":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 20 20"><defs><pattern id="p" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="2" stroke="none" fill="{color}"/></pattern></defs><rect x="0" y="0" width="20" height="20" fill="{secondaryColor}"/><rect x="0" y="0" width="100" height="100" fill="url(#p)"/></svg>',circles:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(7 * {scale})" height="calc(7 * {scale})" viewBox="0 0 20 20"><defs><pattern id="p" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="6" stroke="none" fill="{color}"/></pattern></defs><rect x="0" y="0" width="20" height="20" fill="{secondaryColor}"/><rect x="0" y="0" width="100" height="100" fill="url(#p)"/></svg>',"diagonal-lines-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(18 * {scale})" height="calc(18 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"diagonal-lines-down":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(18 * {scale})" height="calc(18 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g transform="rotate(90 3 3)" fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"diagonal-stripes-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="40" height="40" fill="{secondaryColor}"/><g fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g></svg>',"diagonal-stripes-down":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="40" height="40" fill="{secondaryColor}"/><g transform="rotate(90 20 20)" fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g></svg>',"grid-lines":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(14 * {scale})" height="calc(14 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g transform="rotate(45 3 3)" fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g><g fill="{color}" transform="rotate(-45 3 3)"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"rotated-grid-lines":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(18 * {scale})" height="calc(18 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g transform="rotate(90 3 3)" fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g><g fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"rotated-grid-stripes":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="40" height="40" fill="{secondaryColor}"/><g transform="rotate(90 20 20)" fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g><g fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g></svg>',"x-fill":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="45.3" height="45.3" fill="{secondaryColor}"/><g fill="{color}"><path d="M0 38.59l2.83-2.83 1.41 1.41L1.41 40H0v-1.41zM0 1.4l2.83 2.83 1.41-1.41L1.41 0H0v1.41zM38.59 40l-2.83-2.83 1.41-1.41L40 38.59V40h-1.41zM40 1.41l-2.83 2.83-1.41-1.41L38.59 0H40v1.41zM20 18.6l2.83-2.83 1.41 1.41L21.41 20l2.83 2.83-1.41 1.41L20 21.41l-2.83 2.83-1.41-1.41L18.59 20l-2.83-2.83 1.41-1.41L20 18.59z"/></g></svg>',dots:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(13 * {scale})" height="calc(13 * {scale})" viewBox="0 0 20 20"><rect x="0" y="0" width="20" height="20" fill="{secondaryColor}"/><g fill="{color}"><circle cx="3" cy="3" r="3"/><circle cx="13" cy="13" r="3"/></g></svg>'},ou=(au.getHighContrastMode=function(){return matchMedia("(-ms-high-contrast: white-on-black)").matches?"dark":matchMedia("(-ms-high-contrast: black-on-white)").matches?"light":matchMedia("(-ms-high-contrast: active)").matches?"dark":matchMedia("(inverted-colors: inverted)").matches?"invert":null},au);function au(){}($l=Ql=Ql||{})[$l.LocalStorage=0]="LocalStorage",$l[$l.SessionStorage=1]="SessionStorage",(eu=tu=tu||{})[eu.Default=0]="Default",eu[eu.Required=1]="Required",eu[eu.Array=2]="Array",eu[eu.Hidden=4]="Hidden",(ru=iu=iu||{})[ru.AI=0]="AI",ru[ru.AI_AND_W3C=1]="AI_AND_W3C",ru[ru.W3C=2]="W3C";var su=2,lu=(uu.isNullOrUndefined=function(t){return null==t},uu.disableCookies=function(){uu._canUseCookies=!1},uu.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(hu,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})},uu);function uu(){}var cu,pu,hu=/[xy]/g,du=(fu.prototype.addNotificationListener=function(t){this.listeners.push(t)},fu.prototype.removeNotificationListener=function(t){for(var e=this.listeners.indexOf(t);-1<e;)this.listeners.splice(e,1),e=this.listeners.indexOf(t)},fu.prototype.eventsSent=function(e){for(var i=this,t=function(t){r.listeners[t].eventsSent&&setTimeout(function(){return i.listeners[t].eventsSent(e)},0)},r=this,n=0;n<this.listeners.length;++n)t(n)},fu.prototype.eventsDiscarded=function(e,i){for(var r=this,t=function(t){n.listeners[t].eventsDiscarded&&setTimeout(function(){return r.listeners[t].eventsDiscarded(e,i)},0)},n=this,o=0;o<this.listeners.length;++o)t(o)},fu);function fu(){this.listeners=[]}(pu=cu=cu||{})[pu.CRITICAL=1]="CRITICAL",pu[pu.WARNING=2]="WARNING";var mu=0,gu=1,yu=2,vu=3,_u=4,xu=5,bu=6,wu=7,Su=8,Tu=9,Iu=10,Eu=11,Cu=12,Au=13,ku=14,Pu=15,Mu=16,Lu=17,Du=18,zu=19,Ou=20,Ru=22,Nu=23,Bu=24,Fu=25,Uu=26,ju=27,qu=28,Vu=29,Gu=30,Zu=31,Hu=32,Wu=33,Ku=35,Xu=36,Yu=37,Ju=38,Qu=39,$u=40,tc=41,ec=42,ic=43,rc=45,nc=46,oc=47,ac=48,sc=49,lc=50,uc=52,cc=54,pc=55,hc=56,dc=57,fc=58,mc=60,gc=61,yc=62,vc=63,_c=64,xc=66,bc=67,wc=68,Sc=69,Tc=70,Ic=71,Ec=(Cc.sanitizeDiagnosticText=function(t){return'"'+t.replace(/\"/g,"")+'"'},Cc.dataType="MessageData",Cc.AiNonUserActionablePrefix="AI (Internal): ",Cc.AiUserActionablePrefix="AI: ",Cc);function Cc(t,e,i,r){void 0===i&&(i=!1),this.messageId=t,this.message=(i?Cc.AiUserActionablePrefix:Cc.AiNonUserActionablePrefix)+t;var n=(e?" message:"+Cc.sanitizeDiagnosticText(e):"")+(r?" props:"+Cc.sanitizeDiagnosticText(JSON.stringify(r)):"");this.message+=n}var Ac=(kc.prototype.throwInternal=function(t,e,i,r,n){void 0===n&&(n=!1);var o=new Ec(e,i,n,r);if(this.enableDebugExceptions())throw o;if(void 0!==o&&o&&void 0!==o.message){if(n){var a=+o.messageId;(!this._messageLogged[a]||this.consoleLoggingLevel()>=cu.WARNING)&&(this.warnToConsole(o.message),this._messageLogged[a]=!0)}else this.consoleLoggingLevel()>=cu.WARNING&&this.warnToConsole(o.message);this.logInternalMessage(t,o)}},kc.prototype.warnToConsole=function(t){"undefined"!=typeof console&&console&&("function"==typeof console.warn?console.warn(t):"function"==typeof console.log&&console.log(t))},kc.prototype.resetInternalMessageCount=function(){this._messageCount=0,this._messageLogged={}},kc.prototype.logInternalMessage=function(t,e){if(!this._areInternalMessagesThrottled()){var i=!0,r=this.AIInternalMessagePrefix+e.messageId;if(this._messageLogged[r]?i=!1:this._messageLogged[r]=!0,i&&(t<=this.telemetryLoggingLevel()&&(this.queue.push(e),this._messageCount++),this._messageCount==this.maxInternalMessageLimit())){var n="Internal events throttle limit per PageView reached for this app.",o=new Ec(Nu,n,!1);this.queue.push(o),this.warnToConsole(n)}}},kc.prototype._areInternalMessagesThrottled=function(){return this._messageCount>=this.maxInternalMessageLimit()},kc);function kc(t){this.AIInternalMessagePrefix="AITR_",this.enableDebugExceptions=function(){return!1},this.consoleLoggingLevel=function(){return 0},this.telemetryLoggingLevel=function(){return 1},this.maxInternalMessageLimit=function(){return 25},this.queue=[],this._messageCount=0,this._messageLogged={},lu.isNullOrUndefined(t)||(lu.isNullOrUndefined(t.loggingLevelConsole)||(this.consoleLoggingLevel=function(){return t.loggingLevelConsole}),lu.isNullOrUndefined(t.loggingLevelTelemetry)||(this.telemetryLoggingLevel=function(){return t.loggingLevelTelemetry}),lu.isNullOrUndefined(t.maxMessageLimit)||(this.maxInternalMessageLimit=function(){return t.maxMessageLimit}),lu.isNullOrUndefined(t.enableDebugExceptions)||(this.enableDebugExceptions=function(){return t.enableDebugExceptions}))}var Pc=(Mc.prototype.processTelemetry=function(e){this.channelQueue.forEach(function(t){0<t.length&&t[0].processTelemetry(e)})},Object.defineProperty(Mc.prototype,"ChannelControls",{get:function(){return this.channelQueue},enumerable:!0,configurable:!0}),Mc.prototype.initialize=function(i,r,n){var o=this;if(i.isCookieUseDisabled&&lu.disableCookies(),this.channelQueue=new Array,i.channels){var a=void 0;i.channels.forEach(function(t){if(t&&0<t.length){t=t.sort(function(t,e){return t.priority-e.priority});for(var e=1;e<t.length;e++)t[e-1].setNextPlugin(t[e]);if(t.forEach(function(t){t.priority<500&&(a=t.identifier),t.initialize(i,r,n)}),a)throw Error("Channel has invalid priority"+a);o.channelQueue.push(t)}})}for(var t=new Array,e=0;e<n.length;e++){var s=n[e];500<s.priority&&t.push(s)}if(0<t.length){for(t=t.sort(function(t,e){return t.priority-e.priority}),e=1;e<t.length;e++)t[e-1].setNextPlugin(t[e]);t.forEach(function(t){return t.initialize(i,r,n)}),this.channelQueue.push(t)}},Mc);function Mc(){this.identifier="ChannelControllerPlugin",this.priority=500}var Lc=(Dc.prototype.initialize=function(t,e){var i=this;if(this._isInitialized)throw Error("Core should not be initialized more than once");if(!t||lu.isNullOrUndefined(t.instrumentationKey))throw Error("Please provide instrumentation key");this.config=t,this._notificationManager=new du,this.config.extensions=lu.isNullOrUndefined(this.config.extensions)?[]:this.config.extensions,this.config.extensionConfig=lu.isNullOrUndefined(this.config.extensionConfig)?{}:this.config.extensionConfig,this.config.extensionConfig.NotificationManager=this._notificationManager,this.logger=new Ac(t),(n=this._extensions).push.apply(n,e.concat(this.config.extensions)),this._extensions.forEach(function(t){var e=!0;if((lu.isNullOrUndefined(t)||lu.isNullOrUndefined(t.initialize))&&(e=!1),!e)throw Error("Extensions must provide callback to initialize")}),this._extensions.push(this._channelController),this._extensions=this._extensions.sort(function(t,e){var i=typeof t.processTelemetry,r=typeof e.processTelemetry;return"function"==i&&"function"==r?t.priority-e.priority:"function"==i&&"function"!=r?1:"function"!=i&&"function"==r?-1:void 0});var r={};this._extensions.forEach(function(t){var e=t;e&&e.priority&&(lu.isNullOrUndefined(r[e.priority])?r[e.priority]=e.identifier:i.logger.warnToConsole("Two extensions have same priority"+r[e.priority]+", "+e.identifier))});for(var n,o=-1,a=0;a<this._extensions.length-1;a++){var s=this._extensions[a];if(!s||"function"==typeof s.processTelemetry){if(s.priority===this._channelController.priority){o=a+1;break}this._extensions[a].setNextPlugin(this._extensions[a+1])}}if(this._channelController.initialize(this.config,this,this._extensions),this._extensions.forEach(function(t){t&&t.priority<i._channelController.priority&&t.initialize(i.config,i,i._extensions)}),o<this._extensions.length&&this._extensions.splice(o),0===this.getTransmissionControls().length)throw new Error("No channels available");this._isInitialized=!0},Dc.prototype.getTransmissionControls=function(){return this._channelController.ChannelControls},Dc.prototype.track=function(t){if(null===t)throw this._notifyInvalidEvent(t),Error("Invalid telemetry item");t.iKey||(t.iKey=this.config.instrumentationKey),t.time||(t.time=(new Date).toISOString()),lu.isNullOrUndefined(t.ver)&&(t.ver="4.0"),this._validateTelmetryItem(t),0==this._extensions.length&&this._channelController.processTelemetry(t);for(var e=0;e<this._extensions.length;){if(this._extensions[e].processTelemetry){this._extensions[e].processTelemetry(t);break}e++}},Dc.prototype.addNotificationListener=function(t){this._notificationManager.addNotificationListener(t)},Dc.prototype.removeNotificationListener=function(t){this._notificationManager.removeNotificationListener(t)},Dc.prototype.pollInternalLogs=function(i){var r=this,t=this.config.diagnosticLogInterval;return 0<t||(t=1e4),setInterval(function(){var t=r.logger.queue;t.forEach(function(t){var e={name:i||"InternalMessageId: "+t.messageId,iKey:r.config.instrumentationKey,time:(new Date).toISOString(),baseType:Ec.dataType,baseData:{message:t.message}};r.track(e)}),t.length=0},t)},Dc.prototype._validateTelmetryItem=function(t){if(lu.isNullOrUndefined(t.name))throw this._notifyInvalidEvent(t),Error("telemetry name required");if(lu.isNullOrUndefined(t.time))throw this._notifyInvalidEvent(t),Error("telemetry timestamp required");if(lu.isNullOrUndefined(t.iKey))throw this._notifyInvalidEvent(t),Error("telemetry instrumentationKey required")},Dc.prototype._notifyInvalidEvent=function(t){this._notificationManager.eventsDiscarded([t],su)},Dc);function Dc(){this._isInitialized=!1,this._extensions=new Array,this._channelController=new Pc}var zc=(Oc.requestContextHeader="Request-Context",Oc.requestContextTargetKey="appId",Oc.requestContextAppIdFormat="appId=cid-v1:",Oc.requestIdHeader="Request-Id",Oc.traceParentHeader="traceparent",Oc.sdkContextHeader="Sdk-Context",Oc.sdkContextHeaderAppIdRequest="appId",Oc.requestContextHeaderLowerCase="request-context",Oc);function Oc(){}var Rc=(Nc.sanitizeKeyAndAddUniqueness=function(t,e,i){var r=e.length,n=Nc.sanitizeKey(t,e);if(n.length!==r){for(var o=0,a=n;void 0!==i[a];)o++,a=n.substring(0,Nc.MAX_NAME_LENGTH-3)+Nc.padNumber(o);n=a}return n},Nc.sanitizeKey=function(t,e){var i;return e&&(e=Nc.trim(e.toString())).length>Nc.MAX_NAME_LENGTH&&(i=e.substring(0,Nc.MAX_NAME_LENGTH),t.throwInternal(cu.WARNING,dc,"name is too long.  It has been truncated to "+Nc.MAX_NAME_LENGTH+" characters.",{name:e},!0)),i||e},Nc.sanitizeString=function(t,e,i){var r;return void 0===i&&(i=Nc.MAX_STRING_LENGTH),e&&(i=i||Nc.MAX_STRING_LENGTH,(e=Nc.trim(e)).toString().length>i&&(r=e.toString().substring(0,i),t.throwInternal(cu.WARNING,gc,"string value is too long. It has been truncated to "+i+" characters.",{value:e},!0))),r||e},Nc.sanitizeUrl=function(t,e){return Nc.sanitizeInput(t,e,Nc.MAX_URL_LENGTH,xc)},Nc.sanitizeMessage=function(t,e){var i;return e&&e.length>Nc.MAX_MESSAGE_LENGTH&&(i=e.substring(0,Nc.MAX_MESSAGE_LENGTH),t.throwInternal(cu.WARNING,hc,"message is too long, it has been truncated to "+Nc.MAX_MESSAGE_LENGTH+" characters.",{message:e},!0)),i||e},Nc.sanitizeException=function(t,e){var i;return e&&e.length>Nc.MAX_EXCEPTION_LENGTH&&(i=e.substring(0,Nc.MAX_EXCEPTION_LENGTH),t.throwInternal(cu.WARNING,uc,"exception is too long, it has been truncated to "+Nc.MAX_EXCEPTION_LENGTH+" characters.",{exception:e},!0)),i||e},Nc.sanitizeProperties=function(e,t){if(t){var i={};for(var r in t){var n=t[r];if("object"==typeof n&&"undefined"!=typeof JSON)try{n=JSON.stringify(n)}catch(t){e.throwInternal(cu.WARNING,sc,"custom property is not valid",{exception:t},!0)}n=Nc.sanitizeString(e,n,Nc.MAX_PROPERTY_LENGTH),i[r=Nc.sanitizeKeyAndAddUniqueness(e,r,i)]=n}t=i}return t},Nc.sanitizeMeasurements=function(t,e){if(e){var i={};for(var r in e){var n=e[r];i[r=Nc.sanitizeKeyAndAddUniqueness(t,r,i)]=n}e=i}return e},Nc.sanitizeId=function(t,e){return e?Nc.sanitizeInput(t,e,Nc.MAX_ID_LENGTH,Sc).toString():e},Nc.sanitizeInput=function(t,e,i,r){var n;return e&&(e=Nc.trim(e)).length>i&&(n=e.substring(0,i),t.throwInternal(cu.WARNING,r,"input is too long, it has been truncated to "+i+" characters.",{data:e},!0)),n||e},Nc.padNumber=function(t){var e="00"+t;return e.substr(e.length-3)},Nc.trim=function(t){return"string"!=typeof t?t:t.replace(/^\s+|\s+$/g,"")},Nc.MAX_NAME_LENGTH=150,Nc.MAX_ID_LENGTH=128,Nc.MAX_PROPERTY_LENGTH=8192,Nc.MAX_STRING_LENGTH=1024,Nc.MAX_URL_LENGTH=2048,Nc.MAX_MESSAGE_LENGTH=32768,Nc.MAX_EXCEPTION_LENGTH=32768,Nc);function Nc(){}var Bc=(Fc.createDomEvent=function(t){var e=null;return"function"==typeof Event?e=new Event(t):(e=document.createEvent("Event")).initEvent(t,!0,!0),e},Fc.disableStorage=function(){Fc._canUseLocalStorage=!1,Fc._canUseSessionStorage=!1},Fc._getLocalStorageObject=function(){return Fc.canUseLocalStorage()?Fc._getVerifiedStorageObject(Ql.LocalStorage):null},Fc._getVerifiedStorageObject=function(t){var e,i,r=null;try{if("undefined"==typeof window)return null;i=new Date,(r=t===Ql.LocalStorage?window.localStorage:window.sessionStorage).setItem(i,i),e=r.getItem(i)!=i,r.removeItem(i),e&&(r=null)}catch(t){r=null}return r},Fc.isInternalApplicationInsightsEndpoint=function(t){return-1!==Fc._internalEndpoints.indexOf(t.toLowerCase())},Fc.canUseLocalStorage=function(){return void 0===Fc._canUseLocalStorage&&(Fc._canUseLocalStorage=!!Fc._getVerifiedStorageObject(Ql.LocalStorage)),Fc._canUseLocalStorage},Fc.getStorage=function(e,t){var i=Fc._getLocalStorageObject();if(null!==i)try{return i.getItem(t)}catch(t){Fc._canUseLocalStorage=!1,e.throwInternal(cu.WARNING,gu,"Browser failed read of local storage. "+Fc.getExceptionName(t),{exception:Fc.dump(t)})}return null},Fc.setStorage=function(e,t,i){var r=Fc._getLocalStorageObject();if(null!==r)try{return r.setItem(t,i),!0}catch(t){Fc._canUseLocalStorage=!1,e.throwInternal(cu.WARNING,vu,"Browser failed write to local storage. "+Fc.getExceptionName(t),{exception:Fc.dump(t)})}return!1},Fc.removeStorage=function(e,t){var i=Fc._getLocalStorageObject();if(null!==i)try{return i.removeItem(t),!0}catch(t){Fc._canUseLocalStorage=!1,e.throwInternal(cu.WARNING,xu,"Browser failed removal of local storage item. "+Fc.getExceptionName(t),{exception:Fc.dump(t)})}return!1},Fc._getSessionStorageObject=function(){return Fc.canUseSessionStorage()?Fc._getVerifiedStorageObject(Ql.SessionStorage):null},Fc.canUseSessionStorage=function(){return void 0===Fc._canUseSessionStorage&&(Fc._canUseSessionStorage=!!Fc._getVerifiedStorageObject(Ql.SessionStorage)),Fc._canUseSessionStorage},Fc.getSessionStorageKeys=function(){var t=[];if(Fc.canUseSessionStorage())for(var e in window.sessionStorage)t.push(e);return t},Fc.getSessionStorage=function(e,t){var i=Fc._getSessionStorageObject();if(null!==i)try{return i.getItem(t)}catch(t){Fc._canUseSessionStorage=!1,e.throwInternal(cu.WARNING,yu,"Browser failed read of session storage. "+Fc.getExceptionName(t),{exception:Fc.dump(t)})}return null},Fc.setSessionStorage=function(e,t,i){var r=Fc._getSessionStorageObject();if(null!==r)try{return r.setItem(t,i),!0}catch(t){Fc._canUseSessionStorage=!1,e.throwInternal(cu.WARNING,_u,"Browser failed write to session storage. "+Fc.getExceptionName(t),{exception:Fc.dump(t)})}return!1},Fc.removeSessionStorage=function(e,t){var i=Fc._getSessionStorageObject();if(null!==i)try{return i.removeItem(t),!0}catch(t){Fc._canUseSessionStorage=!1,e.throwInternal(cu.WARNING,bu,"Browser failed removal of session storage item. "+Fc.getExceptionName(t),{exception:Fc.dump(t)})}return!1},Fc.disableCookies=function(){lu.disableCookies()},Fc.canUseCookies=function(e){if(void 0===lu._canUseCookies){lu._canUseCookies=!1;try{lu._canUseCookies=void 0!==Fc.document.cookie}catch(t){e.throwInternal(cu.WARNING,wc,"Cannot access document.cookie - "+Fc.getExceptionName(t),{exception:Fc.dump(t)})}}return lu._canUseCookies},Fc.setCookie=function(t,e,i,r){var n="",o="";r&&(n=";domain="+r),Fc.document.location&&"https:"===Fc.document.location.protocol&&(o=";secure"),Fc.canUseCookies(t)&&(Fc.document.cookie=e+"="+i+n+";path=/"+o)},Fc.stringToBoolOrDefault=function(t,e){return void 0===e&&(e=!1),null==t?e:"true"===t.toString().toLowerCase()},Fc.getCookie=function(t,e){if(Fc.canUseCookies(t)){var i="";if(e&&e.length)for(var r=e+"=",n=Fc.document.cookie.split(";"),o=0;o<n.length;o++){var a=n[o];if((a=Fc.trim(a))&&0===a.indexOf(r)){i=a.substring(r.length,n[o].length);break}}return i}},Fc.deleteCookie=function(t,e){Fc.canUseCookies(t)&&(Fc.document.cookie=e+"=;path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},Fc.trim=function(t){return"string"!=typeof t?t:t.replace(/^\s+|\s+$/g,"")},Fc.newId=function(){for(var t="",e=1073741824*Math.random();0<e;)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e%64),e=Math.floor(e/64);return t},Fc.random32=function(){return 4294967296*Math.random()|0},Fc.generateW3CId=function(){for(var t,e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],i="",r=0;r<4;r++)i+=e[15&(t=Fc.random32())]+e[t>>4&15]+e[t>>8&15]+e[t>>12&15]+e[t>>16&15]+e[t>>20&15]+e[t>>24&15]+e[t>>28&15];var n=e[8+4*Math.random()|0];return i.substr(0,8)+i.substr(9,4)+"4"+i.substr(13,3)+n+i.substr(16,3)+i.substr(19,12)},Fc.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},Fc.isError=function(t){return"[object Error]"===Object.prototype.toString.call(t)},Fc.isDate=function(t){return"[object Date]"===Object.prototype.toString.call(t)},Fc.toISOStringForIE8=function(t){if(Fc.isDate(t)){if(Date.prototype.toISOString)return t.toISOString();var e=function(t){var e=String(t);return 1===e.length&&(e="0"+e),e};return t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes())+":"+e(t.getUTCSeconds())+"."+String((t.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}},Fc.getIEVersion=function(t){void 0===t&&(t=null);var e=t?t.toLowerCase():navigator.userAgent.toLowerCase();return-1!=e.indexOf("msie")?parseInt(e.split("msie")[1]):null},Fc.msToTimeSpan=function(t){(isNaN(t)||t<0)&&(t=0);var e=""+(t=Math.round(t))%1e3,i=""+Math.floor(t/1e3)%60,r=""+Math.floor(t/6e4)%60,n=""+Math.floor(t/36e5)%24,o=Math.floor(t/864e5);return e=1===e.length?"00"+e:2===e.length?"0"+e:e,i=i.length<2?"0"+i:i,r=r.length<2?"0"+r:r,(0<o?o+".":"")+(n=n.length<2?"0"+n:n)+":"+r+":"+i+"."+e},Fc.isCrossOriginError=function(t,e,i,r,n){return("Script error."===t||"Script error"===t)&&!n},Fc.dump=function(t){var e=Object.prototype.toString.call(t),i=JSON.stringify(t);return"[object Error]"===e&&(i="{ stack: '"+t.stack+"', message: '"+t.message+"', name: '"+t.name+"'"),e+i},Fc.getExceptionName=function(t){return"[object Error]"===Object.prototype.toString.call(t)?t.name:""},Fc.addEventHandler=function(t,e){if("undefined"==typeof window||!window||"string"!=typeof t||"function"!=typeof e)return!1;var i="on"+t;if(window.addEventListener)window.addEventListener(t,e,!1);else{if(!window.attachEvent)return!1;window.attachEvent(i,e)}return!0},Fc.IsBeaconApiSupported=function(){return"sendBeacon"in navigator&&navigator.sendBeacon},Fc.getExtension=function(t,e){for(var i=null,r=0;!i&&r<t.length;)t[r]&&t[r].identifier===e&&(i=t[r]),r++;return i},Fc.document="undefined"!=typeof document?document:{},Fc._canUseLocalStorage=void 0,Fc._canUseSessionStorage=void 0,Fc._internalEndpoints=["https://dc.services.visualstudio.com/v2/track","https://breeze.aimon.applicationinsights.io/v2/track","https://dc-int.services.visualstudio.com/v2/track"],Fc.NotSpecified="not_specified",Fc);function Fc(){}var Uc=(jc.parseUrl=function(t){return jc.htmlAnchorElement||(jc.htmlAnchorElement=jc.document.createElement?jc.document.createElement("a"):{host:jc.parseHost(t)}),jc.htmlAnchorElement.href=t,jc.htmlAnchorElement},jc.getAbsoluteUrl=function(t){var e,i=jc.parseUrl(t);return i&&(e=i.href),e},jc.getPathName=function(t){var e,i=jc.parseUrl(t);return i&&(e=i.pathname),e},jc.getCompleteUrl=function(t,e){return t?t.toUpperCase()+" "+e:e},jc.parseHost=function(t){var e=t.match(/:\/\/(www[0-9]?\.)?(.[^/:]+)/i);return null!=e&&2<e.length&&"string"==typeof e[2]&&0<e[2].length?e[2]:null},jc.document="undefined"!=typeof document?document:{},jc);function jc(){}var qc=(Vc.canIncludeCorrelationHeader=function(t,e,i){if(t&&t.disableCorrelationHeaders)return!1;if(!e)return!1;var r=Uc.parseUrl(e).host.toLowerCase();if(!(t&&t.enableCorsCorrelation||r===i))return!1;var n,o=t&&t.correlationHeaderDomains;if(o&&(o.forEach(function(t){var e=new RegExp(t.toLowerCase().replace(/\./g,".").replace(/\*/g,".*"));n=n||e.test(r)}),!n))return!1;var a=t&&t.correlationHeaderExcludedDomains;if(!a||0==a.length)return!0;for(var s=0;s<a.length;s++)if(new RegExp(a[s].toLowerCase().replace(/\./g,".").replace(/\*/g,".*")).test(r))return!1;return!0},Vc.getCorrelationContext=function(t){if(t){var e=Vc.getCorrelationContextValue(t,zc.requestContextTargetKey);if(e&&e!==Vc.correlationIdPrefix)return e}},Vc.getCorrelationContextValue=function(t,e){if(t)for(var i=t.split(","),r=0;r<i.length;++r){var n=i[r].split("=");if(2==n.length&&n[0]==e)return n[1]}},Vc.correlationIdPrefix="cid-v1:",Vc);function Vc(){}var Gc=(Zc.ParseDependencyPath=function(t,e,i,r){var n,o=r,a=r;if(e&&0<e.length){var s=Uc.parseUrl(e);if(n=s.host,!o)if(null!=s.pathname){var l=0===s.pathname.length?"/":s.pathname;"/"!==l.charAt(0)&&(l="/"+l),a=s.pathname,o=Rc.sanitizeString(t,i?i+" "+l:l)}else o=Rc.sanitizeString(t,e)}else o=n=r;return{target:n,name:o,data:a}},Zc);function Zc(){}var Hc=(Wc.Now="undefined"!=typeof window&&window.performance&&window.performance.now&&window.performance.timing?function(){return window.performance.now()+window.performance.timing.navigationStart}:function(){return(new Date).getTime()},Wc.GetDuration=function(t,e){var i=null;return 0===t||0===e||lu.isNullOrUndefined(t)||lu.isNullOrUndefined(e)||(i=e-t),i},Wc);function Wc(){}var Kc,Xc="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",Yc="ProcessLegacy",Jc="http.method",Qc=(b($c,Kc=function(){}),$c);function $c(){return Kc.call(this)||this}var tp,ep=(b(ip,tp=function(){this.ver=1,this.sampleRate=100,this.tags={}}),ip);function ip(t,e,i){var r=tp.call(this)||this;return r.name=Rc.sanitizeString(t,i)||Bc.NotSpecified,r.data=e,r.time=Bc.toISOStringForIE8(new Date),r.aiDataContract={time:tu.Required,iKey:tu.Required,name:tu.Required,sampleRate:function(){return 100==r.sampleRate?tu.Hidden:tu.Required},tags:tu.Required,data:tu.Required},r}function rp(){}var np,op=(b(ap,np=rp),ap);function ap(){var t=np.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}var sp,lp=(b(up,sp=op),up.envelopeType="Microsoft.ApplicationInsights.{0}.Event",up.dataType="EventData",up);function up(t,e,i,r){var n=sp.call(this)||this;return n.aiDataContract={ver:tu.Required,name:tu.Required,properties:tu.Default,measurements:tu.Default},n.name=Rc.sanitizeString(t,e)||Bc.NotSpecified,n.properties=Rc.sanitizeProperties(t,i),n.measurements=Rc.sanitizeMeasurements(t,r),n}function cp(){}var pp,hp=(b(dp,pp=rp),dp);function dp(){var t=pp.call(this)||this;return t.ver=2,t.exceptions=[],t.properties={},t.measurements={},t}function fp(){this.hasFullStack=!0,this.parsedStack=[]}var mp,gp=(b(yp,mp=hp),yp.CreateFromInterface=function(e,t){var i=t.exceptions&&t.exceptions.map(function(t){return _p.CreateFromInterface(e,t)});return new yp(e,w({},t,{exceptions:i}))},yp.prototype.toInterface=function(){var t=this.exceptions,e=this.properties,i=this.measurements,r=this.severityLevel,n=this.ver,o=this.problemGroup,a=this.id,s=this.isManual;return{ver:n,exceptions:t instanceof Array&&t.map(function(t){return t.toInterface()})||void 0,severityLevel:r,properties:e,measurements:i,problemGroup:o,id:a,isManual:s}},yp.CreateSimpleException=function(t,e,i,r,n,o){return{exceptions:[{hasFullStack:!0,message:t,stack:n,typeName:e}]}},yp.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",yp.dataType="ExceptionData",yp);function yp(t,e,i,r,n,o){var a=mp.call(this)||this;return a.aiDataContract={ver:tu.Required,exceptions:tu.Required,severityLevel:tu.Default,properties:tu.Default,measurements:tu.Default},e instanceof Error?(a.exceptions=[new _p(t,e)],a.properties=Rc.sanitizeProperties(t,i),a.measurements=Rc.sanitizeMeasurements(t,r),n&&(a.severityLevel=n),o&&(a.id=o)):(a.exceptions=e.exceptions,a.properties=e.properties,a.measurements=e.measurements,e.severityLevel&&(a.severityLevel=e.severityLevel),e.id&&(a.id=e.id),e.problemGroup&&(a.problemGroup=e.problemGroup),lu.isNullOrUndefined(e.ver)||(a.ver=e.ver),lu.isNullOrUndefined(e.isManual)||(a.isManual=e.isManual)),a}var vp,_p=(b(xp,vp=fp),xp.prototype.toInterface=function(){var t=this.parsedStack instanceof Array&&this.parsedStack.map(function(t){return t.toInterface()});return{id:this.id,outerId:this.outerId,typeName:this.typeName,message:this.message,hasFullStack:this.hasFullStack,stack:this.stack,parsedStack:t||void 0}},xp.CreateFromInterface=function(t,e){var i=e.parsedStack instanceof Array&&e.parsedStack.map(function(t){return wp.CreateFromInterface(t)})||e.parsedStack;return new xp(t,w({},e,{parsedStack:i}))},xp.parseStack=function(t){var e=void 0;if("string"==typeof t){var i=t.split("\n");e=[];for(var r=0,n=0,o=0;o<=i.length;o++){var a=i[o];if(wp.regex.test(a)){var s=new wp(i[o],r++);n+=s.sizeInBytes,e.push(s)}}if(32768<n)for(var l=0,u=e.length-1,c=0,p=l,h=u;l<u;){if(32768<(c+=e[l].sizeInBytes+e[u].sizeInBytes)){var d=h-p+1;e.splice(p,d);break}p=l,h=u,l++,u--}}return e},xp);function xp(t,e){var i=vp.call(this)||this;if(i.aiDataContract={id:tu.Default,outerId:tu.Default,typeName:tu.Required,message:tu.Required,hasFullStack:tu.Default,stack:tu.Default,parsedStack:tu.Array},e instanceof Error){i.typeName=Rc.sanitizeString(t,e.name)||Bc.NotSpecified,i.message=Rc.sanitizeMessage(t,e.message)||Bc.NotSpecified;var r=e.stack;i.parsedStack=xp.parseStack(r),i.stack=Rc.sanitizeException(t,r),i.hasFullStack=Bc.isArray(i.parsedStack)&&0<i.parsedStack.length}else i.typeName=e.typeName,i.message=e.message,i.stack=e.stack,i.parsedStack=e.parsedStack,i.hasFullStack=e.hasFullStack;return i}var bp,wp=(b(Sp,bp=cp),Sp.CreateFromInterface=function(t){return new Sp(t,null)},Sp.prototype.toInterface=function(){return{level:this.level,method:this.method,assembly:this.assembly,fileName:this.fileName,line:this.line}},Sp.regex=/^([\s]+at)?(.*?)(\@|\s\(|\s)([^\(\@\n]+):([0-9]+):([0-9]+)(\)?)$/,Sp.baseSize=58,Sp);function Sp(t,e){var i=bp.call(this)||this;if(i.sizeInBytes=0,i.aiDataContract={level:tu.Required,method:tu.Required,assembly:tu.Default,fileName:tu.Default,line:tu.Default},"string"==typeof t){var r=t;i.level=e,i.method="<no_method>",i.assembly=Bc.trim(r),i.fileName="",i.line=0;var n=r.match(Sp.regex);n&&5<=n.length&&(i.method=Bc.trim(n[2])||i.method,i.fileName=Bc.trim(n[4]),i.line=parseInt(n[5])||0)}else i.level=t.level,i.method=t.method,i.assembly=t.assembly,i.fileName=t.fileName,i.line=t.line,i.sizeInBytes=0;return i.sizeInBytes+=i.method.length,i.sizeInBytes+=i.fileName.length,i.sizeInBytes+=i.assembly.length,i.sizeInBytes+=Sp.baseSize,i.sizeInBytes+=i.level.toString().length,i.sizeInBytes+=i.line.toString().length,i}var Tp,Ip,Ep,Cp=(b(Ap,Tp=rp),Ap);function Ap(){var t=Tp.call(this)||this;return t.ver=2,t.metrics=[],t.properties={},t}(Ep=Ip=Ip||{})[Ep.Measurement=0]="Measurement",Ep[Ep.Aggregation=1]="Aggregation";var kp,Pp=(b(Mp,kp=function(){this.kind=Ip.Measurement}),Mp);function Mp(){var t=null!==kp&&kp.apply(this,arguments)||this;return t.aiDataContract={name:tu.Required,kind:tu.Default,value:tu.Required,count:tu.Default,min:tu.Default,max:tu.Default,stdDev:tu.Default},t}var Lp,Dp=(b(zp,Lp=Cp),zp.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",zp.dataType="MetricData",zp);function zp(t,e,i,r,n,o,a){var s=Lp.call(this)||this;s.aiDataContract={ver:tu.Required,metrics:tu.Required,properties:tu.Default};var l=new Pp;return l.count=0<r?r:void 0,l.max=isNaN(o)||null===o?void 0:o,l.min=isNaN(n)||null===n?void 0:n,l.name=Rc.sanitizeString(t,e)||Bc.NotSpecified,l.value=i,s.metrics=[l],s.properties=Rc.sanitizeProperties(t,a),s}var Op,Rp=(b(Np,Op=op),Np);function Np(){var t=Op.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}var Bp,Fp=(b(Up,Bp=Rp),Up.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",Up.dataType="PageviewData",Up);function Up(t,e,i,r,n,o,a){var s=Bp.call(this)||this;return s.aiDataContract={ver:tu.Required,name:tu.Default,url:tu.Default,duration:tu.Default,properties:tu.Default,measurements:tu.Default,id:tu.Default},s.id=Rc.sanitizeId(t,a),s.url=Rc.sanitizeUrl(t,i),s.name=Rc.sanitizeString(t,e)||Bc.NotSpecified,isNaN(r)||(s.duration=Bc.msToTimeSpan(r)),s.properties=Rc.sanitizeProperties(t,n),s.measurements=Rc.sanitizeMeasurements(t,o),s}var jp,qp=(b(Vp,jp=rp),Vp);function Vp(){var t=jp.call(this)||this;return t.ver=2,t.success=!0,t.properties={},t.measurements={},t}var Gp,Zp=(b(Hp,Gp=qp),Hp.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",Hp.dataType="RemoteDependencyData",Hp);function Hp(t,e,i,r,n,o,a,s,l,u,c,p){void 0===l&&(l="Ajax");var h=Gp.call(this)||this;h.aiDataContract={id:tu.Required,ver:tu.Required,name:tu.Default,resultCode:tu.Default,duration:tu.Default,success:tu.Default,data:tu.Default,target:tu.Default,type:tu.Default,properties:tu.Default,measurements:tu.Default,kind:tu.Default,value:tu.Default,count:tu.Default,min:tu.Default,max:tu.Default,stdDev:tu.Default,dependencyKind:tu.Default,dependencySource:tu.Default,commandName:tu.Default,dependencyTypeName:tu.Default},h.id=e,h.duration=Bc.msToTimeSpan(n),h.success=o,h.resultCode=a+"",h.type=Rc.sanitizeString(t,l);var d=Gc.ParseDependencyPath(t,i,s,r);return h.data=Rc.sanitizeUrl(t,r)||d.data,h.target=Rc.sanitizeString(t,d.target),u&&(h.target=h.target+" | "+u),h.name=Rc.sanitizeString(t,d.name),h.properties=Rc.sanitizeProperties(t,c),h.measurements=Rc.sanitizeMeasurements(t,p),h}var Wp,Kp=(b(Xp,Wp=rp),Xp);function Xp(){var t=Wp.call(this)||this;return t.ver=2,t.properties={},t}var Yp,Jp=(b(Qp,Yp=Kp),Qp.envelopeType="Microsoft.ApplicationInsights.{0}.Message",Qp.dataType="MessageData",Qp);function Qp(t,e,i,r){var n=Yp.call(this)||this;return n.aiDataContract={ver:tu.Required,message:tu.Required,severityLevel:tu.Default,properties:tu.Default},e=e||Bc.NotSpecified,n.message=Rc.sanitizeMessage(t,e),n.properties=Rc.sanitizeProperties(t,r),i&&(n.severityLevel=i),n}var $p,th=(b(eh,$p=Rp),eh);function eh(){var t=$p.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}var ih,rh=(b(nh,ih=th),nh.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",nh.dataType="PageviewPerformanceData",nh);function nh(t,e,i,r,n,o,a){var s=ih.call(this)||this;return s.aiDataContract={ver:tu.Required,name:tu.Default,url:tu.Default,duration:tu.Default,perfTotal:tu.Default,networkConnect:tu.Default,sentRequest:tu.Default,receivedResponse:tu.Default,domProcessing:tu.Default,properties:tu.Default,measurements:tu.Default},s.url=Rc.sanitizeUrl(t,i),s.name=Rc.sanitizeString(t,e)||Bc.NotSpecified,s.properties=Rc.sanitizeProperties(t,n),s.measurements=Rc.sanitizeMeasurements(t,o),a&&(s.domProcessing=a.domProcessing,s.duration=a.duration,s.networkConnect=a.networkConnect,s.perfTotal=a.perfTotal,s.receivedResponse=a.receivedResponse,s.sentRequest=a.sentRequest),s}var oh,ah,sh,lh=(b(uh,oh=Qc),uh);function uh(t,e){var i=oh.call(this)||this;return i.aiDataContract={baseType:tu.Required,baseData:tu.Required},i.baseType=t,i.baseData=e,i}(sh=ah=ah||{})[sh.Verbose=0]="Verbose",sh[sh.Information=1]="Information",sh[sh.Warning=2]="Warning",sh[sh.Error=3]="Error",sh[sh.Critical=4]="Critical";var ch=(ph.getConfig=function(t,e,i,r){var n;return void 0===r&&(r=!1),n=i&&t.extensionConfig&&t.extensionConfig[i]&&!lu.isNullOrUndefined(t.extensionConfig[i][e])?t.extensionConfig[i][e]:t[e],lu.isNullOrUndefined(n)?r:n},ph);function ph(){}var hh=function(){this.applicationVersion="ai.application.ver",this.applicationBuild="ai.application.build",this.applicationTypeId="ai.application.typeId",this.applicationId="ai.application.applicationId",this.applicationLayer="ai.application.layer",this.deviceId="ai.device.id",this.deviceIp="ai.device.ip",this.deviceLanguage="ai.device.language",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceFriendlyName="ai.device.friendlyName",this.deviceNetwork="ai.device.network",this.deviceNetworkName="ai.device.networkName",this.deviceOEMName="ai.device.oemName",this.deviceOS="ai.device.os",this.deviceOSVersion="ai.device.osVersion",this.deviceRoleInstance="ai.device.roleInstance",this.deviceRoleName="ai.device.roleName",this.deviceScreenResolution="ai.device.screenResolution",this.deviceType="ai.device.type",this.deviceMachineName="ai.device.machineName",this.deviceVMName="ai.device.vmName",this.deviceBrowser="ai.device.browser",this.deviceBrowserVersion="ai.device.browserVersion",this.locationIp="ai.location.ip",this.locationCountry="ai.location.country",this.locationProvince="ai.location.province",this.locationCity="ai.location.city",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationRootId="ai.operation.rootId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.sessionIsNew="ai.session.isNew",this.userAccountAcquisitionDate="ai.user.accountAcquisitionDate",this.userAccountId="ai.user.accountId",this.userAgent="ai.user.userAgent",this.userId="ai.user.id",this.userStoreRegion="ai.user.storeRegion",this.userAuthUserId="ai.user.authUserId",this.userAnonymousUserAcquisitionDate="ai.user.anonUserAcquisitionDate",this.userAuthenticatedUserAcquisitionDate="ai.user.authUserAcquisitionDate",this.cloudName="ai.cloud.name",this.cloudRole="ai.cloud.role",this.cloudRoleVer="ai.cloud.roleVer",this.cloudRoleInstance="ai.cloud.roleInstance",this.cloudEnvironment="ai.cloud.environment",this.cloudLocation="ai.cloud.location",this.cloudDeploymentUnit="ai.cloud.deploymentUnit",this.internalNodeName="ai.internal.nodeName",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion"},dh=(fh.create=function(t,e,i,r,n,o){if(i=Rc.sanitizeString(r,i)||Bc.NotSpecified,lu.isNullOrUndefined(t)||lu.isNullOrUndefined(e)||lu.isNullOrUndefined(i))throw Error("Input doesn't contain all required fields");var a={name:i,time:(new Date).toISOString(),iKey:"",ext:o||{},tags:[],data:{},baseType:e,baseData:t};if(!lu.isNullOrUndefined(n))for(var s in n)n.hasOwnProperty(s)&&(a.data[s]=n[s]);return a},fh);function fh(){}var mh=(gh.UserExt="user",gh.DeviceExt="device",gh.TraceExt="trace",gh.WebExt="web",gh.AppExt="app",gh.OSExt="os",gh.SessionExt="ses",gh.SDKExt="sdk",gh);function gh(){}var yh=new hh,vh="AppInsightsPropertiesPlugin",_h="AppInsightsChannelPlugin",xh=(bh.prototype.trackPageView=function(e,i){var r=this,n=e.name;!lu.isNullOrUndefined(n)&&"string"==typeof n||(e.name=window.document&&window.document.title||"");var o=e.uri;if(!lu.isNullOrUndefined(o)&&"string"==typeof o||(e.uri=window.location&&window.location.href||""),!this._pageViewPerformanceManager.isPerformanceTimingSupported())return this.appInsights.sendPageViewInternal(e,i),this._channel().forEach(function(t){t.forEach(function(t){return t.flush(!0)})}),void this._logger.throwInternal(cu.WARNING,Fu,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info.");var a=!1,s=void 0,l=this._pageViewPerformanceManager.getPerformanceTiming().navigationStart;s=Hc.GetDuration(l,+new Date),this._pageViewPerformanceManager.shouldCollectDuration(s)||(s=void 0);var t=void 0;lu.isNullOrUndefined(i)||lu.isNullOrUndefined(i.duration)||(t=i.duration),!this.overridePageViewDuration&&isNaN(t)||(isNaN(t)&&((i=i||{}).duration=s),this.appInsights.sendPageViewInternal(e,i),this._channel().forEach(function(t){t.forEach(function(t){return t.flush(!0)})}),a=!0),i=i||{};var u=setInterval(function(){try{if(r._pageViewPerformanceManager.isPerformanceTimingDataReady()){clearInterval(u);var t={name:n,uri:o};r._pageViewPerformanceManager.populatePageViewPerformanceEvent(t),t.isValid||a?(a||(i.duration=t.durationMs,r.appInsights.sendPageViewInternal(e,i)),r.pageViewPerformanceSent||(r.appInsights.sendPageViewPerformanceInternal(t,i),r.pageViewPerformanceSent=!0),r._channel().forEach(function(t){t.forEach(function(t){return t.flush(!0)})})):(i.duration=s,r.appInsights.sendPageViewInternal(e,i),r._channel().forEach(function(t){t.forEach(function(t){return t.flush(!0)})}))}else 6e4<Hc.GetDuration(l,+new Date)&&(clearInterval(u),a||(i.duration=6e4,r.appInsights.sendPageViewInternal(e,i),r._channel().forEach(function(t){t.forEach(function(t){return t.flush(!0)})})))}catch(t){r._logger.throwInternal(cu.CRITICAL,Ju,"trackPageView failed on page load calculation: "+Bc.getExceptionName(t),{exception:Bc.dump(t)})}},100)},bh);function bh(t,e,i,r){this.pageViewPerformanceSent=!1,this.overridePageViewDuration=!1,this.overridePageViewDuration=e,this.appInsights=t,this._pageViewPerformanceManager=r,i&&(this._channel=function(){return i.getTransmissionControls()},this._logger=i.logger)}var wh=(Sh.prototype.trackPreviousPageVisit=function(t,e){try{var i=this.restartPageVisitTimer(t,e);i&&this.pageVisitTimeTrackingHandler(i.pageName,i.pageUrl,i.pageVisitTime)}catch(t){this._logger.warnToConsole("Auto track page visit time failed, metric will not be collected: "+Bc.dump(t))}},Sh.prototype.restartPageVisitTimer=function(t,e){try{var i=this.stopPageVisitTimer();return this.startPageVisitTimer(t,e),i}catch(t){return this._logger.warnToConsole("Call to restart failed: "+Bc.dump(t)),null}},Sh.prototype.startPageVisitTimer=function(t,e){try{if(Bc.canUseSessionStorage()){if(null!=Bc.getSessionStorage(this._logger,this.prevPageVisitDataKeyName))throw new Error("Cannot call startPageVisit consecutively without first calling stopPageVisit");var i=new Th(t,e),r=JSON.stringify(i);Bc.setSessionStorage(this._logger,this.prevPageVisitDataKeyName,r)}}catch(t){this._logger.warnToConsole("Call to start failed: "+Bc.dump(t))}},Sh.prototype.stopPageVisitTimer=function(){try{if(Bc.canUseSessionStorage()){var t=Date.now(),e=Bc.getSessionStorage(this._logger,this.prevPageVisitDataKeyName);if(e){var i=JSON.parse(e);return i.pageVisitTime=t-i.pageVisitStartTime,Bc.removeSessionStorage(this._logger,this.prevPageVisitDataKeyName),i}return null}return null}catch(t){return this._logger.warnToConsole("Stop page visit timer failed: "+Bc.dump(t)),null}},Sh);function Sh(t,e){this.prevPageVisitDataKeyName="prevPageVisitData",this.pageVisitTimeTrackingHandler=e,this._logger=t}var Th=function(t,e){this.pageVisitStartTime=Date.now(),this.pageName=t,this.pageUrl=e},Ih=(Eh.prototype.populatePageViewPerformanceEvent=function(t){t.isValid=!1;var e=this.getPerformanceTiming();if(e){var i=Hc.GetDuration(e.navigationStart,e.loadEventEnd),r=Hc.GetDuration(e.navigationStart,e.connectEnd),n=Hc.GetDuration(e.requestStart,e.responseStart),o=Hc.GetDuration(e.responseStart,e.responseEnd),a=Hc.GetDuration(e.responseEnd,e.loadEventEnd);0==i?this._logger.throwInternal(cu.WARNING,Iu,"error calculating page view performance.",{total:i,network:r,request:n,response:o,dom:a}):this.shouldCollectDuration(i,r,n,o,a)?i<Math.floor(r)+Math.floor(n)+Math.floor(o)+Math.floor(a)?this._logger.throwInternal(cu.WARNING,Su,"client performance math error.",{total:i,network:r,request:n,response:o,dom:a}):(t.durationMs=i,t.perfTotal=t.duration=Bc.msToTimeSpan(i),t.networkConnect=Bc.msToTimeSpan(r),t.sentRequest=Bc.msToTimeSpan(n),t.receivedResponse=Bc.msToTimeSpan(o),t.domProcessing=Bc.msToTimeSpan(a),t.isValid=!0):this._logger.throwInternal(cu.WARNING,rc,"Invalid page load duration value. Browser perf data won't be sent.",{total:i,network:r,request:n,response:o,dom:a})}},Eh.prototype.getPerformanceTiming=function(){return this.isPerformanceTimingSupported()?window.performance.timing:null},Eh.prototype.isPerformanceTimingSupported=function(){return"undefined"!=typeof window&&window.performance&&window.performance.timing},Eh.prototype.isPerformanceTimingDataReady=function(){var t=window.performance.timing;return 0<t.domainLookupStart&&0<t.navigationStart&&0<t.responseStart&&0<t.requestStart&&0<t.loadEventEnd&&0<t.responseEnd&&0<t.connectEnd&&0<t.domLoading},Eh.prototype.shouldCollectDuration=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=["googlebot","adsbot-google","apis-google","mediapartners-google"],r=navigator.userAgent,n=!1;if(r)for(var o=0;o<i.length;o++)n=n||-1!==r.toLowerCase().indexOf(i[o]);if(n)return!1;for(var a=0;a<t.length;a++)if(t[a]>=this.MAX_DURATION_ALLOWED)return!1;return!0},Eh);function Eh(t){this.MAX_DURATION_ALLOWED=36e5,t&&(this._logger=t.logger)}var Ch="duration",Ah=(kh.getDefaultConfig=function(t){return(t=t||{}).sessionRenewalMs=18e5,t.sessionExpirationMs=864e5,t.disableExceptionTracking=Bc.stringToBoolOrDefault(t.disableExceptionTracking),t.autoTrackPageVisitTime=Bc.stringToBoolOrDefault(t.autoTrackPageVisitTime),t.overridePageViewDuration=Bc.stringToBoolOrDefault(t.overridePageViewDuration),(isNaN(t.samplingPercentage)||t.samplingPercentage<=0||100<=t.samplingPercentage)&&(t.samplingPercentage=100),t.isCookieUseDisabled=Bc.stringToBoolOrDefault(t.isCookieUseDisabled),t.isStorageUseDisabled=Bc.stringToBoolOrDefault(t.isStorageUseDisabled),t.isBrowserLinkTrackingEnabled=Bc.stringToBoolOrDefault(t.isBrowserLinkTrackingEnabled),t.enableAutoRouteTracking=Bc.stringToBoolOrDefault(t.enableAutoRouteTracking),t.namePrefix=t.namePrefix||"",t},kh.prototype.processTelemetry=function(t){for(var e=!1,i=this._telemetryInitializers.length,r=0;r<i;++r){var n=this._telemetryInitializers[r];if(n)try{if(!1===n.apply(null,[t])){e=!0;break}}catch(t){this._logger.throwInternal(cu.CRITICAL,_c,"One of telemetry initializers failed, telemetry item will not be sent: "+Bc.getExceptionName(t),{exception:Bc.dump(t)},!0)}}e||lu.isNullOrUndefined(this._nextPlugin)||this._nextPlugin.processTelemetry(t)},kh.prototype.setNextPlugin=function(t){this._nextPlugin=t},kh.prototype.trackEvent=function(t,e){try{var i=dh.create(t,lp.dataType,lp.envelopeType,this._logger,e);this.core.track(i)}catch(t){this._logger.throwInternal(cu.WARNING,Qu,"trackTrace failed, trace will not be collected: "+Bc.getExceptionName(t),{exception:Bc.dump(t)})}},kh.prototype.startTrackEvent=function(t){try{this._eventTracking.start(t)}catch(t){this._logger.throwInternal(cu.CRITICAL,Vu,"startTrackEvent failed, event will not be collected: "+Bc.getExceptionName(t),{exception:Bc.dump(t)})}},kh.prototype.stopTrackEvent=function(t,e,i){try{this._eventTracking.stop(t,void 0,e)}catch(t){this._logger.throwInternal(cu.CRITICAL,Gu,"stopTrackEvent failed, event will not be collected: "+Bc.getExceptionName(t),{exception:Bc.dump(t)})}},kh.prototype.trackTrace=function(t,e){try{var i=dh.create(t,Jp.dataType,Jp.envelopeType,this._logger,e);this.core.track(i)}catch(t){this._logger.throwInternal(cu.WARNING,Qu,"trackTrace failed, trace will not be collected: "+Bc.getExceptionName(t),{exception:Bc.dump(t)})}},kh.prototype.trackMetric=function(t,e){try{var i=dh.create(t,Dp.dataType,Dp.envelopeType,this._logger,e);this.core.track(i)}catch(t){this._logger.throwInternal(cu.CRITICAL,Xu,"trackMetric failed, metric will not be collected: "+Bc.getExceptionName(t),{exception:Bc.dump(t)})}},kh.prototype.trackPageView=function(t,e){try{var i=t||{};this._pageViewManager.trackPageView(i,w({},i.properties,i.measurements,e)),this.config.autoTrackPageVisitTime&&this._pageVisitTimeManager.trackPreviousPageVisit(i.name,i.uri)}catch(t){this._logger.throwInternal(cu.CRITICAL,Yu,"trackPageView failed, page view will not be collected: "+Bc.getExceptionName(t),{exception:Bc.dump(t)})}},kh.prototype.sendPageViewInternal=function(t,e,i){"undefined"!=typeof document&&(t.refUri=void 0===t.refUri?document.referrer:t.refUri);var r=dh.create(t,Fp.dataType,Fp.envelopeType,this._logger,e,i);this.core.track(r),this._trackAjaxAttempts=0},kh.prototype.sendPageViewPerformanceInternal=function(t,e,i){var r=dh.create(t,rh.dataType,rh.envelopeType,this._logger,e,i);this.core.track(r)},kh.prototype.trackPageViewPerformance=function(t,e){try{this._pageViewPerformanceManager.populatePageViewPerformanceEvent(t),this.sendPageViewPerformanceInternal(t,e)}catch(t){this._logger.throwInternal(cu.CRITICAL,Yu,"trackPageViewPerformance failed, page view will not be collected: "+Bc.getExceptionName(t),{exception:Bc.dump(t)})}},kh.prototype.startTrackPage=function(t){try{"string"!=typeof t&&(t=window.document&&window.document.title||""),this._pageTracking.start(t)}catch(t){this._logger.throwInternal(cu.CRITICAL,Zu,"startTrackPage failed, page view may not be collected: "+Bc.getExceptionName(t),{exception:Bc.dump(t)})}},kh.prototype.stopTrackPage=function(t,e,i,r){try{"string"!=typeof t&&(t=window.document&&window.document.title||""),"string"!=typeof e&&(e=window.location&&window.location.href||""),this._pageTracking.stop(t,e,i,r),this.config.autoTrackPageVisitTime&&this._pageVisitTimeManager.trackPreviousPageVisit(t,e)}catch(t){this._logger.throwInternal(cu.CRITICAL,Hu,"stopTrackPage failed, page view will not be collected: "+Bc.getExceptionName(t),{exception:Bc.dump(t)})}},kh.prototype.sendExceptionInternal=function(t,e,i){var r=new gp(this._logger,t.exception||new Error(Bc.NotSpecified),t.properties,t.measurements,t.severityLevel,t.id).toInterface(),n=dh.create(r,gp.dataType,gp.envelopeType,this._logger,e,i);this.core.track(n)},kh.prototype.trackException=function(t,e){try{this.sendExceptionInternal(t,e)}catch(t){this._logger.throwInternal(cu.CRITICAL,Ku,"trackException failed, exception will not be collected: "+Bc.getExceptionName(t),{exception:Bc.dump(t)})}},kh.prototype._onerror=function(e){try{var t={url:e&&e.url||document.URL,lineNumber:e.lineNumber,columnNumber:e.columnNumber,message:e.message};if(Bc.isCrossOriginError(e.message,e.url,e.lineNumber,e.columnNumber,e.error))this._sendCORSException(t.url);else{if(!Bc.isError(e.error)){var i="window.onerror@"+t.url+":"+e.lineNumber+":"+(e.columnNumber||0);e.error=new Error(e.message),e.error.stack=i}this.trackException({exception:e.error,severityLevel:ah.Error},t)}}catch(t){var r=e.error?e.error.name+", "+e.error.message:"null";this._logger.throwInternal(cu.CRITICAL,Eu,"_onError threw exception while logging error, error will not be collected: "+Bc.getExceptionName(t),{exception:Bc.dump(t),errorString:r})}},kh.prototype.addTelemetryInitializer=function(t){this._telemetryInitializers.push(t)},kh.prototype._initialize=function(t,e,i){var a=this;if(!this._isInitialized){if(lu.isNullOrUndefined(e))throw Error("Error initializing");this.core=e,this._logger=e.logger,this._globalconfig={instrumentationKey:t.instrumentationKey,endpointUrl:t.endpointUrl||"https://dc.services.visualstudio.com/v2/track"},this.config=t.extensionConfig&&t.extensionConfig[this.identifier]?t.extensionConfig[this.identifier]:{};var r=kh.getDefaultConfig();if(void 0!==r){for(var n in r)this.config[n]=ch.getConfig(t,n,this.identifier,r[n]);if(this._globalconfig)for(var n in r)void 0===this._globalconfig[n]&&(this._globalconfig[n]=r[n])}this.config.isCookieUseDisabled&&Bc.disableCookies(),this.config.isStorageUseDisabled&&Bc.disableStorage();var o={instrumentationKey:function(){return t.instrumentationKey},accountId:function(){return a.config.accountId||t.accountId},sessionRenewalMs:function(){return a.config.sessionRenewalMs||t.sessionRenewalMs},sessionExpirationMs:function(){return a.config.sessionExpirationMs||t.sessionExpirationMs},sampleRate:function(){return a.config.samplingPercentage||t.samplingPercentage},cookieDomain:function(){return a.config.cookieDomain||t.cookieDomain},sdkExtension:function(){return a.config.sdkExtension||t.sdkExtension},isBrowserLinkTrackingEnabled:function(){return a.config.isBrowserLinkTrackingEnabled||t.isBrowserLinkTrackingEnabled},appId:function(){return a.config.appId||t.appId}};this._pageViewPerformanceManager=new Ih(this.core),this._pageViewManager=new xh(this,this.config.overridePageViewDuration,this.core,this._pageViewPerformanceManager),this._pageVisitTimeManager=new wh(this._logger,function(t,e,i){return a.trackPageVisitTime(t,e,i)}),this._telemetryInitializers=[],this._addDefaultTelemetryInitializers(o),this._eventTracking=new Ph(this._logger,"trackEvent"),this._eventTracking.action=function(t,e,i,r){(r=r||{})[Ch]=i.toString(),a.trackEvent({name:t,properties:r})},this._pageTracking=new Ph(this._logger,"trackPageView"),this._pageTracking.action=function(t,e,i,r,n){lu.isNullOrUndefined(r)&&(r={}),r[Ch]=i.toString();var o={name:t,uri:e,properties:r,measurements:n};a.sendPageViewInternal(o)};var s,l,u=this;if(!1===this.config.disableExceptionTracking&&!this.config.autoExceptionInstrumented){var c=window.onerror;window.onerror=function(t,e,i,r,n){var o=c&&c(t,e,i,r,n);return!0!==o&&u._onerror({message:t,url:e,lineNumber:i,columnNumber:r,error:n}),o},this.config.autoExceptionInstrumented=!0}if(!0===this.config.enableAutoRouteTracking&&"object"==typeof history&&"function"==typeof history.pushState&&"function"==typeof history.replaceState&&"object"==typeof window&&"undefined"!=typeof Event){var p=this;i.forEach(function(t){t.identifier===vh&&(a._properties=t)}),history.pushState=(l=history.pushState,function(){var t=l.apply(this,arguments);return window.dispatchEvent(Bc.createDomEvent(p.config.namePrefix+"pushState")),window.dispatchEvent(Bc.createDomEvent(p.config.namePrefix+"locationchange")),t}),history.replaceState=(s=history.replaceState,function(){var t=s.apply(this,arguments);return window.dispatchEvent(Bc.createDomEvent(p.config.namePrefix+"replaceState")),window.dispatchEvent(Bc.createDomEvent(p.config.namePrefix+"locationchange")),t}),window.addEventListener(p.config.namePrefix+"popstate",function(){window.dispatchEvent(Bc.createDomEvent(p.config.namePrefix+"locationchange"))}),window.addEventListener(p.config.namePrefix+"locationchange",function(){p._properties&&p._properties.context&&p._properties.context.telemetryTrace&&(p._properties.context.telemetryTrace.traceID=Bc.generateW3CId(),p._properties.context.telemetryTrace.name=window.location&&window.location.pathname||"_unknown_"),a._currUri&&(a._prevUri=a._currUri),a._currUri=window.location&&window.location.href||"",setTimeout(function(t){p.trackPageView({refUri:t,properties:{duration:0}})}.bind(a,a._prevUri),p.autoRoutePVDelay)})}this._isInitialized=!0}},kh.prototype.trackPageVisitTime=function(t,e,i){var r={PageName:t,PageUrl:e};this.trackMetric({name:"PageVisitTime",average:i,max:i,min:i,sampleCount:1},r)},kh.prototype._addDefaultTelemetryInitializers=function(t){if(!t.isBrowserLinkTrackingEnabled()){var r=["/browserLinkSignalR/","/__browserLink/"];this._addTelemetryInitializer(function(t){if(t.baseType===Zp.dataType){var e=t.baseData;if(e)for(var i=0;i<r.length;i++)if(e.target&&0<=e.target.indexOf(r[i]))return!1}return!0})}},kh.prototype._addTelemetryInitializer=function(t){this._telemetryInitializers.push(t)},kh.prototype._sendCORSException=function(t){var e={message:"Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",url:t,lineNumber:0,columnNumber:0,error:void 0},i=dh.create(e,gp.dataType,gp.envelopeType,this._logger,{url:t});this.core.track(i)},kh.Version="2.2.2",kh);function kh(){this.identifier="ApplicationInsightsAnalytics",this.priority=180,this.autoRoutePVDelay=500,this._isInitialized=!1,this._trackAjaxAttempts=0,this._prevUri="object"==typeof window&&window.location&&window.location.href||"",this.initialize=this._initialize.bind(this)}var Ph=(Mh.prototype.start=function(t){void 0!==this._events[t]&&this._logger.throwInternal(cu.WARNING,yc,"start was called more than once for this event without calling stop.",{name:this._name,key:t},!0),this._events[t]=+new Date},Mh.prototype.stop=function(t,e,i,r){var n=this._events[t];if(isNaN(n))this._logger.throwInternal(cu.WARNING,vc,"stop was called without a corresponding start.",{name:this._name,key:t},!0);else{var o=+new Date,a=Hc.GetDuration(n,o);this.action(t,e,a,i,r)}delete this._events[t],this._events[t]=void 0},Mh);function Mh(t,e){this._name=e,this._events={},this._logger=t}var Lh=(Dh.prototype.enqueue=function(t){this._buffer.push(t)},Dh.prototype.count=function(){return this._buffer.length},Dh.prototype.clear=function(){this._buffer.length=0},Dh.prototype.getItems=function(){return this._buffer.slice(0)},Dh.prototype.batchPayloads=function(t){return t&&0<t.length?this._config.emitLineDelimitedJson()?t.join("\n"):"["+t.join(",")+"]":null},Dh.prototype.markAsSent=function(t){this.clear()},Dh.prototype.clearSent=function(t){},Dh);function Dh(t){this._config=t,this._buffer=[]}var zh=(Oh.prototype.enqueue=function(t){this._buffer.length>=Oh.MAX_BUFFER_SIZE?this._bufferFullMessageSent||(this._logger.throwInternal(cu.WARNING,bc,"Maximum buffer size reached: "+this._buffer.length,!0),this._bufferFullMessageSent=!0):(this._buffer.push(t),this.setBuffer(Oh.BUFFER_KEY,this._buffer))},Oh.prototype.count=function(){return this._buffer.length},Oh.prototype.clear=function(){this._buffer.length=0,this.setBuffer(Oh.BUFFER_KEY,[]),this.setBuffer(Oh.SENT_BUFFER_KEY,[]),this._bufferFullMessageSent=!1},Oh.prototype.getItems=function(){return this._buffer.slice(0)},Oh.prototype.batchPayloads=function(t){return t&&0<t.length?this._config.emitLineDelimitedJson()?t.join("\n"):"["+t.join(",")+"]":null},Oh.prototype.markAsSent=function(t){this._buffer=this.removePayloadsFromBuffer(t,this._buffer),this.setBuffer(Oh.BUFFER_KEY,this._buffer);var e=this.getBuffer(Oh.SENT_BUFFER_KEY);e instanceof Array&&t instanceof Array&&((e=e.concat(t)).length>Oh.MAX_BUFFER_SIZE&&(this._logger.throwInternal(cu.CRITICAL,bc,"Sent buffer reached its maximum size: "+e.length,!0),e.length=Oh.MAX_BUFFER_SIZE),this.setBuffer(Oh.SENT_BUFFER_KEY,e))},Oh.prototype.clearSent=function(t){var e=this.getBuffer(Oh.SENT_BUFFER_KEY);e=this.removePayloadsFromBuffer(t,e),this.setBuffer(Oh.SENT_BUFFER_KEY,e)},Oh.prototype.removePayloadsFromBuffer=function(t,e){var i=[];for(var r in e){var n=!1;for(var o in t)if(t[o]===e[r]){n=!0;break}n||i.push(e[r])}return i},Oh.prototype.getBuffer=function(t){var e=t;try{e=this._config.namePrefix&&this._config.namePrefix()?this._config.namePrefix()+"_"+e:e;var i=Bc.getSessionStorage(this._logger,e);if(i){var r=JSON.parse(i);if(r)return r}}catch(t){this._logger.throwInternal(cu.CRITICAL,ec," storage key: "+e+", "+Bc.getExceptionName(t),{exception:Bc.dump(t)})}return[]},Oh.prototype.setBuffer=function(t,e){var i=t;try{i=this._config.namePrefix&&this._config.namePrefix()?this._config.namePrefix()+"_"+i:i;var r=JSON.stringify(e);Bc.setSessionStorage(this._logger,i,r)}catch(t){Bc.setSessionStorage(this._logger,i,JSON.stringify([])),this._logger.throwInternal(cu.WARNING,tc," storage key: "+i+", "+Bc.getExceptionName(t)+". Buffer cleared",{exception:Bc.dump(t)})}},Oh.BUFFER_KEY="AI_buffer",Oh.SENT_BUFFER_KEY="AI_sentBuffer",Oh.MAX_BUFFER_SIZE=2e3,Oh);function Oh(t,e){this._bufferFullMessageSent=!1,this._logger=t,this._config=e;var i=this.getBuffer(Oh.BUFFER_KEY),r=this.getBuffer(Oh.SENT_BUFFER_KEY);this._buffer=i.concat(r),this._buffer.length>Oh.MAX_BUFFER_SIZE&&(this._buffer.length=Oh.MAX_BUFFER_SIZE),this.setBuffer(Oh.SENT_BUFFER_KEY,[]),this.setBuffer(Oh.BUFFER_KEY,this._buffer)}var Rh=(Nh.extractProperties=function(t){var e=null;for(var i in t)if(t.hasOwnProperty(i)){var r=t[i];"number"!=typeof r&&((e=e||{})[i]=r)}return e},Nh.extractPropsAndMeasurements=function(t,e,i){if(!lu.isNullOrUndefined(t))for(var r in t)if(t.hasOwnProperty(r)){var n=t[r];"number"==typeof n?i[r]=n:e[r]="string"==typeof n?n:JSON.stringify(n)}},Nh.createEnvelope=function(t,e,i,r){var n=new ep(t,r,e);n.iKey=i.iKey;var o=i.iKey.replace(/-/g,"");return n.name=n.name.replace("{0}",o),Nh.extractPartAExtensions(i,n),i.tags||(i.tags=[]),n},Nh.extractPartAExtensions=function(i,t){if(t.tags||(t.tags={}),i.ext||(i.ext={}),i.tags||(i.tags=[]),i.ext.user){i.ext.user.authId&&(t.tags[yh.userAuthUserId]=i.ext.user.authId);var e=i.ext.user.id||i.ext.user.localId;e&&(t.tags[yh.userId]=e)}if(i.ext.app&&i.ext.app.sesId&&(t.tags[yh.sessionId]=i.ext.app.sesId),i.ext.device&&((i.ext.device.id||i.ext.device.localId)&&(t.tags[yh.deviceId]=i.ext.device.id||i.ext.device.localId),i.ext.device.deviceClass&&(t.tags[yh.deviceType]=i.ext.device.deviceClass),i.ext.device.ip&&(t.tags[yh.deviceIp]=i.ext.device.ip)),i.ext.web){var r=i.ext.web;r.browserLang&&(t.tags[yh.deviceLanguage]=r.browserLang),r.browserVer&&(t.tags[yh.deviceBrowserVersion]=r.browserVer),r.browser&&(t.tags[yh.deviceBrowser]=r.browser),t.data=t.data||{},t.data.baseData=t.data.baseData||{},t.data.baseData.properties=t.data.baseData.properties||{},r.domain&&(t.data.baseData.properties.domain=r.domain),r.isManual&&(t.data.baseData.properties.isManual=r.isManual.toString()),r.screenRes&&(t.data.baseData.properties.screenRes=r.screenRes),r.userConsent&&(t.data.baseData.properties.userConsent=r.userConsent.toString())}i.ext.device&&i.ext.device.model&&(t.tags[yh.deviceModel]=i.ext.device.model),i.ext.os&&i.ext.os.name&&(t.tags[yh.deviceOS]=i.ext.os.name),i.ext.device&&i.ext.device.deviceType&&(t.tags[yh.deviceType]=i.ext.device.deviceType),i.ext.trace&&(i.ext.trace.parentID&&(t.tags[yh.operationParentId]=i.ext.trace.parentID),i.ext.trace.name&&(t.tags[yh.operationName]=i.ext.trace.name),i.ext.trace.traceID&&(t.tags[yh.operationId]=i.ext.trace.traceID));for(var n={},o=function(t){var e=i.tags[t];Object.keys(e).forEach(function(t){n[t]=e[t]}),i.tags.splice(t,1)},a=i.tags.length-1;0<=a;a--)o(a);for(var s in i.tags)n[s]=i.tags[s];t.tags=w({},t.tags,n),t.tags[yh.internalSdkVersion]||(t.tags[yh.internalSdkVersion]="javascript:"+Nh.Version)},Nh.Version="2.2.2",Nh);function Nh(){}var Bh,Fh=(b(Uh,Bh=Rh),Uh.prototype.Create=function(t,e){this._logger=t,lu.isNullOrUndefined(e.baseData)&&this._logger.throwInternal(cu.CRITICAL,nc,"telemetryItem.baseData cannot be null.");var i=e.baseData.measurements||{},r=e.baseData.properties||{};Rh.extractPropsAndMeasurements(e.data,r,i);var n=e.baseData;if(lu.isNullOrUndefined(n))return t.warnToConsole("Invalid input for dependency data"),null;var o=n.id,a=n.target,s=n.name,l=n.duration,u=n.success,c=n.responseCode,p=n.type,h=n.correlationContext,d=n.properties&&n.properties[Jc]?n.properties[Jc]:"GET",f=new Zp(t,o,a,s,l,u,c,d,p,h,r,i),m=new lh(Zp.dataType,f);return Rh.createEnvelope(t,Zp.envelopeType,e,m)},Uh.DependencyEnvelopeCreator=new Uh,Uh);function Uh(){return null!==Bh&&Bh.apply(this,arguments)||this}var jh,qh=(b(Vh,jh=Rh),Vh.prototype.Create=function(t,e){this._logger=t,lu.isNullOrUndefined(e.baseData)&&this._logger.throwInternal(cu.CRITICAL,nc,"telemetryItem.baseData cannot be null.");var i={},r={};e.baseType!==lp.dataType&&(i.baseTypeSource=e.baseType),e.baseType===lp.dataType?(i=e.baseData.properties||{},r=e.baseData.measurements||{}):e.baseData&&Rh.extractPropsAndMeasurements(e.baseData,i,r),Rh.extractPropsAndMeasurements(e.data,i,r);var n=e.baseData.name,o=new lp(t,n,i,r),a=new lh(lp.dataType,o);return Rh.createEnvelope(t,lp.envelopeType,e,a)},Vh.EventEnvelopeCreator=new Vh,Vh);function Vh(){return null!==jh&&jh.apply(this,arguments)||this}var Gh,Zh=(b(Hh,Gh=Rh),Hh.prototype.Create=function(t,e){this._logger=t,lu.isNullOrUndefined(e.baseData)&&this._logger.throwInternal(cu.CRITICAL,nc,"telemetryItem.baseData cannot be null.");var i=e.baseData,r=gp.CreateFromInterface(t,i),n=new lh(gp.dataType,r);return Rh.createEnvelope(t,gp.envelopeType,e,n)},Hh.ExceptionEnvelopeCreator=new Hh,Hh);function Hh(){return null!==Gh&&Gh.apply(this,arguments)||this}var Wh,Kh=(b(Xh,Wh=Rh),Xh.prototype.Create=function(t,e){this._logger=t,lu.isNullOrUndefined(e.baseData)&&this._logger.throwInternal(cu.CRITICAL,nc,"telemetryItem.baseData cannot be null.");var i=e.baseData.properties||{},r=Rh.extractProperties(e.data);r=w({},i,r);var n=e.baseData.name,o=e.baseData.average,a=e.baseData.sampleCount,s=e.baseData.min,l=e.baseData.max,u=new Dp(t,n,o,a,s,l,r),c=new lh(Dp.dataType,u);return Rh.createEnvelope(t,Dp.envelopeType,e,c)},Xh.MetricEnvelopeCreator=new Xh,Xh);function Xh(){return null!==Wh&&Wh.apply(this,arguments)||this}var Yh,Jh=(b(Qh,Yh=Rh),Qh.prototype.Create=function(t,e){this._logger=t,lu.isNullOrUndefined(e.baseData)&&this._logger.throwInternal(cu.CRITICAL,nc,"telemetryItem.baseData cannot be null.");var i=void 0;lu.isNullOrUndefined(e.baseData)||lu.isNullOrUndefined(e.baseData.properties)||lu.isNullOrUndefined(e.baseData.properties.duration)?lu.isNullOrUndefined(e.data)||lu.isNullOrUndefined(e.data.duration)||(i=e.data.duration,delete e.data.duration):(i=e.baseData.properties.duration,delete e.baseData.properties.duration);var r,n=e.baseData;e.ext&&e.ext.trace&&e.ext.trace.traceID&&(r=e.ext.trace.traceID);var o=n.id||r,a=n.name,s=n.uri,l=n.properties||{},u=n.measurements||{};if(lu.isNullOrUndefined(n.refUri)||(l.refUri=n.refUri),lu.isNullOrUndefined(n.pageType)||(l.pageType=n.pageType),lu.isNullOrUndefined(n.isLoggedIn)||(l.isLoggedIn=n.isLoggedIn.toString()),!lu.isNullOrUndefined(n.properties)){var c=n.properties;for(var p in c)c.hasOwnProperty(p)&&(l[p]=c[p])}Rh.extractPropsAndMeasurements(e.data,l,u);var h=new Fp(t,a,s,i,l,u,o),d=new lh(Fp.dataType,h);return Rh.createEnvelope(t,Fp.envelopeType,e,d)},Qh.PageViewEnvelopeCreator=new Qh,Qh);function Qh(){return null!==Yh&&Yh.apply(this,arguments)||this}var $h,td=(b(ed,$h=Rh),ed.prototype.Create=function(t,e){this._logger=t,lu.isNullOrUndefined(e.baseData)&&this._logger.throwInternal(cu.CRITICAL,nc,"telemetryItem.baseData cannot be null.");var i=e.baseData,r=i.name,n=i.uri||i.url,o=i.properties||{},a=i.measurements||{};Rh.extractPropsAndMeasurements(e.data,o,a);var s=new rh(t,r,n,void 0,o,a,i),l=new lh(rh.dataType,s);return Rh.createEnvelope(t,rh.envelopeType,e,l)},ed.PageViewPerformanceEnvelopeCreator=new ed,ed);function ed(){return null!==$h&&$h.apply(this,arguments)||this}var id,rd=(b(nd,id=Rh),nd.prototype.Create=function(t,e){this._logger=t,lu.isNullOrUndefined(e.baseData)&&this._logger.throwInternal(cu.CRITICAL,nc,"telemetryItem.baseData cannot be null.");var i=e.baseData.message,r=e.baseData.severityLevel,n=Rh.extractProperties(e.data),o=w({},n,e.baseData.properties),a=new Jp(t,i,r,o),s=new lh(Jp.dataType,a);return Rh.createEnvelope(t,Jp.envelopeType,e,s)},nd.TraceEnvelopeCreator=new nd,nd);function nd(){return null!==id&&id.apply(this,arguments)||this}var od=(ad.prototype.serialize=function(t){var e=this._serializeObject(t,"root");return JSON.stringify(e)},ad.prototype._serializeObject=function(t,e){var i="__aiCircularRefCheck",r={};if(!t)return this._logger.throwInternal(cu.CRITICAL,ac,"cannot serialize object because it is null or undefined",{name:e},!0),r;if(t[i])return this._logger.throwInternal(cu.WARNING,lc,"Circular reference detected while serializing object",{name:e},!0),r;if(!t.aiDataContract){if("measurements"===e)r=this._serializeStringMap(t,"number",e);else if("properties"===e)r=this._serializeStringMap(t,"string",e);else if("tags"===e)r=this._serializeStringMap(t,"string",e);else if(Bc.isArray(t))r=this._serializeArray(t,e);else{this._logger.throwInternal(cu.WARNING,sc,"Attempting to serialize an object which does not implement ISerializable",{name:e},!0);try{JSON.stringify(t),r=t}catch(t){this._logger.throwInternal(cu.CRITICAL,ac,t&&"function"==typeof t.toString?t.toString():"Error serializing object",null,!0)}}return r}for(var n in t[i]=!0,t.aiDataContract){var o,a=t.aiDataContract[n],s="function"==typeof a?a()&tu.Required:a&tu.Required,l="function"==typeof a?a()&tu.Hidden:a&tu.Hidden,u=a&tu.Array,c=void 0!==t[n],p="object"==typeof t[n]&&null!==t[n];!s||c||u?l||void 0!==(o=p?u?this._serializeArray(t[n],n):this._serializeObject(t[n],n):t[n])&&(r[n]=o):this._logger.throwInternal(cu.CRITICAL,Bu,"Missing required field specification. The field is required but not present on source",{field:n,name:e})}return delete t[i],r},ad.prototype._serializeArray=function(t,e){var i=void 0;if(t)if(Bc.isArray(t)){i=[];for(var r=0;r<t.length;r++){var n=t[r],o=this._serializeObject(n,e+"["+r+"]");i.push(o)}}else this._logger.throwInternal(cu.CRITICAL,cc,"This field was specified as an array in the contract but the item is not an array.\r\n",{name:e},!0);return i},ad.prototype._serializeStringMap=function(t,e,i){var r=void 0;if(t)for(var n in r={},t){var o=t[n];if("string"===e)void 0===o?r[n]="undefined":null===o?r[n]="null":o.toString?r[n]=o.toString():r[n]="invalid field: toString() is not defined.";else if("number"===e)if(void 0===o)r[n]="undefined";else if(null===o)r[n]="null";else{var a=parseFloat(o);isNaN(a)?r[n]="NaN":r[n]=a}else r[n]="invalid field: "+i+" is of unknown type.",this._logger.throwInternal(cu.CRITICAL,r[n],null,!0)}return r},ad);function ad(t){this._logger=t}function sd(){this._onlineStatus=!0;try{"undefined"==typeof window?this.isListening=!1:window&&window.addEventListener?(window.addEventListener("online",this._setOnline.bind(this),!1),window.addEventListener("offline",this._setOffline.bind(this),!1),this.isListening=!0):document&&document.body?(document.body.ononline=this._setOnline.bind(this),document.body.onoffline=this._setOffline.bind(this),this.isListening=!0):document?(document.ononline=this._setOnline.bind(this),document.onoffline=this._setOffline.bind(this),this.isListening=!0):this.isListening=!1}catch(t){this.isListening=!1}}var ld=(sd.prototype._setOnline=function(){this._onlineStatus=!0},sd.prototype._setOffline=function(){this._onlineStatus=!1},sd.prototype.isOnline=function(){return this.isListening?this._onlineStatus:!(navigator&&!lu.isNullOrUndefined(navigator.onLine))||navigator.onLine},sd.prototype.isOffline=function(){return!this.isOnline()},sd.Offline=new sd,sd).Offline,ud=(cd.prototype.getHashCodeScore=function(t){return this.getHashCode(t)/cd.INT_MAX_VALUE*100},cd.prototype.getHashCode=function(t){if(""==t)return 0;for(;t.length<cd.MIN_INPUT_LENGTH;)t=t.concat(t);for(var e=5381,i=0;i<t.length;++i)e=(e<<5)+e+t.charCodeAt(i),e&=e;return Math.abs(e)},cd.INT_MAX_VALUE=2147483647,cd.MIN_INPUT_LENGTH=8,cd);function cd(){}var pd=(hd.prototype.getSamplingScore=function(t){return t.tags&&t.tags[this.keys.userId]?this.hashCodeGeneragor.getHashCodeScore(t.tags[this.keys.userId]):t.ext&&t.ext.user&&t.ext.user.id?this.hashCodeGeneragor.getHashCodeScore(t.ext.user.id):t.tags&&t.tags[this.keys.operationId]?this.hashCodeGeneragor.getHashCodeScore(t.tags[this.keys.operationId]):t.ext&&t.ext.telemetryTrace&&t.ext.telemetryTrace.traceID?this.hashCodeGeneragor.getHashCodeScore(t.ext.telemetryTrace.traceID):100*Math.random()},hd);function hd(){this.hashCodeGeneragor=new ud,this.keys=new hh}var dd=(fd.prototype.isSampledIn=function(t){var e=this.sampleRate;return null==e||100<=e||t.baseType===Dp.dataType||this.samplingScoreGenerator.getSamplingScore(t)<e},fd);function fd(t,e){this.INT_MAX_VALUE=2147483647,lu.isNullOrUndefined(e)?this._logger=new Ac:this._logger=e,(100<t||t<0)&&(this._logger.throwInternal(cu.WARNING,fc,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:t},!0),this.sampleRate=100),this.sampleRate=t,this.samplingScoreGenerator=new pd}var md=(gd.prototype.pause=function(){throw new Error("Method not implemented.")},gd.prototype.resume=function(){throw new Error("Method not implemented.")},gd.prototype.flush=function(){try{this.triggerSend()}catch(t){this._logger.throwInternal(cu.CRITICAL,Ru,"flush failed, telemetry will not be collected: "+Bc.getExceptionName(t),{exception:Bc.dump(t)})}},gd.prototype.onunloadFlush=function(){if(!1!==this._config.onunloadDisableBeacon()&&!1!==this._config.isBeaconApiDisabled()||!Bc.IsBeaconApiSupported())this.flush();else try{this.triggerSend(!0,this._beaconSender)}catch(t){this._logger.throwInternal(cu.CRITICAL,Ou,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+Bc.getExceptionName(t),{exception:Bc.dump(t)})}},gd.prototype.teardown=function(){throw new Error("Method not implemented.")},gd.prototype.initialize=function(e,t,i){var r=this;this._logger=t.logger,this._serializer=new od(t.logger),this._consecutiveErrors=0,this._retryAt=null,this._lastSend=0,this._sender=null;var n=gd._getDefaultAppInsightsChannelConfig();function o(t){a._config[t]=function(){return ch.getConfig(e,t,r.identifier,n[t]())}}this._config=gd._getEmptyAppInsightsChannelConfig();var a=this;for(var s in n)o(s);this._buffer=this._config.enableSessionStorageBuffer&&Bc.canUseSessionStorage()?new zh(this._logger,this._config):new Lh(this._config),this._sample=new dd(this._config.samplingPercentage(),this._logger),!this._config.isBeaconApiDisabled()&&Bc.IsBeaconApiSupported()?this._sender=this._beaconSender:"undefined"!=typeof XMLHttpRequest&&("withCredentials"in new XMLHttpRequest?(this._sender=this._xhrSender,this._XMLHttpRequestSupported=!0):"undefined"!=typeof XDomainRequest&&(this._sender=this._xdrSender))},gd.prototype.processTelemetry=function(t){var e=this;try{if(this._config.disableTelemetry())return;if(!t)return void this._logger.throwInternal(cu.CRITICAL,wu,"Cannot send empty telemetry");if(t.baseData&&!t.baseType)return void this._logger.throwInternal(cu.CRITICAL,Tc,"Cannot send telemetry without baseData and baseType");if(t.baseType||(t.baseType="EventData"),!this._sender)return void this._logger.throwInternal(cu.CRITICAL,qu,"Sender was not initialized");if(!this._isSampledIn(t))return void this._logger.throwInternal(cu.WARNING,Wu,"Telemetry item was sampled out and not sent",{SampleRate:this._sample.sampleRate});t.tags=t.tags||{},t.tags.sampleRate=this._sample.sampleRate;var i=gd.constructEnvelope(t,this._config.instrumentationKey(),this._logger);if(!i)return void this._logger.throwInternal(cu.CRITICAL,oc,"Unable to create an AppInsights envelope");var r=!1;if(t.tags&&t.tags[Yc]&&(t.tags[Yc].forEach(function(t){try{t&&!1===t(i)&&(r=!0,e._logger.warnToConsole("Telemetry processor check returns false"))}catch(t){e._logger.throwInternal(cu.CRITICAL,_c,"One of telemetry initializers failed, telemetry item will not be sent: "+Bc.getExceptionName(t),{exception:Bc.dump(t)},!0)}}),delete t.tags[Yc]),r)return;var n=this._serializer.serialize(i),o=this._buffer.getItems(),a=this._buffer.batchPayloads(o);a&&a.length+n.length>this._config.maxBatchSizeInBytes()&&this.triggerSend(),this._buffer.enqueue(n),this._setupTimer()}catch(t){this._logger.throwInternal(cu.WARNING,Cu,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+Bc.getExceptionName(t),{exception:Bc.dump(t)})}lu.isNullOrUndefined(this._nextPlugin)||this._nextPlugin.processTelemetry(t)},gd.prototype.setNextPlugin=function(t){this._nextPlugin=t},gd.prototype._xhrReadyStateChange=function(t,e,i){if(4===t.readyState){var r=null;this._appId||(r=this._parseResponse(t.responseText||t.response))&&r.appId&&(this._appId=r.appId),(t.status<200||300<=t.status)&&0!==t.status?!this._config.isRetryDisabled()&&this._isRetriable(t.status)?(this._resendPayload(e),this._logger.throwInternal(cu.WARNING,$u,". Response code "+t.status+". Will retry to send "+e.length+" items.")):this._onError(e,this._formatErrorMessageXhr(t)):ld.isOffline()?this._config.isRetryDisabled()||(this._resendPayload(e,10),this._logger.throwInternal(cu.WARNING,$u,". Offline - Response Code: "+t.status+". Offline status: "+ld.isOffline()+". Will retry to send "+e.length+" items.")):206===t.status?(r=r||this._parseResponse(t.responseText||t.response))&&!this._config.isRetryDisabled()?this._onPartialSuccess(e,r):this._onError(e,this._formatErrorMessageXhr(t)):(this._consecutiveErrors=0,this._onSuccess(e,i))}},gd.prototype.triggerSend=function(t,e){void 0===t&&(t=!0);try{if(this._config.disableTelemetry())this._buffer.clear();else{if(0<this._buffer.count()){var i=this._buffer.getItems();e?e.call(this,i,t):this._sender(i,t)}this._lastSend=+new Date}clearTimeout(this._timeoutHandle),this._timeoutHandle=null,this._retryAt=null}catch(t){(!Bc.getIEVersion()||9<Bc.getIEVersion())&&this._logger.throwInternal(cu.CRITICAL,$u,"Telemetry transmission failed, some telemetry will be lost: "+Bc.getExceptionName(t),{exception:Bc.dump(t)})}},gd.prototype._onError=function(t,e,i){this._logger.throwInternal(cu.WARNING,Uu,"Failed to send telemetry.",{message:e}),this._buffer.clearSent(t)},gd.prototype._onPartialSuccess=function(t,e){for(var i=[],r=[],n=0,o=e.errors.reverse();n<o.length;n++){var a=o[n],s=t.splice(a.index,1)[0];this._isRetriable(a.statusCode)?r.push(s):i.push(s)}0<t.length&&this._onSuccess(t,e.itemsAccepted),0<i.length&&this._onError(i,this._formatErrorMessageXhr(null,["partial success",e.itemsAccepted,"of",e.itemsReceived].join(" "))),0<r.length&&(this._resendPayload(r),this._logger.throwInternal(cu.WARNING,$u,"Partial success. Delivered: "+t.length+", Failed: "+i.length+". Will retry to send "+r.length+" our of "+e.itemsReceived+" items"))},gd.prototype._onSuccess=function(t,e){this._buffer.clearSent(t)},gd.prototype._xdrOnLoad=function(t,e){if(!t||t.responseText+""!="200"&&""!==t.responseText){var i=this._parseResponse(t.responseText);i&&i.itemsReceived&&i.itemsReceived>i.itemsAccepted&&!this._config.isRetryDisabled()?this._onPartialSuccess(e,i):this._onError(e,this._formatErrorMessageXdr(t))}else this._consecutiveErrors=0,this._onSuccess(e,0)},gd.constructEnvelope=function(t,e,i){var r;switch((r=e===t.iKey||lu.isNullOrUndefined(e)?t:w({},t,{iKey:e})).baseType){case lp.dataType:return qh.EventEnvelopeCreator.Create(i,r);case Jp.dataType:return rd.TraceEnvelopeCreator.Create(i,r);case Fp.dataType:return Jh.PageViewEnvelopeCreator.Create(i,r);case rh.dataType:return td.PageViewPerformanceEnvelopeCreator.Create(i,r);case gp.dataType:return Zh.ExceptionEnvelopeCreator.Create(i,r);case Dp.dataType:return Kh.MetricEnvelopeCreator.Create(i,r);case Zp.dataType:return Fh.DependencyEnvelopeCreator.Create(i,r);default:return qh.EventEnvelopeCreator.Create(i,r)}},gd._getDefaultAppInsightsChannelConfig=function(){return{endpointUrl:function(){return"https://dc.services.visualstudio.com/v2/track"},emitLineDelimitedJson:function(){return!1},maxBatchInterval:function(){return 15e3},maxBatchSizeInBytes:function(){return 102400},disableTelemetry:function(){return!1},enableSessionStorageBuffer:function(){return!0},isRetryDisabled:function(){return!1},isBeaconApiDisabled:function(){return!0},onunloadDisableBeacon:function(){return!1},instrumentationKey:function(){},namePrefix:function(){},samplingPercentage:function(){return 100}}},gd._getEmptyAppInsightsChannelConfig=function(){return{endpointUrl:void 0,emitLineDelimitedJson:void 0,maxBatchInterval:void 0,maxBatchSizeInBytes:void 0,disableTelemetry:void 0,enableSessionStorageBuffer:void 0,isRetryDisabled:void 0,isBeaconApiDisabled:void 0,onunloadDisableBeacon:void 0,instrumentationKey:void 0,namePrefix:void 0,samplingPercentage:void 0}},gd.prototype._isSampledIn=function(t){return this._sample.isSampledIn(t)},gd.prototype._beaconSender=function(t,e){var i=this._config.endpointUrl(),r=this._buffer.batchPayloads(t),n=new Blob([r],{type:"text/plain;charset=UTF-8"});navigator.sendBeacon(i,n)?(this._buffer.markAsSent(t),this._onSuccess(t,t.length)):(this._xhrSender(t,!0),this._logger.throwInternal(cu.WARNING,$u,". Failed to send telemetry with Beacon API, retried with xhrSender."))},gd.prototype._xhrSender=function(e,t){var i=this,r=new XMLHttpRequest;r[Xc]=!0,r.open("POST",this._config.endpointUrl(),t),r.setRequestHeader("Content-type","application/json"),Bc.isInternalApplicationInsightsEndpoint(this._config.endpointUrl())&&r.setRequestHeader(zc.sdkContextHeader,zc.sdkContextHeaderAppIdRequest),r.onreadystatechange=function(){return i._xhrReadyStateChange(r,e,e.length)},r.onerror=function(t){return i._onError(e,i._formatErrorMessageXhr(r),t)};var n=this._buffer.batchPayloads(e);r.send(n),this._buffer.markAsSent(e)},gd.prototype._parseResponse=function(e){try{if(e&&""!==e){var t=JSON.parse(e);if(t&&t.itemsReceived&&t.itemsReceived>=t.itemsAccepted&&t.itemsReceived-t.itemsAccepted==t.errors.length)return t}}catch(t){this._logger.throwInternal(cu.CRITICAL,ic,"Cannot parse the response. "+Bc.getExceptionName(t),{response:e})}return null},gd.prototype._resendPayload=function(t,e){if(void 0===e&&(e=1),t&&0!==t.length){this._buffer.clearSent(t),this._consecutiveErrors++;for(var i=0,r=t;i<r.length;i++){var n=r[i];this._buffer.enqueue(n)}this._setRetryTime(e),this._setupTimer()}},gd.prototype._setRetryTime=function(t){var e;if(this._consecutiveErrors<=1)e=10;else{var i=(Math.pow(2,this._consecutiveErrors)-1)/2,r=Math.floor(Math.random()*i*10)+1;r*=t,e=Math.max(Math.min(r,3600),10)}var n=Date.now()+1e3*e;this._retryAt=n},gd.prototype._setupTimer=function(){var t=this;if(!this._timeoutHandle){var e=this._retryAt?Math.max(0,this._retryAt-Date.now()):0,i=Math.max(this._config.maxBatchInterval(),e);this._timeoutHandle=setTimeout(function(){t.triggerSend()},i)}},gd.prototype._isRetriable=function(t){return 408==t||429==t||500==t||503==t},gd.prototype._formatErrorMessageXhr=function(t,e){return t?"XMLHttpRequest,Status:"+t.status+",Response:"+t.responseText||t.response||"":e},gd.prototype._xdrSender=function(e,t){var i=this,r=new XDomainRequest;r.onload=function(){return i._xdrOnLoad(r,e)},r.onerror=function(t){return i._onError(e,i._formatErrorMessageXdr(r),t)};var n=window.location&&window.location.protocol;if(0!==this._config.endpointUrl().lastIndexOf(n,0))return this._logger.throwInternal(cu.WARNING,$u,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),void this._buffer.clear();var o=this._config.endpointUrl().replace(/^(https?:)/,"");r.open("POST",o);var a=this._buffer.batchPayloads(e);r.send(a),this._buffer.markAsSent(e)},gd.prototype._formatErrorMessageXdr=function(t,e){return t?"XDomainRequest,Response:"+t.responseText||"":e},gd);function gd(){this.priority=1001,this.identifier=_h,this._XMLHttpRequestSupported=!1}var yd=function(){},vd=(_d.prototype.update=function(){this.automaticSession.id||this.initializeAutomaticSession();var t=Hc.Now(),e=t-this.automaticSession.acquisitionDate>this.config.sessionExpirationMs(),i=t-this.automaticSession.renewalDate>this.config.sessionRenewalMs();e||i?this.renew():(!this.cookieUpdatedTimestamp||t-this.cookieUpdatedTimestamp>_d.cookieUpdateInterval)&&(this.automaticSession.renewalDate=t,this.setCookie(this.automaticSession.id,this.automaticSession.acquisitionDate,this.automaticSession.renewalDate))},_d.prototype.backup=function(){this.setStorage(this.automaticSession.id,this.automaticSession.acquisitionDate,this.automaticSession.renewalDate)},_d.prototype.initializeAutomaticSession=function(){var t=Bc.getCookie(this._logger,this._storageNamePrefix());if(t&&"function"==typeof t.split)this.initializeAutomaticSessionWithData(t);else{var e=Bc.getStorage(this._logger,this._storageNamePrefix());e&&this.initializeAutomaticSessionWithData(e)}this.automaticSession.id||this.renew()},_d.prototype.initializeAutomaticSessionWithData=function(t){var e=t.split("|");0<e.length&&(this.automaticSession.id=e[0]);try{if(1<e.length){var i=+e[1];this.automaticSession.acquisitionDate=+new Date(i),this.automaticSession.acquisitionDate=0<this.automaticSession.acquisitionDate?this.automaticSession.acquisitionDate:0}if(2<e.length){var r=+e[2];this.automaticSession.renewalDate=+new Date(r),this.automaticSession.renewalDate=0<this.automaticSession.renewalDate?this.automaticSession.renewalDate:0}}catch(t){this._logger.throwInternal(cu.CRITICAL,Tu,"Error parsing ai_session cookie, session will be reset: "+Bc.getExceptionName(t),{exception:Bc.dump(t)})}0==this.automaticSession.renewalDate&&this._logger.throwInternal(cu.WARNING,ju,"AI session renewal date is 0, session will be reset.")},_d.prototype.renew=function(){var t=Hc.Now();this.automaticSession.id=Bc.newId(),this.automaticSession.acquisitionDate=t,this.automaticSession.renewalDate=t,this.setCookie(this.automaticSession.id,this.automaticSession.acquisitionDate,this.automaticSession.renewalDate),Bc.canUseLocalStorage()||this._logger.throwInternal(cu.WARNING,mu,"Browser does not support local storage. Session durations will be inaccurate.")},_d.prototype.setCookie=function(t,e,i){var r=e+this.config.sessionExpirationMs(),n=i+this.config.sessionRenewalMs(),o=new Date,a=[t,e,i];r<n?o.setTime(r):o.setTime(n);var s=this.config.cookieDomain?this.config.cookieDomain():null;Bc.setCookie(this._logger,this._storageNamePrefix(),a.join("|")+";expires="+o.toUTCString(),s),this.cookieUpdatedTimestamp=Hc.Now()},_d.prototype.setStorage=function(t,e,i){Bc.setStorage(this._logger,this._storageNamePrefix(),[t,e,i].join("|"))},_d.acquisitionSpan=864e5,_d.renewalSpan=18e5,_d.cookieUpdateInterval=6e4,_d.cookieNameConst="ai_session",_d);function _d(t,e){var i=this;lu.isNullOrUndefined(e)?this._logger=new Ac:this._logger=e,"function"!=typeof(t=t||{}).sessionExpirationMs&&(t.sessionExpirationMs=function(){return _d.acquisitionSpan}),"function"!=typeof t.sessionRenewalMs&&(t.sessionRenewalMs=function(){return _d.renewalSpan}),this.config=t,this._storageNamePrefix=function(){return i.config.namePrefix&&i.config.namePrefix()?_d.cookieNameConst+i.config.namePrefix():_d.cookieNameConst},this.automaticSession=new yd}var xd=function(){},bd=function(){this.id="browser",this.deviceClass="Browser"},wd=function(t){this.sdkVersion=(t.sdkExtension&&t.sdkExtension()?t.sdkExtension()+"_":"")+"javascript:2.2.2"},Sd=(Td.prototype.setAuthenticatedUserContext=function(t,e,i){if(void 0===i&&(i=!1),!this.validateUserInput(t)||e&&!this.validateUserInput(e))this._logger.throwInternal(cu.WARNING,mc,"Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.",!0);else{this.authenticatedId=t;var r=this.authenticatedId;e&&(this.accountId=e,r=[this.authenticatedId,this.accountId].join(Td.cookieSeparator)),i&&Bc.setCookie(this._logger,Td.authUserCookieName,encodeURI(r),this.config.cookieDomain())}},Td.prototype.clearAuthenticatedUserContext=function(){this.authenticatedId=null,this.accountId=null,Bc.deleteCookie(this._logger,Td.authUserCookieName)},Td.prototype.validateUserInput=function(t){return!("string"!=typeof t||!t||t.match(/,|;|=| |\|/))},Td.cookieSeparator="|",Td.userCookieName="ai_user",Td.authUserCookieName="ai_authUser",Td);function Td(t,e){this._logger=e;var i=Bc.getCookie(this._logger,Td.userCookieName);if(i){var r=i.split(Td.cookieSeparator);0<r.length&&(this.id=r[0])}if(this.config=t,!this.id){this.id=Bc.newId();var n=new Date,o=Bc.toISOStringForIE8(n);this.accountAcquisitionDate=o,n.setTime(n.getTime()+31536e6);var a=[this.id,o],s=this.config.cookieDomain?this.config.cookieDomain():void 0;Bc.setCookie(this._logger,Td.userCookieName,a.join(Td.cookieSeparator)+";expires="+n.toUTCString(),s);var l=t.namePrefix&&t.namePrefix()?t.namePrefix()+"ai_session":"ai_session";Bc.removeStorage(this._logger,l)}this.accountId=t.accountId?t.accountId():void 0;var u=Bc.getCookie(this._logger,Td.authUserCookieName);if(u){var c=(u=decodeURI(u)).split(Td.cookieSeparator);c[0]&&(this.authenticatedId=c[0]),1<c.length&&c[1]&&(this.accountId=c[1])}}var Id=function(){},Ed=function(t,e,i){this.traceID=t||Bc.generateW3CId(),this.parentID=e,this.name=i,window&&window.location&&window.location.pathname&&(this.name=window.location.pathname)},Cd=(Ad.prototype.applySessionContext=function(t){var e=this.session||this.sessionManager.automaticSession;e&&"string"==typeof e.id&&(t.ext.app.sesId=e.id),this.session&&("string"==typeof this.session.id?t.ext.app.sesId=this.session.id:t.ext.app.sesId=this.sessionManager.automaticSession.id)},Ad.prototype.applyOperatingSystemContxt=function(t){this.os&&this.os.name&&(t.ext.os=this.os)},Ad.prototype.applyApplicationContext=function(t){this.application&&("string"==typeof this.application.ver&&(t.tags[yh.applicationVersion]=this.application.ver),"string"==typeof this.application.build&&(t.tags[yh.applicationBuild]=this.application.build))},Ad.prototype.applyDeviceContext=function(t){this.device&&("string"==typeof this.device.id&&(t.ext.device.localId=this.device.id),"string"==typeof this.device.ip&&(t.ext.device.ip=this.device.ip),"string"==typeof this.device.model&&(t.ext.device.model=this.device.model),"string"==typeof this.device.deviceClass&&(t.ext.device.deviceClass=this.device.deviceClass))},Ad.prototype.applyInternalContext=function(t){this.internal&&("string"==typeof this.internal.agentVersion&&(t.tags[yh.internalAgentVersion]=this.internal.agentVersion),"string"==typeof this.internal.sdkVersion&&(t.tags[yh.internalSdkVersion]=this.internal.sdkVersion))},Ad.prototype.applyLocationContext=function(t){this.location&&"string"==typeof this.location.ip&&(t.tags[yh.locationIp]=this.location.ip)},Ad.prototype.applyOperationContext=function(t){if(this.telemetryTrace){var e=t.ext.trace||{traceID:void 0,parentID:void 0};"string"==typeof this.telemetryTrace.traceID&&(e.traceID=this.telemetryTrace.traceID),"string"==typeof this.telemetryTrace.name&&(e.name=this.telemetryTrace.name),"string"==typeof this.telemetryTrace.parentID&&(e.parentID=this.telemetryTrace.parentID),t.ext.trace=e}},Ad.prototype.applyWebContext=function(t){this.web&&(t.ext.web=t.ext.web||{},t.ext.web=this.web)},Ad.prototype.applyUserContext=function(t){this.user&&(t.tags||(t.tags=[]),"string"==typeof this.user.accountId&&(t.tags[yh.userAccountId]=this.user.accountId),"string"==typeof this.user.id&&(t.ext.user.id=this.user.id),"string"==typeof this.user.authenticatedId&&(t.ext.user.authId=this.user.authenticatedId))},Ad.prototype.cleanUp=function(t){t.ext[mh.DeviceExt]&&0===Object.keys(t.ext[mh.DeviceExt]).length&&delete t.ext[mh.DeviceExt],t.ext[mh.UserExt]&&0===Object.keys(t.ext[mh.UserExt]).length&&delete t.ext[mh.UserExt],t.ext[mh.WebExt]&&0===Object.keys(t.ext[mh.WebExt]).length&&delete t.ext[mh.WebExt],t.ext[mh.OSExt]&&0===Object.keys(t.ext[mh.OSExt]).length&&delete t.ext[mh.OSExt],t.ext[mh.AppExt]&&0===Object.keys(t.ext[mh.AppExt]).length&&delete t.ext[mh.AppExt],t.ext[mh.TraceExt]&&0===Object.keys(t.ext[mh.TraceExt]).length&&delete t.ext[mh.TraceExt]},Ad);function Ad(t,e){"undefined"!=typeof window&&(this.sessionManager=new vd(e,t),this.application=new xd,this.device=new bd,this.internal=new wd(e),this.location=new Id,this.user=new Sd(e,t),this.telemetryTrace=new Ed,this.session=new yd),this.appId=function(){return null}}var kd=(Pd.getDefaultConfig=function(){return{instrumentationKey:function(){},accountId:function(){return null},sessionRenewalMs:function(){return 18e5},samplingPercentage:function(){return 100},sessionExpirationMs:function(){return 864e5},cookieDomain:function(){return null},sdkExtension:function(){return null},isBrowserLinkTrackingEnabled:function(){return!1},appId:function(){return null},namePrefix:function(){}}},Pd.prototype.initialize=function(e,t,i){var r=this,n=Pd.getDefaultConfig();function o(t){a._extensionConfig[t]=function(){return ch.getConfig(e,t,r.identifier,n[t]())}}this._extensionConfig=this._extensionConfig||Pd.getDefaultConfig();var a=this;for(var s in n)o(s);this._logger=t.logger,this.context=new Cd(t.logger,this._extensionConfig),this._breezeChannel=Bc.getExtension(i,_h),this.context.appId=function(){return r._breezeChannel?r._breezeChannel._appId:null}},Pd.prototype.processTelemetry=function(t){lu.isNullOrUndefined(t)||(t.name===Fp.envelopeType&&this._logger.resetInternalMessageCount(),this.context.session&&"string"!=typeof this.context.session.id&&this.context.sessionManager.update(),this._processTelemetryInternal(t),lu.isNullOrUndefined(this._nextPlugin)||this._nextPlugin.processTelemetry(t))},Pd.prototype.setNextPlugin=function(t){this._nextPlugin=t},Pd.prototype._processTelemetryInternal=function(t){t.tags||(t.tags=[]),t.ext||(t.ext={}),t.ext[mh.DeviceExt]=t.ext[mh.DeviceExt]||{},t.ext[mh.WebExt]=t.ext[mh.WebExt]||{},t.ext[mh.UserExt]=t.ext[mh.UserExt]||{},t.ext[mh.OSExt]=t.ext[mh.OSExt]||{},t.ext[mh.AppExt]=t.ext[mh.AppExt]||{},t.ext[mh.TraceExt]=t.ext[mh.TraceExt]||{},this.context.applySessionContext(t),this.context.applyApplicationContext(t),this.context.applyDeviceContext(t),this.context.applyOperationContext(t),this.context.applyUserContext(t),this.context.applyOperatingSystemContxt(t),this.context.applyWebContext(t),this.context.applyLocationContext(t),this.context.applyInternalContext(t),this.context.cleanUp(t)},Pd);function Pd(){this.priority=110,this.identifier=vh}var Md=function(){this.openDone=!1,this.setRequestHeaderDone=!1,this.sendDone=!1,this.abortDone=!1,this.onreadystatechangeCallbackAttached=!1},Ld=(Dd.prototype.getAbsoluteUrl=function(){return this.requestUrl?Uc.getAbsoluteUrl(this.requestUrl):null},Dd.prototype.getPathName=function(){return this.requestUrl?Rc.sanitizeUrl(this._logger,Uc.getCompleteUrl(this.method,this.requestUrl)):null},Dd);function Dd(t,e,i){this.completed=!1,this.requestHeadersSize=null,this.requestHeaders=null,this.ttfb=null,this.responseReceivingDuration=null,this.callbackDuration=null,this.ajaxTotalDuration=null,this.aborted=null,this.pageUrl=null,this.requestUrl=null,this.requestSize=0,this.method=null,this.status=null,this.requestSentTime=null,this.responseStartedTime=null,this.responseFinishedTime=null,this.callbackFinishedTime=null,this.endTime=null,this.originalOnreadystatechage=null,this.xhrMonitoringState=new Md,this.clientFailure=0,this.CalculateMetrics=function(){this.ajaxTotalDuration=Math.round(1e3*Hc.GetDuration(this.requestSentTime,this.responseFinishedTime))/1e3},this.traceID=t,this.spanID=e,this._logger=i}var zd=(Od.AttachEvent=function(t,e,i){var r=!1;return lu.isNullOrUndefined(t)||(lu.isNullOrUndefined(t.attachEvent)?lu.isNullOrUndefined(t.addEventListener)||(t.addEventListener(e,i,!1),r=!0):(t.attachEvent("on"+e,i),r=!0)),r},Od.DetachEvent=function(t,e,i){lu.isNullOrUndefined(t)||(lu.isNullOrUndefined(t.detachEvent)?lu.isNullOrUndefined(t.removeEventListener)||t.removeEventListener(e,i,!1):t.detachEvent("on"+e,i))},Od);function Od(){}var Rd=(Nd.isValidTraceId=function(t){return t.match(/^[0-9a-f]{32}$/)&&"00000000000000000000000000000000"!==t},Nd.isValidSpanId=function(t){return t.match(/^[0-9a-f]{16}$/)&&"0000000000000000"!==t},Nd.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},Nd.DEFAULT_TRACE_FLAG="00",Nd.DEFAULT_VERSION="00",Nd);function Nd(t,e){this.traceFlag=Nd.DEFAULT_TRACE_FLAG,this.version=Nd.DEFAULT_VERSION,t&&Nd.isValidTraceId(t)?this.traceId=t:this.traceId=Bc.generateW3CId(),e&&Nd.isValidSpanId(e)?this.spanId=e:this.spanId=Bc.generateW3CId().substr(0,16)}var Bd=(Fd.prototype.isMonitoredInstance=function(t,e,i,r){var n=!1,o=!0,a=!1;return void 0!==i?(a=this._fetchInitialized,n="object"==typeof i&&!0===i[Xc]||!!r&&!0===r[Xc]):void 0!==t&&(a=this.initialized,n=!0===t[Xc],o=!0===e||!lu.isNullOrUndefined(t.ajaxData)),a&&o&&!n},Fd.prototype.supportsAjaxMonitoring=function(){var e=!0;(lu.isNullOrUndefined(XMLHttpRequest)||lu.isNullOrUndefined(XMLHttpRequest.prototype)||lu.isNullOrUndefined(XMLHttpRequest.prototype.open)||lu.isNullOrUndefined(XMLHttpRequest.prototype.send)||lu.isNullOrUndefined(XMLHttpRequest.prototype.abort))&&(e=!1);try{" a ".trim()}catch(t){e=!1}return e},Fd.prototype.instrumentOpen=function(){var r=XMLHttpRequest.prototype.open,n=this;XMLHttpRequest.prototype.open=function(t,e,i){try{!n.isMonitoredInstance(this,!0)||this.ajaxData&&this.ajaxData.xhrMonitoringState.openDone||n.openHandler(this,t,e,i)}catch(t){n._core.logger.throwInternal(cu.CRITICAL,Pu,"Failed to monitor XMLHttpRequest.open, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:Fd.getFailedAjaxDiagnosticsMessage(this),exception:Bc.dump(t)})}return r.apply(this,arguments)}},Fd.prototype.openHandler=function(t,e,i,r){var n=this._context&&this._context.telemetryTrace&&this._context.telemetryTrace.traceID||Bc.generateW3CId(),o=Bc.generateW3CId().substr(0,16),a=new Ld(n,o,this._core.logger);a.method=e,a.requestUrl=i,a.xhrMonitoringState.openDone=!0,a.requestHeaders={},t.ajaxData=a,this.attachToOnReadyStateChange(t)},Fd.getFailedAjaxDiagnosticsMessage=function(t){var e="";try{lu.isNullOrUndefined(t)||lu.isNullOrUndefined(t.ajaxData)||lu.isNullOrUndefined(t.ajaxData.requestUrl)||(e+="(url: '"+t.ajaxData.requestUrl+"')")}catch(t){}return e},Fd.prototype.instrumentSend=function(){var e=XMLHttpRequest.prototype.send,i=this;XMLHttpRequest.prototype.send=function(t){try{i.isMonitoredInstance(this)&&!this.ajaxData.xhrMonitoringState.sendDone&&i.sendHandler(this,t)}catch(t){i._core.logger.throwInternal(cu.CRITICAL,Lu,"Failed to monitor XMLHttpRequest, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:Fd.getFailedAjaxDiagnosticsMessage(this),exception:Bc.dump(t)})}return e.apply(this,arguments)}},Fd.prototype.sendHandler=function(t,e){t.ajaxData.requestSentTime=Hc.Now(),(t=this.includeCorrelationHeaders(t.ajaxData,void 0,void 0,t)).ajaxData.xhrMonitoringState.sendDone=!0},Fd.prototype.instrumentAbort=function(){var t=XMLHttpRequest.prototype.abort,e=this;XMLHttpRequest.prototype.abort=function(){try{e.isMonitoredInstance(this)&&!this.ajaxData.xhrMonitoringState.abortDone&&(this.ajaxData.aborted=1,this.ajaxData.xhrMonitoringState.abortDone=!0)}catch(t){e._core.logger.throwInternal(cu.CRITICAL,Au,"Failed to monitor XMLHttpRequest.abort, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:Fd.getFailedAjaxDiagnosticsMessage(this),exception:Bc.dump(t)})}return t.apply(this,arguments)}},Fd.prototype.instrumentSetRequestHeader=function(){if(this._config.enableRequestHeaderTracking){var i=XMLHttpRequest.prototype.setRequestHeader,r=this;XMLHttpRequest.prototype.setRequestHeader=function(t,e){try{r.isMonitoredInstance(this)&&(this.ajaxData.requestHeaders[t]=e)}catch(t){r._core.logger.throwInternal(cu.CRITICAL,Ic,"Failed to monitor XMLHttpRequest.setRequestHeader, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:Fd.getFailedAjaxDiagnosticsMessage(this),exception:Bc.dump(t)})}return i.apply(this,arguments)}}},Fd.prototype.attachToOnReadyStateChange=function(i){var r=this;i.ajaxData.xhrMonitoringState.onreadystatechangeCallbackAttached=zd.AttachEvent(i,"readystatechange",function(){try{r.isMonitoredInstance(i)&&4===i.readyState&&r.onAjaxComplete(i)}catch(t){var e=Bc.dump(t);e&&-1!=e.toLowerCase().indexOf("c00c023f")||r._core.logger.throwInternal(cu.CRITICAL,Mu,"Failed to monitor XMLHttpRequest 'readystatechange' event handler, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:Fd.getFailedAjaxDiagnosticsMessage(i),exception:Bc.dump(t)})}})},Fd.prototype.onAjaxComplete=function(t){if(t.ajaxData.responseFinishedTime=Hc.Now(),t.ajaxData.status=t.status,t.ajaxData.CalculateMetrics(),t.ajaxData.ajaxTotalDuration<0)this._core.logger.throwInternal(cu.WARNING,ku,"Failed to calculate the duration of the ajax call, monitoring data for this ajax call won't be sent.",{ajaxDiagnosticsMessage:Fd.getFailedAjaxDiagnosticsMessage(t),requestSentTime:t.ajaxData.requestSentTime,responseFinishedTime:t.ajaxData.responseFinishedTime});else{var e={id:"|"+t.ajaxData.traceID+"."+t.ajaxData.spanID,target:t.ajaxData.getAbsoluteUrl(),name:t.ajaxData.getPathName(),type:"Ajax",duration:t.ajaxData.ajaxTotalDuration,success:200<=+t.ajaxData.status&&+t.ajaxData.status<400,responseCode:+t.ajaxData.status,method:t.ajaxData.method},i=this.getAjaxCorrelationContext(t);if(i&&(e.correlationContext=i),this._config.enableRequestHeaderTracking&&0<Object.keys(t.ajaxData.requestHeaders).length&&(e.properties=e.properties||{},e.properties.requestHeaders={},e.properties.requestHeaders=t.ajaxData.requestHeaders),this._config.enableResponseHeaderTracking){var r=t.getAllResponseHeaders();if(r){var n=r.trim().split(/[\r\n]+/),o={};n.forEach(function(t){var e=t.split(": "),i=e.shift(),r=e.join(": ");o[i]=r}),0<Object.keys(o).length&&(e.properties=e.properties||{},e.properties.responseHeaders={},e.properties.responseHeaders=o)}}this.trackDependencyDataInternal(e),t.ajaxData=null}},Fd.prototype.getAjaxCorrelationContext=function(e){try{var t=e.getAllResponseHeaders();if(null!==t&&-1!==t.toLowerCase().indexOf(zc.requestContextHeaderLowerCase)){var i=e.getResponseHeader(zc.requestContextHeader);return qc.getCorrelationContext(i)}}catch(t){this._core.logger.throwInternal(cu.WARNING,Du,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{ajaxDiagnosticsMessage:Fd.getFailedAjaxDiagnosticsMessage(e),exception:Bc.dump(t)})}},Fd.prototype.trackDependencyDataInternal=function(t,e,i){if(-1===this._config.maxAjaxCallsPerView||this._trackAjaxAttempts<this._config.maxAjaxCallsPerView){var r=dh.create(t,Zp.dataType,Zp.envelopeType,this._core.logger,e,i);this._core.track(r)}else this._trackAjaxAttempts===this._config.maxAjaxCallsPerView&&this._core.logger.throwInternal(cu.CRITICAL,pc,"Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.",!0);++this._trackAjaxAttempts},Fd.prototype.trackDependencyData=function(t,e){this.trackDependencyDataInternal(t,e)},Fd.prototype.processTelemetry=function(t){this._nextPlugin&&this._nextPlugin.processTelemetry&&this._nextPlugin.processTelemetry(t)},Fd.prototype.setNextPlugin=function(t){t&&(this._nextPlugin=t)},Fd.prototype.instrumentFetch=function(){if(this.supportsFetch()&&!this._fetchInitialized){var r=window.fetch,n=this;window.fetch=function(e,t){var i;if(n.isFetchInstrumented(e)&&n.isMonitoredInstance(void 0,void 0,e,t))try{i=n.createFetchRecord(e,t),t=n.includeCorrelationHeaders(i,e,t)}catch(t){n._core.logger.throwInternal(cu.CRITICAL,Pu,"Failed to monitor Window.fetch, monitoring data for this fetch call may be incorrect.",{ajaxDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(e),exception:Bc.dump(t)})}return r(e,t).then(function(t){return n.onFetchComplete(t,i),t}).catch(function(t){throw n.onFetchFailed(e,i,t),t})},this._fetchInitialized=!0}},Fd.prototype.isFetchInstrumented=function(t){return this._fetchInitialized&&!0!==t[Xc]},Fd.prototype.supportsFetch=function(){var t=!0;return(!window||lu.isNullOrUndefined(window.Request)||lu.isNullOrUndefined(window.Request.prototype)||lu.isNullOrUndefined(window.fetch))&&(t=!1),t},Fd.prototype.createFetchRecord=function(t,e){var i=this._context&&this._context.telemetryTrace&&this._context.telemetryTrace.traceID||Bc.generateW3CId(),r=Bc.generateW3CId().substr(0,16),n=new Ld(i,r,this._core.logger);return n.requestSentTime=Hc.Now(),t instanceof Request?n.requestUrl=t?t.url:"":n.requestUrl=t,e&&e.method?n.method=e.method:t&&t instanceof Request?n.method=t.method:n.method="GET",e&&e.headers&&this._config.enableRequestHeaderTracking?n.requestHeaders=e.headers:n.requestHeaders={},n},Fd.prototype.includeCorrelationHeaders=function(t,e,i,r){if(e){if(qc.canIncludeCorrelationHeader(this._config,t.getAbsoluteUrl(),this.currentWindowHost)){if((i=i||{}).headers=new Headers(i.headers||e instanceof Request&&e.headers||{}),this._isUsingAIHeaders){var n="|"+t.traceID+"."+t.spanID;i.headers.set(zc.requestIdHeader,n),this._config.enableRequestHeaderTracking&&(t.requestHeaders[zc.requestIdHeader]=n)}var o=this._config.appId||this._context.appId();if(o&&(i.headers.set(zc.requestContextHeader,zc.requestContextAppIdFormat+o),this._config.enableRequestHeaderTracking&&(t.requestHeaders[zc.requestContextHeader]=zc.requestContextAppIdFormat+o)),this._isUsingW3CHeaders){var a=new Rd(t.traceID,t.spanID);i.headers.set(zc.traceParentHeader,a.toString()),this._config.enableRequestHeaderTracking&&(t.requestHeaders[zc.traceParentHeader]=a.toString())}return i}return i}if(r){if(this.currentWindowHost&&qc.canIncludeCorrelationHeader(this._config,r.ajaxData.getAbsoluteUrl(),this.currentWindowHost)){this._isUsingAIHeaders&&(n="|"+r.ajaxData.traceID+"."+r.ajaxData.spanID,r.setRequestHeader(zc.requestIdHeader,n),this._config.enableRequestHeaderTracking&&(r.ajaxData.requestHeaders[zc.requestIdHeader]=n));var s=this._config.appId||this._context.appId();s&&(r.setRequestHeader(zc.requestContextHeader,zc.requestContextAppIdFormat+s),this._config.enableRequestHeaderTracking&&(r.ajaxData.requestHeaders[zc.requestContextHeader]=zc.requestContextAppIdFormat+s)),this._isUsingW3CHeaders&&(a=new Rd(r.ajaxData.traceID,r.ajaxData.spanID),r.setRequestHeader(zc.traceParentHeader,a.toString()),this._config.enableRequestHeaderTracking&&(r.ajaxData.requestHeaders[zc.traceParentHeader]=a.toString()))}return r}},Fd.prototype.getFailedFetchDiagnosticsMessage=function(t){var e="";try{lu.isNullOrUndefined(t)||(e+="string"==typeof t?"(url: '"+t+"')":"(url: '"+t.url+"')")}catch(t){this._core.logger.throwInternal(cu.CRITICAL,Pu,"Failed to grab failed fetch diagnostics message",{exception:Bc.dump(t)})}return e},Fd.prototype.onFetchComplete=function(e,t){if(t)try{if(t.responseFinishedTime=Hc.Now(),t.CalculateMetrics(),t.ajaxTotalDuration<0)this._core.logger.throwInternal(cu.WARNING,ku,"Failed to calculate the duration of the fetch call, monitoring data for this fetch call won't be sent.",{fetchDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(e),requestSentTime:t.requestSentTime,responseFinishedTime:t.responseFinishedTime});else{var i={id:"|"+t.traceID+"."+t.spanID,target:t.getAbsoluteUrl(),name:t.getPathName(),type:"Fetch",duration:t.ajaxTotalDuration,success:200<=e.status&&e.status<400,responseCode:e.status,properties:{HttpMethod:t.method}},r=this.getFetchCorrelationContext(e);if(r&&(i.correlationContext=r),this._config.enableRequestHeaderTracking&&0<Object.keys(t.requestHeaders).length&&(i.properties=i.properties||{},i.properties.requestHeaders=t.requestHeaders),this._config.enableResponseHeaderTracking){var n={};e.headers.forEach(function(t,e){n[e]=t}),0<Object.keys(n).length&&(i.properties=i.properties||{},i.properties.responseHeaders=n)}this.trackDependencyDataInternal(i)}}catch(t){this._core.logger.throwInternal(cu.WARNING,Du,"Failed to calculate the duration of the fetch call, monitoring data for this fetch call won't be sent.",{fetchDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(e),exception:Bc.dump(t)})}},Fd.prototype.onFetchFailed=function(e,t,i){if(t)try{if(t.responseFinishedTime=Hc.Now(),t.CalculateMetrics(),t.ajaxTotalDuration<0)this._core.logger.throwInternal(cu.WARNING,ku,"Failed to calculate the duration of the failed fetch call, monitoring data for this fetch call won't be sent.",{fetchDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(e),requestSentTime:t.requestSentTime,responseFinishedTime:t.responseFinishedTime});else{var r={id:"|"+t.traceID+"."+t.spanID,target:t.getAbsoluteUrl(),name:t.getPathName(),type:"Fetch",duration:t.ajaxTotalDuration,success:!1,responseCode:0,properties:{HttpMethod:t.method}};this.trackDependencyDataInternal(r,{error:i.message})}}catch(t){this._core.logger.throwInternal(cu.WARNING,Du,"Failed to calculate the duration of the failed fetch call, monitoring data for this fetch call won't be sent.",{fetchDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(e),exception:Bc.dump(t)})}},Fd.prototype.getFetchCorrelationContext=function(e){try{var t=e.headers.get(zc.requestContextHeader);return qc.getCorrelationContext(t)}catch(t){this._core.logger.throwInternal(cu.WARNING,Du,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{fetchDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(e),exception:Bc.dump(t)})}},Fd.prototype.instrumentXhr=function(){this.supportsAjaxMonitoring()&&!this.initialized&&(this.instrumentOpen(),this.instrumentSend(),this.instrumentAbort(),this.instrumentSetRequestHeader(),this.initialized=!0)},Fd.getDefaultConfig=function(){return{maxAjaxCallsPerView:500,disableAjaxTracking:!1,disableFetchTracking:!0,disableCorrelationHeaders:!1,distributedTracingMode:iu.AI,correlationHeaderExcludedDomains:["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],correlationHeaderDomains:void 0,appId:void 0,enableCorsCorrelation:!1,enableRequestHeaderTracking:!1,enableResponseHeaderTracking:!1}},Fd.getEmptyConfig=function(){return{maxAjaxCallsPerView:void 0,disableAjaxTracking:void 0,disableFetchTracking:void 0,disableCorrelationHeaders:void 0,distributedTracingMode:void 0,correlationHeaderExcludedDomains:void 0,appId:void 0,enableCorsCorrelation:void 0,correlationHeaderDomains:void 0,enableRequestHeaderTracking:void 0,enableResponseHeaderTracking:void 0}},Fd.prototype.initialize=function(t,e,i){if(!this.initialized&&!this._fetchInitialized){this._core=e;var r=Fd.getDefaultConfig();for(var n in this._config=Fd.getEmptyConfig(),r)this._config[n]=ch.getConfig(t,n,Fd.identifier,r[n]);if(this._isUsingAIHeaders=this._config.distributedTracingMode===iu.AI||this._config.distributedTracingMode===iu.AI_AND_W3C,this._isUsingW3CHeaders=this._config.distributedTracingMode===iu.AI_AND_W3C||this._config.distributedTracingMode===iu.W3C,!1===this._config.disableAjaxTracking&&this.instrumentXhr(),!1===this._config.disableFetchTracking&&this.instrumentFetch(),0<i.length&&i){for(var o=void 0,a=0;!o&&a<i.length;)i[a]&&i[a].identifier===vh&&(o=i[a]),a++;o&&(this._context=o.context)}}},Fd.identifier="AjaxDependencyPlugin",Fd);function Fd(){this._trackAjaxAttempts=0,this.identifier=Fd.identifier,this.priority=120,this.currentWindowHost=window&&window.location&&window.location.host&&window.location.host.toLowerCase(),this.initialized=!1,this._fetchInitialized=!1}var Ud=(jd.prototype.trackEvent=function(t,e){this.appInsights.trackEvent(t,e)},jd.prototype.trackPageView=function(t){var e=t||{};this.appInsights.trackPageView(e)},jd.prototype.trackPageViewPerformance=function(t){var e=t||{};this.appInsights.trackPageViewPerformance(e)},jd.prototype.trackException=function(t){!t.exception&&t.error&&(t.exception=t.error),this.appInsights.trackException(t)},jd.prototype._onerror=function(t){this.appInsights._onerror(t)},jd.prototype.trackTrace=function(t,e){this.appInsights.trackTrace(t,e)},jd.prototype.trackMetric=function(t,e){this.appInsights.trackMetric(t,e)},jd.prototype.startTrackPage=function(t){this.appInsights.startTrackPage(t)},jd.prototype.stopTrackPage=function(t,e,i,r){this.appInsights.stopTrackPage(t,e,i,r)},jd.prototype.startTrackEvent=function(t){this.appInsights.startTrackEvent(t)},jd.prototype.stopTrackEvent=function(t,e,i){this.appInsights.stopTrackEvent(t,e,i)},jd.prototype.addTelemetryInitializer=function(t){return this.appInsights.addTelemetryInitializer(t)},jd.prototype.setAuthenticatedUserContext=function(t,e,i){void 0===i&&(i=!1),this.properties.context.user.setAuthenticatedUserContext(t,e,i)},jd.prototype.clearAuthenticatedUserContext=function(){this.properties.context.user.clearAuthenticatedUserContext()},jd.prototype.trackDependencyData=function(t){this.dependencies.trackDependencyData(t)},jd.prototype.flush=function(e){void 0===e&&(e=!0),this.core.getTransmissionControls().forEach(function(t){t.forEach(function(t){t.flush(e)})})},jd.prototype.onunloadFlush=function(e){void 0===e&&(e=!0),this.core.getTransmissionControls().forEach(function(t){t.forEach(function(t){t.onunloadFlush?t.onunloadFlush():t.flush(e)})})},jd.prototype.loadAppInsights=function(t){if(void 0===t&&(t=!1),t&&this.config.extensions&&0<this.config.extensions.length)throw new Error("Extensions not allowed in legacy mode");var e=[],i=new md;return e.push(i),e.push(this.properties),e.push(this.dependencies),e.push(this.appInsights),this.core.initialize(this.config,e),this.emptyQueue(),this.pollInternalLogs(),this.addHousekeepingBeforeUnload(this),this.context=this.properties.context,this},jd.prototype.updateSnippetDefinitions=function(t){for(var e in this)"string"==typeof e&&(t[e]=this[e])},jd.prototype.emptyQueue=function(){try{if(Bc.isArray(this.snippet.queue)){for(var t=this.snippet.queue.length,e=0;e<t;e++)(0,this.snippet.queue[e])();this.snippet.queue=void 0,delete this.snippet.queue}}catch(t){var i={};t&&"function"==typeof t.toString&&(i.exception=t.toString())}},jd.prototype.pollInternalLogs=function(){this.core.pollInternalLogs()},jd.prototype.addHousekeepingBeforeUnload=function(e){!e.appInsights.config.disableFlushOnBeforeUnload&&"onbeforeunload"in window&&(Bc.addEventHandler("beforeunload",function(){e.onunloadFlush(!1);var t=e.appInsights.core._extensions[vh];t&&t.context&&t.context._sessionManager&&t.context._sessionManager.backup()})||e.appInsights.core.logger.throwInternal(cu.CRITICAL,zu,"Could not add handler for beforeunload"))},jd.prototype.getSKUDefaults=function(){this.config.diagnosticLogInterval=this.config.diagnosticLogInterval&&0<this.config.diagnosticLogInterval?this.config.diagnosticLogInterval:1e4},jd);function jd(t){t.queue=t.queue||[],t.version=t.version||2;var e=t.config||{};e&&!e.instrumentationKey&&(e=t,Ah.Version="2.2.2"),this.appInsights=new Ah,this.properties=new kd,this.dependencies=new Bd,this.core=new Lc,this.snippet=t,this.config=e,this.getSKUDefaults()}var qd=(Vd.prototype.trackEvent=function(t,e){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.trackEvent(t,e)},Vd.prototype.setAuthenticatedUserContext=function(t,e){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.setAuthenticatedUserContext(t,e)},Vd.prototype.trackException=function(t){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.trackException(t)},Vd.prototype.flush=function(t){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.flush(t)},Vd);function Vd(t){this.options=t,!this.options.disableTelemetry&&s&&(this.appInsights=new Ud({config:{instrumentationKey:s,disableExceptionTracking:!0,disableAjaxTracking:!0,isCookieUseDisabled:!0,maxBatchInterval:5e3}}),this.appInsights.loadAppInsights(),this.appInsights.addTelemetryInitializer(function(t){t.tags[yh.applicationVersion]=z.getFullVersion()}))}var Gd=(Zd.prototype.onAdd=function(t){return this.container=document.createElement("div"),this.container.className="azure-map-logo",this.container},Zd.prototype.onRemove=function(){this.container.remove()},Zd);function Zd(){}var Hd,Wd=(b(Kd,Hd=I),Kd);function Kd(){var t=null!==Hd&&Hd.apply(this,arguments)||this;return t.copyrightMessage=void 0,t.showFeedbackLink=!0,t}var Xd,Yd=(b(Jd,Xd=at),Jd.prototype.onAdd=function(t){return this.container=this.buildContainer(t,p.ControlStyle.auto),this.container.className="map-copyright",this.copyrightDiv=this.buildCopyrightDiv(),this.container.appendChild(this.copyrightDiv),this.options.showFeedbackLink&&(this.feedbackLink=this.buildFeedbackLink(),this.container.appendChild(this.feedbackLink)),this.container},Jd.prototype.onRemove=function(){Xd.prototype.onRemove.call(this),delete this.container},Jd.prototype.setOptions=function(t){var e=(new Wd).merge(this.options,t);e.copyrightMessage!==this.options.copyrightMessage&&(this.copyrightDiv.innerText=e.copyrightMessage),!e.showFeedbackLink&&this.feedbackLink?(this.feedbackLink.remove(),delete this.feedbackLink):e.showFeedbackLink&&!this.feedbackLink&&(this.feedbackLink=this.buildFeedbackLink(),this.container.appendChild(this.feedbackLink)),this.options=e},Jd.prototype.buildCopyrightDiv=function(){var t=document.createElement("div");return t.innerText=this.options.copyrightMessage||"",t},Jd.prototype.buildFeedbackLink=function(){var t=document.createElement("a");return t.textContent="Improve this map",t.href="https://feedback.azuremaps.com",t.target="_blank",t.rel="noopener",t},Jd);function Jd(t){var e=Xd.call(this)||this;return e.options=(new Wd).merge(t),e}var Qd=($d.throwOnError=function(t,e){var i=t instanceof ig?t._getMap():t,r=function(t){throw i.off("error",r),t.error};i.on("error",r);var n=e();return i.off("error",r),n},$d.tryCatch=function(t,e,i,r){try{return this.throwOnError(t,e)}catch(t){return i(t)}finally{"function"==typeof r&&r()}},$d.tryFinally=function(t,e,i){try{return this.throwOnError(t,e)}finally{i()}},$d);function $d(){}var tf=(ef.prototype.request=function(t){var e={domain:this.map.getServiceOptions().domain,path:"search/address/reverse/json",queryParams:w({"api-version":"1.0",language:t.style.language,limit:1,query:io(t.position[1])+","+ro(t.position[0])},t.style.view&&{view:t.style.view})};return new P(this.map.authentication.signRequest(e)).get()},ef);function ef(t){this.map=t}var rf=(nf.prototype.cache=function(t,e,i,r){var n=t+"_"+i[0]+"_"+i[1]+"_"+r;this._labelIdx[e.labelType]||(this._labelIdx[e.labelType]=[],this._labelCache[e.labelType]=[]),-1===this._labelIdx[e.labelType].indexOf(n)&&(this._labelCache[e.labelType].push({name:t,radius:e.radius,minZoom:e.minZoom,maxZoom:e.maxZoom||24,position:i}),this._labelIdx[e.labelType].push(n))},nf.prototype.getNearestLabel=function(t,e,i){var r=null,n=this._labelCache[t];if(n)for(var o=1/0,a=0,s=n.length;a<s;a++)if(i>=n[a].minZoom&&i<=n[a].maxZoom){var l=Yn(n[a].position,e);l<=n[a].radius&&l<=o&&(o=l,r=n[a])}return r},nf.prototype._preloadCache=function(t){if(!this._preloadedCache.has(t)){this._preloadedCache.add(t);var e={source:["Ocean label","Ocean name"],labelType:"water",minZoom:0,radius:395e4,polygonSources:["Ocean","Ocean or sea"]},i=t,r=i.indexOf("-");switch(-1!==r&&(i=i.substr(0,r)),i){case"fr":this.cache("Océan Pacifique",e,[-170,32],t),this.cache("Océan Pacifique",e,[-138,-27],t),this.cache("Océan Atlantique",e,[-40,32],t),this.cache("Océan Atlantique",e,[-17,-29],t);break;case"es":this.cache("Océan Pacifique",e,[-170,32],t),this.cache("Océan Pacifique",e,[-138,-27],t),this.cache("Océano Atlántico",e,[-40,32],t),this.cache("Océano Atlántico",e,[-17,-29],t);break;case"pt":this.cache("Oceano Pacífico",e,[-170,32],t),this.cache("Oceano Pacífico",e,[-138,-27],t),this.cache("Oceano Atlântico",e,[-40,32],t),this.cache("Oceano Atlântico",e,[-17,-29],t);break;case"ja":this.cache("太平洋",e,[-170,32],t),this.cache("太平洋",e,[-138,-27],t);break;case"en":this.cache("Pacific Ocean",e,[-170,32],t),this.cache("Pacific Ocean",e,[-138,-27],t),this.cache("Atlantic Ocean",e,[-40,32],t),this.cache("Atlantic Ocean",e,[-17,-29],t),this.cache("Indian Ocean",e,[77,-26],t)}}},nf);function nf(){this._labelCache={},this._labelIdx={},this._preloadedCache=new Set}var of=(af.prototype.dispose=function(){this._disposed=!0,this._map._getMap().off("move",this._onMove),this._map._getMap().off("moveend",this._onMoveEnd),this._map._getMap().off("styledata",this._onStyleData),this._map._getMap().off("rotate",this._onRotate),this._map.getCanvas().removeEventListener("mousedown",this._onPointerDown),this._map.getCanvas().removeEventListener("touchstart",this._onPointerDown),this._map.getMapContainer().removeEventListener("keydown",this._shortcutListener)},af.prototype._getEventPos=function(t){if("touches"in t){var e=t.touches[0],i=t.target.getBoundingClientRect();return[e.pageX-i.left,e.pageY-i.top]}return[t.offsetX,t.offsetY]},af.prototype._checkThresholds=function(t,e){return this._checkZoomThreshold(t.zoom,e.zoom)||this._checkPitchThreshold(t.pitch,e.pitch)||this._checkLocThreshold(t.center,e.center)||this._checkHeadingThreshold(t.bearing,e.bearing)},af.prototype._checkZoomThreshold=function(t,e){return this._round(t)!==this._round(e)},af.prototype._checkPitchThreshold=function(t,e){return Math.abs(t-e)>=this._pitchThreshold},af.prototype._checkLocThreshold=function(t,e){var i=this._map.positionsToPixels([e,t]),r=i[0],n=i[1];return mn.getDistance(r,n)>=this._moveThreshold},af.prototype._checkHeadingThreshold=function(t,e){t<0&&(t+=360),e<0&&(e+=360);var i=Math.abs(t-e);return 180<i&&(i=360-i),i>=this._headingThreshold},af.prototype._getLocDesc=function(p,h,d){return S(this,void 0,void 0,function(){var e,i,r,n,o,a,s,l,u,c=this;return T(this,function(t){switch(t.label){case 0:return"blank"===d?[3,3]:this._map._getMap().loaded()?[3,2]:[4,new Promise(function(t){return c._map._getMap().once("idle",t)})];case 1:t.sent(),t.label=2;case 2:for(e={},i=this._map.positionsToPixels([p.center])[0],Qd.tryCatch(this._map,function(){r=c._map._getMap().queryRenderedFeatures(i,{layers:c._polygonStyleLayer,filter:["==",["geometry-type"],"Polygon"]})},function(){}),n=null,r&&0<r.length&&(n=r[0]),o=null,a=0,s=this._lableConfig.length;a<s;a++)l=this._lableConfig[a],p.zoom>=l.minZoom?l.polygonSources?n&&-1!==l.polygonSources.indexOf(n.layer["source-layer"])?(o=l.labelType,this._getClosestLabel(l,p,h,e,!1)):this._getClosestLabel(l,p,h,e,!0):this._getClosestLabel(l,p,h,e,!1):this._getClosestLabel(l,p,h,e,!0);return 8<=p.zoom&&this._processRoads(e,p,h),this._labelCache.forEach(function(t){e[t]||(u=null,("water"!==t&&"majorPoi"!==t||t===o)&&(u=af._labelCache.getNearestLabel(t,p.center,p.zoom)),u&&(e[t]=u.name))}),[2,this._processLocInfo(p,o,e,!0,this._restFallback)];case 3:return[2,this._processLocInfo(p,null,null,!1,!1)]}})})},af.prototype._getHeadingDesc=function(t){var e=t.bearing;switch(e<0&&(e+=360),e=this._round(e,this._headingThreshold)){case 0:case 360:return"north";case 45:return"north east";case 90:return"east";case 135:return"south east";case 180:return"south";case 225:return"south west";case 270:return"west";case 315:return"north west";default:return e+" degrees"}},af.prototype._getClosestLabel=function(t,e,i,r,n){for(var o=t.radius,a=0,s=t.source.length;a<s;a++){var l={sourceLayer:t.source[a]},u=this._map._getMap().querySourceFeatures(this._baseVectorTileSourceId,l),c=null,p=1/0,h=this._labelCache.has(t.labelType);if(!n||n&&h)for(var d=0,f=u.length;d<f;d++){var m="Point"===u[d].geometry.type?u[d]:_o(e.center,u[d].geometry);if(!n){var g="Point"===u[d].geometry.type?Yn(e.center,m.geometry.coordinates):m.properties.distance;g<p&&(p=g,c=u[d])}h&&af._labelCache.cache(u[d].properties.name,t,m.geometry.coordinates,i)}if(!n){var y=t.labelType+"Dis";c&&p<=o&&("number"!=typeof r[y]||p<=r[y])&&(r[t.labelType]=c.properties.name,r[y]=p)}}},af.prototype._processRoads=function(t,e,i,r){var n=this._map._getMap().queryRenderedFeatures(r,{filter:["==",["geometry-type"],"LineString"]});if(n){for(var o=void 0,a=void 0,s=void 0,l=void 0,u=0,c=n.length;u<c;u++)if(this._roadLayers.has(n[u].layer["source-layer"])&&n[u].properties.name&&""!==n[u].properties.name){var p=_o(e.center,n[u]);(!s||p.properties.distance<s.properties.distance)&&(o&&n[u].properties.name===o.properties.name?s=p:o&&n[u].properties.name===o.properties.name?(!l||p.properties.distance<l.properties.distance)&&(l=p,a=n[u]):(l=s,a=o,s=p,o=n[u]))}if(o&&(t.country||(t.country=o.properties.country_code,t.countryDis=0,af._labelCache.cache(t.country,{source:["Country name"],labelType:"country",radius:5e3,minZoom:0},s.geometry.coordinates,i)),t.state||(t.state=o.properties.country_subdivision,t.stateDis=0,af._labelCache.cache(t.state,{source:["State name"],labelType:"state",radius:5e3,minZoom:4},s.geometry.coordinates,i)),15<=e.zoom)){var h=this._map.positionsToPixels([e.center,s.geometry.coordinates]),d=mn.getDistance(h[0],h[1]);if((d<this._roadPixelRadius||s.properties.distance<this._minRoadDistance)&&(t.road=o.properties.name),a){var f=this._map.positionsToPixels([l.geometry.coordinates]);((d=mn.getDistance(h[0],f[0]))<this._minIntersectionPixelDistance||l.properties.distance<this._minRoadDistance)&&(t.secondRoad=a.properties.name,t.secondRoadDis=l.properties.distance)}}}},af.prototype._getActionDesc=function(t){if(this._lastCam){var e=[];if(this._checkLocThreshold(t.center,this._lastCam.center)){var i=["panned"],r=Math.round(Qn(this._lastCam.center,t.center));0===r||360===r?i.push("north"):r<90?i.push("north east"):90===r?i.push("east"):r<180?i.push("south east"):180===r?i.push("south"):r<270?i.push("south west"):270===r?i.push("west"):r<360&&i.push("north west");var n=Yn(this._lastCam.center,t.center,bn.meters);i.push(1e3<n?Wn(n/1e3,2)+" kilometers":Wn(n,2)+" meters"),e.push(i.join(" "))}if(this._checkZoomThreshold(t.zoom,this._lastCam.zoom)){(i=["zoomed"]).push(this._lastCam.zoom<t.zoom?"in":"out");var o=Math.abs(this._lastCam.zoom-t.zoom);1<=o&&(o=Math.ceil(o),i.push(1<o?o+" levels":o+" level")),this._getCanonicalZoom(this._lastCam.zoom)!==this._getCanonicalZoom(t.zoom)&&i.push("to "+this._getCanonicalZoom(t.zoom)+" level"),e.push(i.join(" "))}if(this._checkPitchThreshold(t.pitch,this._lastCam.pitch)){var a=this._round(t.pitch,this._pitchThreshold);if(e.push("pitched to "+a+" degrees"),60===t.pitch||0===t.pitch){var s=60===t.pitch?"maximum":"minimum";e.push("reached "+s+" of "+t.pitch+" degrees")}}return this._checkHeadingThreshold(this._lastCam.bearing,t.bearing)&&e.push("rotated to "+this._getHeadingDesc(t)),e.join(" and ")||null}return null},af.prototype._getCanonicalZoom=function(t){return(t=this._round(t))<2?"world":t<5?"country":t<11?"state province":t<15?"city":"street"},af.prototype._processLocInfo=function(n,o,a,s,l){var u=this;return new Promise(function(e,t){var i=[];if(s){var r=[];if(a&&(o&&("water"===o&&a.water?r.push(a.water):"majorPoi"===o&&a.majorPoi&&r.push(a.majorPoi)),0===r.length&&(a.majorPoi&&8<=n.zoom?r.push(a.majorPoi):(a.poi&&14<=n.zoom?r.push(a.poi):a.road&&15<=n.zoom&&(a.secondRoad?r.push(a.road+" & "+a.secondRoad):r.push(a.road)),a.neighbourhood&&12<=n.zoom&&r.push(a.neighbourhood),a.city&&6<=n.zoom&&r.push(a.city)),a.state&&4<=n.zoom&&r.push(a.state),0===r.length?a.water?r.push(a.water):a.country&&r.push(a.country):1===r.length&&a.state&&4<=n.zoom&&a.country&&r.push(a.country))),0<r.length)i.push("<p>Location: ",r.join(", "),".</p>");else if(l&&"water"!==o)return void u._reverseGeocodeDescription(n).then(function(t){e(t)},function(){t("<p>Location: unknown</p>")})}u._returnDetailedDescriptions&&(i.push("<p>Zoom: ",Wn(n.zoom,2),".</p>"),i.push("<p>Latitude: ",Wn(n.center[1],5),".</p>"),i.push("<p>Longitude: ",Wn(n.center[0],5),".</p>")),e(i.join(""))})},af.prototype._reverseGeocodeDescription=function(o){var a=this;return new Promise(function(r){var n=a._map.getStyle();a._reverseSearch.request({position:o.center,style:n}).then(function(t){var e={};if(t&&t.addresses&&0<t.addresses.length&&t.addresses[0].address){var i=t.addresses[0].address;i.country&&(e.country=i.country,af._labelCache.cache(e.country,{source:["Country name"],labelType:"country",radius:5e3,minZoom:0},o.center,n.language)),i.countrySubdivision&&(e.state=i.countrySubdivision,af._labelCache.cache(e.state,{source:["State name"],labelType:"state",radius:5e3,minZoom:4},o.center,n.language)),i.municipality&&(e.city=i.municipality,af._labelCache.cache(e.state,{source:["Small city"],labelType:"city",radius:1e3,minZoom:10},o.center,n.language)),i.streetNameAndNumber?e.road=i.streetNameAndNumber:i.street&&(e.road=i.street)}a._processLocInfo(o,null,e,!0,!1).then(function(t){r(t)})},function(t){a._processLocInfo(o,null,null,!0,!1).then(function(t){r(t)})}).catch(function(t){a._processLocInfo(o,null,null,!0,!1).then(function(t){r(t)})})})},af.prototype._round=function(t,e){return void 0===e&&(e=1),Math.round(t/e)*e},af);function af(t,e){var s=this;this._restFallback=!0,this._disposed=!1,this._lastHeadingTime=0,this._actionQueue=[],this._pointerUpdateDelay=3e3,this._camUpdateDelay=1e3,this._headUpdateLimit=1e3,this._controlEventDelay=500,this._moveThreshold=25,this._headingThreshold=5,this._pitchThreshold=5,this._roadPixelRadius=120,this._minRoadDistance=25,this._minIntersectionPixelDistance=50,this._baseVectorTileSourceId="vectorTiles",this._lableConfig=[{source:["Ocean label","Ocean name"],labelType:"water",minZoom:0,radius:395e4,polygonSources:["Ocean","Ocean or sea"]},{source:["Sea label"],labelType:"water",minZoom:3,radius:1e6,polygonSources:["Sea","Ocean or sea"]},{source:["Country name"],labelType:"country",minZoom:0,maxZoom:5,radius:3e5},{source:["State name","State name short"],labelType:"state",minZoom:4,maxZoom:7,radius:3e5},{source:["Capital city","Large city"],labelType:"city",minZoom:8,radius:4e4},{source:["Medium city"],labelType:"city",minZoom:8,radius:3e4},{source:["Small city"],labelType:"city",minZoom:8,radius:2e4},{source:["Island label"],labelType:"city",minZoom:8,radius:1e4},{source:["Town"],labelType:"city",minZoom:10,radius:1e4},{source:["Village"],labelType:"neighbourhood",minZoom:12,radius:6e3},{source:["Amusement area label"],labelType:"poi",minZoom:14,radius:2e3,polygonSources:["Amusement park"]},{source:["Hospital label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Hospital"]},{source:["Shopping centre label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Shopping"]},{source:["Stadium label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Stadium"]},{source:["University/School label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["University"]},{source:["Zoo label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Zoo"]},{source:["Airport Label","Airport name","Airport POI"],labelType:"majorPoi",minZoom:11,radius:3e3,polygonSources:["Airport","Runway"]},{source:["National park label"],labelType:"majorPoi",minZoom:7,radius:15e3,polygonSources:["National or state park","National park","Forest"]},{source:["Reservation label"],labelType:"majorPoi",minZoom:7,radius:15e3,polygonSources:["Reservation"]}],this._polygonStyleLayer=["National or state park","National park","Reservation","Airport","Runway","Stadium","University","Zoo","Shopping","Hospital","Amusement park","Ocean","Sea","Ocean or sea"],this._labelCache=new Set(["city","state","country","water","majorPoi"]),this._roadLayers=new Set(["Connecting road","Connecting road tunnel","International road","International road tunnel","Local road","Local road tunnel","Major local road","Major local road tunnel","Major road","Major road tunnel","Minor local road","Minor local road tunnel","Motorway","Motorway tunnel","Secondary road","Secondary road tunnel","Toll connecting road","Toll connecting road tunnel","Toll international road","Toll international road tunnel","Toll local road","Toll local road tunnel","Toll major local road","Toll major local road tunnel","Toll major road","Toll major road tunnel","Toll minor local road","Toll minor local road tunnel","Toll motorway","Toll motorway tunnel","Toll secondary road","Toll secondary road tunnel"]),this._returnDetailedDescriptions=!1,this._shortcutListener=function(a){return S(s,void 0,void 0,function(){var e,i,r,n,o;return T(this,function(t){switch(t.label){case 0:return a.altKey&&a.ctrlKey&&68===a.keyCode?(this._returnDetailedDescriptions=!this._returnDetailedDescriptions,e=this._map.getCamera(),i=this._map.getStyle(),r=i.language.toLowerCase(),n=i.style.toLowerCase(),[4,this._getLocDesc(e,r,n)]):[3,2];case 1:o=t.sent(),this._descCallback(o),t.label=2;case 2:return[2]}})})},this._onRotate=function(){s._rotateTimeout||(Date.now()-s._lastHeadingTime>=s._headUpdateLimit?s._rotateTimeout=setTimeout(s._updateHeading,ht.RotationDuration+25):s._rotateTimeout=setTimeout(s._updateHeading,s._headUpdateLimit-(Date.now()-s._lastHeadingTime)))},this._onMove=function(){s._moveTimeout&&(clearTimeout(s._moveTimeout),delete s._moveTimeout),s._controlTimeout&&(clearTimeout(s._controlTimeout),delete s._controlTimeout)},this._onMoveEnd=function(t){t.fromControl?s._controlTimeout=setTimeout(s._updateCam,s._controlEventDelay):s._updateCam()},this._onStyleData=function(){setTimeout(s._updateStyle)},this._onPointerDown=function(t){s._lastPointerPos=s._getEventPos(t),s._pointerTimeout=setTimeout(function(){return S(s,void 0,void 0,function(){var e,i,r,n,o;return T(this,function(t){switch(t.label){case 0:return e=this._map.getStyle(),i=e.language.toLowerCase(),r=e.style.toLowerCase(),(n=this._map.getCamera()).center=this._map.pixelsToPositions([this._lastPointerPos])[0],[4,this._getLocDesc(n,i,r)];case 1:return o=t.sent(),this._descCallback(o),this._onPointerUp(),[2]}})})},s._pointerUpdateDelay),s._map.getCanvas().addEventListener("mousemove",s._onPointerMove),s._map.getCanvas().addEventListener("touchmove",s._onPointerMove),s._map.getCanvas().addEventListener("mouseup",s._onPointerUp),s._map.getCanvas().addEventListener("touchend",s._onPointerUp)},this._onPointerMove=function(t){var e=s._getEventPos(t),i=s._lastPointerPos[0]-e[0],r=s._lastPointerPos[1]-e[1];Math.sqrt(i*i+r*r)>s._moveThreshold&&s._onPointerUp()},this._onPointerUp=function(){clearTimeout(s._pointerTimeout),delete s._pointerTimeout,s._map.getCanvas().removeEventListener("mousemove",s._onPointerMove),s._map.getCanvas().removeEventListener("touchmove",s._onPointerMove),s._map.getCanvas().removeEventListener("mouseup",s._onPointerUp),s._map.getCanvas().removeEventListener("touchend",s._onPointerUp)},this._updateHeading=function(){var t=s._map.getCamera();if(!s._lastHead||s._checkHeadingThreshold(t.bearing,s._lastHead)){var e=s._getHeadingDesc(t);s._lastHead=t.bearing,s._descCallback("<p>Map heading "+e+".</p>"),s._lastHeadingTime=Date.now()}delete s._rotateTimeout},this._updateStyle=function(){return S(s,void 0,void 0,function(){var e,i,r,n,o;return T(this,function(t){switch(t.label){case 0:return(e=this._map.getCamera(),i=this._map.getStyle(),r=i.language.toLowerCase(),n=i.style.toLowerCase(),this._lastLang===r)?[3,2]:(af._labelCache._preloadCache(r),[4,this._getLocDesc(e,r,n)]);case 1:return o=t.sent(),[3,4];case 2:return this._lastStyle===n||"blank"!==this._lastStyle?[3,4]:[4,this._getLocDesc(e,r,n)];case 3:o=t.sent(),t.label=4;case 4:return this._lastLang=r,this._lastStyle=n,o&&this._descCallback(o),[2]}})})},this._updateCam=function(t){void 0===t&&(t=!1);var i=s._map.getCamera();if(!s._lastCam||0<s._actionQueue.length||s._checkThresholds(i,s._lastCam)){var e=s._map.getStyle(),r=e.language.toLowerCase(),n=e.style.toLowerCase(),o=s._getActionDesc(i);o&&s._actionQueue.push(o),s._lastCam=i,s._moveTimeout&&(clearTimeout(s._moveTimeout),delete s._moveTimeout),s._moveTimeout=setTimeout(function(){return S(s,void 0,void 0,function(){var e;return T(this,function(t){switch(t.label){case 0:return clearTimeout(this._rotateTimeout),delete this._rotateTimeout,[4,this._getLocDesc(i,r,n)];case 1:return e=t.sent(),0<this._actionQueue.length?(this._descCallback("<p>Map "+this._actionQueue.join(", then ")+".</p>"+e),this._actionQueue=[]):this._descCallback(e),[2]}})})},t?0:s._camUpdateDelay)}},this._map=t,this._descCallback=e,this._reverseSearch=new tf(t),af._labelCache||(af._labelCache=new rf),this._lastLang=this._map.getStyle().language.toLowerCase(),af._labelCache._preloadCache(this._lastLang),this._map.events.addOnce("load",function(){s._disposed||(s._updateCam(!0),s._map._getMap().on("move",s._onMove),s._map._getMap().on("moveend",s._onMoveEnd),s._map._getMap().on("styledata",s._onStyleData),s._map._getMap().on("rotate",s._onRotate),s._map.getCanvas().addEventListener("mousedown",s._onPointerDown),s._map.getCanvas().addEventListener("touchstart",s._onPointerDown))}),this._map.getMapContainer().addEventListener("keydown",this._shortcutListener)}var sf,lf=function(t){var e=this;this.addToMap=function(){e.initializeMapLiveStateInfo(),e.initializeMapStyleInfo(),e.createMapKeyBindingInfo(),e.map.getMapContainer().setAttribute("role","application"),e.map.getMapContainer().setAttribute("aria-label","Map Application"),e.map.getCanvas().setAttribute("aria-label","Interactive Map"),e.map.getCanvas().setAttribute("aria-describedby","atlas-map-state atlas-map-style atlas-map-shortcuts"),e.map.getCanvas().setAttribute("alt","Interactive Map")},this.removeFromMap=function(){null!=e.mapViewDesc&&e.mapViewDesc.dispose(),delete e.mapViewDesc,null!=e.atlasMapKeyBindings&&e.map.getCanvasContainer().removeChild(e.atlasMapKeyBindings),delete e.atlasMapKeyBindings,null!=e.atlasMapLiveStateInfo&&e.map.getCanvasContainer().removeChild(e.atlasMapLiveStateInfo),delete e.atlasMapLiveStateInfo,null!=e.atlasMapStyleInfo&&e.map.getCanvasContainer().removeChild(e.atlasMapStyleInfo),delete e.atlasMapStyleInfo,e.map.getMapContainer().removeAttribute("role"),e.map.getMapContainer().removeAttribute("aria-label"),e.map.getCanvas().removeAttribute("aria-label"),e.map.getCanvas().removeAttribute("aria-describedby"),e.map.getCanvas().removeAttribute("alt"),e.map.events.remove("styledata",e.updateMapStyle)},this.createMapKeyBindingInfo=function(){e.atlasMapKeyBindings=document.createElement("div"),e.atlasMapKeyBindings.setAttribute("tabindex","-1"),e.atlasMapKeyBindings.setAttribute("aria-hidden","true"),e.atlasMapKeyBindings.id="atlas-map-shortcuts",e.atlasMapKeyBindings.classList.add("hidden-accessible-element"),e.atlasMapKeyBindings.innerHTML=["Map shortcuts:","Zoom out: hyphen.","Zoom in: plus.","Pan right 100 pixels: right arrow.","Pan left 100 pixels: left arrow.","Pan up 100 pixels: up arrow.","Pan down 100 pixels: down arrow.","Rotate 15 degrees clockwise: shift + right arrow.","Rotate 15 degrees counter clockwise: shift + left arrow.","Increase pitch 10 degrees: shift + up arrow.","Decrease pitch 10 degrees: shift + down arrow.","Toggle verbose map state: control + alt + D.","Jump focus to the map: Escape."].join("\n"),e.map.getCanvasContainer().appendChild(e.atlasMapKeyBindings),e.atlasMapKeyBindings.setAttribute("aria-live","polite")},this.initializeMapLiveStateInfo=function(){e.mapViewDesc=new of(e.map,e.updateMapState),e.atlasMapLiveStateInfo=document.createElement("div"),e.atlasMapLiveStateInfo.setAttribute("tabindex","-1"),e.atlasMapLiveStateInfo.setAttribute("aria-hidden","true"),e.atlasMapLiveStateInfo.id="atlas-map-state",e.atlasMapLiveStateInfo.classList.add("hidden-accessible-element"),e.map.getCanvasContainer().appendChild(e.atlasMapLiveStateInfo),e.atlasMapLiveStateInfo.setAttribute("aria-live","polite")},this.initializeMapStyleInfo=function(){e.atlasMapStyleInfo=document.createElement("div"),e.atlasMapStyleInfo.setAttribute("tabindex","-1"),e.atlasMapStyleInfo.setAttribute("aria-hidden","true"),e.atlasMapStyleInfo.id="atlas-map-style",e.atlasMapStyleInfo.classList.add("hidden-accessible-element"),e.updateMapStyle(),e.map.events.add("styledata",e.updateMapStyle),e.map.getCanvasContainer().appendChild(e.atlasMapStyleInfo),e.atlasMapStyleInfo.setAttribute("aria-live","polite")},this.updateMapStyle=function(){e.atlasMapStyleInfo.innerHTML="<p>Map style: "+e.map.getStyle().style+".</p>"},this.updateMapState=function(t){e.atlasMapLiveStateInfo.innerHTML=t},this.map=t},uf=function(t){var a=this;this.callCounter=0,this.listenerEnabled=!1,this.flowComponent=void 0,this.flowPath=void 0,this.addToMap=function(){if(!a.map._isReady())throw new Error("Traffic flow could not be added to the map because the map is not ready. Please use a ready event listener to guarantee the map is ready before enabling traffic flow.");a.listenerEnabled||(a.map.events.add("styledata",a.addToMap),a.listenerEnabled=!0);var t=a.map.getStyle(),e=a.map.getTraffic(),n=a.map.styles.getFlowPath(t,e);if(n&&a.flowPath!==n){a.callCounter++;var o=a.callCounter;a.map.styles.getFlowComponent(t,e).then(function(t){if(a.callCounter===o){a.flowComponent&&(a.map.layers.remove(a.flowComponent.layer),a.map.sources.remove(a.flowComponent.sources),delete a.flowComponent);var e=a.map.layers.getLayers(),i=e.findIndex(function(t){return"transit"===t.getId()}),r=-1!==i?e[i+1]:void 0;a.map.sources.add(t.sources),a.map.layers.add(t.layer,r),a.flowComponent=t,a.flowPath=n}})}},this.removeFromMap=function(){a.callCounter++,a.listenerEnabled&&(a.map.events.remove("styledata",a.addToMap),a.listenerEnabled=!1),a.flowPath&&delete a.flowPath,a.flowComponent&&(a.map.layers.remove(a.flowComponent.layer),a.map.sources.remove(a.flowComponent.sources),delete a.flowComponent)},this.map=t},cf=(b(pf,sf=I),pf);function pf(){var t=null!==sf&&sf.apply(this,arguments)||this;return t.version="1.0",t.bbox=void 0,t.zoom=void 0,t.params={},t}var hf=(df.prototype.request=function(t){var e,i=(new cf).merge(t),r=this.map.getServiceOptions().domain;e=Oo.getWest(i.bbox)<-180&&180<Oo.getEast(i.bbox)?Oo.getSouth(i.bbox)+",-180,"+Oo.getNorth(i.bbox)+",180":Oo.getSouth(i.bbox)+","+ro(Oo.getWest(i.bbox))+","+Oo.getNorth(i.bbox)+","+ro(Oo.getEast(i.bbox));var n={domain:r,path:"traffic/incident/detail/json",queryParams:w({"api-version":i.version,projection:"EPSG4326",style:"s3",boundingbox:e,boundingzoom:i.zoom,trafficmodelid:-1},i.params)};return new P(this.map.authentication.signRequest(n)).get()},df);function df(t){this.map=t}var ff,mf,gf,yf=(b(vf,ff=hn),vf.getIncidentTypeName=function(t,e){switch(t){case 0:return e.Unknown;case 1:return e.Accident;case 2:return e.Fog;case 3:return e.Danger;case 4:return e.Rain;case 5:return e.Ice;case 6:return e.Jam;case 7:return e.LaneClosed;case 8:return e.RoadClosed;case 9:return e.RoadWorks;case 10:return e.Wind;case 11:return e.Flood;case 12:return e.Detour;default:return e.Unknown}},vf.getIncidentTypeIconName=function(t){switch(t){case 0:return"unknown";case 1:return"accident";case 2:return"fog";case 3:return"danger";case 4:return"rain";case 5:return"ice";case 6:return"jam";case 7:return"lane-closed";case 8:return"road-closed";case 9:return"road-work";case 10:return"wind";case 11:return"flood";case 12:return"detour";default:return"unknown"}},vf.getSeverityColorName=function(t){switch(t){case 0:return"grey";case 1:return"yellow";case 2:return"orange";case 3:return"red";case 4:default:return"grey"}},vf.getSeverityColorHexCode=function(t){switch(t){case 0:return"#B5B6B7";case 1:return"#F4C951";case 2:return"#F4873F";case 3:return"#F04F4E";case 4:default:return"#B5B6B7"}},vf);function vf(t,e){var i=new yn(new bo(t.op.x,t.op.y)),r={icon:vf.getSeverityColorName(t.ty)+"-"+vf.getIncidentTypeIconName(t.ic),incidentType:vf.getIncidentTypeName(t.ic,e),description:t.d,length:t.l,delay:t.dl,from:t.f,color:vf.getSeverityColorHexCode(t.ty),to:t.t,id:t.id};return ff.call(this,i,r)||this}(gf=mf=mf||{}).DELAY="delay",gf.LENGTH="length",gf.FROM="from",gf.TO="to";var _f=(xf.build=function(t,e){void 0===e&&(e="en-US");var i=document.createElement("div");i.classList.add("incident-popup-title"),i.classList.add("font-segoeui-b"),i.setAttribute("tabindex","0"),i.innerText=t.properties.incidentType,i.setAttribute("aria-label","Incident Type "+t.properties.incidentType);var r=document.createElement("div");r.classList.add("incident-popup-subtitle"),r.classList.add("font-segoeui-b"),r.setAttribute("aria-label","Incident Description "+t.properties.description),r.setAttribute("tabindex","0"),r.innerText=t.properties.description;var n=document.createElement("div");n.classList.add("incident-popup-header"),n.style.backgroundColor=t.properties.color,n.appendChild(i),n.appendChild(r);var o=document.createElement("div");if(o.classList.add("incident-popup-body"),t.properties.delay){var a=Math.floor(t.properties.delay/60)+" min",s=this.createInfoSection(a,mf.DELAY);o.appendChild(s)}if(t.properties.length){var l=new Intl.NumberFormat([e,"en-US"],{maximumFractionDigits:2}),u=void 0;if("en-US"===e){var c=Kn(t.properties.length,"meters","miles");u=l.format(c)+" miles"}else{var p=Kn(t.properties.length,"meters","kilometers");u=l.format(p)+" km"}var h=this.createInfoSection(u,mf.LENGTH);o.appendChild(h)}if(t.properties.from){var d=this.createInfoSection(t.properties.from,mf.FROM);o.appendChild(d)}if(t.properties.to){var f=this.createInfoSection(t.properties.to,mf.TO);o.appendChild(f)}var m=document.createElement("div");return m.classList.add("incident-popup-content"),m.appendChild(n),m.appendChild(o),new Fs({content:m,position:t.geometry.coordinates})},xf.createInfoSection=function(t,e){var i=document.createElement("div");i.classList.add("incident-popup-info");var r=document.createElement("div");r.classList.add("icon"),r.classList.add(e);var n=document.createElement("span");return n.classList.add("message"),n.classList.add("font-segoeui"),n.setAttribute("aria-label","Incident "+e+" "+t),n.setAttribute("tabindex","0"),n.innerText=t,i.appendChild(r),i.appendChild(n),i},xf);function xf(){}var bf,wf=function(t){var p=this;this.incidentLayerName="incidents",this.popups=new kr,this.addToMap=function(){p.map.addPins([],{name:p.incidentLayerName,cluster:!1}),p.map.addEventListener("mouseenter",p.incidentLayerName,p.cursorToPointer),p.map.addEventListener("mouseleave",p.incidentLayerName,p.cursorToDefault),p.map.addEventListener("click",p.incidentLayerName,p.openIncidentPopup),p.map.events.add("moveend",p.updateIncidents),p.map.events.add("styledata",p.updateLanguage),p.updateIncidents()},this.removeFromMap=function(){p.map.removeLayers([p.incidentLayerName]),p.map.removeEventListener("click",p.incidentLayerName,p.openIncidentPopup),p.map.removeEventListener("mouseenter",p.incidentLayerName,p.cursorToPointer),p.map.removeEventListener("mouseleave",p.incidentLayerName,p.cursorToDefault),p.map.events.remove("moveend",p.updateIncidents),p.map.events.remove("styledata",p.updateLanguage),p.cleanUpPopups()},this.updateIncidents=function(){var t=Math.ceil(p.map.getCamera().zoom),c=p.map.getCamera().bounds;p.incidentLanguage=p.map.getStyle().language;var e=p.map._getLocalizedStrings(),i=p.incidentService.request({bbox:c,zoom:t,params:{expandCluster:!0,originalPosition:!0,language:p.incidentLanguage}});Promise.all([i,e]).then(function(t){var e=t[0],r=t[1];if(p.map.getTraffic().incidents){var n=[];p.cleanUpPopups();for(var i=0,o=e.tm.poi||[];i<o.length;i++)for(var a=o[i],s=function(t){if(Oo.containsPosition(c,[t.op.x,t.op.y])){var e=new yf(t,r);n.push(e);var i=_f.build(e,p.incidentLanguage);p.popups.set(e.properties.id,i),p.map.events.add("open",i,function(){p.openPopupId=e.properties.id,p.popups.forEach(function(t,e){p.openPopupId!==e&&t.close()})}),p.map.events.add("close",i,function(){p.openPopupId===e.properties.id&&delete p.openPopupId}),p.openPopupId===e.properties.id?p.popups.get(e.properties.id).open(p.map):p.popups.get(e.properties.id).attach(p.map)}},l=0,u=a.cpoi||[a];l<u.length;l++)s(u[l]);p.map.addPins(n,{overwrite:!0,name:p.incidentLayerName})}})},this.cursorToPointer=function(t){p.map.getCanvas().style.cursor="pointer"},this.cursorToDefault=function(t){p.map.getCanvas().style.cursor=""},this.openIncidentPopup=function(t){var e=t.features[0].properties.id;p.popups.has(e)&&p.popups.get(e).open(p.map)},this.cleanUpPopups=function(){p.popups.forEach(function(t){t.remove()}),p.popups.clear()},this.updateLanguage=function(){p.map.getStyle().language!==p.incidentLanguage&&p.updateIncidents()},this.map=t,this.incidentService=new hf(this.map)},Sf=(b(Tf,bf=I),Tf);function Tf(){var t=null!==bf&&bf.apply(this,arguments)||this;return t.interactive=!0,t.scrollZoomInteraction=!0,t.boxZoomInteraction=!0,t.dragRotateInteraction=!0,t.dragPanInteraction=!0,t.keyboardInteraction=!0,t.dblClickZoomInteraction=!0,t.touchInteraction=!0,t.wheelZoomRate=1/450,t}var If=(Ef.prototype.enable=function(){this.map.getMapContainer().addEventListener("keydown",this._onKeyDown)},Ef.prototype.disable=function(){this.map.getMapContainer().removeEventListener("keydown",this._onKeyDown)},Ef);function Ef(t){var e=this;this._onKeyDown=function(t){27===t.keyCode&&e.map.getCanvas().focus()},this.map=t}var Cf=(Af.prototype.enable=function(){this.map._getMap().on("touchstart",this._onTouchStart),this.map._getMap().on("touchmove",this._onTouchMove),this.map._getMap().on("touchend",this._onTouchEnd),this.map._getMap().on("touchcancel",this._onTouchCancel)},Af.prototype.disable=function(){this.map._getMap().off("touchstart",this._onTouchStart),this.map._getMap().off("touchmove",this._onTouchMove),this.map._getMap().off("touchend",this._onTouchEnd),this.map._getMap().off("touchcancel",this._onTouchCancel)},Af);function Af(t){var o=this;this.minDiffX=70,this.maxDiffY=100,this.minDiff=30,this.delay=160,this._onTouchStart=function(t){if(2===t.points.length){var e=t.points[0].y-t.points[1].y,i=t.points[0].x-t.points[1].x;Math.abs(i)>=o.minDiffX&&Math.abs(e)<=o.maxDiffY&&(t.originalEvent.preventDefault(),o.map._getMap().touchZoomRotate.disable(),o.map._getMap().dragPan.disable(),o.dpPoint=t.point,o.dpPitch=o.map._getMap().getPitch(),o.startTiming=Date.now(),o.startDistance=Math.hypot(i,e),o.startEventData=t)}},this._onTouchMove=function(t){if(void 0!==o.dpPoint&&void 0!==o.dpPitch){t.preventDefault(),t.originalEvent.preventDefault();var e=t.points[0].y-t.points[1].y,i=t.points[0].x-t.points[1].x,r=Math.hypot(i,e);if(Math.abs(r-o.startDistance)>=o.minDiff)return o.dpPoint&&(o.map._getMap().touchZoomRotate.enable(),o.map._getMap().dragPan.enable(),o.map._getMap().touchZoomRotate.onStart(Date.now()-o.startTiming>=o.delay?t.originalEvent:o.startEventData.originalEvent)),void(o.dpPoint=void 0);if(Date.now()-o.startTiming>=o.delay){var n=.5*(o.dpPoint.y-t.point.y);o.map._getMap().setPitch(o.dpPitch+n)}}},this._onTouchEnd=function(){o.dpPoint&&(o.map._getMap().touchZoomRotate.enable(),o.map._getMap().dragPan.enable()),o.dpPoint=void 0},this._onTouchCancel=function(){o.dpPoint&&(o.map._getMap().touchZoomRotate.enable(),o.map._getMap().dragPan.enable()),o.dpPoint=void 0},this.map=t}var kf=(Pf.prototype.enable=function(){this.map.getCanvasContainer().addEventListener("gesturestart",this._onGestureStart),this.map.getCanvasContainer().addEventListener("gesturechange",this._onGestureChange),this.map.getCanvasContainer().addEventListener("touchstart",this._onTouchStart),this.map.getCanvasContainer().addEventListener("touchend",this._onTouchEnd)},Pf.prototype.disable=function(){this.map.getCanvasContainer().removeEventListener("gesturestart",this._onGestureStart),this.map.getCanvasContainer().removeEventListener("gesturechange",this._onGestureChange),this.map.getCanvasContainer().removeEventListener("touchstart",this._onTouchStart),this.map.getCanvasContainer().removeEventListener("touchend",this._onTouchEnd)},Pf);function Pf(t){var e=this;this._onGestureStart=function(t){e.hasTouch||(t.preventDefault(),e.initZoom=e.map.getCamera().zoom)},this._onGestureChange=function(t){e.hasTouch||(t.preventDefault(),e.map.setCamera({zoom:e.initZoom+t.scale-1}))},this._onTouchStart=function(t){e.hasTouch=!0},this._onTouchEnd=function(t){0===t.touches.length&&(e.hasTouch=!1)},this.map=t}var Mf=(Lf.prototype.addToMap=function(){this.added||(this.added=!0,this._setInteractions(this.options))},Lf.prototype.removeFromMap=function(){this.added&&(this.added=!1,this._setInteractions({interactive:!1}))},Lf.prototype.setOptions=function(t){this.options=(new Sf).merge(this.options,t),this.added&&this._setInteractions(this.options)},Lf.prototype.getOptions=function(){return Object.assign({},this.options)},Lf.prototype._setInteractions=function(t){t.interactive?(t.boxZoomInteraction?this.map._getMap().boxZoom.enable():this.map._getMap().boxZoom.disable(),t.dblClickZoomInteraction?this.map._getMap().doubleClickZoom.enable():this.map._getMap().doubleClickZoom.disable(),t.dragPanInteraction?this.map._getMap().dragPan.enable():this.map._getMap().dragPan.disable(),t.dragRotateInteraction?this.map._getMap().dragRotate.enable():this.map._getMap().dragRotate.disable(),t.keyboardInteraction?(this.map._getMap().keyboard.enable(),this.focusShortcut.enable()):(this.map._getMap().keyboard.disable(),this.focusShortcut.disable()),t.scrollZoomInteraction?(this.map._getMap().scrollZoom.enable(),this.map._getMap().scrollZoom.setWheelZoomRate(t.wheelZoomRate)):this.map._getMap().scrollZoom.disable(),t.touchInteraction?(this.map._getMap().touchZoomRotate.enable(),this.mobilePitch.enable()):(this.map._getMap().touchZoomRotate.disable(),this.mobilePitch.disable()),this.pinchZoom.enable()):(this.map._getMap().boxZoom.disable(),this.map._getMap().doubleClickZoom.disable(),this.map._getMap().dragPan.disable(),this.map._getMap().dragRotate.disable(),this.map._getMap().keyboard.disable(),this.focusShortcut.disable(),this.map._getMap().scrollZoom.disable(),this.map._getMap().touchZoomRotate.disable(),this.mobilePitch.disable(),this.pinchZoom.disable())},Lf);function Lf(t,e){this.added=!1,this.map=t,this.mobilePitch=new Cf(t),this.focusShortcut=new If(t),this.pinchZoom=new kf(t),this.options=(new Sf).merge(e)}var Df=e(function(t){var e=(e=function(t){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",UNKNOWN:"UNKNOWN"},this.RESPONSE_TYPE={ID_TOKEN_TOKEN:"id_token token",TOKEN:"token"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",ERROR:"error",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error",RENEW_STATUS:"adal.token.renew.status",ANGULAR_LOGIN_REQUEST:"adal.angular.login.request"},RESOURCE_DELIMETER:"|",CACHE_DELIMETER:"||",LOADFRAME_TIMEOUT:6e3,TOKEN_RENEW_STATUS_CANCELED:"Canceled",TOKEN_RENEW_STATUS_COMPLETED:"Completed",TOKEN_RENEW_STATUS_IN_PROGRESS:"In Progress",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:"ERROR:",1:"WARNING:",2:"INFO:",3:"VERBOSE:"},POPUP_WIDTH:483,POPUP_HEIGHT:600},e.prototype._singletonInstance)return e.prototype._singletonInstance;if((e.prototype._singletonInstance=this).instance="https://login.microsoftonline.com/",this.config={},this.callback=null,this.popUp=!1,this.isAngular=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._callBackMappedToRenewStates={},this._callBacksMappedToRenewStates={},this._openedWindows=[],this._requestType=this.REQUEST_TYPE.LOGIN,window._adalInstance=this,t.displayCall&&"function"!=typeof t.displayCall)throw new Error("displayCall is not a function");if(!t.clientId)throw new Error("clientId is required");this.config=this._cloneConfig(t),void 0===this.config.navigateToLoginRequestUrl&&(this.config.navigateToLoginRequestUrl=!0),this.config.popUp&&(this.popUp=!0),this.config.callback&&"function"==typeof this.config.callback&&(this.callback=this.config.callback),this.config.instance&&(this.instance=this.config.instance),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.postLogoutRedirectUri||(this.config.postLogoutRedirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.anonymousEndpoints||(this.config.anonymousEndpoints=[]),this.config.isAngular&&(this.isAngular=this.config.isAngular),this.config.loadFrameTimeout&&(this.CONSTANTS.LOADFRAME_TIMEOUT=this.config.loadFrameTimeout)},"undefined"!=typeof window&&(window.Logging={piiLoggingEnabled:!1,level:0,log:function(t){}}),e.prototype.login=function(){if(this._loginInProgress)this.info("Login in progress");else{this._loginInProgress=!0;var t=this._guid();this.config.state=t,this._idTokenNonce=this._guid();var e=this._getItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST);e&&""!==e?this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""):e=window.location.href,this.verbose("Expected state: "+t+" startPage:"+e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,t,!0),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var i=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce);this.config.displayCall?this.config.displayCall(i):this.popUp?(this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates.push(t),this.registerCallback(t,this.config.clientId,this.callback),this._loginPopup(i)):this.promptUser(i)}},e.prototype._openPopup=function(t,e,i,r){try{var n=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,l=a/2-i/2+n,u=s/2-r/2+o,c=window.open(t,e,"width="+i+", height="+r+", top="+u+", left="+l);return c.focus&&c.focus(),c}catch(t){return this.warn("Error opening popup, "+t.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},e.prototype._handlePopupError=function(t,e,i,r,n){this.warn(r),this._saveItem(this.CONSTANTS.STORAGE.ERROR,i),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,r),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,n),e&&this._activeRenewals[e]&&(this._activeRenewals[e]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,t&&t(r,null,i)},e.prototype._loginPopup=function(t,r,e){var n=this._openPopup(t,"login",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),o=e||this.callback;if(null!=n){if(this._openedWindows.push(n),-1!=this.config.redirectUri.indexOf("#"))var a=this.config.redirectUri.split("#")[0];else a=this.config.redirectUri;var s=this,l=window.setInterval(function(){if(!n||n.closed||void 0===n.closed){var t="Popup Window closed",e="Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge";return s.isAngular&&s._broadcast("adal:popUpClosed",e+s.CONSTANTS.RESOURCE_DELIMETER+t),s._handlePopupError(o,r,t,e,e),void window.clearInterval(l)}try{var i=n.location;if(-1!=encodeURI(i.href).indexOf(encodeURI(a)))return s.isAngular?s._broadcast("adal:popUpHashChanged",i.hash):s.handleWindowCallback(i.hash),window.clearInterval(l),s._loginInProgress=!1,s._acquireTokenInProgress=!1,s.info("Closing popup window"),s._openedWindows=[],void n.close()}catch(t){}},1)}else{var i="Popup Window is null. This can happen if you are using IE";this._handlePopupError(o,r,"Error opening popup",i,i)}},e.prototype._broadcast=function(t,e){function i(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),i}"function"!=typeof window.CustomEvent&&(i.prototype=window.Event.prototype,window.CustomEvent=i);var r=new CustomEvent(t,{detail:e});window.dispatchEvent(r)},e.prototype.loginInProgress=function(){return this._loginInProgress},e.prototype._hasResource=function(t){var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return e&&!this._isEmpty(e)&&-1<e.indexOf(t+this.CONSTANTS.RESOURCE_DELIMETER)},e.prototype.getCachedToken=function(t){if(!this._hasResource(t))return null;var e=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t),i=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t),r=this.config.expireOffsetSeconds||300;return i&&i>this._now()+r?e:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,0),null)},e.prototype.getCachedUser=function(){if(this._user)return this._user;var t=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(t),this._user},e.prototype.registerCallback=function(o,a,t){this._activeRenewals[a]=o,this._callBacksMappedToRenewStates[o]||(this._callBacksMappedToRenewStates[o]=[]);var s=this;this._callBacksMappedToRenewStates[o].push(t),this._callBackMappedToRenewStates[o]||(this._callBackMappedToRenewStates[o]=function(t,e,i,r){s._activeRenewals[a]=null;for(var n=0;n<s._callBacksMappedToRenewStates[o].length;++n)try{s._callBacksMappedToRenewStates[o][n](t,e,i,r)}catch(i){s.warn(i)}s._callBacksMappedToRenewStates[o]=null,s._callBackMappedToRenewStates[o]=null})},e.prototype._renewToken=function(t,e,i){this.info("renewToken is called for resource:"+t);var r=this._addAdalFrame("adalRenewFrame"+t),n=this._guid()+"|"+t;this.config.state=n,this._renewStates.push(n),this.verbose("Renew token Expected state: "+n),i=i||"token";var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl(i,t),"prompt");i===this.RESPONSE_TYPE.ID_TOKEN_TOKEN&&(this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),o+="&nonce="+encodeURIComponent(this._idTokenNonce)),o+="&prompt=none",o=this._addHintParameters(o),this.registerCallback(n,t,e),this.verbosePii("Navigate to:"+o),r.src="about:blank",this._loadFrameTimeout(o,"adalRenewFrame"+t,t)},e.prototype._renewIdToken=function(t,e){this.info("renewIdToken is called");var i=this._addAdalFrame("adalIdTokenFrame"),r=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this.config.state=r,this._renewStates.push(r),this.verbose("Renew Idtoken Expected state: "+r);var n=null==e?null:this.config.clientId,o=(e=e||"id_token",this._urlRemoveQueryStringParameter(this._getNavigateUrl(e,n),"prompt"));o+="&prompt=none",o=this._addHintParameters(o),o+="&nonce="+encodeURIComponent(this._idTokenNonce),this.registerCallback(r,this.config.clientId,t),this.verbosePii("Navigate to:"+o),i.src="about:blank",this._loadFrameTimeout(o,"adalIdTokenFrame",this.config.clientId)},e.prototype._urlContainsQueryStringParameter=function(t,e){return new RegExp("[\\?&]"+t+"=").test(e)},e.prototype._urlRemoveQueryStringParameter=function(t,e){var i=new RegExp("(\\&"+e+"=)[^&]+");return t=t.replace(i,""),i=new RegExp("("+e+"=)[^&]+&"),t=t.replace(i,""),i=new RegExp("("+e+"=)[^&]+"),t=t.replace(i,"")},e.prototype._loadFrameTimeout=function(t,e,i){this.verbose("Set loading state to pending for: "+i),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+i,this.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS),this._loadFrame(t,e);var r=this;setTimeout(function(){if(r._getItem(r.CONSTANTS.STORAGE.RENEW_STATUS+i)===r.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS){r.verbose("Loading frame has timed out after: "+r.CONSTANTS.LOADFRAME_TIMEOUT/1e3+" seconds for resource "+i);var t=r._activeRenewals[i];t&&r._callBackMappedToRenewStates[t]&&r._callBackMappedToRenewStates[t]("Token renewal operation failed due to timeout",null,"Token Renewal Failed"),r._saveItem(r.CONSTANTS.STORAGE.RENEW_STATUS+i,r.CONSTANTS.TOKEN_RENEW_STATUS_CANCELED)}},r.CONSTANTS.LOADFRAME_TIMEOUT)},e.prototype._loadFrame=function(e,t){var i=this;i.info("LoadFrame: "+t);var r=t;setTimeout(function(){var t=i._addAdalFrame(r);""!==t.src&&"about:blank"!==t.src||(t.src=e,i._loadFrame(e,r))},500)},e.prototype.acquireToken=function(t,e){if(this._isEmpty(t))return this.warn("resource is required"),void e("resource is required",null,"resource is required");var i=this.getCachedToken(t);return i?(this.info("Token is already in cache for resource:"+t),void e(null,i,null)):this._user||this.config.extraQueryParameter&&-1!==this.config.extraQueryParameter.indexOf("login_hint")?void(this._activeRenewals[t]?this.registerCallback(this._activeRenewals[t],t,e):(this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,t===this.config.clientId?this._user?(this.verbose("renewing idtoken"),this._renewIdToken(e)):(this.verbose("renewing idtoken and access_token"),this._renewIdToken(e,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)):this._user?(this.verbose("renewing access_token"),this._renewToken(t,e)):(this.verbose("renewing idtoken and access_token"),this._renewToken(t,e,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)))):(this.warn("User login is required"),void e("User login is required",null,"login required"))},e.prototype.acquireTokenPopup=function(t,e,i,r){if(this._isEmpty(t))return this.warn("resource is required"),void r("resource is required",null,"resource is required");if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var n=this._guid()+"|"+t;this.config.state=n,this._renewStates.push(n),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose("Renew token Expected state: "+n);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",t),"prompt");if(o+="&prompt=select_account",e&&(o+=e),i&&-1===o.indexOf("&claims"))o+="&claims="+encodeURIComponent(i);else if(i&&-1!==o.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");o=this._addHintParameters(o),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+t),this.registerCallback(n,t,r),this._loginPopup(o,t,r)},e.prototype.acquireTokenRedirect=function(t,e,i){if(this._isEmpty(t))return this.warn("resource is required"),void r("resource is required",null,"resource is required");var r=this.callback;if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var n=this._guid()+"|"+t;this.config.state=n,this.verbose("Renew token Expected state: "+n);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",t),"prompt");if(o+="&prompt=select_account",e&&(o+=e),i&&-1===o.indexOf("&claims"))o+="&claims="+encodeURIComponent(i);else if(i&&-1!==o.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");o=this._addHintParameters(o),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,n,!0),this.promptUser(o)},e.prototype.promptUser=function(t){t?(this.infoPii("Navigate to:"+t),window.location.replace(t)):this.info("Navigate url is empty")},e.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"");var t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(t)){t=t.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var e=0;e<t.length&&""!==t[e];e++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t[e],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t[e],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},e.prototype.clearCacheForResource=function(t){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(t)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,0))},e.prototype.logOut=function(){var t;if(this.clearCache(),this._user=null,this.config.logOutUri)t=this.config.logOutUri;else{var e="common",i="";this.config.tenant&&(e=this.config.tenant),this.config.postLogoutRedirectUri&&(i="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri)),t=this.instance+e+"/oauth2/logout?"+i}this.infoPii("Logout navigate to: "+t),this.promptUser(t)},e.prototype._isEmpty=function(t){return void 0===t||!t||0===t.length},e.prototype.getUser=function(t){if("function"!=typeof t)throw new Error("callback is not a function");if(this._user)t(null,this._user);else{var e=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);this._isEmpty(e)?(this.warn("User information is not available"),t("User information is not available",null)):(this.info("User exists in cache: "),this._user=this._createUser(e),t(null,this._user))}},e.prototype._addHintParameters=function(t){if(this._user&&this._user.profile)if(this._user.profile.sid&&-1!==t.indexOf("&prompt=none"))this._urlContainsQueryStringParameter("sid",t)||(t+="&sid="+encodeURIComponent(this._user.profile.sid));else if(this._user.profile.upn&&(this._urlContainsQueryStringParameter("login_hint",t)||(t+="&login_hint="+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter("domain_hint",t)&&-1<this._user.profile.upn.indexOf("@"))){var e=this._user.profile.upn.split("@");t+="&domain_hint="+encodeURIComponent(e[e.length-1])}return t},e.prototype._createUser=function(t){var e=null,i=this._extractIdToken(t);return i&&i.hasOwnProperty("aud")&&(i.aud.toLowerCase()===this.config.clientId.toLowerCase()?(e={userName:"",profile:i},i.hasOwnProperty("upn")?e.userName=i.upn:i.hasOwnProperty("email")&&(e.userName=i.email)):this.warn("IdToken has invalid aud field")),e},e.prototype._getHash=function(t){return-1<t.indexOf("#/")?t=t.substring(t.indexOf("#/")+2):-1<t.indexOf("#")&&(t=t.substring(1)),t},e.prototype.isCallback=function(t){t=this._getHash(t);var e=this._deserialize(t);return e.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||e.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||e.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},e.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},e.prototype.getRequestInfo=function(t){t=this._getHash(t);var e=this._deserialize(t),i={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(e&&((i.parameters=e).hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||e.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||e.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){i.valid=!0;var r="";if(!e.hasOwnProperty("state"))return this.warn("No state returned"),i;if(this.verbose("State: "+e.state),r=e.state,i.stateResponse=r,this._matchState(i))return i;if(!i.stateMatch&&window.parent){i.requestType=this._requestType;for(var n=this._renewStates,o=0;o<n.length;o++)if(n[o]===i.stateResponse){i.stateMatch=!0;break}}}return i},e.prototype._matchNonce=function(t){var e=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(e){e=e.split(this.CONSTANTS.CACHE_DELIMETER);for(var i=0;i<e.length;i++)if(e[i]===t.profile.nonce)return!0}return!1},e.prototype._matchState=function(t){var e=this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN);if(e){e=e.split(this.CONSTANTS.CACHE_DELIMETER);for(var i=0;i<e.length;i++)if(e[i]===t.stateResponse)return t.requestType=this.REQUEST_TYPE.LOGIN,t.stateMatch=!0}var r=this._getItem(this.CONSTANTS.STORAGE.STATE_RENEW);if(r)for(r=r.split(this.CONSTANTS.CACHE_DELIMETER),i=0;i<r.length;i++)if(r[i]===t.stateResponse)return t.requestType=this.REQUEST_TYPE.RENEW_TOKEN,t.stateMatch=!0;return!1},e.prototype._getResourceFromState=function(t){if(t){var e=t.indexOf("|");if(-1<e&&e+1<t.length)return t.substring(e+1)}return""},e.prototype.saveTokenFromHash=function(t){this.info("State status:"+t.stateMatch+"; Request type:"+t.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var e,i=this._getResourceFromState(t.stateResponse);t.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)?(this.infoPii("Error :"+t.parameters.error+"; Error description:"+t.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,t.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,t.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),t.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,t.parameters.error_description))):t.stateMatch?(this.info("State is right"),t.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,t.parameters[this.CONSTANTS.SESSION_STATE]),t.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this.info("Fragment has access token"),this._hasResource(i)||(e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,e+i+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+i,t.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+i,this._expiresIn(t.parameters[this.CONSTANTS.EXPIRES_IN]))),t.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info("Fragment has id token"),this._loginInProgress=!1,this._user=this._createUser(t.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile?this._matchNonce(this._user)?(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,t.parameters[this.CONSTANTS.ID_TOKEN]),i=this.config.loginResource?this.config.loginResource:this.config.clientId,this._hasResource(i)||(e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,e+i+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+i,t.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+i,this._user.profile.exp)):(this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"Nonce received: "+this._user.profile.nonce+" is not same as requested: "+this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)),this._user=null):(t.parameters.error="invalid id_token",t.parameters.error_description="Invalid id_token. id_token: "+t.parameters[this.CONSTANTS.ID_TOKEN],this._saveItem(this.CONSTANTS.STORAGE.ERROR,"invalid id_token"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid id_token. id_token: "+t.parameters[this.CONSTANTS.ID_TOKEN])))):(t.parameters.error="Invalid_state",t.parameters.error_description="Invalid_state. state: "+t.stateResponse,this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state. state: "+t.stateResponse)),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+i,this.CONSTANTS.TOKEN_RENEW_STATUS_COMPLETED)},e.prototype.getResourceForEndpoint=function(t){if(this.config&&this.config.anonymousEndpoints)for(var e=0;e<this.config.anonymousEndpoints.length;e++)if(-1<t.indexOf(this.config.anonymousEndpoints[e]))return null;if(this.config&&this.config.endpoints)for(var i in this.config.endpoints)if(-1<t.indexOf(i))return this.config.endpoints[i];return(-1<t.indexOf("http://")||-1<t.indexOf("https://"))&&this._getHostFromUri(t)!==this._getHostFromUri(this.config.redirectUri)?null:this.config.loginResource},e.prototype._getHostFromUri=function(t){var e=String(t).replace(/^(https?:)\/\//,"");return e=e.split("/")[0]},e.prototype.handleWindowCallback=function(t){if(null==t&&(t=window.location.hash),this.isCallback(t)){var e=null,i=!1;0<this._openedWindows.length&&this._openedWindows[this._openedWindows.length-1].opener&&this._openedWindows[this._openedWindows.length-1].opener._adalInstance?(e=this._openedWindows[this._openedWindows.length-1].opener._adalInstance,i=!0):window.parent&&window.parent._adalInstance&&(e=window.parent._adalInstance);var r,n,o=e.getRequestInfo(t),a=null;n=i||window.parent!==window?e._callBackMappedToRenewStates[o.stateResponse]:e.callback,e.info("Returned from redirect url"),e.saveTokenFromHash(o),o.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(window.parent!==window?e.verbose("Window is in iframe, acquiring token silently"):e.verbose("acquiring token interactive in progress"),r=o.parameters[e.CONSTANTS.ACCESS_TOKEN]||o.parameters[e.CONSTANTS.ID_TOKEN],a=e.CONSTANTS.ACCESS_TOKEN):o.requestType===this.REQUEST_TYPE.LOGIN&&(r=o.parameters[e.CONSTANTS.ID_TOKEN],a=e.CONSTANTS.ID_TOKEN);var s=o.parameters[e.CONSTANTS.ERROR_DESCRIPTION],l=o.parameters[e.CONSTANTS.ERROR];try{n&&n(s,r,l,a)}catch(t){e.error("Error occurred in user defined callback function: "+t)}window.parent!==window||i||(e.config.navigateToLoginRequestUrl?window.location.href=e._getItem(e.CONSTANTS.STORAGE.LOGIN_REQUEST):window.location.hash="")}},e.prototype._getNavigateUrl=function(t,e){var i="common";this.config.tenant&&(i=this.config.tenant);var r=this.instance+i+"/oauth2/authorize"+this._serialize(t,this.config,e)+this._addLibMetadata();return this.info("Navigate url:"+r),r},e.prototype._extractIdToken=function(t){var e=this._decodeJwt(t);if(!e)return null;try{var i=e.JWSPayload,r=this._base64DecodeStringUrlSafe(i);return r?JSON.parse(r):(this.info("The returned id_token could not be base64 url safe decoded."),null)}catch(t){this.error("The returned id_token could not be decoded",t)}return null},e.prototype._base64DecodeStringUrlSafe=function(t){return t=t.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(t))):decodeURIComponent(escape(this._decode(t)))},e.prototype._decode=function(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=(t=String(t).replace(/=+$/,"")).length;if(i%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var r,n,o,a,s,l,u,c,p="",h=0;h<i;h+=4){if(r=e.indexOf(t.charAt(h)),n=e.indexOf(t.charAt(h+1)),o=e.indexOf(t.charAt(h+2)),a=e.indexOf(t.charAt(h+3)),h+2===i-1){l=(s=r<<18|n<<12|o<<6)>>16&255,u=s>>8&255,p+=String.fromCharCode(l,u);break}if(h+1===i-1){l=(s=r<<18|n<<12)>>16&255,p+=String.fromCharCode(l);break}l=(s=r<<18|n<<12|o<<6|a)>>16&255,u=s>>8&255,c=255&s,p+=String.fromCharCode(l,u,c)}return p},e.prototype._decodeJwt=function(t){if(this._isEmpty(t))return null;var e=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);return!e||e.length<4?(this.warn("The returned id_token is not parseable."),null):{header:e[1],JWSPayload:e[2],JWSSig:e[3]}},e.prototype._convertUrlSafeToRegularBase64EncodedString=function(t){return t.replace("-","+").replace("_","/")},e.prototype._serialize=function(t,e,i){var r=[];if(null!==e){r.push("?response_type="+t),r.push("client_id="+encodeURIComponent(e.clientId)),i&&r.push("resource="+encodeURIComponent(i)),r.push("redirect_uri="+encodeURIComponent(e.redirectUri)),r.push("state="+encodeURIComponent(e.state)),e.hasOwnProperty("slice")&&r.push("slice="+encodeURIComponent(e.slice)),e.hasOwnProperty("extraQueryParameter")&&r.push(e.extraQueryParameter);var n=e.correlationId?e.correlationId:this._guid();r.push("client-request-id="+encodeURIComponent(n))}return r.join("&")},e.prototype._deserialize=function(t){function e(t){return decodeURIComponent(t.replace(r," "))}var i,r=/\+/g,n=/([^&=]+)=([^&]*)/g,o={};for(i=n.exec(t);i;)o[e(i[1])]=e(i[2]),i=n.exec(t);return o},e.prototype._decimalToHex=function(t){for(var e=t.toString(16);e.length<2;)e="0"+e;return e},e.prototype._guid=function(){var t=window.crypto||window.msCrypto;if(t&&t.getRandomValues){var e=new Uint8Array(16);return t.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,this._decimalToHex(e[0])+this._decimalToHex(e[1])+this._decimalToHex(e[2])+this._decimalToHex(e[3])+"-"+this._decimalToHex(e[4])+this._decimalToHex(e[5])+"-"+this._decimalToHex(e[6])+this._decimalToHex(e[7])+"-"+this._decimalToHex(e[8])+this._decimalToHex(e[9])+"-"+this._decimalToHex(e[10])+this._decimalToHex(e[11])+this._decimalToHex(e[12])+this._decimalToHex(e[13])+this._decimalToHex(e[14])+this._decimalToHex(e[15])}for(var i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",n=0,o="",a=0;a<36;a++)"-"!==i[a]&&"4"!==i[a]&&(n=16*Math.random()|0),"x"===i[a]?o+=r[n]:"y"===i[a]?(n&=3,o+=r[n|=8]):o+=i[a];return o},e.prototype._expiresIn=function(t){return t=t||3599,this._now()+parseInt(t,10)},e.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},e.prototype._addAdalFrame=function(t){if(void 0!==t){this.info("Add adal frame to document:"+t);var e=document.getElementById(t);if(!e){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var i=document.createElement("iframe");i.setAttribute("id",t),i.setAttribute("aria-hidden","true"),i.style.visibility="hidden",i.style.position="absolute",i.style.width=i.style.height=i.borderWidth="0px",e=document.getElementsByTagName("body")[0].appendChild(i)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+t+'" id="'+t+'" style="display:none"></iframe>');window.frames&&window.frames[t]&&(e=window.frames[t])}return e}},e.prototype._saveItem=function(t,e,i){if(this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation){if(!this._supportsLocalStorage())return this.info("Local storage is not supported"),!1;if(i){var r=this._getItem(t)||"";localStorage.setItem(t,r+e+this.CONSTANTS.CACHE_DELIMETER)}else localStorage.setItem(t,e);return!0}return this._supportsSessionStorage()?(sessionStorage.setItem(t,e),!0):(this.info("Session storage is not supported"),!1)},e.prototype._getItem=function(t){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(t):(this.info("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(t):(this.info("Session storage is not supported"),null)},e.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem("storageTest","A"),"A"==window.localStorage.getItem("storageTest")&&(window.localStorage.removeItem("storageTest"),!window.localStorage.getItem("storageTest")))}catch(t){return!1}},e.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem("storageTest","A"),"A"==window.sessionStorage.getItem("storageTest")&&(window.sessionStorage.removeItem("storageTest"),!window.sessionStorage.getItem("storageTest")))}catch(t){return!1}},e.prototype._cloneConfig=function(t){if(null===t||"object"!=typeof t)return t;var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},e.prototype._addLibMetadata=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()},e.prototype.log=function(t,e,i,r){if(t<=Logging.level){if(!Logging.piiLoggingEnabled&&r)return;var n=(new Date).toUTCString(),o="";o=this.config.correlationId?n+":"+this.config.correlationId+"-"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[t]+" "+e:n+":"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[t]+" "+e,i&&(o+="\nstack:\n"+i.stack),Logging.log(o)}},e.prototype.error=function(t,e){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,t,e)},e.prototype.warn=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,t,null)},e.prototype.info=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,t,null)},e.prototype.verbose=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,t,null)},e.prototype.errorPii=function(t,e){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,t,e,!0)},e.prototype.warnPii=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,t,null,!0)},e.prototype.infoPii=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,t,null,!0)},e.prototype.verbosePii=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,t,null,!0)},e.prototype._libVersion=function(){return"1.0.17"},t.exports&&(t.exports=e,t.exports.inject=function(t){return new e(t)}),e)});Df.inject;function zf(t){this.message=t}(zf.prototype=new Error).name="InvalidCharacterError";var Of="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new zf("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,r,n=0,o=0,a="";r=e.charAt(o++);~r&&(i=n%4?64*i+r:r,n++%4)&&(a+=String.fromCharCode(255&i>>(-2*n&6))))r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return a};function Rf(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return decodeURIComponent(Of(e).replace(/(.)/g,function(t,e){var i=e.charCodeAt(0).toString(16).toUpperCase();return i.length<2&&(i="0"+i),"%"+i}))}catch(t){return Of(e)}}function Nf(t){this.message=t}(Nf.prototype=new Error).name="InvalidTokenError";function Bf(t,e){if("string"!=typeof t)throw new Nf("Invalid token specified");var i=!0===(e=e||{}).header?0:1;try{return JSON.parse(Rf(t.split(".")[i]))}catch(t){throw new Nf("Invalid token specified: "+t.message)}}Bf.InvalidTokenError=Nf;var Ff=(Uf.prototype.initialize=function(){var i=this;return this.initPromise||(this.initPromise=new Promise(function(t,e){if(i.options.authType===p.AuthenticationType.subscriptionKey)t();else if(i.options.authType===p.AuthenticationType.aad){if(i.options.authContext=i.options.authContext||Uf.getDefaultAuthContext(i.options),i.options.authContext.handleWindowCallback(),i.options.authContext.getLoginError())return void e(new Error("Error logging in the AAD users: "+i.options.authContext.getLoginError()));if(i.options.authContext.isCallback(window.location.hash))return void i.map.dispose();setTimeout(function(){return i._loginAndAcquire(t,e)})}else i.options.authType===p.AuthenticationType.anonymous?t(i._triggerTokenFetch()):e(new Error("An invalid authentication type was specified."))})),this.initPromise},Uf.getDefaultAuthContext=function(t){if(!t.aadAppId)throw new Error("No AAD app ID was specified.");if(!t.aadTenant)throw new Error("No AAD tenant was specified.");return this.defaultAuthContext||(this.defaultAuthContext=new Df({instance:t.aadInstance||l,tenant:t.aadTenant,clientId:t.aadAppId,cacheLocation:this.constants.preferredCacheLocation})),this.defaultAuthContext},Uf.prototype._loginAndAcquire=function(i,r){function t(){n.options.authContext.acquireToken(v,function(t){if(t)r(new Error(t));else{var e={map:n.map,type:Uf.constants.events.tokenAcquired};n.map.events.invoke(Uf.constants.events.tokenAcquired,e),i()}})}var n=this,e=this.options.authContext.getCachedToken(this.options.aadAppId),o=this.options.authContext.getCachedUser();if(e&&o)t();else{this.options.authContext.loginInProgress()||this.options.authContext.login();var a=setInterval(function(){n.options.authContext.loginInProgress()||(clearInterval(a),n.options.authContext.getCachedToken(n.options.aadAppId)?t():r(new Error(n.options.authContext.getLoginError()||"The AAD authentication context is not logged-in for the specified app ID: "+n.options.aadAppId)))},25)}},Uf.prototype.getAuthType=function(){return this.options.authType},Uf.prototype.getClientId=function(){return this.options.clientId},Uf.prototype.getToken=function(){var r=this;if(this.options.authType===p.AuthenticationType.aad){var n=this.options.authContext.getCachedToken(v);return n||(this.options.authContext.getCachedUser()||this.options.authContext.login(),this.options.authContext.acquireToken(v,function(t,e){if(!t){n=e;var i={map:r.map,type:Uf.constants.events.tokenAcquired};r.map.events.invoke(Uf.constants.events.tokenAcquired,i)}})),n}if(this.options.authType===p.AuthenticationType.anonymous){var t=this._getItem(Uf.constants.storage.accessTokenKey);if(t){var e=this._getTokenExpiry(t);if(e<300&&0<e)this._triggerTokenFetch();else if(e<=0)throw this._saveItem(Uf.constants.storage.accessTokenKey,""),new Error(Uf.constants.errors.tokenExpired)}else this._triggerTokenFetch();return t}if(this.options.authType===p.AuthenticationType.subscriptionKey)return this.options.subscriptionKey},Uf.prototype._getTokenExpiry=function(t){var e=Bf(t).exp,i=this._getCurrentTime();return 0<e-i?e-i:-1},Uf.prototype._storeAccessToken=function(t){this._saveItem(Uf.constants.storage.accessTokenKey,t);var e={map:this.map,type:Uf.constants.events.tokenAcquired};this.map.events.invoke(Uf.constants.events.tokenAcquired,e)},Uf.prototype._saveItem=function(t,e){return this._supportsLocalStorage()?(localStorage.setItem(t,e),!0):!!this._supportsSessionStorage()&&(sessionStorage.setItem(t,e),!0)},Uf.prototype._getItem=function(t){return this._supportsLocalStorage()?localStorage.getItem(t):this._supportsSessionStorage()?sessionStorage.getItem(t):null},Uf.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem(Uf.constants.storage.testStorageKey,"A"),"A"===window.localStorage.getItem(Uf.constants.storage.testStorageKey)&&(window.localStorage.removeItem(Uf.constants.storage.testStorageKey),!window.localStorage.getItem(Uf.constants.storage.testStorageKey)))}catch(t){return!1}},Uf.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem(Uf.constants.storage.testStorageKey,"A"),"A"===window.sessionStorage.getItem(Uf.constants.storage.testStorageKey)&&(window.sessionStorage.removeItem(Uf.constants.storage.testStorageKey),!window.sessionStorage.getItem(Uf.constants.storage.testStorageKey)))}catch(t){return!1}},Uf.prototype._getCurrentTime=function(){return Math.round((new Date).getTime()/1e3)},Uf.prototype.signRequest=function(t){t.headers=t.headers||{},t.headers[_]=this.sessionId,t.headers[g]=y,t.headers[f]="MapControl/"+D+" (Web)";var e=this.getToken();switch(this.options.authType){case p.AuthenticationType.aad:case p.AuthenticationType.anonymous:t.headers[m]=this.options.clientId,t.headers[u]=c+e;break;case p.AuthenticationType.subscriptionKey:if("url"in t)-1!==t.url.indexOf("?")?t.url+="&subscription-key="+e:t.url+="?&subscription-key="+e;else{if(!("domain"in t))throw new Error("Could not determine if the provided object was UrlOptions or RequestParameters");t.queryParams=t.queryParams||{},t.queryParams["subscription-key"]=e}break;default:throw new Error("An invalid authentication type was specified")}return t},Uf.constants={preferredCacheLocation:"localStorage",storage:{accessTokenKey:"access.token.key",testStorageKey:"testStorage"},events:{tokenAcquired:"tokenacquired"},tokenExpiresIn:3599,tokenRefreshClockSkew:300,errors:{tokenExpired:"Token Expired, Try again"}},Uf);function Uf(t){var n=this;this._triggerTokenFetch=function(){return new Promise(function(i,r){n.options.getToken(function(t){try{var e=n._getTokenExpiry(t)-Uf.constants.tokenRefreshClockSkew;n._storeAccessToken(t),clearTimeout(n.tokenTimeOutHandle),n.tokenTimeOutHandle=setTimeout(n._triggerTokenFetch,1e3*e),i()}catch(t){r(new Error("Invalid token returned by getToken function"))}},function(t){r(t)},n.map)})};var e=t.getServiceOptions();this.options=e.authOptions,this.sessionId=e.sessionId,this.map=t}var jf=(qf.prototype.add=function(t,e){if(Array.isArray(t))for(var i=0,r=t;i<r.length;i++){var n=r[i];this._add(n,e)}else this._add(t,e)},qf.prototype.getControls=function(){return Array.from(this.controls)},qf.prototype.remove=function(t){if(Array.isArray(t))for(var e=0,i=t;e<i.length;e++){var r=i[e];this._remove(r)}else this._remove(t)},qf.prototype._add=function(t,e){this.controls.add(t);var i=(new N).merge(e),r=t.onAdd(this.map,e),n=this.controlContainer.getElementsByClassName(i.position);if(!(0<n.length))throw new Error("Control position "+i.position+" does not exist.");n.item(0).appendChild(r)},qf.prototype._remove=function(t){t.onRemove(),this.controls.delete(t)},qf);function qf(t){for(var e in this.map=t,this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("atlas-control-container"),p.ControlPosition)if(p.ControlPosition.hasOwnProperty(e)){var i=document.createElement("div");i.classList.add(p.ControlPosition[e]),i.classList.add("subcontrol-container"),this.controlContainer.appendChild(i)}this.map.getMapContainer().appendChild(this.controlContainer),this.controls=new Set}var Vf=(Gf.prototype.addCallback=function(s,l,u,t,c){var e,p,h=this;if(t)e=function(t){var e=t.lngLat?new bo(t.lngLat.lng,t.lngLat.lat):void 0,i=t.point?[t.point.x,t.point.y]:void 0,r=t.features?t.features.map(function(t){return new hn(t.geometry,t.properties,t.id)}):[],n={type:t.type,originalEvent:t.originalEvent,position:e,coordinate:i,features:r};u(n)};else switch(s){case"data":case"sourcedata":case"styledata":e=function(t){var e=w(w({dataType:t.dataType},"source"===t.dataType&&w(w(w({isSourceLoaded:t.isSourceLoaded},t.sourceDataType&&{sourceDataType:t.sourceDataType}),{source:h.map.sources.getById(t.sourceId)}),t.tile&&{tile:{id:{x:t.tile.tileID.canonical.x,y:t.tile.tileID.canonical.y,z:t.tile.tileID.canonical.z},size:t.tile.tileSize,state:t.tile.state}})),{map:h.map,type:t.type});c&&h.map.events._removeListener(s,l,u),u(e)};break;case"error":e=function(t){var e={error:t.error,map:h.map,type:t.type};c&&h.map.events._removeListener(s,l,u),u(e)};break;case"touchstart":case"touchend":case"touchmove":case"touchcancel":e=function(t){if(t.originalEvent){if(t.originalEvent===p)return;p=t.originalEvent}var e=t.point?new mn(t.point.x,t.point.y):void 0,i=t.points?t.points.map(function(t){return new mn(t.x,t.y)}):[],r=t.lngLat?new bo(t.lngLat.lng,t.lngLat.lat):void 0,n=t.lngLats?t.lngLats.map(function(t){return new bo(t.lng,t.lat)}):[],o=r?h.map.layers.getRenderedShapes(new yn(r),l?[l]:void 0):[],a={map:h.map,originalEvent:t.originalEvent,pixel:e,pixels:i,position:r,positions:n,shapes:o,layerId:l||void 0,preventDefault:function(){return t.preventDefault()},type:t.type};c&&h.map.events._removeListener(s,l,u),u(a)};break;case"mousedown":case"mouseup":case"mouseover":case"mousemove":case"click":case"dblclick":case"mouseout":case"mouseenter":case"mouseleave":case"contextmenu":e=function(t){if(t.originalEvent){if(t.originalEvent===p)return;p=t.originalEvent}var e=t.lngLat?new bo(t.lngLat.lng,t.lngLat.lat):void 0,i=t.point?new mn(t.point.x,t.point.y):void 0,r=e?h.map.layers.getRenderedShapes(new yn(e),l?[l]:void 0):[],n={map:h.map,originalEvent:t.originalEvent,position:e,pixel:i,preventDefault:function(){return t.preventDefault()},shapes:r,layerId:l||void 0,type:t.type};c&&h.map.events._removeListener(s,l,u),u(n)};break;case"styleimagemissing":e=function(t){c&&h.map.events._removeListener(s,l,u),u(t.id)};break;case"wheel":e=function(t){if(t.originalEvent){if(t.originalEvent===p)return;p=t.originalEvent}var e={map:h.map,originalEvent:t.originalEvent,preventDefault:function(){return t.preventDefault()},type:t.type};c&&h.map.events._removeListener(s,l,u),u(e)};break;case"resize":e=function(t){var e={map:h.map,type:t.type};for(var i in t)"type"!==i&&"target"!==i&&(e[i]=t[i]);c&&h.map.events._removeListener(s,l,u),u(e)};break;default:e=function(t){var e={map:h.map,type:t.type};t.originalEvent&&(e.originalEvent=t.originalEvent),c&&h.map.events._removeListener(s,l,u),u(e)}}this.callbacks.has(l)||this.callbacks.set(l,new kr),this.callbacks.get(l).has(s)||this.callbacks.get(l).set(s,new kr),this.callbacks.get(l).get(s).set(u,[e,c])},Gf.prototype.removeCallback=function(t,e,i){this.callbacks.has(e)&&this.callbacks.get(e).has(t)&&this.callbacks.get(e).get(t).has(i)&&this.callbacks.get(e).get(t).delete(i)},Gf.prototype.getModifiedCallback=function(t,e,i){if(this.callbacks.has(e)&&this.callbacks.get(e).has(t)&&this.callbacks.get(e).get(t).has(i))return this.callbacks.get(e).get(t).get(i)[0]},Gf.prototype.getLayerCallbacks=function(t){if(this.callbacks.has(t))return this.callbacks.get(t)},Gf.prototype.getEventCallbacks=function(t,e){if(this.callbacks.has(e)){var i=this.callbacks.get(e);if(i.has(t))return i.get(t)}},Gf);function Gf(t){this.callbacks=new kr,this.map=t}var Zf=(Hf.prototype.add=function(t,e,i){if("function"==typeof e)this._addGlobalListener(t,e,!1,!1);else for(var r=0,n=e=Array.isArray(e)?e:[e];r<n.length;r++){var o=n[r];o instanceof fa&&fa._isMBoxEvent(t)?this._addLayerListener(t,o,i,!1,!1):o._addEventListener(t,i,!1)}},Hf.prototype.addOnce=function(t,e,i){"function"==typeof e?this._addGlobalListener(t,e,!1,!0):e instanceof fa&&fa._isMBoxEvent(t)?this._addLayerListener(t,e,i,!1,!0):e._addEventListener(t,i,!0)},Hf.prototype._addLegacy=function(t,e,i){"function"==typeof e?this._addGlobalListener(t,e,!0,!1):this._addLayerListener(t,e,i,!0,!1)},Hf.prototype._addLayerListener=function(t,e,i,r,n){var o=e instanceof fa?e.getId():e,a=this.map.layers.getLayerById(o),s=this.mapCallbackHandler.getModifiedCallback(t,o,i);if(s&&a)for(var l=0,u=a._getLayerIds();l<u.length;l++){var c=u[l];this.map._getMap().off(t,c,s)}if(this.mapCallbackHandler.addCallback(t,o,i,r,n),a){s=this.mapCallbackHandler.getModifiedCallback(t,o,i);for(var p=0,h=a._getLayerIds();p<h.length;p++)c=h[p],this.map._getMap().on(t,c,s)}},Hf.prototype._addGlobalListener=function(t,e,i,r){var n=this.mapCallbackHandler.getModifiedCallback(t,"",e);if(n&&this.map._getMap().off(t,n),this.mapCallbackHandler.addCallback(t,"",e,i,r),n=this.mapCallbackHandler.getModifiedCallback(t,"",e),"load"===t&&this.map._isLoaded()){var o={type:"load",map:this.map};setTimeout(function(){return n(o)})}else if("ready"===t){if(this.map._isReady()){var a={type:"ready",map:this.map};setTimeout(function(){return n(a)})}}else this.map._getMap().on(t,n)},Hf.prototype.invoke=function(t,e,i){if(void 0===i)this._invokeListeners(t,"",e);else if(e instanceof fa&&fa._isMBoxEvent(t))this._invokeListeners(t,e.getId(),i);else{if(!(e instanceof Io))throw new Error("The invoke target is invalid.");e._invokeEvent(t,i)}},Hf.prototype._invokeListeners=function(i,r,n){var o=this,t=this.mapCallbackHandler.getEventCallbacks(i,r);t?t.forEach(function(t,e){t[0],t[1]&&o._removeListener(i,r,e),e(n)}):"error"===i&&console.error("error"in n?n.error:n)},Hf.prototype.remove=function(t,e,i){if("function"==typeof e)this._removeListener(t,"",e);else for(var r=0,n=e=Array.isArray(e)?e:[e];r<n.length;r++){var o=n[r];o instanceof fa&&fa._isMBoxEvent(t)?this._removeListener(t,o,i):o._removeEventListener(t,i)}},Hf.prototype._removeLegacy=function(t,e,i){"function"==typeof e?this._removeListener(t,"",e):this._removeListener(t,e,i)},Hf.prototype._removeListener=function(t,e,i){var r=e instanceof fa?e.getId():e,n=this.mapCallbackHandler.getModifiedCallback(t,r,i);if(n)if(r){var o=this.map.layers.getLayerById(r);if(o)for(var a=0,s=o._getLayerIds();a<s.length;a++){var l=s[a];this.map._getMap().off(t,l,n)}}else this.map._getMap().off(t,n);this.mapCallbackHandler.removeCallback(t,r,i)},Hf.prototype._enableLayerEvents=function(a){var s=this,t=this.mapCallbackHandler.getLayerCallbacks(a.getId());t&&t.forEach(function(t,o){t.forEach(function(t){for(var e=t[0],i=0,r=a._getLayerIds();i<r.length;i++){var n=r[i];s.map._getMap().on(o,n,e)}})})},Hf.prototype._disableLayerEvents=function(a){var s=this,t=this.mapCallbackHandler.getLayerCallbacks(a.getId());t&&t.forEach(function(t,o){t.forEach(function(t){for(var e=t[0],i=0,r=a._getLayerIds();i<r.length;i++){var n=r[i];s.map._getMap().off(o,n,e)}})})},Hf);function Hf(t){this.map=t,this.mapCallbackHandler=new Vf(this.map)}var Wf=(Kf.prototype.add=function(t,e){if(Array.isArray(t))for(var i=0,r=t;i<r.length;i++){var n=r[i];this._addMarker(n,e)}else this._addMarker(t,e)},Kf.prototype._addMarker=function(t,e){t._addToMap(this.map,e),this.markers.add(t)},Kf.prototype.getMarkers=function(){return Array.from(this.markers)},Kf.prototype.remove=function(t){if(Array.isArray(t))for(var e=0,i=t;e<i.length;e++){var r=i[e];this._removeMarker(r)}else this._removeMarker(t)},Kf.prototype._removeMarker=function(e){var i=this;e instanceof Zs?(e._removeFromMap(),this.markers.delete(e)):this.markers.forEach(function(t){t._getId()===e&&(t._removeFromMap(),i.markers.delete(t))})},Kf.prototype.clear=function(){var e=this;this.markers.forEach(function(t){t._removeFromMap(),e.markers.delete(t)})},Kf);function Kf(t){this.markers=new Set,this.map=t}var Xf=(Yf.prototype.add=function(a,e){var s=this;return new Promise(function(i,r){if(s.userImages.has(a))i();else if(e instanceof HTMLImageElement||e instanceof ImageData)s.map._getMap().addImage(a,e),s.userImages.set(a,e),i();else if("string"==typeof e){var n,t=void 0;t=/<svg/i.test(e)&&!/^data:/i.test(e)?"data:image/svg+xml;base64,"+window.btoa(e):e;var o=!1;s.map._sendRequest(t,"Image").then(function(t){if(!o)return t.blob()}).then(function(t){if(!o){clearTimeout(n);var e=new Image;e.onload=function(){s.map._getMap().addImage(a,e),s.userImages.set(a,e),i()},e.onerror=e.onabort=function(){r("Failed to load image into HTML element.")},e.src=URL.createObjectURL(t)}}).catch(function(){o||(clearTimeout(n),r("Failed to load image into HTML element."))}),n=setTimeout(function(){o=!0,r("Failed to load image within specified timeout: "+s.imageLoadTimeout+" ms.")},s.imageLoadTimeout)}})},Yf.prototype.clear=function(){var i=this;this.userImages.forEach(function(t,e){i.map._getMap().removeImage(e)}),this.userImages.clear()},Yf.prototype.getImageIds=function(){var i=[];return this.userImages.forEach(function(t,e){i.push(e)}),i},Yf.prototype.createFromTemplate=function(t,e,i,r,n){i=i||"#1A73AA",r=r||"#fff";var o=Hl(e,n);return o=o.replace(/{color}/g,i).replace(/{secondaryColor}/g,r).replace(/{text}/g,""),this.add(t,o)},Yf.prototype.hasImage=function(t){return this.userImages.has(t)},Yf.prototype.remove=function(t){this.map._getMap().removeImage(t),this.userImages.delete(t)},Yf.prototype._restoreImages=function(){var i=this;this.userImages.forEach(function(t,e){i.map._getMap().hasImage(e)||i.map._getMap().addImage(e,t)})},Yf);function Yf(t){this.userImages=new kr,this.imageLoadTimeout=5e3,this.map=t}var Jf=(Qf.prototype.add=function(t,e,i){void 0===i&&(i=!0);var r=e instanceof fa?e.getId():e;if(Array.isArray(t))for(var n=0,o=t;n<o.length;n++){var a=o[n];this._addLayer(a,r,i)}else this._addLayer(t,r,i)},Qf.prototype._addLayer=function(e,i,t){if(i!==e.getId()&&this.layersById.has(i))if(this.layersById.has(e.getId())){var r=this.layers.findIndex(function(t){return t.getId()===e.getId()}),n=this.layers[r];t&&(this._removeMapboxLayers(n),this._addMapboxLayers(e,i)),this.map.events._disableLayerEvents(n),this.map.events._enableLayerEvents(e),this.layersById.set(e.getId(),e),this.layers.splice(r,1);var o=this.layers.findIndex(function(t){return t.getId()===i});this.layers.splice(o,0,e),n.onRemove(),e.onAdd(this.map)}else t&&this._addMapboxLayers(e,i),o=this.layers.findIndex(function(t){return t.getId()===i}),this.layers.splice(o,0,e),this.layersById.set(e.getId(),e),this.map.events._enableLayerEvents(e),e.onAdd(this.map);else this.layersById.has(e.getId())?(r=this.layers.findIndex(function(t){return t.getId()===e.getId()}),n=this.layers[r],t&&(this._removeMapboxLayers(n),this._addMapboxLayers(e,r+1)),this.map.events._disableLayerEvents(n),this.map.events._enableLayerEvents(e),this.layersById.set(e.getId(),e),this.layers[r]=e,n.onRemove()):(t&&this._addMapboxLayers(e),this.layersById.set(e.getId(),e),this.layers.push(e),this.map.events._enableLayerEvents(e)),e.onAdd(this.map)},Qf.prototype._addMapboxLayers=function(t,e){if(!this.map._isReady())throw new Error("The layer '"+t.getId()+"' could not be added to the map because the map is not ready. Please use a ready event listener to guarantee the map is ready before adding a layer to it.");if(!(t instanceof Ss)||t.getOptions().tileUrl){t instanceof Ba&&this.map._getMap().addSource(t._getSourceId(),t._buildSource());for(var i=this._getMapboxBefore(e),r=0,n=t._buildLayers();r<n.length;r++){var o=n[r];this.map._getMap().addLayer(o,i)}}},Qf.prototype._removeMapboxLayers=function(t){for(var e=0,i=t._getLayerIds();e<i.length;e++){var r=i[e];this.map._getMap().getLayer(r)&&this.map._getMap().removeLayer(r)}t instanceof Ba&&this.map._getMap().getSource(t._getSourceId())&&this.map._getMap().removeSource(t._getSourceId())},Qf.prototype._getMapboxBefore=function(e){if("string"==typeof e){var t=this.layersById.get(e);if(!t)return;for(var i=0,r=t._getLayerIds();i<r.length;i++){var n=r[i];if(this.map._getMap().getLayer(n))return n}e=this.layers.findIndex(function(t){return t.getId()===e})+1}for(var o=e;o<this.layers.length;o++)for(var a=0,s=this.layers[o]._getLayerIds();a<s.length;a++)if(n=s[a],this.map._getMap().getLayer(n))return n},Qf.prototype.clear=function(){for(var t=this.layers.length-1;0<=t;t--){var e=this.layers[t];this._removeMapboxLayers(e),this.map.events._disableLayerEvents(e),this.layersById.delete(e.getId()),this.layers.splice(t,1),e.onRemove()}},Qf.prototype.getLayerById=function(t){return this.layersById.get(t)},Qf.prototype.getLayers=function(){return this.layers.slice(0)},Qf.prototype._getSourceIds=function(){for(var e=new Set,t=0,i=this.layers;t<i.length;t++)i[t]._getSourceIds().forEach(function(t){return e.add(t)});return e},Qf.prototype.move=function(t,e){var i=t instanceof fa?t.getId():t,r=e instanceof fa?e.getId():e;if(!this.layersById.has(i))throw new Error("The layer '"+i+"' has not been added to the map and cannot be moved.");var n=this.layers.findIndex(function(t){return t.getId()===i});if(this._moveMapboxLayers(this.layers[n],r),t=this.layers[n],this.layers.splice(n,1),this.layersById.has(r)){var o=this.layers.findIndex(function(t){return t.getId()===r});this.layers.splice(o,0,t)}else this.layers.push(t)},Qf.prototype._moveMapboxLayers=function(t,e){for(var i=this._getMapboxBefore(e),r=0,n=t._getLayerIds();r<n.length;r++){var o=n[r];this.map._getMap().moveLayer(o,i)}},Qf.prototype.getRenderedShapes=function(t,e,i){var r,n,o=this;if(t=t||[-180,-85.0511,180,85.0511],Array.isArray(t)?4===t.length||6===t.length?r=this.map.positionsToPixels([Oo.getSouthWest(t),Oo.getNorthEast(t)]):2!==t.length&&3!==t.length||(r=this.map.positionsToPixels([t])[0]):r=this.map.positionsToPixels([t.coordinates])[0],e){n=[];for(var a=0,s=e=Array.isArray(e)?e:[e];a<s.length;a++){var l=s[a],u=l instanceof fa?l.getId():l;if(!this.layersById.has(u))throw new Error("The layer '"+u+"' has not been added to the map and its rendered features cannot be retrieved.");n.push.apply(n,this.layersById.get(u)._getLayerIds().filter(function(t){return!!o.map._getMap().getLayer(t)}))}}var c=this.map._getMap().queryRenderedFeatures(r,{layers:n,filter:i});return this.map.sources._mapFeaturesToShapes(c)},Qf.prototype.remove=function(t,e){if(void 0===e&&(e=!0),Array.isArray(t))for(var i=0,r=t;i<r.length;i++){var n=r[i];this._removeLayer(n,e)}else this._removeLayer(t,e)},Qf.prototype._removeLayer=function(t,e){var i=t instanceof fa?t.getId():t;if(!this.layersById.has(i))throw new Error("The layer '"+i+"' has not been added to the map and cannot be removed.");var r=this.layers.findIndex(function(t){return t.getId()===i}),n=this.layers[r];e&&this._removeMapboxLayers(n),this.layersById.delete(i),this.layers.splice(r,1),this.map.events._disableLayerEvents(n),n.onRemove()},Qf);function Qf(t){this.layersById=new kr,this.layers=[],this.map=t}var $f=(tm.prototype.add=function(t){for(var e=0,i=t=Array.isArray(t)?t:[t];e<i.length;e++){var r=i[e];this.popups.has(r)||(this.popups.add(r),r.attach(this.map))}},tm.prototype.clear=function(){var e=this;this.popups.forEach(function(t){e.popups.delete(t),t.remove()})},tm.prototype.remove=function(t){for(var e=0,i=t=Array.isArray(t)?t:[t];e<i.length;e++){var r=i[e];this.popups.has(r)&&(this.popups.delete(r),r.remove())}},tm.prototype.getPopups=function(){return Array.from(this.popups)},tm.prototype._getCollectionDiv=function(){var t=this.map.getMapContainer().querySelector("."+tm.Css.collection);return t||((t=document.createElement("div")).classList.add(tm.Css.collection),t.setAttribute("aria-label","Map Information"),this.map.getMapContainer().appendChild(t)),t},tm.prototype._addDraggedPopup=function(t){0===this.draggedPopups.size&&(this.map.getMapContainer().addEventListener("mousemove",this._onDrag),this.map.getMapContainer().addEventListener("touchmove",this._onDrag),this.map.getMapContainer().addEventListener("mouseup",this._onUp),this.map.getMapContainer().addEventListener("touchend",this._onUp)),this.draggedPopups.add(t)},tm.Css={collection:"popup-collection-container"},tm);function tm(t){var r=this;this._onDrag=function(t){var e,i;"mousemove"===t.type?(e=(t=t).clientX,i=t.clientY):"touchmove"===t.type&&(e=(t=t).touches[0].clientX,i=t.touches[0].clientY),r.draggedPopups.forEach(function(t){t._dragToPixel([e,i])})},this._onUp=function(){r.map.getMapContainer().removeEventListener("mousemove",r._onDrag),r.map.getMapContainer().removeEventListener("touchmove",r._onDrag),r.map.getMapContainer().removeEventListener("mouseup",r._onUp),r.map.getMapContainer().removeEventListener("touchend",r._onUp),r.draggedPopups.forEach(function(t){r.draggedPopups.delete(t),t._onUp()})},this.map=t,this.popups=new Set,this.draggedPopups=new Set}var em=(im.prototype.add=function(t,e){if(void 0===e&&(e=!0),Array.isArray(t))for(var i=0,r=t;i<r.length;i++){var n=r[i];this._addSource(n,e)}else this._addSource(t,e)},im.prototype.getRenderedShapes=function(t,e,i){var r="string"==typeof t?t:t.getId(),n=this.map._getMap().querySourceFeatures(r,{sourceLayer:i,filter:e});return this.map.sources._mapFeaturesToShapes(n,!0,this.sources.get(r))},im.prototype._buildSources=function(){var e={};return this.sources.forEach(function(t){e[t.getId()]=t._buildSource()}),e},im.prototype.clear=function(){var e=this;this.sources.forEach(function(t){e.remove(t)})},im.prototype.getById=function(t){return this.sources.get(t)},im.prototype.getSources=function(){return Array.from(this.sources.values())},im.prototype.isSourceLoaded=function(t){var e=t instanceof ea?t.getId():t;return this.map._getMap().isSourceLoaded(e)},im.prototype.remove=function(t,e){if(void 0===e&&(e=!0),Array.isArray(t))for(var i=0,r=t;i<r.length;i++){var n=r[i];this._removeSource(n,e)}else this._removeSource(t,e)},im.prototype._removeSource=function(t,e){var i=t instanceof ea?t.getId():t;if(this.sources.has(i)){if(this.map._getMap().getSource(i)&&e&&this.map._getMap().removeSource(i),this.map._getMap().getSource(i)&&e)throw new Error("One or more layers have a dependency on the source '"+i+"'");return this.sources.get(i)._setMap(null),void this.sources.delete(i)}throw new Error("'"+i+"' is not added to the map")},im.prototype._addSource=function(t,e){if(this.sources.has(t.getId())){if(e)throw new Error("'"+t.getId()+"' is already added to the map");this.sources.get(t.getId())._setMap(null),this.sources.delete(t.getId())}if(e){if(!this.map._isReady())throw new Error("The source '"+t.getId()+"' could not be added to the map because the map is not ready. Please use a ready event listener to guarantee the map is ready before adding a source to it.");this.map._getMap().addSource(t.getId(),t._buildSource())}this.sources.set(t.getId(),t),t._setMap(this.map)},im.prototype._mapFeaturesToShapes=function(t,e,i){for(var r=[],n=0,o=t;n<o.length;n++){var a=o[n];if((i||"string"==typeof a.source)&&"string"==typeof a.properties[Lo._shapeIdPropName]){var s=i||this.sources.get(a.source);if(s instanceof na){var l=s.getShapeById(a.properties[Lo._shapeIdPropName]);if(l instanceof Lo){r.push(l);continue}}}e||r.push(a)}return r},im);function im(t){this.map=t,this.sources=new kr}var rm,nm=(b(om,rm=I),om);function om(){var t=null!==rm&&rm.apply(this,arguments)||this;return t.duration=1e3,t.type="jump",t}var am,sm=(b(lm,am=I),lm);function lm(){var t=null!==am&&am.apply(this,arguments)||this;return t.bottom=0,t.left=0,t.right=0,t.top=0,t}var um,cm=(b(pm,um=I),pm.prototype.merge=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0,r=t;i<r.length;i++){var n=r[i];n&&"number"==typeof n.padding&&(n.padding={top:n.padding,bottom:n.padding,left:n.padding,right:n.padding})}return um.prototype.merge.apply(this,t)},pm);function pm(){var t=null!==um&&um.apply(this,arguments)||this;return t.bounds=[-180,-89,180,90],t.maxBounds=void 0,t.maxZoom=20,t.offset=new mn(0,0),t.padding=new sm,t}var hm,dm=(b(fm,hm=I),fm);function fm(){var t=null!==hm&&hm.apply(this,arguments)||this;return t.zoom=1,t.center=new bo(0,0),t.centerOffset=new mn(0,0),t.bearing=0,t.pitch=0,t.minZoom=1,t.maxZoom=20,t.maxBounds=void 0,t}var mm,gm=(b(ym,mm=I),ym);function ym(){var t=null!==mm&&mm.apply(this,arguments)||this;return t.name=void 0,t.before=void 0,t.minZoom=1,t.maxZoom=20,t.overwrite=!1,t.defer=!1,t.opacity=1,t}var vm,_m=(b(xm,vm=gm),xm);function xm(){var t=null!==vm&&vm.apply(this,arguments)||this;return t.color="rgba(0,0,0,.5)",t.outlineColor="#000",t.radius=1,t.outlineWidth=5,t.name="default-circles",t}var bm,wm=(b(Sm,bm=gm),Sm);function Sm(){var t=null!==bm&&bm.apply(this,arguments)||this;return t.cap="butt",t.join="miter",t.name="default-linestrings",t.color="#000",t.width=1,t}var Tm,Im=(b(Em,Tm=gm),Em);function Em(){var t=null!==Tm&&Tm.apply(this,arguments)||this;return t.iconSize=1,t.fontSize=14,t.fontColor="#000",t.textFont="SegoeUi-Regular",t.cluster=!0,t.clusterIcon=void 0,t.textOffset=[0,0],t.name="default-pins",t.icon="pin-darkblue",t.title="",t}var Cm,Am=(b(km,Cm=gm),km);function km(){var t=null!==Cm&&Cm.apply(this,arguments)||this;return t.color="rgba(0,0,0,.5)",t.outlineColor="#000",t.name="default-polygons",t}var Pm,Mm=(b(Lm,Pm=gm),Lm);function Lm(){var t=null!==Pm&&Pm.apply(this,arguments)||this;return t.name="default-raster",t}var Dm,zm=(b(Om,Dm=I),Om);function Om(){var t=null!==Dm&&Dm.apply(this,arguments)||this;return t.anchor="map",t.color="#FFFFFF",t.intensity=.5,t.position=[1.15,210,30],t}var Rm,Nm=(b(Bm,Rm=I),Bm.prototype.merge=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0,r=t;i<r.length;i++){var n=r[i];n&&(n.hasOwnProperty("view")?n.userRegion=n.view:n.hasOwnProperty("userRegion")&&(n.view=n.userRegion),"string"==typeof n.language&&(n.language=ml.getCode(n.language)))}return Rm.prototype.merge.apply(this,t)},Bm);function Bm(){var t=null!==Rm&&Rm.apply(this,arguments)||this;return t.autoResize=!0,t.language=Ol(),t.light=new zm,t.preserveDrawingBuffer=!1,t.renderWorldCopies=!0,t.showBuildingModels=!1,t.showFeedbackLink=!0,t.showLogo=!0,t.showTileBoundaries=!1,t.style="road",t.view=Bl(),t.userRegion=t.view,t}var Fm,Um=(b(jm,Fm=I),jm);function jm(){var t=null!==Fm&&Fm.apply(this,arguments)||this;return t.flow="none",t.incidents=!1,t}var qm,Vm=(b(Gm,qm=I),Gm.prototype.merge=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0,r=t;i<r.length;i++){var n=r[i];n&&(n.authOptions?"string"==typeof n.authOptions.subscriptionKey&&(n.subscriptionKey=n["subscription-key"]=n.authOptions.subscriptionKey):"string"==typeof n.subscriptionKey?(n["subscription-key"]=n.subscriptionKey,n.authOptions={authType:p.AuthenticationType.subscriptionKey,subscriptionKey:n.subscriptionKey}):"string"==typeof n["subscription-key"]&&(n.subscriptionKey=n["subscription-key"],n.authOptions={authType:p.AuthenticationType.subscriptionKey,subscriptionKey:n["subscription-key"]}),"string"==typeof n.sessionId?n["session-id"]=n.sessionId:"string"==typeof n["session-id"]&&(n.sessionId=n["session-id"]),"boolean"==typeof n.disableTelemetry?n["disable-telemetry"]=n.disableTelemetry:"boolean"==typeof n["disable-telemetry"]&&(n.disableTelemetry=n["disable-telemetry"]),"boolean"==typeof n.enableAccessibility?n["enable-accessibility"]=n.enableAccessibility:"boolean"==typeof n["enable-accessibility"]&&(n.enableAccessibility=n["enable-accessibility"]))}var o=qm.prototype.merge.apply(this,t);return o.authOptions.authType!==p.AuthenticationType.subscriptionKey&&(o["subscription-key"]=o.subscriptionKey=void 0),o},Gm._cloneCustomizer=function(t){if("object"==typeof t)return Object.assign({},t)},Gm);function Gm(){var t=null!==qm&&qm.apply(this,arguments)||this;return t.authOptions=Dl(),t.disableTelemetry=!1,t["disable-telemetry"]=t.disableTelemetry,t.domain=zl(),t.enableAccessibility=!0,t["enable-accessibility"]=t.enableAccessibility,t.refreshExpiredTiles=!0,t.subscriptionKey=Nl(),t["subscription-key"]=t.subscriptionKey,t.sessionId=Rl(),t["session-id"]=t.sessionId,t.transformRequest=void 0,t}var Zm=function(){this.version=8,this.sprite="",this.glyphs="",this.light={},this.sources={},this.layers=[]},Hm=(Wm.prototype.build=function(t){var e=new Zm;if(null!=this.glyphs&&(e.glyphs=this.glyphs),null!=this.sprite&&(e.sprite=this.sprite),null!=t.light&&Object.assign(e.light,t.light),null!=this.map.sources&&(e.sources=this.map.sources._buildSources()),null!=this.map.layers)for(var i=0,r=this.map.layers.getLayers();i<r.length;i++){var n=r[i];e.layers=e.layers.concat(n._buildLayers()),n instanceof Ba&&(e.sources[n._getSourceId()]=n._buildSource())}return e},Wm.prototype.setGlyphs=function(t){this.glyphs=t},Wm.prototype.setSprite=function(t){this.sprite=t},Wm);function Wm(t){this.sprite="",this.glyphs="{fontstack}/{range}",this.map=t}var Km,Xm=(b(Ym,Km=fa),Ym.prototype._buildLayers=function(){return this.layers},Ym.prototype._getLayerIds=function(){return this.layers.map(function(t){return t.id})},Ym.prototype._getSourceIds=function(){for(var t=new Set,e=0,i=this.layers;e<i.length;e++){var r=i[e];"string"==typeof r.source?t.add(r.source):r.source&&t.add(r.id)}return t},Ym);function Ym(t,e){var i=Km.call(this,e)||this;return i.layers=t,i}var Jm,Qm=(b($m,Jm=ea),$m.prototype._buildSource=function(){return this.source},$m.prototype._modifySource=function(t,e){var i=t.tiles.map(function(t){return"string"==typeof t?t:new P({domain:d,path:t.path,queryParams:w(w({},e),t.queryParams)}).toString()});return t.tiles=i,t},$m);function $m(t,e,i){var r=Jm.call(this,t)||this;return r.source=r._modifySource(e,i),r}var tg=(eg.prototype.initialize=function(){var e=this;return this.initPromise||(this.initPromise=this.request(o,a).then(function(t){e.definitions=t}).catch(function(t){throw new Error("Failed to retrieve the style definitions: "+t)})),this.initPromise},eg.prototype.getStyleComponents=function(c){return S(this,void 0,void 0,function(){var u,e,i,r=this;return T(this,function(t){return u=new Set,e=this.lookUp(c),i=e.layerGroups.map(function(l){return S(r,void 0,void 0,function(){var e,i,r,n,o,a,s;return T(this,function(t){switch(t.label){case 0:return e=l.layerPath,i=l.name,r={language:c.language},c.view&&(r.view=c.view),[4,this.buildComponent(i,e,r,u)];case 1:for(n=t.sent(),o=0,a=n.layer.layers;o<a.length;o++)"fill-extrusion"===(s=a[o]).type&&(s.layout=s.layout||{},s.layout.visibility=c.showBuildingModels?"visible":"none");return[2,n]}})})}),[2,Promise.all(i)]})})},eg.prototype.getFlowComponent=function(i,r){return S(this,void 0,void 0,function(){var e;return T(this,function(t){return e=this.getFlowPath(i,r),[2,this.buildComponent("flow",e)]})})},eg.prototype.getCopyrightCaption=function(t){var e=this.lookUp(t).copyright.join(" ");return t.showLogo||(e+=" ©2019 Microsoft"),e},eg.prototype.getSprite=function(t){var e=this.lookUp(t);return new P({domain:this.definitions.domain,path:e.spritePath}).toString()},eg.prototype.getGlyphs=function(t){var e=this.lookUp(t);return new P({domain:this.definitions.domain,path:e.glyphsPath}).toString()},eg.prototype.getFlowPath=function(t,e){return this.lookUp(t).flowPaths[e.flow]},eg.prototype.getTheme=function(t){return this.lookUp(t).theme.toLowerCase()||"light"},eg.prototype.getDef=function(){return this.definitions},eg.prototype.lookUp=function(t){for(var e,i=t.style||this.definitions.defaultStyle,r=0,n=this.definitions.styles;r<n.length;r++){var o=n[r];if(o.name===i)return o;o.name===this.definitions.defaultStyle&&(e=o)}return e},eg.prototype.request=function(e,i){return S(this,void 0,void 0,function(){return T(this,function(t){return[2,new P({domain:e,path:i}).get()]})})},eg.prototype.buildComponent=function(s,e,l,u){return S(this,void 0,void 0,function(){return T(this,function(t){return[2,this.request(this.definitions.domain,e).then(function(t){for(var e=new Xm(t.layers,s),i=[],r=0,n=t.sources;r<n.length;r++){var o=n[r],a=o.name;if(u){if(u.has(a))continue;u.add(a)}i.push(new Qm(a,o,l))}return{layer:e,sources:i}})]})})},eg);function eg(){}var ig=(rg.prototype.getCanvas=function(){return this.map.getCanvas()},rg.prototype.getCanvasContainer=function(){return this.map.getCanvasContainer()},rg.prototype.getMapContainer=function(){return this.map.getContainer()},rg.prototype.getServiceOptions=function(){return Jo(this.serviceOptions,Vm._cloneCustomizer)},rg.prototype.setServiceOptions=function(t){this.serviceOptions=(new Vm).merge(this.serviceOptions,t),this.serviceOptions["enable-accessibility"]?this.accessibleMapDelegate.addToMap():this.accessibleMapDelegate.removeFromMap()},rg.prototype.setCamera=function(t,e){var i,r;if(void 0===e&&(e=!1),"padding"in t||"offset"in t||"bounds"in t){var n=(new cm).merge({maxZoom:this.getCamera().maxZoom},t),o=this._generateSafeBounds(n.bounds);if(!(i=this.map.cameraForBounds(o,{padding:n.padding,offset:n.offset,maxZoom:n.maxZoom})))throw new Error("The map cannot be fit to the current canvas with the given CameraBoundsOptions.");this.map.setMaxZoom(n.maxZoom),r=this._generateSafeBounds(n.maxBounds)}else{var a=(new dm).merge(this.getCamera(),t);if(a.centerOffset&&2<=a.centerOffset.length){var s=a.centerOffset,l=ao([a.center],a.zoom);l[0][0]+=s[0],l[0][1]+=s[1],a.center=oo(l,a.zoom)[0]}i={center:a.center,zoom:a.zoom,bearing:a.bearing,pitch:a.pitch,around:void 0},this.map.setMinZoom(a.minZoom),this.map.setMaxZoom(a.maxZoom),r=this._generateSafeBounds(a.maxBounds)}r?this.map.setMaxBounds(r):this.map.setMaxBounds(null);var u=(new nm).merge(t),c={duration:u.duration,easing:function(t){return t},offset:[0,0],animate:!0},p={fromControl:e};"jump"===u.type?this.map.jumpTo(i,p):"ease"===u.type?this.map.easeTo(w(w({},i),c),p):"fly"===u.type&&this.map.flyTo(w(w({},i),c),p)},rg.prototype.setCameraBounds=function(t){this.setCamera(t)},rg.prototype.getCamera=function(){var t=this.map.getBounds().getSouthWest().toArray(),e=this.map.getBounds().getNorthEast().toArray();return{zoom:this.map.getZoom(),center:this.map.getCenter().toArray(),bearing:this.map.getBearing(),pitch:this.map.getPitch(),bounds:new Oo(t,e),minZoom:this.map.getMinZoom(),maxZoom:this.map.getMaxZoom()}},rg.prototype.setStyle=function(t){delete t.preserveDrawingBuffer;var e=(new Nm).merge(this.styleOptions,t);e.autoResize!==this.styleOptions.autoResize&&this._setAutoResize(e.autoResize),e.language!==this.styleOptions.language&&(this.localizedStringsPromise=ml.getStrings(e.language)),e.renderWorldCopies!==this.styleOptions.renderWorldCopies&&this.map.setRenderWorldCopies(e.renderWorldCopies),e.showFeedbackLink!==this.styleOptions.showFeedbackLink&&this.copyrightControl.setOptions({showFeedbackLink:e.showFeedbackLink}),e.showLogo&&!this.logoControl?(this.logoControl=new Gd,this.controls.add(this.logoControl,{position:p.ControlPosition.NonFixed})):!e.showLogo&&this.logoControl&&(this.controls.remove(this.logoControl),delete this.logoControl),e.showTileBoundaries!==this.styleOptions.showTileBoundaries&&(this.map.showTileBoundaries=e.showTileBoundaries),this._setStyleComponents(e),this.styleOptions=e},rg.prototype.getStyle=function(){return Ar(this.styleOptions)},rg.prototype.addIcon=function(t,e){this.imageSprite.add(t,e)},rg.prototype.addPins=function(t,e){var i,r=(new Im).merge(e),n=this.layers.getLayerById(r.name),o=!1;if(n||(o=!0,n=new ys(r.name+"-source",r.name,{source:r.name+"-source",minZoom:r.minZoom,maxZoom:r.maxZoom,iconOptions:{anchor:"center",size:r.iconSize,image:["case",["has","icon"],["get","icon"],r.icon],ignorePlacement:!r.cluster,opacity:r.opacity},textOptions:{anchor:"center",textField:["case",["has","point_count"],["to-string",["get","point_count"]],["has","title"],["to-string",["get","title"]],r.title],font:["case",["has","point_count"],["literal",["StandardFontCondensed-Bold"]],["literal",[r.textFont]]],size:["case",["has","point_count"],20,r.fontSize],ignorePlacement:!r.cluster,opacity:r.opacity,offset:["case",["has","point_count"],["literal",[.5,-.45]],["literal",[r.textOffset[0]/16,r.textOffset[1]/16]]],color:r.fontColor}})),!(n instanceof ys))throw new Error("A layer with name '"+r.name+"' already exists but it is not a SymbolLayer.A SymbolLayer should be used for rendering pins.");var a=n.getSource();"string"==typeof a?(i=a,a=this.sources.getById(i)):i=a.getId();var s=!1;if(a||(s=!0,a=new na(i,{cluster:r.cluster})),!(a instanceof na))throw new Error("The source with name '"+i+"' already exists but it is not a DataSource.New data can only be added to a DataSource.");s&&this.sources.add(a),o&&this.layers.add(n,r.before);var l=new No(t);r.defer?(r.overwrite&&a._clearNoUpdate(),a._addNoUpdate(l)):r.overwrite?a.setShapes(l):a.add(l)},rg.prototype.addCircles=function(t,e){var i,r=(new _m).merge(e),n=this.layers.getLayerById(r.name),o=!1;if(n||(o=!0,n=new Sa(r.name+"-source",r.name,{source:r.name+"-source",minZoom:r.minZoom,maxZoom:r.maxZoom,opacity:r.opacity,radius:["case",["has","radius"],["get","radius"],r.radius],color:["case",["has","color"],["get","color"],r.color],strokeColor:["case",["has","outlineColor"],["get","outlineColor"],r.outlineColor],strokeWidth:["case",["has","outlineWidth"],["get","outlineWidth"],r.outlineWidth]})),!(n instanceof Sa))throw new Error("A layer with name '"+r.name+"' already exists but it is not a BubbleLayer.A BubbleLayer should be used for rendering circles.");var a=n.getSource();"string"==typeof a?(i=a,a=this.sources.getById(i)):i=a.getId();var s=!1;if(a||(s=!0,a=new na(i)),!(a instanceof na))throw new Error("The source with name '"+i+"' already exists but it is not a DataSource.New data can only be added to a DataSource.");s&&this.sources.add(a),o&&this.layers.add(n,r.before);var l=new No(t);r.defer?(r.overwrite&&a._clearNoUpdate(),a._addNoUpdate(l)):r.overwrite?a.setShapes(l):a.add(l)},rg.prototype.addLinestrings=function(t,e){var i,r=(new wm).merge(e),n=this.layers.getLayerById(r.name),o=!1;if(n||(o=!0,n=new Wa(r.name+"-source",r.name,{source:r.name+"-source",minZoom:r.minZoom,maxZoom:r.maxZoom,lineCap:r.cap,lineJoin:r.join,strokeOpacity:r.opacity,strokeColor:["case",["has","color"],["get","color"],r.color],strokeWidth:["case",["has","width"],["get","width"],r.width]})),!(n instanceof Wa))throw new Error("A layer with name '"+r.name+"' already exists but it is not a LineLayer.A LineLayer should be used for rendering linestrings.");var a=n.getSource();"string"==typeof a?(i=a,a=this.sources.getById(i)):i=a.getId();var s=!1;if(a||(s=!0,a=new na(i)),!(a instanceof na))throw new Error("The source with name '"+i+"' already exists but it is not a DataSource.New data can only be added to a DataSource.");s&&this.sources.add(a),o&&this.layers.add(n,r.before);var l=new No(t);r.defer?(r.overwrite&&a._clearNoUpdate(),a._addNoUpdate(l)):r.overwrite?a.setShapes(l):a.add(l)},rg.prototype.addPolygons=function(t,e){var i,r=(new Am).merge(e),n=this.layers.getLayerById(r.name),o=!1;if(n||(o=!0,n=new os(r.name+"-source",r.name,{source:r.name+"-source",minZoom:r.minZoom,maxZoom:r.maxZoom,fillOpacity:r.opacity,fillColor:["case",["has","color"],["get","color"],r.color]})),!(n instanceof os))throw new Error("A layer with name '"+r.name+"' already exists but it is not a PolygonLayer.A PolygonLayer should be used for rendering linestrings.");var a=n.getSource();"string"==typeof a?(i=a,a=this.sources.getById(i)):i=a.getId();var s=!1;if(a||(s=!0,a=new na(i)),!(a instanceof na))throw new Error("The source with name '"+i+"' already exists but it is not a DataSource.New data can only be added to a DataSource.");s&&this.sources.add(a),o&&this.layers.add(n,r.before);var l=new No(t);r.defer?(r.overwrite&&a._clearNoUpdate(),a._addNoUpdate(l)):r.overwrite?a.setShapes(l):a.add(l)},rg.prototype.addRaster=function(t,e){var i,r=(new Mm).merge(e),n=this.layers.getLayerById(r.name),o=!1;if(n||(o=!0,n=new Ss({maxZoom:r.maxZoom,minZoom:r.minZoom,opacity:r.opacity,tileSize:256,tileUrl:"{subdomain}"},r.name)),!(n instanceof Ss))throw new Error("A layer with name '"+r.name+"' already exists but it is not a TileLayer.A TileLayer should be used for rendering raster images.");if("{subdomain}"!==n.getOptions().tileUrl)throw new Error("A TileLayer with name '"+r.name+"' already exists but was configured for a single tile url [default for new TileLayer(...)].");(i=!r.overwrite&&n.getOptions().subdomains||[]).push.apply(i,t),n._setOptionsNoUpdate({subdomains:i}),r.defer?o&&this.layers.add(n,r.before,!1):this.layers.add(n,r.before)},rg.prototype.getLayers=function(){return this.layers.getLayers().map(function(t){return t.getId()})},rg.prototype.removeLayers=function(t){for(var e=0,i=t;e<i.length;e++){var r=i[e];if(this.layers.getLayerById(r)){this.layers.remove(r);var n=r+"-source";this.sources.getById(n)&&this.sources.remove(n)}}},rg.prototype.addHtml=function(t,e){t.id||(t.id="marker_"+pn());var i=new Zs({htmlContent:t});return this.markers.add(i,e),t.id},rg.prototype.removeHtml=function(t){this.markers.remove(t)},rg.prototype.addEventListener=function(t,e,i){this.events._addLegacy(t,e,i)},rg.prototype.removeEventListener=function(t,e,i){this.events._removeLegacy(t,e,i)},rg.prototype.setUserInteraction=function(t){this.userInteractionDelegate.setOptions(t)},rg.prototype.getUserInteraction=function(){return this.userInteractionDelegate.getOptions()},rg.prototype.addControl=function(t,e){this.controls.add(t,e)},rg.prototype.removeControl=function(t){this.controls.remove(t)},rg.prototype.setTraffic=function(t){var e=this.trafficOptions.incidents,i=this.trafficOptions.flow;if(this.trafficOptions=(new Um).merge(this.trafficOptions,t),this.trafficOptions.incidents?e||this.incidentDelegate.addToMap():this.incidentDelegate.removeFromMap(),this.trafficOptions.flow&&"none"!==this.trafficOptions.flow)try{this.flowDelegate.addToMap()}catch(t){throw this.trafficOptions.flow=i,t}else this.flowDelegate.removeFromMap()},rg.prototype.getTraffic=function(){return Ar(this.trafficOptions)},rg.prototype.remove=function(){this.dispose()},rg.prototype.clear=function(){this.popups.clear(),this.layers.clear(),this.sources.clear(),this.markers.clear()},rg.prototype.dispose=function(){for(this.clear(),this.map.remove(),this.removed=!0;this.getMapContainer().firstChild;){var t=this.getMapContainer().firstChild;this.getMapContainer().removeChild(t)}},rg.prototype.resize=function(t,e,i){if("number"!=typeof t&&"string"!=typeof t||"number"!=typeof e&&"string"!=typeof e)i=t;else{var r=t;this.getMapContainer().style.height="number"==typeof r?r+"px":r,this.getMapContainer().style.width="number"==typeof e?e+"px":e}var n=this.getMapContainer().style.overflow;this.getMapContainer().style.overflow="hidden",this.map.resize(i),this.getMapContainer().style.overflow=n},rg.prototype.pixelsToPositions=function(t){for(var e=[],i=0,r=t;i<r.length;i++){var n=r[i],o=this.map.unproject(n);e.push(new bo(o.lng,o.lat))}return e},rg.prototype.positionsToPixels=function(t){for(var e=[],i=0,r=t;i<r.length;i++){var n=r[i],o=this.map.project(n);e.push(new mn(o.x,o.y))}return e},rg.prototype.areTilesLoaded=function(){return this.map.areTilesLoaded()},rg.prototype.stop=function(){this.map.stop()},rg.prototype._getMap=function(){return this.map},rg.prototype._rebuildStyle=function(){this.map.setStyle(this.styleBuilder.build(this.styleOptions)),this.imageSprite._restoreImages()},rg.prototype._isLoaded=function(){return this.loaded},rg.prototype._isReady=function(){return this.ready},rg.prototype._getLocalizedStrings=function(){return this.localizedStringsPromise},rg.prototype._sendRequest=function(t,e,i){var r;return"function"==typeof this.serviceOptions.transformRequest&&(r=this.serviceOptions.transformRequest(t,e)),r?fetch(r.url||t,{credentials:r.credentials,headers:w(w({},i),r.headers),method:"GET",mode:"cors"}):fetch(t,{headers:i,method:"GET",mode:"cors"})},rg.prototype._setAutoResize=function(t){t?window.addEventListener("resize",this._windowResizeCallback):window.removeEventListener("resize",this._windowResizeCallback)},rg.prototype._setStyleComponents=function(g){var y=this;this.styles.getStyleComponents(g).then(function(o){if(!y.removed){y.copyrightControl.setOptions({copyrightMessage:y.styles.getCopyrightCaption(g)}),y.styleBuilder.setGlyphs(y.styles.getGlyphs(g)),y.styleBuilder.setSprite(y.styles.getSprite(g));for(var e=new Set,i=new Set,t=0,r=o;t<r.length;t++){var n=r[t];e.add(n.layer.getId());for(var a=0,s=n.sources;a<s.length;a++){var l=s[a];i.add(l.getId())}}y.styleLayerIds.forEach(function(t){e.has(t)||(y.layers.getLayerById(t)&&y.layers.remove(t,!1),y.styleLayerIds.delete(t))});for(var u=function(t){var e=o[t].layer;if(y.styleLayerIds.add(e.getId()),y.layers.getLayerById(e.getId()))y.layers.add(e,void 0,!1);else if(0===t)y.layers.add(e,y.layers.getLayers()[0],!1);else{var i=o[t-1].layer,r=y.layers.getLayers(),n=r.findIndex(function(t){return t.getId()===i.getId()});y.layers.add(e,r[n+1],!1)}},c=0;c<o.length;c++)u(c);var p=y.layers._getSourceIds();y.styleSourceIds.forEach(function(t){p.has(t)||i.has(t)||(y.sources.getById(t)&&y.sources.remove(t,!1),y.styleSourceIds.delete(t))});for(var h=0,d=o;h<d.length;h++){n=d[h],y.sources.add(n.sources,!1);for(var f=0,m=n.sources;f<m.length;f++)l=m[f],y.styleSourceIds.add(l.getId())}y._rebuildStyle()}})},rg.prototype._updateGlobalDefaults=function(t){t&&(t.authOptions&&!Wl()&&Ul(t.authOptions),t.domain&&!Kl()&&jl(t.domain),!t.subscriptionKey&&!t["subscription-key"]||Wl()||Gl(t.subscriptionKey||t["subscription-key"]),!t.sessionId&&!t["session-id"]||Yl()||Vl(t.sessionId||t["session-id"]),t.language&&!Xl()&&ql(t.language),!t.userRegion&&!t.view||Jl()||Zl(t.userRegion||t.view))},rg.prototype._generateSafeBounds=function(t){if(t){var e=Oo.getSouth(t),i=Oo.getWest(t),r=Oo.getNorth(t),n=Oo.getEast(t);if(isNaN(e)||isNaN(i)||isNaN(r)||isNaN(n))throw new Error("The bounds specified are invalid: ["+t+"]");for(;n<i;)n+=360;return new Oo([i,e,n,r])}return t},rg.prototype._detectHighContrast=function(){var t,e;switch(ou.getHighContrastMode()){case"invert":t=rg.Css.hcLight,e="high_contrast_dark";break;case"light":t=rg.Css.hcLight,e="grayscale_light";break;case"dark":t=rg.Css.hcDark,e="high_contrast_dark"}t&&this.map.getContainer().classList.add(t),e&&"road"===this.styleOptions.style&&(this.styleOptions.style=e)},rg.Css={canvasContainer:"atlas-map-canvas-container",canvas:"atlas-map-canvas",container:"atlas-map",hcDark:"high-contrast-dark",hcLight:"high-contrast-light"},rg);function rg(t,e){var n=this;this.styleLayerIds=new Set,this.styleSourceIds=new Set,this.removed=!1,this.loaded=!1,this.ready=!1,this._windowResizeCallback=function(){return n.resize()};var i=!0;this._updateGlobalDefaults(e),this.serviceOptions=(new Vm).merge(e),this.styleOptions=(new Nm).merge(e),this.trafficOptions=new Um,this.styles=new tg,this.insights=new qd(this.serviceOptions);var r,o={attributionControl:!1,container:t,preserveDrawingBuffer:this.styleOptions.preserveDrawingBuffer,refreshExpiredTiles:this.serviceOptions.refreshExpiredTiles,renderWorldCopies:this.styleOptions.renderWorldCopies,trackResize:!1,transformRequest:function(t,e){var i={url:t};if("Tile"===e&&t.includes(d)){if(n.insights.trackEvent({name:"TileLoad"}),P.protoRegEx.test(n.serviceOptions.domain)){var r=t.indexOf(d);i.url=n.serviceOptions.domain+t.substring(r+d.length)}else i.url=t.replace(d,n.serviceOptions.domain);n.authentication.signRequest(i)}return n.serviceOptions.transformRequest&&cl(i,n.serviceOptions.transformRequest(i.url,e)),i}};r=this.serviceOptions.authOptions.clientId?this.serviceOptions.authOptions.clientId:this.serviceOptions.authOptions.subscriptionKey?this.serviceOptions.authOptions.subscriptionKey.replace(/.(?=.{3,}$)/g,"*"):"invalid-setting",this.insights.setAuthenticatedUserContext(this.serviceOptions.sessionId,r);try{var a=new h.Map(o);this.map=a,this.authentication=new Ff(this),this.controls=new jf(this),this.events=new Zf(this),this.imageSprite=new Xf(this),this.layers=new Jf(this),this.markers=new Wf(this),this.sources=new em(this),this.popups=new $f(this),this.styleBuilder=new Hm(this),this.map.getContainer().classList.add(rg.Css.container),this.map.getCanvasContainer().classList.add(rg.Css.canvasContainer),this.map.getCanvas().classList.add(rg.Css.canvas),this._detectHighContrast(),this.copyrightControl=new Yd({showFeedbackLink:this.styleOptions.showFeedbackLink}),this.controls.add(this.copyrightControl,{position:p.ControlPosition.NonFixed}),this.styleOptions.showLogo&&(this.logoControl=new Gd,this.controls.add(this.logoControl,{position:p.ControlPosition.NonFixed}));var s=this.authentication.initialize();if(this.removed)return;var l=function(){n.loaded=!0,n.map.off("load",l)};this.map.on("load",l);var u=function(){n.ready=!0,n.map.off("styledata",u);var t={map:n,type:"ready"};n.events.invoke("ready",t)};this.map.on("styledata",u),this._setAutoResize(this.styleOptions.autoResize),this.map.showTileBoundaries=this.styleOptions.showTileBoundaries,this.localizedStringsPromise=ml.getStrings(this.styleOptions.language);var c=this.styles.initialize();Promise.all([s,c]).then(function(){if(!n.removed){if(!n.authentication.getToken())throw new Error("AuthenticationManager finished initializing, but no token is available");n.serviceOptions["enable-accessibility"]&&n.accessibleMapDelegate.addToMap(),n._setStyleComponents(n.styleOptions)}}).catch(function(t){var e=t instanceof Error?t:new Error(t);n.insights.trackException({error:e});var i={map:n,type:"error",error:e};n.events.invoke("error",i)}),this.setCamera(w(w({},e),{type:"jump",duration:0})),this.incidentDelegate=new wf(this),this.flowDelegate=new uf(this),this.accessibleMapDelegate=new lf(this),this.userInteractionDelegate=new Mf(this,e),this.userInteractionDelegate.addToMap()}catch(t){throw i=!1,this.insights.trackException({error:t instanceof Error?t:new Error(t)}),t}finally{this.insights.trackEvent({name:"MapLoad"},{success:i,supported:Fl(!1),supportedWithPerformance:Fl(!0)}),this.insights.flush()}}var ng=(og.applyTemplate=function(e,i){var r=this,t=document.createElement("div");if(t.classList.add(og.Css.template),e){"boolean"!=typeof(i=i||{}).singleDescription&&(i.singleDescription=!0),i.sandboxContent="boolean"!=typeof i.sandboxContent||i.sandboxContent,i.title&&"string"==typeof i.content&&(i.content.includes("{title}")||i.content.includes("{name}"))||(e.title?i.title="{title}":e.name&&(i.title="{name}")),"boolean"!=typeof i.detectHyperlinks&&(i.detectHyperlinks=!0),"boolean"!=typeof i.parsePropertyPaths&&(i.parsePropertyPaths=!0),i.textColor&&(t.style.color=i.textColor),i.fillColor&&(t.style.backgroundColor=i.fillColor),i.title&&((a=this._applyStringTemplate(e,i.title,i)).innerText=a.textContent||a.innerText||"",this._appendChild(t,a,og.Css.title));var n=document.createElement("div");if(n.classList.add(og.Css.content),Array.isArray(i.content))0<i.content.length&&i.content[0].propertyPath?this._appendChild(n,this._generateContent(e,i.content,i),og.Css.item):i.content.forEach(function(t){r._appendChild(n,r._generateContent(e,t,i),og.Css.item)});else{var o=0;e.description&&Object.keys(e).forEach(function(t){r._ignoreProperty(t,e[t])||o++});var a=void 0;1===o||i.singleDescription&&e.description||2===o&&e.Snippet?(a=document.createElement("div")).innerHTML=e.description:a=this._generateContent(e,i.content,i),this._appendChild(n,a,og.Css.item)}""!==n.innerHTML&&(i.sandboxContent?t.appendChild(og._createSandboxedIframe(n,i)):t.appendChild(n))}return t},og._createSandboxedIframe=function(t,e){var i=document.createElement("iframe");i.sandbox.add("allow-popups");var r,n=t.innerHTML,o=!1,a=100,s=550,l=10;document.body.scrollWidth<=340&&(s=300,a=50);var u=n.split(/<(tr|div|br|li|h[0-9]|p>)/);r=Math.max.apply(Math,u.map(function(t){return t.replace(/<[a-zA-Z0-9\s=\/]+>/g,"").length}))-1;var c=Math.ceil(3.5*r);if(c<s&&(s=c,a=r),n.includes("<img")||n.includes("<video"))o=!0,i.width="550px";else{var p=-1<n.indexOf(og.Css.table)?25:20;l+=Math.max(.5*u.length*p,Math.ceil(n.replace(/<[a-zA-Z0-9\s=\/]+>/g,"").length/a)*p)}i.width=s+"px",i.height=o||280<l?"280px":l+"px";var h=e.textColor?"color:"+e.textColor+";":"",d=e.fillColor?"background-color:"+e.fillColor+";":"",f='<html><head><title></title><meta charset="utf-8" /><meta http-equiv="x-ua-compatible" content="IE=Edge" /><link rel="stylesheet" href="'+og._cssUrl+'" type="text/css"/><style>html, body{margin:0;padding:0;'+h+d+'}</style></head><body><div class="'+og.Css.template+'" style="padding:0;width:'+(s-20)+'px">'+n+"</div></body></html>";return void 0===i.srcdoc?i.src="data:text/html;charset=utf-8,"+encodeURI(f):i.srcdoc=f,i},og._appendChild=function(t,e,i){e&&(i&&(e.className=(e.className?e.className+" ":"")+i),t.appendChild(e))},og._generateContent=function(t,e,i){if(e)return Array.isArray(e)?this._generatePropertyInfoTable(t,e,i):this._applyStringTemplate(t,e,i);var r=this._generateDynamicTableHtml(t,null,i);if(r){var n=document.createElement("div");return n.innerHTML=r,n}return null},og._applyStringTemplate=function(t,e,i){if(e){for(var r=e,n=this._placeholderRx.exec(e);n;){if(2<=n.length){var o=this._getPropertyValue(t,n[1],i);r=r.replace(n[0],o)}n=this._placeholderRx.exec(e)}if(r){(r=r.trim()).includes("<")&&(r=r.replace(/[\r\n]+/g,"<br/>"));var a=document.createElement("div");return a.innerHTML=r,a}}return null},og._getPropertyValue=function(t,e,i,r){var n=i.parsePropertyPaths?e.split("/"):[e],o=n.length;if(0<o&&t){var a=n[0],s=t[a];if(i.detectHyperlinks&&"link"===e&&(!r||r.hyperlinkFormat)){var l=[];if(Array.isArray(s)?s.forEach(function(t){t.href?l.push(t):"string"==typeof t&&l.push({href:t})}):s.href&&l.push(s),0<l.length){var u,c;r&&r.hyperlinkFormat?u=r.hyperlinkFormat:i&&i.hyperlinkFormat&&(u=i.hyperlinkFormat),c=u&&u.target?u.target:"_blank";var p=[];return l.forEach(function(t){t.title||u&&u.label||!t.rel||p.push(t.rel," - "),p.push('<a href="',t.href,'" target="',c,'">'),t.title?p.push(t.title):u&&u.label?p.push(u.label):p.push(t.href),p.push("</a>","<br/>")}),p.pop(),p.join("")}}if(null!=s){var h=void 0;for(h=1;h<o&&(s=s[n[h]],a=n[h],null!=s);h++);if(h===o&&null!=s){var d=void 0;if((d=void 0!==s.value?s.value:s)instanceof Date)return r&&r.dateFormat?d.toLocaleString(void 0,r.dateFormat):i.dateFormat?d.toLocaleString(void 0,i.dateFormat):d.toISOString();if("object"==typeof d)return(v=this._generateDynamicTableHtml(d,n.slice(1),i))||"";if("number"==typeof d){if(r){if(r.dateFormat)return new Date(d).toLocaleString(void 0,r.dateFormat);if(r.numberFormat)return d.toLocaleString(void 0,r.numberFormat)}else if(/(timestamp|date)/gi.test(a))return new Date(d).toISOString();return d.toLocaleString(void 0,i.numberFormat)}if("string"==typeof d&&""!==d&&!/[\n\r<>\s]/g.test(d)&&(i.detectHyperlinks||r&&r.hyperlinkFormat)){d=d.trim();var f=this._isUrlRx.test(d)||r&&r.hyperlinkFormat,m=this._isImageUrlRx.test(d)&&(f||d.startsWith("data:image")),g=this._emailRx.test(d);if(f||m||g){var y=void 0;r&&r.hyperlinkFormat?y=r.hyperlinkFormat:i&&i.hyperlinkFormat&&(y=i.hyperlinkFormat);var v=void 0;v=y&&y.target?' target="'+y.target+'"':' target="_blank"';var _=""+(y&&y.label?y.label:d);y&&y.scheme?d=y.scheme+d:g&&(d="mailto:"+d);var x=y&&y.label?' alt="'+y.label+'"':"";return(y&&y.isImage||m)&&(_='<img src="'+d+'" style="max-width:100%"'+x+'"/>'),'<a href="'+d+'"'+v+">"+_+"</a>"}}return d.toString()}}}return""},og._generatePropertyInfoTable=function(r,t,n){if(r&&t&&0<t.length){var o=[],a=this;o.push('<table class="'+a.Css.table+'">'),t.forEach(function(t){var e=a._getPropertyValue(r,t.propertyPath,n,t);if(t.hideLabel)o.push('<tr><td colspan="2">',e,"</td></tr>");else{var i=t.label||t.propertyPath.split("/")[0];o.push("<tr><th>",i,"</th><td>",e,"</td></tr>")}}),o.push("</table>");var e=document.createElement("div");return e.innerHTML=o.join(""),e}return null},og._generateDynamicTableHtml=function(e,t,i){var r=this;if(e){var n=[],o=this;n.push('<table class="'+o.Css.table+'">');var a=t&&0<t.length?t.join("/")+"/":"",s=0;return Object.keys(e).forEach(function(t){r._ignoreProperty(t,e[t])||(n.push("<tr><th>",t,"</th><td>",o._getPropertyValue(e,a+t,i),"</td></tr>"),s++)}),0===s?null:(n.push("</table>"),n.join(""))}return null},og._ignoreProperty=function(t,e){switch(t){case"title":case"name":case"base":case"popupTemplate":case"anchor":case"icon":case"image":case"imageUrl":case"rotation":case"color":case"size":case"offset":case"strokeColor":case"strokeWidth":case"strokeOpacity":case"subType":case"fillColor":case"fillOpacity":case"visibility":case"visible":return!0;default:if(0===t.indexOf("_")||null==e||""===e)return!0}return!1},og._placeholderRx=/\{([a-zA-Z0-9_\/\s]+)\}/gi,og._isUrlRx=/^(http|https|ftp|tel|mailto):\/\//i,og._isImageUrlRx=/(^data:image|.png$|.jpg$|.jpeg$|.gif$|.bmp$|.svg|.tif|.tiff$)/i,og._emailRx=/^[^\.\s@:](?:[^\s@:]*[^\s@:\.])?@[^\.\s@]+(?:\.[^\.\s@]+)*$/,og._cssUrl=new P({domain:o,path:"sdk/javascript/mapcontrol/"+z.getEndpointVersion()+"/atlas.min.css"}).toString(),og.Css={template:"azure-maps-control-popup-template",title:"azure-maps-control-popup-template-title",content:"azure-maps-control-popup-template-content",item:"azure-maps-control-popup-template-content-item",table:"azure-maps-control-popup-template-table"},og);function og(){this.detectHyperlinks=!0,this.parsePropertyPaths=!0}i(new P({domain:o,path:"sdk/javascript/mapcontrol/"+z.getEndpointVersion()+"/mapbox-gl-rtl-text.min.js"}).toString(),function(t){t&&console.warn(t)},!0),p.HtmlMarker=Zs,p.Map=ig,p.Pixel=mn,p.Popup=Fs,p.PopupTemplate=ng,p.Shape=Lo,p._getAssetDomain=function(){return n},p._getDomain=function(){return zl()},p._hasSetAuthenticationOptions=Wl,p._hasSetDomain=Kl,p._hasSetLanguage=Xl,p._hasSetSessionId=Yl,p._hasSetView=Jl,p.addImageTemplate=function(t,e,i){!i&&nu[t.toLowerCase()]||(nu[t.toLowerCase()]=e)},p.control=jr,p.data=Xo,p.getAllImageTemplateNames=function(){return Object.keys(nu)},p.getAuthenticationOptions=Dl,p.getDomain=zl,p.getImageTemplate=Hl,p.getLanguage=Ol,p.getSessionId=Rl,p.getSubscriptionKey=Nl,p.getUserRegion=function(){return bl},p.getVersion=function(){return z.getFullVersion()},p.getView=Bl,p.internal=Co,p.isSupported=Fl,p.layer=Is,p.math=Mo,p.setAuthenticationOptions=Ul,p.setDomain=jl,p.setLanguage=ql,p.setSessionId=Vl,p.setSubscriptionKey=Gl,p.setUserRegion=Zl,p.setView=function(t){bl=t,Al=!0},p.source=da,Object.defineProperty(p,"__esModule",{value:!0})});
